{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Home","text":""},{"location":"#diffraction-data-analysis-library","title":"Diffraction data analysis library","text":"<p>Here is a brief overview of the main documentation sections:</p> <ul> <li> Introduction \u2013   Provides an overview of EasyDiffraction, including its purpose, licensing,   latest release details, and contact information.</li> <li> Installation &amp; Setup \u2013   Guides users through system requirements, environment configuration, and the   installation process.</li> <li> User Guide \u2013 Covers core   concepts, key terminology, workflow steps, and essential parameters for   effective use of EasyDiffraction.</li> <li> Tutorials \u2013 Offers practical,   step-by-step examples demonstrating common workflows and data analysis tasks.</li> <li> API Reference \u2013 An   auto-generated reference detailing the available functions and modules in   EasyDiffraction.</li> </ul>"},{"location":"api-reference/","title":"API Reference","text":"<p>This section contains the reference detailing the functions and modules available in EasyDiffraction:</p> <ul> <li>core \u2013 Contains core utilities and foundational objects used across   the package.</li> <li>crystallography \u2013 Handles crystallographic calculations,   space groups, and symmetry operations.</li> <li>utils \u2013 Miscellaneous utility functions for formatting,   decorators, and general helpers.</li> <li>display \u2013 Tools for plotting data and rendering tables.</li> <li>project \u2013 Defines the project and manages its state.</li> <li>sample_models \u2013 Defines sample models, such as   crystallographic structures, and manages their properties.</li> <li>experiments \u2013 Manages experimental setups and instrument   parameters, as well as the associated diffraction data.</li> <li>analysis \u2013 Provides tools for analyzing diffraction data,   including fitting and minimization.</li> <li>summary \u2013 Provides a summary of the project.</li> </ul>"},{"location":"api-reference/analysis/","title":"analysis","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis","title":"<code>analysis</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis","title":"<code>analysis</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis","title":"<code>Analysis</code>","text":"<p>High-level orchestration of analysis tasks for a Project.</p> <p>This class wires calculators and minimizers, exposes a compact interface for parameters, constraints and results, and coordinates computations across the project's sample models and experiments.</p> <p>Typical usage:</p> <ul> <li>Display or filter parameters to fit.</li> <li>Select a calculator/minimizer implementation.</li> <li>Calculate patterns and run single or joint fits.</li> </ul> <p>project: The parent Project object.     aliases: A registry of human-friendly aliases for parameters.     constraints: Symbolic constraints between parameters. calculator: Active calculator used for computations.     fitter: Active fitter/minimizer driver.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>class Analysis:\n    \"\"\"High-level orchestration of analysis tasks for a Project.\n\n    This class wires calculators and minimizers, exposes a compact\n    interface for parameters, constraints and results, and coordinates\n    computations across the project's sample models and experiments.\n\n    Typical usage:\n\n    - Display or filter parameters to fit.\n    - Select a calculator/minimizer implementation.\n    - Calculate patterns and run single or joint fits.\n\n    Attributes:\n    project: The parent Project object.\n        aliases: A registry of human-friendly aliases for parameters.\n        constraints: Symbolic constraints between parameters.\n    calculator: Active calculator used for computations.\n        fitter: Active fitter/minimizer driver.\n    \"\"\"\n\n    _calculator = CalculatorFactory.create_calculator('cryspy')\n\n    def __init__(self, project) -&gt; None:\n        \"\"\"Create a new Analysis instance bound to a project.\n\n        Args:\n            project: The project that owns models and experiments.\n        \"\"\"\n        self.project = project\n        self.aliases = Aliases()\n        self.constraints = Constraints()\n        self.constraints_handler = ConstraintsHandler.get()\n        self.calculator = Analysis._calculator  # Default calculator shared by project\n        self._calculator_key: str = 'cryspy'  # Added to track the current calculator\n        self._fit_mode: str = 'single'\n        self.fitter = Fitter('lmfit (leastsq)')\n\n    def _get_params_as_dataframe(\n        self,\n        params: List[Union[NumericDescriptor, Parameter]],\n    ) -&gt; pd.DataFrame:\n        \"\"\"Convert a list of parameters to a DataFrame.\n\n        Args:\n            params: List of DescriptorFloat or Parameter objects.\n\n        Returns:\n            A pandas DataFrame containing parameter information.\n        \"\"\"\n        records = []\n        for param in params:\n            record = {}\n            # TODO: Merge into one. Add field if attr exists\n            # TODO: f'{param.value!r}' for StringDescriptor?\n            if isinstance(param, (StringDescriptor, NumericDescriptor, Parameter)):\n                record = {\n                    ('fittable', 'left'): False,\n                    ('datablock', 'left'): param._identity.datablock_entry_name,\n                    ('category', 'left'): param._identity.category_code,\n                    ('entry', 'left'): param._identity.category_entry_name or '',\n                    ('parameter', 'left'): param.name,\n                    ('value', 'right'): param.value,\n                }\n            if isinstance(param, (NumericDescriptor, Parameter)):\n                record = record | {\n                    ('units', 'left'): param.units,\n                }\n            if isinstance(param, Parameter):\n                record = record | {\n                    ('fittable', 'left'): True,\n                    ('free', 'left'): param.free,\n                    ('min', 'right'): param.fit_min,\n                    ('max', 'right'): param.fit_max,\n                    ('uncertainty', 'right'): param.uncertainty or '',\n                }\n            records.append(record)\n\n        df = pd.DataFrame.from_records(records)\n        df.columns = pd.MultiIndex.from_tuples(df.columns)\n        return df\n\n    def show_all_params(self) -&gt; None:\n        \"\"\"Print a table with all parameters for sample models and\n        experiments.\n        \"\"\"\n        sample_models_params = self.project.sample_models.parameters\n        experiments_params = self.project.experiments.parameters\n\n        if not sample_models_params and not experiments_params:\n            log.warning('No parameters found.')\n            return\n\n        tabler = TableRenderer.get()\n\n        filtered_headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'value',\n            'fittable',\n        ]\n\n        console.paragraph('All parameters for all sample models (\ud83e\udde9 data blocks)')\n        df = self._get_params_as_dataframe(sample_models_params)\n        filtered_df = df[filtered_headers]\n        tabler.render(filtered_df)\n\n        console.paragraph('All parameters for all experiments (\ud83d\udd2c data blocks)')\n        df = self._get_params_as_dataframe(experiments_params)\n        filtered_df = df[filtered_headers]\n        tabler.render(filtered_df)\n\n    def show_fittable_params(self) -&gt; None:\n        \"\"\"Print a table with parameters that can be included in\n        fitting.\n        \"\"\"\n        sample_models_params = self.project.sample_models.fittable_parameters\n        experiments_params = self.project.experiments.fittable_parameters\n\n        if not sample_models_params and not experiments_params:\n            log.warning('No fittable parameters found.')\n            return\n\n        tabler = TableRenderer.get()\n\n        filtered_headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'value',\n            'uncertainty',\n            'units',\n            'free',\n        ]\n\n        console.paragraph('Fittable parameters for all sample models (\ud83e\udde9 data blocks)')\n        df = self._get_params_as_dataframe(sample_models_params)\n        filtered_df = df[filtered_headers]\n        tabler.render(filtered_df)\n\n        console.paragraph('Fittable parameters for all experiments (\ud83d\udd2c data blocks)')\n        df = self._get_params_as_dataframe(experiments_params)\n        filtered_df = df[filtered_headers]\n        tabler.render(filtered_df)\n\n    def show_free_params(self) -&gt; None:\n        \"\"\"Print a table with only currently-free (varying)\n        parameters.\n        \"\"\"\n        sample_models_params = self.project.sample_models.free_parameters\n        experiments_params = self.project.experiments.free_parameters\n        free_params = sample_models_params + experiments_params\n\n        if not free_params:\n            log.warning('No free parameters found.')\n            return\n\n        tabler = TableRenderer.get()\n\n        filtered_headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'value',\n            'uncertainty',\n            'min',\n            'max',\n            'units',\n        ]\n\n        console.paragraph(\n            'Free parameters for both sample models (\ud83e\udde9 data blocks) '\n            'and experiments (\ud83d\udd2c data blocks)'\n        )\n        df = self._get_params_as_dataframe(free_params)\n        filtered_df = df[filtered_headers]\n        tabler.render(filtered_df)\n\n    def how_to_access_parameters(self) -&gt; None:\n        \"\"\"Show Python access paths for all parameters.\n\n        The output explains how to reference specific parameters in\n        code.\n        \"\"\"\n        sample_models_params = self.project.sample_models.parameters\n        experiments_params = self.project.experiments.parameters\n        all_params = {\n            'sample_models': sample_models_params,\n            'experiments': experiments_params,\n        }\n\n        if not all_params:\n            log.warning('No parameters found.')\n            return\n\n        columns_headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'How to Access in Python Code',\n        ]\n\n        columns_alignment = [\n            'left',\n            'left',\n            'left',\n            'left',\n            'left',\n        ]\n\n        columns_data = []\n        project_varname = self.project._varname\n        for datablock_code, params in all_params.items():\n            for param in params:\n                if isinstance(param, (StringDescriptor, NumericDescriptor, Parameter)):\n                    datablock_entry_name = param._identity.datablock_entry_name\n                    category_code = param._identity.category_code\n                    category_entry_name = param._identity.category_entry_name or ''\n                    param_key = param.name\n                    code_variable = (\n                        f'{project_varname}.{datablock_code}'\n                        f\"['{datablock_entry_name}'].{category_code}\"\n                    )\n                    if category_entry_name:\n                        code_variable += f\"['{category_entry_name}']\"\n                    code_variable += f'.{param_key}'\n                    columns_data.append([\n                        datablock_entry_name,\n                        category_code,\n                        category_entry_name,\n                        param_key,\n                        code_variable,\n                    ])\n\n        console.paragraph('How to access parameters')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_parameter_cif_uids(self) -&gt; None:\n        \"\"\"Show CIF unique IDs for all parameters.\n\n        The output explains which unique identifiers are used when\n        creating CIF-based constraints.\n        \"\"\"\n        sample_models_params = self.project.sample_models.parameters\n        experiments_params = self.project.experiments.parameters\n        all_params = {\n            'sample_models': sample_models_params,\n            'experiments': experiments_params,\n        }\n\n        if not all_params:\n            log.warning('No parameters found.')\n            return\n\n        columns_headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'Unique Identifier for CIF Constraints',\n        ]\n\n        columns_alignment = [\n            'left',\n            'left',\n            'left',\n            'left',\n            'left',\n        ]\n\n        columns_data = []\n        for _, params in all_params.items():\n            for param in params:\n                if isinstance(param, (StringDescriptor, NumericDescriptor, Parameter)):\n                    datablock_entry_name = param._identity.datablock_entry_name\n                    category_code = param._identity.category_code\n                    category_entry_name = param._identity.category_entry_name or ''\n                    param_key = param.name\n                    cif_uid = param._cif_handler.uid\n                    columns_data.append([\n                        datablock_entry_name,\n                        category_code,\n                        category_entry_name,\n                        param_key,\n                        cif_uid,\n                    ])\n\n        console.paragraph('Show parameter CIF unique identifiers')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_calculator(self) -&gt; None:\n        \"\"\"Print the name of the currently selected calculator\n        engine.\n        \"\"\"\n        console.paragraph('Current calculator')\n        console.print(self.current_calculator)\n\n    @staticmethod\n    def show_supported_calculators() -&gt; None:\n        \"\"\"Print a table of available calculator backends on this\n        system.\n        \"\"\"\n        CalculatorFactory.show_supported_calculators()\n\n    @property\n    def current_calculator(self) -&gt; str:\n        \"\"\"The key/name of the active calculator backend.\"\"\"\n        return self._calculator_key\n\n    @current_calculator.setter\n    def current_calculator(self, calculator_name: str) -&gt; None:\n        \"\"\"Switch to a different calculator backend.\n\n        Args:\n            calculator_name: Calculator key to use (e.g. 'cryspy').\n        \"\"\"\n        calculator = CalculatorFactory.create_calculator(calculator_name)\n        if calculator is None:\n            return\n        self.calculator = calculator\n        self._calculator_key = calculator_name\n        console.paragraph('Current calculator changed to')\n        console.print(self.current_calculator)\n\n    def show_current_minimizer(self) -&gt; None:\n        \"\"\"Print the name of the currently selected minimizer.\"\"\"\n        console.paragraph('Current minimizer')\n        console.print(self.current_minimizer)\n\n    @staticmethod\n    def show_available_minimizers() -&gt; None:\n        \"\"\"Print a table of available minimizer drivers on this\n        system.\n        \"\"\"\n        MinimizerFactory.show_available_minimizers()\n\n    @property\n    def current_minimizer(self) -&gt; Optional[str]:\n        \"\"\"The identifier of the active minimizer, if any.\"\"\"\n        return self.fitter.selection if self.fitter else None\n\n    @current_minimizer.setter\n    def current_minimizer(self, selection: str) -&gt; None:\n        \"\"\"Switch to a different minimizer implementation.\n\n        Args:\n            selection: Minimizer selection string, e.g.\n                'lmfit (leastsq)'.\n        \"\"\"\n        self.fitter = Fitter(selection)\n        console.paragraph('Current minimizer changed to')\n        console.print(self.current_minimizer)\n\n    @property\n    def fit_mode(self) -&gt; str:\n        \"\"\"Current fitting strategy: either 'single' or 'joint'.\"\"\"\n        return self._fit_mode\n\n    @fit_mode.setter\n    def fit_mode(self, strategy: str) -&gt; None:\n        \"\"\"Set the fitting strategy.\n\n        When set to 'joint', all experiments get default weights and\n        are used together in a single optimization.\n\n        Args:\n                strategy: Either 'single' or 'joint'.\n\n        Raises:\n            ValueError: If an unsupported strategy value is\n                provided.\n        \"\"\"\n        if strategy not in ['single', 'joint']:\n            raise ValueError(\"Fit mode must be either 'single' or 'joint'\")\n        self._fit_mode = strategy\n        if strategy == 'joint' and not hasattr(self, 'joint_fit_experiments'):\n            # Pre-populate all experiments with weight 0.5\n            self.joint_fit_experiments = JointFitExperiments()\n            for id in self.project.experiments.names:\n                self.joint_fit_experiments.add(id=id, weight=0.5)\n        console.paragraph('Current fit mode changed to')\n        console.print(self._fit_mode)\n\n    def show_available_fit_modes(self) -&gt; None:\n        \"\"\"Print all supported fitting strategies and their\n        descriptions.\n        \"\"\"\n        strategies = [\n            {\n                'Strategy': 'single',\n                'Description': 'Independent fitting of each experiment; no shared parameters',\n            },\n            {\n                'Strategy': 'joint',\n                'Description': 'Simultaneous fitting of all experiments; '\n                'some parameters are shared',\n            },\n        ]\n\n        columns_headers = ['Strategy', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data = []\n        for item in strategies:\n            strategy = item['Strategy']\n            description = item['Description']\n            columns_data.append([strategy, description])\n\n        console.paragraph('Available fit modes')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_fit_mode(self) -&gt; None:\n        \"\"\"Print the currently active fitting strategy.\"\"\"\n        console.paragraph('Current fit mode')\n        console.print(self.fit_mode)\n\n    def show_constraints(self) -&gt; None:\n        \"\"\"Print a table of all user-defined symbolic constraints.\"\"\"\n        constraints_dict = dict(self.constraints)\n\n        if not self.constraints._items:\n            log.warning('No constraints defined.')\n            return\n\n        rows = []\n        for constraint in constraints_dict.values():\n            row = {\n                'lhs_alias': constraint.lhs_alias.value,\n                'rhs_expr': constraint.rhs_expr.value,\n                'full expression': f'{constraint.lhs_alias.value} = {constraint.rhs_expr.value}',\n            }\n            rows.append(row)\n\n        headers = ['lhs_alias', 'rhs_expr', 'full expression']\n        alignments = ['left', 'left', 'left']\n        rows = [[row[header] for header in headers] for row in rows]\n\n        console.paragraph('User defined constraints')\n        render_table(\n            columns_headers=headers,\n            columns_alignment=alignments,\n            columns_data=rows,\n        )\n\n    def apply_constraints(self):\n        \"\"\"Apply the currently defined constraints to the active\n        project.\n        \"\"\"\n        if not self.constraints._items:\n            log.warning('No constraints defined.')\n            return\n\n        self.constraints_handler.set_aliases(self.aliases)\n        self.constraints_handler.set_constraints(self.constraints)\n        self.constraints_handler.apply()\n\n    def fit(self):\n        \"\"\"Execute fitting using the selected mode, calculator and\n        minimizer.\n\n        This method performs the optimization but does not display\n        results automatically. Call :meth:`show_fit_results` after\n        fitting to see a summary of the fit quality and parameter\n        values.\n\n        In 'single' mode, fits each experiment independently. In\n        'joint' mode, performs a simultaneous fit across experiments\n        with weights.\n\n        Sets :attr:`fit_results` on success, which can be accessed\n        programmatically\n        (e.g., ``analysis.fit_results.reduced_chi_square``).\n\n        Example::\n\n            project.analysis.fit()\n            project.analysis.show_fit_results()  # Display results\n        \"\"\"\n        sample_models = self.project.sample_models\n        if not sample_models:\n            log.warning('No sample models found in the project. Cannot run fit.')\n            return\n\n        experiments = self.project.experiments\n        if not experiments:\n            log.warning('No experiments found in the project. Cannot run fit.')\n            return\n\n        # Run the fitting process\n        if self.fit_mode == 'joint':\n            console.paragraph(\n                f\"Using all experiments \ud83d\udd2c {experiments.names} for '{self.fit_mode}' fitting\"\n            )\n            self.fitter.fit(\n                sample_models,\n                experiments,\n                weights=self.joint_fit_experiments,\n                analysis=self,\n            )\n        elif self.fit_mode == 'single':\n            # TODO: Find a better way without creating dummy\n            #  experiments?\n            for expt_name in experiments.names:\n                console.paragraph(\n                    f\"Using experiment \ud83d\udd2c '{expt_name}' for '{self.fit_mode}' fitting\"\n                )\n                experiment = experiments[expt_name]\n                dummy_experiments = Experiments()  # TODO: Find a better name\n\n                # This is a workaround to set the parent project\n                # of the dummy experiments collection, so that\n                # parameters can be resolved correctly during fitting.\n                object.__setattr__(dummy_experiments, '_parent', self.project)\n\n                dummy_experiments._add(experiment)\n                self.fitter.fit(\n                    sample_models,\n                    dummy_experiments,\n                    analysis=self,\n                )\n        else:\n            raise NotImplementedError(f'Fit mode {self.fit_mode} not implemented yet.')\n\n        # After fitting, get the results\n        self.fit_results = self.fitter.results\n\n    def show_fit_results(self) -&gt; None:\n        \"\"\"Display a summary of the fit results.\n\n        Renders the fit quality metrics (reduced \u03c7\u00b2, R-factors) and a\n        table of fitted parameters with their starting values, final\n        values, and uncertainties.\n\n        This method should be called after :meth:`fit` completes. If no\n        fit has been performed yet, a warning is logged.\n\n        Example::\n\n            project.analysis.fit()\n            project.analysis.show_fit_results()\n        \"\"\"\n        if not hasattr(self, 'fit_results') or self.fit_results is None:\n            log.warning('No fit results available. Run fit() first.')\n            return\n\n        sample_models = self.project.sample_models\n        experiments = self.project.experiments\n\n        self.fitter._process_fit_results(sample_models, experiments)\n\n    def _update_categories(self, called_by_minimizer=False) -&gt; None:\n        \"\"\"Update all categories owned by Analysis.\n\n        This ensures aliases and constraints are up-to-date before\n        serialization or after parameter changes.\n\n        Args:\n            called_by_minimizer: Whether this is called during fitting.\n        \"\"\"\n        # Apply constraints to sync dependent parameters\n        if self.constraints._items:\n            self.constraints_handler.apply()\n\n        # Update category-specific logic\n        # TODO: Need self.categories as in the case of datablock.py\n        for category in [self.aliases, self.constraints]:\n            if hasattr(category, '_update'):\n                category._update(called_by_minimizer=called_by_minimizer)\n\n    def as_cif(self):\n        \"\"\"Serialize the analysis section to a CIF string.\n\n        Returns:\n            The analysis section represented as a CIF document string.\n        \"\"\"\n        from easydiffraction.io.cif.serialize import analysis_to_cif\n\n        self._update_categories()\n        return analysis_to_cif(self)\n\n    def show_as_cif(self) -&gt; None:\n        \"\"\"Render the analysis section as CIF in a formatted console\n        view.\n        \"\"\"\n        cif_text: str = self.as_cif()\n        paragraph_title: str = 'Analysis \ud83e\uddee info as cif'\n        console.paragraph(paragraph_title)\n        render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.__init__","title":"<code>__init__(project)</code>","text":"<p>Create a new Analysis instance bound to a project.</p> <p>Parameters:</p> Name Type Description Default <code>project</code> <p>The project that owns models and experiments.</p> required Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def __init__(self, project) -&gt; None:\n    \"\"\"Create a new Analysis instance bound to a project.\n\n    Args:\n        project: The project that owns models and experiments.\n    \"\"\"\n    self.project = project\n    self.aliases = Aliases()\n    self.constraints = Constraints()\n    self.constraints_handler = ConstraintsHandler.get()\n    self.calculator = Analysis._calculator  # Default calculator shared by project\n    self._calculator_key: str = 'cryspy'  # Added to track the current calculator\n    self._fit_mode: str = 'single'\n    self.fitter = Fitter('lmfit (leastsq)')\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.apply_constraints","title":"<code>apply_constraints()</code>","text":"<p>Apply the currently defined constraints to the active project.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def apply_constraints(self):\n    \"\"\"Apply the currently defined constraints to the active\n    project.\n    \"\"\"\n    if not self.constraints._items:\n        log.warning('No constraints defined.')\n        return\n\n    self.constraints_handler.set_aliases(self.aliases)\n    self.constraints_handler.set_constraints(self.constraints)\n    self.constraints_handler.apply()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.as_cif","title":"<code>as_cif()</code>","text":"<p>Serialize the analysis section to a CIF string.</p> <p>Returns:</p> Type Description <p>The analysis section represented as a CIF document string.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def as_cif(self):\n    \"\"\"Serialize the analysis section to a CIF string.\n\n    Returns:\n        The analysis section represented as a CIF document string.\n    \"\"\"\n    from easydiffraction.io.cif.serialize import analysis_to_cif\n\n    self._update_categories()\n    return analysis_to_cif(self)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.current_calculator","title":"<code>current_calculator</code>  <code>property</code> <code>writable</code>","text":"<p>The key/name of the active calculator backend.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.current_minimizer","title":"<code>current_minimizer</code>  <code>property</code> <code>writable</code>","text":"<p>The identifier of the active minimizer, if any.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.fit","title":"<code>fit()</code>","text":"<p>Execute fitting using the selected mode, calculator and minimizer.</p> <p>This method performs the optimization but does not display results automatically. Call :meth:<code>show_fit_results</code> after fitting to see a summary of the fit quality and parameter values.</p> <p>In 'single' mode, fits each experiment independently. In 'joint' mode, performs a simultaneous fit across experiments with weights.</p> <p>Sets :attr:<code>fit_results</code> on success, which can be accessed programmatically (e.g., <code>analysis.fit_results.reduced_chi_square</code>).</p> <p>Example::</p> <pre><code>project.analysis.fit()\nproject.analysis.show_fit_results()  # Display results\n</code></pre> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def fit(self):\n    \"\"\"Execute fitting using the selected mode, calculator and\n    minimizer.\n\n    This method performs the optimization but does not display\n    results automatically. Call :meth:`show_fit_results` after\n    fitting to see a summary of the fit quality and parameter\n    values.\n\n    In 'single' mode, fits each experiment independently. In\n    'joint' mode, performs a simultaneous fit across experiments\n    with weights.\n\n    Sets :attr:`fit_results` on success, which can be accessed\n    programmatically\n    (e.g., ``analysis.fit_results.reduced_chi_square``).\n\n    Example::\n\n        project.analysis.fit()\n        project.analysis.show_fit_results()  # Display results\n    \"\"\"\n    sample_models = self.project.sample_models\n    if not sample_models:\n        log.warning('No sample models found in the project. Cannot run fit.')\n        return\n\n    experiments = self.project.experiments\n    if not experiments:\n        log.warning('No experiments found in the project. Cannot run fit.')\n        return\n\n    # Run the fitting process\n    if self.fit_mode == 'joint':\n        console.paragraph(\n            f\"Using all experiments \ud83d\udd2c {experiments.names} for '{self.fit_mode}' fitting\"\n        )\n        self.fitter.fit(\n            sample_models,\n            experiments,\n            weights=self.joint_fit_experiments,\n            analysis=self,\n        )\n    elif self.fit_mode == 'single':\n        # TODO: Find a better way without creating dummy\n        #  experiments?\n        for expt_name in experiments.names:\n            console.paragraph(\n                f\"Using experiment \ud83d\udd2c '{expt_name}' for '{self.fit_mode}' fitting\"\n            )\n            experiment = experiments[expt_name]\n            dummy_experiments = Experiments()  # TODO: Find a better name\n\n            # This is a workaround to set the parent project\n            # of the dummy experiments collection, so that\n            # parameters can be resolved correctly during fitting.\n            object.__setattr__(dummy_experiments, '_parent', self.project)\n\n            dummy_experiments._add(experiment)\n            self.fitter.fit(\n                sample_models,\n                dummy_experiments,\n                analysis=self,\n            )\n    else:\n        raise NotImplementedError(f'Fit mode {self.fit_mode} not implemented yet.')\n\n    # After fitting, get the results\n    self.fit_results = self.fitter.results\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.fit_mode","title":"<code>fit_mode</code>  <code>property</code> <code>writable</code>","text":"<p>Current fitting strategy: either 'single' or 'joint'.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.how_to_access_parameters","title":"<code>how_to_access_parameters()</code>","text":"<p>Show Python access paths for all parameters.</p> <p>The output explains how to reference specific parameters in code.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def how_to_access_parameters(self) -&gt; None:\n    \"\"\"Show Python access paths for all parameters.\n\n    The output explains how to reference specific parameters in\n    code.\n    \"\"\"\n    sample_models_params = self.project.sample_models.parameters\n    experiments_params = self.project.experiments.parameters\n    all_params = {\n        'sample_models': sample_models_params,\n        'experiments': experiments_params,\n    }\n\n    if not all_params:\n        log.warning('No parameters found.')\n        return\n\n    columns_headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'How to Access in Python Code',\n    ]\n\n    columns_alignment = [\n        'left',\n        'left',\n        'left',\n        'left',\n        'left',\n    ]\n\n    columns_data = []\n    project_varname = self.project._varname\n    for datablock_code, params in all_params.items():\n        for param in params:\n            if isinstance(param, (StringDescriptor, NumericDescriptor, Parameter)):\n                datablock_entry_name = param._identity.datablock_entry_name\n                category_code = param._identity.category_code\n                category_entry_name = param._identity.category_entry_name or ''\n                param_key = param.name\n                code_variable = (\n                    f'{project_varname}.{datablock_code}'\n                    f\"['{datablock_entry_name}'].{category_code}\"\n                )\n                if category_entry_name:\n                    code_variable += f\"['{category_entry_name}']\"\n                code_variable += f'.{param_key}'\n                columns_data.append([\n                    datablock_entry_name,\n                    category_code,\n                    category_entry_name,\n                    param_key,\n                    code_variable,\n                ])\n\n    console.paragraph('How to access parameters')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_all_params","title":"<code>show_all_params()</code>","text":"<p>Print a table with all parameters for sample models and experiments.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_all_params(self) -&gt; None:\n    \"\"\"Print a table with all parameters for sample models and\n    experiments.\n    \"\"\"\n    sample_models_params = self.project.sample_models.parameters\n    experiments_params = self.project.experiments.parameters\n\n    if not sample_models_params and not experiments_params:\n        log.warning('No parameters found.')\n        return\n\n    tabler = TableRenderer.get()\n\n    filtered_headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'value',\n        'fittable',\n    ]\n\n    console.paragraph('All parameters for all sample models (\ud83e\udde9 data blocks)')\n    df = self._get_params_as_dataframe(sample_models_params)\n    filtered_df = df[filtered_headers]\n    tabler.render(filtered_df)\n\n    console.paragraph('All parameters for all experiments (\ud83d\udd2c data blocks)')\n    df = self._get_params_as_dataframe(experiments_params)\n    filtered_df = df[filtered_headers]\n    tabler.render(filtered_df)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_as_cif","title":"<code>show_as_cif()</code>","text":"<p>Render the analysis section as CIF in a formatted console view.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_as_cif(self) -&gt; None:\n    \"\"\"Render the analysis section as CIF in a formatted console\n    view.\n    \"\"\"\n    cif_text: str = self.as_cif()\n    paragraph_title: str = 'Analysis \ud83e\uddee info as cif'\n    console.paragraph(paragraph_title)\n    render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_available_fit_modes","title":"<code>show_available_fit_modes()</code>","text":"<p>Print all supported fitting strategies and their descriptions.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_available_fit_modes(self) -&gt; None:\n    \"\"\"Print all supported fitting strategies and their\n    descriptions.\n    \"\"\"\n    strategies = [\n        {\n            'Strategy': 'single',\n            'Description': 'Independent fitting of each experiment; no shared parameters',\n        },\n        {\n            'Strategy': 'joint',\n            'Description': 'Simultaneous fitting of all experiments; '\n            'some parameters are shared',\n        },\n    ]\n\n    columns_headers = ['Strategy', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data = []\n    for item in strategies:\n        strategy = item['Strategy']\n        description = item['Description']\n        columns_data.append([strategy, description])\n\n    console.paragraph('Available fit modes')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_available_minimizers","title":"<code>show_available_minimizers()</code>  <code>staticmethod</code>","text":"<p>Print a table of available minimizer drivers on this system.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>@staticmethod\ndef show_available_minimizers() -&gt; None:\n    \"\"\"Print a table of available minimizer drivers on this\n    system.\n    \"\"\"\n    MinimizerFactory.show_available_minimizers()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_constraints","title":"<code>show_constraints()</code>","text":"<p>Print a table of all user-defined symbolic constraints.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_constraints(self) -&gt; None:\n    \"\"\"Print a table of all user-defined symbolic constraints.\"\"\"\n    constraints_dict = dict(self.constraints)\n\n    if not self.constraints._items:\n        log.warning('No constraints defined.')\n        return\n\n    rows = []\n    for constraint in constraints_dict.values():\n        row = {\n            'lhs_alias': constraint.lhs_alias.value,\n            'rhs_expr': constraint.rhs_expr.value,\n            'full expression': f'{constraint.lhs_alias.value} = {constraint.rhs_expr.value}',\n        }\n        rows.append(row)\n\n    headers = ['lhs_alias', 'rhs_expr', 'full expression']\n    alignments = ['left', 'left', 'left']\n    rows = [[row[header] for header in headers] for row in rows]\n\n    console.paragraph('User defined constraints')\n    render_table(\n        columns_headers=headers,\n        columns_alignment=alignments,\n        columns_data=rows,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_current_calculator","title":"<code>show_current_calculator()</code>","text":"<p>Print the name of the currently selected calculator engine.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_current_calculator(self) -&gt; None:\n    \"\"\"Print the name of the currently selected calculator\n    engine.\n    \"\"\"\n    console.paragraph('Current calculator')\n    console.print(self.current_calculator)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_current_fit_mode","title":"<code>show_current_fit_mode()</code>","text":"<p>Print the currently active fitting strategy.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_current_fit_mode(self) -&gt; None:\n    \"\"\"Print the currently active fitting strategy.\"\"\"\n    console.paragraph('Current fit mode')\n    console.print(self.fit_mode)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_current_minimizer","title":"<code>show_current_minimizer()</code>","text":"<p>Print the name of the currently selected minimizer.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_current_minimizer(self) -&gt; None:\n    \"\"\"Print the name of the currently selected minimizer.\"\"\"\n    console.paragraph('Current minimizer')\n    console.print(self.current_minimizer)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_fit_results","title":"<code>show_fit_results()</code>","text":"<p>Display a summary of the fit results.</p> <p>Renders the fit quality metrics (reduced \u03c7\u00b2, R-factors) and a table of fitted parameters with their starting values, final values, and uncertainties.</p> <p>This method should be called after :meth:<code>fit</code> completes. If no fit has been performed yet, a warning is logged.</p> <p>Example::</p> <pre><code>project.analysis.fit()\nproject.analysis.show_fit_results()\n</code></pre> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_fit_results(self) -&gt; None:\n    \"\"\"Display a summary of the fit results.\n\n    Renders the fit quality metrics (reduced \u03c7\u00b2, R-factors) and a\n    table of fitted parameters with their starting values, final\n    values, and uncertainties.\n\n    This method should be called after :meth:`fit` completes. If no\n    fit has been performed yet, a warning is logged.\n\n    Example::\n\n        project.analysis.fit()\n        project.analysis.show_fit_results()\n    \"\"\"\n    if not hasattr(self, 'fit_results') or self.fit_results is None:\n        log.warning('No fit results available. Run fit() first.')\n        return\n\n    sample_models = self.project.sample_models\n    experiments = self.project.experiments\n\n    self.fitter._process_fit_results(sample_models, experiments)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_fittable_params","title":"<code>show_fittable_params()</code>","text":"<p>Print a table with parameters that can be included in fitting.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_fittable_params(self) -&gt; None:\n    \"\"\"Print a table with parameters that can be included in\n    fitting.\n    \"\"\"\n    sample_models_params = self.project.sample_models.fittable_parameters\n    experiments_params = self.project.experiments.fittable_parameters\n\n    if not sample_models_params and not experiments_params:\n        log.warning('No fittable parameters found.')\n        return\n\n    tabler = TableRenderer.get()\n\n    filtered_headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'value',\n        'uncertainty',\n        'units',\n        'free',\n    ]\n\n    console.paragraph('Fittable parameters for all sample models (\ud83e\udde9 data blocks)')\n    df = self._get_params_as_dataframe(sample_models_params)\n    filtered_df = df[filtered_headers]\n    tabler.render(filtered_df)\n\n    console.paragraph('Fittable parameters for all experiments (\ud83d\udd2c data blocks)')\n    df = self._get_params_as_dataframe(experiments_params)\n    filtered_df = df[filtered_headers]\n    tabler.render(filtered_df)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_free_params","title":"<code>show_free_params()</code>","text":"<p>Print a table with only currently-free (varying) parameters.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_free_params(self) -&gt; None:\n    \"\"\"Print a table with only currently-free (varying)\n    parameters.\n    \"\"\"\n    sample_models_params = self.project.sample_models.free_parameters\n    experiments_params = self.project.experiments.free_parameters\n    free_params = sample_models_params + experiments_params\n\n    if not free_params:\n        log.warning('No free parameters found.')\n        return\n\n    tabler = TableRenderer.get()\n\n    filtered_headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'value',\n        'uncertainty',\n        'min',\n        'max',\n        'units',\n    ]\n\n    console.paragraph(\n        'Free parameters for both sample models (\ud83e\udde9 data blocks) '\n        'and experiments (\ud83d\udd2c data blocks)'\n    )\n    df = self._get_params_as_dataframe(free_params)\n    filtered_df = df[filtered_headers]\n    tabler.render(filtered_df)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_parameter_cif_uids","title":"<code>show_parameter_cif_uids()</code>","text":"<p>Show CIF unique IDs for all parameters.</p> <p>The output explains which unique identifiers are used when creating CIF-based constraints.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>def show_parameter_cif_uids(self) -&gt; None:\n    \"\"\"Show CIF unique IDs for all parameters.\n\n    The output explains which unique identifiers are used when\n    creating CIF-based constraints.\n    \"\"\"\n    sample_models_params = self.project.sample_models.parameters\n    experiments_params = self.project.experiments.parameters\n    all_params = {\n        'sample_models': sample_models_params,\n        'experiments': experiments_params,\n    }\n\n    if not all_params:\n        log.warning('No parameters found.')\n        return\n\n    columns_headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'Unique Identifier for CIF Constraints',\n    ]\n\n    columns_alignment = [\n        'left',\n        'left',\n        'left',\n        'left',\n        'left',\n    ]\n\n    columns_data = []\n    for _, params in all_params.items():\n        for param in params:\n            if isinstance(param, (StringDescriptor, NumericDescriptor, Parameter)):\n                datablock_entry_name = param._identity.datablock_entry_name\n                category_code = param._identity.category_code\n                category_entry_name = param._identity.category_entry_name or ''\n                param_key = param.name\n                cif_uid = param._cif_handler.uid\n                columns_data.append([\n                    datablock_entry_name,\n                    category_code,\n                    category_entry_name,\n                    param_key,\n                    cif_uid,\n                ])\n\n    console.paragraph('Show parameter CIF unique identifiers')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.analysis.Analysis.show_supported_calculators","title":"<code>show_supported_calculators()</code>  <code>staticmethod</code>","text":"<p>Print a table of available calculator backends on this system.</p> Source code in <code>src/easydiffraction/analysis/analysis.py</code> <pre><code>@staticmethod\ndef show_supported_calculators() -&gt; None:\n    \"\"\"Print a table of available calculator backends on this\n    system.\n    \"\"\"\n    CalculatorFactory.show_supported_calculators()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators","title":"<code>calculators</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.base","title":"<code>base</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.base.CalculatorBase","title":"<code>CalculatorBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Base API for diffraction calculation engines.</p> Source code in <code>src/easydiffraction/analysis/calculators/base.py</code> <pre><code>class CalculatorBase(ABC):\n    \"\"\"Base API for diffraction calculation engines.\"\"\"\n\n    @property\n    @abstractmethod\n    def name(self) -&gt; str:\n        pass\n\n    @property\n    @abstractmethod\n    def engine_imported(self) -&gt; bool:\n        pass\n\n    @abstractmethod\n    def calculate_structure_factors(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n    ) -&gt; None:\n        \"\"\"Calculate structure factors for a single sample model and\n        experiment.\n        \"\"\"\n        pass\n\n    @abstractmethod\n    def calculate_pattern(\n        self,\n        sample_model: SampleModels,  # TODO: SampleModelBase?\n        experiment: ExperimentBase,\n        called_by_minimizer: bool,\n    ) -&gt; np.ndarray:\n        \"\"\"Calculate the diffraction pattern for a single sample model\n        and experiment.\n\n        Args:\n            sample_model: The sample model object.\n            experiment: The experiment object.\n            called_by_minimizer: Whether the calculation is called by a\n                minimizer.\n\n        Returns:\n            The calculated diffraction pattern as a NumPy array.\n        \"\"\"\n        pass\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.base.CalculatorBase.calculate_pattern","title":"<code>calculate_pattern(sample_model, experiment, called_by_minimizer)</code>  <code>abstractmethod</code>","text":"<p>Calculate the diffraction pattern for a single sample model and experiment.</p> <p>Parameters:</p> Name Type Description Default <code>sample_model</code> <code>SampleModels</code> <p>The sample model object.</p> required <code>experiment</code> <code>ExperimentBase</code> <p>The experiment object.</p> required <code>called_by_minimizer</code> <code>bool</code> <p>Whether the calculation is called by a minimizer.</p> required <p>Returns:</p> Type Description <code>ndarray</code> <p>The calculated diffraction pattern as a NumPy array.</p> Source code in <code>src/easydiffraction/analysis/calculators/base.py</code> <pre><code>@abstractmethod\ndef calculate_pattern(\n    self,\n    sample_model: SampleModels,  # TODO: SampleModelBase?\n    experiment: ExperimentBase,\n    called_by_minimizer: bool,\n) -&gt; np.ndarray:\n    \"\"\"Calculate the diffraction pattern for a single sample model\n    and experiment.\n\n    Args:\n        sample_model: The sample model object.\n        experiment: The experiment object.\n        called_by_minimizer: Whether the calculation is called by a\n            minimizer.\n\n    Returns:\n        The calculated diffraction pattern as a NumPy array.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.base.CalculatorBase.calculate_structure_factors","title":"<code>calculate_structure_factors(sample_model, experiment)</code>  <code>abstractmethod</code>","text":"<p>Calculate structure factors for a single sample model and experiment.</p> Source code in <code>src/easydiffraction/analysis/calculators/base.py</code> <pre><code>@abstractmethod\ndef calculate_structure_factors(\n    self,\n    sample_model: SampleModelBase,\n    experiment: ExperimentBase,\n) -&gt; None:\n    \"\"\"Calculate structure factors for a single sample model and\n    experiment.\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.crysfml","title":"<code>crysfml</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.crysfml.CrysfmlCalculator","title":"<code>CrysfmlCalculator</code>","text":"<p>               Bases: <code>CalculatorBase</code></p> <p>Wrapper for Crysfml library.</p> Source code in <code>src/easydiffraction/analysis/calculators/crysfml.py</code> <pre><code>class CrysfmlCalculator(CalculatorBase):\n    \"\"\"Wrapper for Crysfml library.\"\"\"\n\n    engine_imported: bool = cfml_py_utilities is not None\n\n    @property\n    def name(self) -&gt; str:\n        return 'crysfml'\n\n    def calculate_structure_factors(\n        self,\n        sample_models: SampleModels,\n        experiments: Experiments,\n    ) -&gt; None:\n        \"\"\"Call Crysfml to calculate structure factors.\n\n        Args:\n            sample_models: The sample models to calculate structure\n                factors for.\n            experiments: The experiments associated with the sample\n                models.\n        \"\"\"\n        raise NotImplementedError('HKL calculation is not implemented for CrysfmlCalculator.')\n\n    def calculate_pattern(\n        self,\n        sample_model: SampleModels,\n        experiment: ExperimentBase,\n        called_by_minimizer: bool = False,\n    ) -&gt; Union[np.ndarray, List[float]]:\n        \"\"\"Calculates the diffraction pattern using Crysfml for the\n        given sample model and experiment.\n\n        Args:\n            sample_model: The sample model to calculate the pattern for.\n            experiment: The experiment associated with the sample model.\n            called_by_minimizer: Whether the calculation is called by a\n            minimizer.\n\n        Returns:\n            The calculated diffraction pattern as a NumPy array or a\n                list of floats.\n        \"\"\"\n        # Intentionally unused, required by public API/signature\n        del called_by_minimizer\n\n        crysfml_dict = self._crysfml_dict(sample_model, experiment)\n        try:\n            _, y = cfml_py_utilities.cw_powder_pattern_from_dict(crysfml_dict)\n            y = self._adjust_pattern_length(y, len(experiment.data.x))\n        except KeyError:\n            print('[CrysfmlCalculator] Error: No calculated data')\n            y = []\n        return y\n\n    def _adjust_pattern_length(\n        self,\n        pattern: List[float],\n        target_length: int,\n    ) -&gt; List[float]:\n        \"\"\"Adjusts the length of the pattern to match the target length.\n\n        Args:\n            pattern: The pattern to adjust.\n            target_length: The desired length of the pattern.\n\n        Returns:\n            The adjusted pattern.\n        \"\"\"\n        # TODO: Check the origin of this discrepancy coming from\n        #  PyCrysFML\n        if len(pattern) &gt; target_length:\n            return pattern[:target_length]\n        return pattern\n\n    def _crysfml_dict(\n        self,\n        sample_model: SampleModels,\n        experiment: ExperimentBase,\n    ) -&gt; Dict[str, Union[ExperimentBase, SampleModelBase]]:\n        \"\"\"Converts the sample model and experiment into a dictionary\n        format for Crysfml.\n\n        Args:\n            sample_model: The sample model to convert.\n            experiment: The experiment to convert.\n\n        Returns:\n            A dictionary representation of the sample model and\n                experiment.\n        \"\"\"\n        sample_model_dict = self._convert_sample_model_to_dict(sample_model)\n        experiment_dict = self._convert_experiment_to_dict(experiment)\n        return {\n            'phases': [sample_model_dict],\n            'experiments': [experiment_dict],\n        }\n\n    def _convert_sample_model_to_dict(\n        self,\n        sample_model: SampleModelBase,\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Converts a sample model into a dictionary format.\n\n        Args:\n            sample_model: The sample model to convert.\n\n        Returns:\n            A dictionary representation of the sample model.\n        \"\"\"\n        sample_model_dict = {\n            sample_model.name: {\n                '_space_group_name_H-M_alt': sample_model.space_group.name_h_m.value,\n                '_cell_length_a': sample_model.cell.length_a.value,\n                '_cell_length_b': sample_model.cell.length_b.value,\n                '_cell_length_c': sample_model.cell.length_c.value,\n                '_cell_angle_alpha': sample_model.cell.angle_alpha.value,\n                '_cell_angle_beta': sample_model.cell.angle_beta.value,\n                '_cell_angle_gamma': sample_model.cell.angle_gamma.value,\n                '_atom_site': [],\n            }\n        }\n\n        for atom in sample_model.atom_sites:\n            atom_site = {\n                '_label': atom.label.value,\n                '_type_symbol': atom.type_symbol.value,\n                '_fract_x': atom.fract_x.value,\n                '_fract_y': atom.fract_y.value,\n                '_fract_z': atom.fract_z.value,\n                '_occupancy': atom.occupancy.value,\n                '_adp_type': 'Biso',  # Assuming Biso for simplicity\n                '_B_iso_or_equiv': atom.b_iso.value,\n            }\n            sample_model_dict[sample_model.name]['_atom_site'].append(atom_site)\n\n        return sample_model_dict\n\n    def _convert_experiment_to_dict(\n        self,\n        experiment: ExperimentBase,\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Converts an experiment into a dictionary format.\n\n        Args:\n            experiment: The experiment to convert.\n\n        Returns:\n            A dictionary representation of the experiment.\n        \"\"\"\n        expt_type = getattr(experiment, 'type', None)\n        instrument = getattr(experiment, 'instrument', None)\n        peak = getattr(experiment, 'peak', None)\n\n        x_data = experiment.data.x\n        twotheta_min = float(x_data.min())\n        twotheta_max = float(x_data.max())\n\n        # TODO: Process default values on the experiment creation\n        #  instead of here\n        exp_dict = {\n            'NPD': {\n                '_diffrn_radiation_probe': expt_type.radiation_probe.value\n                if expt_type\n                else 'neutron',\n                '_diffrn_radiation_wavelength': instrument.setup_wavelength.value\n                if instrument\n                else 1.0,\n                '_pd_instr_resolution_u': peak.broad_gauss_u.value if peak else 0.0,\n                '_pd_instr_resolution_v': peak.broad_gauss_v.value if peak else 0.0,\n                '_pd_instr_resolution_w': peak.broad_gauss_w.value if peak else 0.0,\n                '_pd_instr_resolution_x': peak.broad_lorentz_x.value if peak else 0.0,\n                '_pd_instr_resolution_y': peak.broad_lorentz_y.value if peak else 0.0,\n                '_pd_meas_2theta_offset': instrument.calib_twotheta_offset.value\n                if instrument\n                else 0.0,\n                '_pd_meas_2theta_range_min': twotheta_min,\n                '_pd_meas_2theta_range_max': twotheta_max,\n                '_pd_meas_2theta_range_inc': (twotheta_max - twotheta_min) / len(x_data),\n            }\n        }\n\n        return exp_dict\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.crysfml.CrysfmlCalculator.calculate_pattern","title":"<code>calculate_pattern(sample_model, experiment, called_by_minimizer=False)</code>","text":"<p>Calculates the diffraction pattern using Crysfml for the given sample model and experiment.</p> <p>Parameters:</p> Name Type Description Default <code>sample_model</code> <code>SampleModels</code> <p>The sample model to calculate the pattern for.</p> required <code>experiment</code> <code>ExperimentBase</code> <p>The experiment associated with the sample model.</p> required <code>called_by_minimizer</code> <code>bool</code> <p>Whether the calculation is called by a</p> <code>False</code> <p>Returns:</p> Type Description <code>Union[ndarray, List[float]]</code> <p>The calculated diffraction pattern as a NumPy array or a list of floats.</p> Source code in <code>src/easydiffraction/analysis/calculators/crysfml.py</code> <pre><code>def calculate_pattern(\n    self,\n    sample_model: SampleModels,\n    experiment: ExperimentBase,\n    called_by_minimizer: bool = False,\n) -&gt; Union[np.ndarray, List[float]]:\n    \"\"\"Calculates the diffraction pattern using Crysfml for the\n    given sample model and experiment.\n\n    Args:\n        sample_model: The sample model to calculate the pattern for.\n        experiment: The experiment associated with the sample model.\n        called_by_minimizer: Whether the calculation is called by a\n        minimizer.\n\n    Returns:\n        The calculated diffraction pattern as a NumPy array or a\n            list of floats.\n    \"\"\"\n    # Intentionally unused, required by public API/signature\n    del called_by_minimizer\n\n    crysfml_dict = self._crysfml_dict(sample_model, experiment)\n    try:\n        _, y = cfml_py_utilities.cw_powder_pattern_from_dict(crysfml_dict)\n        y = self._adjust_pattern_length(y, len(experiment.data.x))\n    except KeyError:\n        print('[CrysfmlCalculator] Error: No calculated data')\n        y = []\n    return y\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.crysfml.CrysfmlCalculator.calculate_structure_factors","title":"<code>calculate_structure_factors(sample_models, experiments)</code>","text":"<p>Call Crysfml to calculate structure factors.</p> <p>Parameters:</p> Name Type Description Default <code>sample_models</code> <code>SampleModels</code> <p>The sample models to calculate structure factors for.</p> required <code>experiments</code> <code>Experiments</code> <p>The experiments associated with the sample models.</p> required Source code in <code>src/easydiffraction/analysis/calculators/crysfml.py</code> <pre><code>def calculate_structure_factors(\n    self,\n    sample_models: SampleModels,\n    experiments: Experiments,\n) -&gt; None:\n    \"\"\"Call Crysfml to calculate structure factors.\n\n    Args:\n        sample_models: The sample models to calculate structure\n            factors for.\n        experiments: The experiments associated with the sample\n            models.\n    \"\"\"\n    raise NotImplementedError('HKL calculation is not implemented for CrysfmlCalculator.')\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.cryspy","title":"<code>cryspy</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.cryspy.CryspyCalculator","title":"<code>CryspyCalculator</code>","text":"<p>               Bases: <code>CalculatorBase</code></p> <p>Cryspy-based diffraction calculator.</p> <p>Converts EasyDiffraction models into Cryspy objects and computes patterns.</p> Source code in <code>src/easydiffraction/analysis/calculators/cryspy.py</code> <pre><code>class CryspyCalculator(CalculatorBase):\n    \"\"\"Cryspy-based diffraction calculator.\n\n    Converts EasyDiffraction models into Cryspy objects and computes\n    patterns.\n    \"\"\"\n\n    engine_imported: bool = cryspy is not None\n\n    @property\n    def name(self) -&gt; str:\n        return 'cryspy'\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._cryspy_dicts: Dict[str, Dict[str, Any]] = {}\n\n    def calculate_structure_factors(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n    ) -&gt; None:\n        \"\"\"Raises a NotImplementedError as HKL calculation is not\n        implemented.\n\n        Args:\n            sample_model: The sample model to calculate structure\n                factors for.\n            experiment: The experiment associated with the sample\n                models.\n        \"\"\"\n        raise NotImplementedError('HKL calculation is not implemented for CryspyCalculator.')\n\n    def calculate_pattern(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n        called_by_minimizer: bool = False,\n    ) -&gt; Union[np.ndarray, List[float]]:\n        \"\"\"Calculates the diffraction pattern using Cryspy for the given\n        sample model and experiment.\n\n        We only recreate the cryspy_obj if this method is\n         - NOT called by the minimizer, or\n         - the cryspy_dict is NOT yet created.\n        In other cases, we are modifying the existing cryspy_dict\n        This allows significantly speeding up the calculation\n\n        Args:\n            sample_model: The sample model to calculate the pattern for.\n            experiment: The experiment associated with the sample model.\n            called_by_minimizer: Whether the calculation is called by a\n            minimizer.\n\n        Returns:\n            The calculated diffraction pattern as a NumPy array or a\n                list of floats.\n        \"\"\"\n        combined_name = f'{sample_model.name}_{experiment.name}'\n\n        if called_by_minimizer:\n            if self._cryspy_dicts and combined_name in self._cryspy_dicts:\n                cryspy_dict = self._recreate_cryspy_dict(sample_model, experiment)\n            else:\n                cryspy_obj = self._recreate_cryspy_obj(sample_model, experiment)\n                cryspy_dict = cryspy_obj.get_dictionary()\n        else:\n            cryspy_obj = self._recreate_cryspy_obj(sample_model, experiment)\n            cryspy_dict = cryspy_obj.get_dictionary()\n\n        self._cryspy_dicts[combined_name] = copy.deepcopy(cryspy_dict)\n\n        cryspy_in_out_dict: Dict[str, Any] = {}\n\n        # Calculate the pattern using Cryspy\n        # TODO: Redirect stderr to suppress Cryspy warnings.\n        #  This is a temporary solution to avoid cluttering the output.\n        #  E.g. cryspy/A_functions_base/powder_diffraction_tof.py:106:\n        #  RuntimeWarning: overflow encountered in exp\n        #  Remove this when Cryspy is updated to handle warnings better.\n        with contextlib.redirect_stderr(io.StringIO()):\n            rhochi_calc_chi_sq_by_dictionary(\n                cryspy_dict,\n                dict_in_out=cryspy_in_out_dict,\n                flag_use_precalculated_data=False,\n                flag_calc_analytical_derivatives=False,\n            )\n\n        prefixes = {\n            BeamModeEnum.CONSTANT_WAVELENGTH: 'pd',\n            BeamModeEnum.TIME_OF_FLIGHT: 'tof',\n        }\n        beam_mode = experiment.type.beam_mode.value\n        if beam_mode in prefixes:\n            cryspy_block_name = f'{prefixes[beam_mode]}_{experiment.name}'\n        else:\n            print(f'[CryspyCalculator] Error: Unknown beam mode {experiment.type.beam_mode.value}')\n            return []\n\n        try:\n            signal_plus = cryspy_in_out_dict[cryspy_block_name]['signal_plus']\n            signal_minus = cryspy_in_out_dict[cryspy_block_name]['signal_minus']\n            y_calc = signal_plus + signal_minus\n        except KeyError:\n            print(f'[CryspyCalculator] Error: No calculated data for {cryspy_block_name}')\n            return []\n\n        return y_calc\n\n    def _recreate_cryspy_dict(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Recreates the Cryspy dictionary for the given sample model\n        and experiment.\n\n        Args:\n            sample_model: The sample model to update.\n            experiment: The experiment to update.\n\n        Returns:\n            The updated Cryspy dictionary.\n        \"\"\"\n        combined_name = f'{sample_model.name}_{experiment.name}'\n        cryspy_dict = copy.deepcopy(self._cryspy_dicts[combined_name])\n\n        cryspy_model_id = f'crystal_{sample_model.name}'\n        cryspy_model_dict = cryspy_dict[cryspy_model_id]\n\n        # Update sample model parameters\n\n        # Cell\n        cryspy_cell = cryspy_model_dict['unit_cell_parameters']\n        cryspy_cell[0] = sample_model.cell.length_a.value\n        cryspy_cell[1] = sample_model.cell.length_b.value\n        cryspy_cell[2] = sample_model.cell.length_c.value\n        cryspy_cell[3] = np.deg2rad(sample_model.cell.angle_alpha.value)\n        cryspy_cell[4] = np.deg2rad(sample_model.cell.angle_beta.value)\n        cryspy_cell[5] = np.deg2rad(sample_model.cell.angle_gamma.value)\n\n        # Atomic coordinates\n        cryspy_xyz = cryspy_model_dict['atom_fract_xyz']\n        for idx, atom_site in enumerate(sample_model.atom_sites):\n            cryspy_xyz[0][idx] = atom_site.fract_x.value\n            cryspy_xyz[1][idx] = atom_site.fract_y.value\n            cryspy_xyz[2][idx] = atom_site.fract_z.value\n\n        # Atomic occupancies\n        cryspy_occ = cryspy_model_dict['atom_occupancy']\n        for idx, atom_site in enumerate(sample_model.atom_sites):\n            cryspy_occ[idx] = atom_site.occupancy.value\n\n        # Atomic ADPs - Biso only for now\n        cryspy_biso = cryspy_model_dict['atom_b_iso']\n        for idx, atom_site in enumerate(sample_model.atom_sites):\n            cryspy_biso[idx] = atom_site.b_iso.value\n\n        # Update experiment parameters\n\n        if experiment.type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n            cryspy_expt_name = f'pd_{experiment.name}'\n            cryspy_expt_dict = cryspy_dict[cryspy_expt_name]\n\n            # Instrument\n            cryspy_expt_dict['offset_ttheta'][0] = np.deg2rad(\n                experiment.instrument.calib_twotheta_offset.value\n            )\n            cryspy_expt_dict['wavelength'][0] = experiment.instrument.setup_wavelength.value\n\n            # Peak\n            cryspy_resolution = cryspy_expt_dict['resolution_parameters']\n            cryspy_resolution[0] = experiment.peak.broad_gauss_u.value\n            cryspy_resolution[1] = experiment.peak.broad_gauss_v.value\n            cryspy_resolution[2] = experiment.peak.broad_gauss_w.value\n            cryspy_resolution[3] = experiment.peak.broad_lorentz_x.value\n            cryspy_resolution[4] = experiment.peak.broad_lorentz_y.value\n\n        elif experiment.type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n            cryspy_expt_name = f'tof_{experiment.name}'\n            cryspy_expt_dict = cryspy_dict[cryspy_expt_name]\n\n            # Instrument\n            cryspy_expt_dict['zero'][0] = experiment.instrument.calib_d_to_tof_offset.value\n            cryspy_expt_dict['dtt1'][0] = experiment.instrument.calib_d_to_tof_linear.value\n            cryspy_expt_dict['dtt2'][0] = experiment.instrument.calib_d_to_tof_quad.value\n            cryspy_expt_dict['ttheta_bank'] = np.deg2rad(\n                experiment.instrument.setup_twotheta_bank.value\n            )\n\n            # Peak\n            cryspy_sigma = cryspy_expt_dict['profile_sigmas']\n            cryspy_sigma[0] = experiment.peak.broad_gauss_sigma_0.value\n            cryspy_sigma[1] = experiment.peak.broad_gauss_sigma_1.value\n            cryspy_sigma[2] = experiment.peak.broad_gauss_sigma_2.value\n\n            cryspy_beta = cryspy_expt_dict['profile_betas']\n            cryspy_beta[0] = experiment.peak.broad_mix_beta_0.value\n            cryspy_beta[1] = experiment.peak.broad_mix_beta_1.value\n\n            cryspy_alpha = cryspy_expt_dict['profile_alphas']\n            cryspy_alpha[0] = experiment.peak.asym_alpha_0.value\n            cryspy_alpha[1] = experiment.peak.asym_alpha_1.value\n\n        return cryspy_dict\n\n    def _recreate_cryspy_obj(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n    ) -&gt; Any:\n        \"\"\"Recreates the Cryspy object for the given sample model and\n        experiment.\n\n        Args:\n            sample_model: The sample model to recreate.\n            experiment: The experiment to recreate.\n\n        Returns:\n            The recreated Cryspy object.\n        \"\"\"\n        cryspy_obj = str_to_globaln('')\n\n        cryspy_sample_model_cif = self._convert_sample_model_to_cryspy_cif(sample_model)\n        cryspy_sample_model_obj = str_to_globaln(cryspy_sample_model_cif)\n        cryspy_obj.add_items(cryspy_sample_model_obj.items)\n\n        # Add single experiment to cryspy_obj\n        cryspy_experiment_cif = self._convert_experiment_to_cryspy_cif(\n            experiment,\n            linked_phase=sample_model,\n        )\n\n        cryspy_experiment_obj = str_to_globaln(cryspy_experiment_cif)\n        cryspy_obj.add_items(cryspy_experiment_obj.items)\n\n        return cryspy_obj\n\n    def _convert_sample_model_to_cryspy_cif(\n        self,\n        sample_model: SampleModelBase,\n    ) -&gt; str:\n        \"\"\"Converts a sample model to a Cryspy CIF string.\n\n        Args:\n            sample_model: The sample model to convert.\n\n        Returns:\n            The Cryspy CIF string representation of the sample model.\n        \"\"\"\n        return sample_model.as_cif\n\n    def _convert_experiment_to_cryspy_cif(\n        self,\n        experiment: ExperimentBase,\n        linked_phase: Any,\n    ) -&gt; str:\n        \"\"\"Converts an experiment to a Cryspy CIF string.\n\n        Args:\n            experiment: The experiment to convert.\n            linked_phase: The linked phase associated with the\n                experiment.\n\n        Returns:\n            The Cryspy CIF string representation of the experiment.\n        \"\"\"\n        expt_type = getattr(experiment, 'type', None)\n        instrument = getattr(experiment, 'instrument', None)\n        peak = getattr(experiment, 'peak', None)\n\n        cif_lines = [f'data_{experiment.name}']\n\n        if expt_type is not None:\n            cif_lines.append('')\n            radiation_probe = expt_type.radiation_probe.value\n            radiation_probe = radiation_probe.replace('neutron', 'neutrons')\n            radiation_probe = radiation_probe.replace('xray', 'X-rays')\n            cif_lines.append(f'_setup_radiation {radiation_probe}')\n\n        if instrument:\n            # Restrict to only attributes relevant for the beam mode to\n            # avoid probing non-existent guarded attributes (which\n            # triggers diagnostics).\n            if expt_type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n                instrument_mapping = {\n                    'setup_wavelength': '_setup_wavelength',\n                    'calib_twotheta_offset': '_setup_offset_2theta',\n                }\n            elif expt_type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n                instrument_mapping = {\n                    'setup_twotheta_bank': '_tof_parameters_2theta_bank',\n                    'calib_d_to_tof_offset': '_tof_parameters_Zero',\n                    'calib_d_to_tof_linear': '_tof_parameters_Dtt1',\n                    'calib_d_to_tof_quad': '_tof_parameters_dtt2',\n                }\n            cif_lines.append('')\n            for local_attr_name, engine_key_name in instrument_mapping.items():\n                # attr_obj = instrument.__dict__.get(local_attr_name)\n                attr_obj = getattr(instrument, local_attr_name)\n                if attr_obj is not None:\n                    cif_lines.append(f'{engine_key_name} {attr_obj.value}')\n\n        if peak:\n            if expt_type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n                peak_mapping = {\n                    'broad_gauss_u': '_pd_instr_resolution_U',\n                    'broad_gauss_v': '_pd_instr_resolution_V',\n                    'broad_gauss_w': '_pd_instr_resolution_W',\n                    'broad_lorentz_x': '_pd_instr_resolution_X',\n                    'broad_lorentz_y': '_pd_instr_resolution_Y',\n                }\n            elif expt_type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n                peak_mapping = {\n                    'broad_gauss_sigma_0': '_tof_profile_sigma0',\n                    'broad_gauss_sigma_1': '_tof_profile_sigma1',\n                    'broad_gauss_sigma_2': '_tof_profile_sigma2',\n                    'broad_mix_beta_0': '_tof_profile_beta0',\n                    'broad_mix_beta_1': '_tof_profile_beta1',\n                    'asym_alpha_0': '_tof_profile_alpha0',\n                    'asym_alpha_1': '_tof_profile_alpha1',\n                }\n                cif_lines.append('_tof_profile_peak_shape Gauss')\n            cif_lines.append('')\n            for local_attr_name, engine_key_name in peak_mapping.items():\n                # attr_obj = peak.__dict__.get(local_attr_name)\n                attr_obj = getattr(peak, local_attr_name)\n                if attr_obj is not None:\n                    cif_lines.append(f'{engine_key_name} {attr_obj.value}')\n\n        x_data = experiment.data.x\n        twotheta_min = float(x_data.min())\n        twotheta_max = float(x_data.max())\n        cif_lines.append('')\n        if expt_type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n            cif_lines.append(f'_range_2theta_min {twotheta_min}')\n            cif_lines.append(f'_range_2theta_max {twotheta_max}')\n        elif expt_type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n            cif_lines.append(f'_range_time_min {twotheta_min}')\n            cif_lines.append(f'_range_time_max {twotheta_max}')\n\n        cif_lines.append('')\n        cif_lines.append('loop_')\n        cif_lines.append('_phase_label')\n        cif_lines.append('_phase_scale')\n        cif_lines.append(f'{linked_phase.name} 1.0')\n\n        if expt_type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n            cif_lines.append('')\n            cif_lines.append('loop_')\n            cif_lines.append('_pd_background_2theta')\n            cif_lines.append('_pd_background_intensity')\n            cif_lines.append(f'{twotheta_min} 0.0')\n            cif_lines.append(f'{twotheta_max} 0.0')\n        elif expt_type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n            cif_lines.append('')\n            cif_lines.append('loop_')\n            cif_lines.append('_tof_backgroundpoint_time')\n            cif_lines.append('_tof_backgroundpoint_intensity')\n            cif_lines.append(f'{twotheta_min} 0.0')\n            cif_lines.append(f'{twotheta_max} 0.0')\n\n        if expt_type.beam_mode.value == BeamModeEnum.CONSTANT_WAVELENGTH:\n            cif_lines.append('')\n            cif_lines.append('loop_')\n            cif_lines.append('_pd_meas_2theta')\n            cif_lines.append('_pd_meas_intensity')\n            cif_lines.append('_pd_meas_intensity_sigma')\n        elif expt_type.beam_mode.value == BeamModeEnum.TIME_OF_FLIGHT:\n            cif_lines.append('')\n            cif_lines.append('loop_')\n            cif_lines.append('_tof_meas_time')\n            cif_lines.append('_tof_meas_intensity')\n            cif_lines.append('_tof_meas_intensity_sigma')\n\n        y_data: np.ndarray = experiment.data.meas\n        sy_data: np.ndarray = experiment.data.meas_su\n\n        for x_val, y_val, sy_val in zip(x_data, y_data, sy_data, strict=True):\n            cif_lines.append(f'  {x_val:.5f}   {y_val:.5f}   {sy_val:.5f}')\n\n        cryspy_experiment_cif = '\\n'.join(cif_lines)\n\n        return cryspy_experiment_cif\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.cryspy.CryspyCalculator.calculate_pattern","title":"<code>calculate_pattern(sample_model, experiment, called_by_minimizer=False)</code>","text":"<p>Calculates the diffraction pattern using Cryspy for the given sample model and experiment.</p> <p>We only recreate the cryspy_obj if this method is  - NOT called by the minimizer, or  - the cryspy_dict is NOT yet created. In other cases, we are modifying the existing cryspy_dict This allows significantly speeding up the calculation</p> <p>Parameters:</p> Name Type Description Default <code>sample_model</code> <code>SampleModelBase</code> <p>The sample model to calculate the pattern for.</p> required <code>experiment</code> <code>ExperimentBase</code> <p>The experiment associated with the sample model.</p> required <code>called_by_minimizer</code> <code>bool</code> <p>Whether the calculation is called by a</p> <code>False</code> <p>Returns:</p> Type Description <code>Union[ndarray, List[float]]</code> <p>The calculated diffraction pattern as a NumPy array or a list of floats.</p> Source code in <code>src/easydiffraction/analysis/calculators/cryspy.py</code> <pre><code>def calculate_pattern(\n    self,\n    sample_model: SampleModelBase,\n    experiment: ExperimentBase,\n    called_by_minimizer: bool = False,\n) -&gt; Union[np.ndarray, List[float]]:\n    \"\"\"Calculates the diffraction pattern using Cryspy for the given\n    sample model and experiment.\n\n    We only recreate the cryspy_obj if this method is\n     - NOT called by the minimizer, or\n     - the cryspy_dict is NOT yet created.\n    In other cases, we are modifying the existing cryspy_dict\n    This allows significantly speeding up the calculation\n\n    Args:\n        sample_model: The sample model to calculate the pattern for.\n        experiment: The experiment associated with the sample model.\n        called_by_minimizer: Whether the calculation is called by a\n        minimizer.\n\n    Returns:\n        The calculated diffraction pattern as a NumPy array or a\n            list of floats.\n    \"\"\"\n    combined_name = f'{sample_model.name}_{experiment.name}'\n\n    if called_by_minimizer:\n        if self._cryspy_dicts and combined_name in self._cryspy_dicts:\n            cryspy_dict = self._recreate_cryspy_dict(sample_model, experiment)\n        else:\n            cryspy_obj = self._recreate_cryspy_obj(sample_model, experiment)\n            cryspy_dict = cryspy_obj.get_dictionary()\n    else:\n        cryspy_obj = self._recreate_cryspy_obj(sample_model, experiment)\n        cryspy_dict = cryspy_obj.get_dictionary()\n\n    self._cryspy_dicts[combined_name] = copy.deepcopy(cryspy_dict)\n\n    cryspy_in_out_dict: Dict[str, Any] = {}\n\n    # Calculate the pattern using Cryspy\n    # TODO: Redirect stderr to suppress Cryspy warnings.\n    #  This is a temporary solution to avoid cluttering the output.\n    #  E.g. cryspy/A_functions_base/powder_diffraction_tof.py:106:\n    #  RuntimeWarning: overflow encountered in exp\n    #  Remove this when Cryspy is updated to handle warnings better.\n    with contextlib.redirect_stderr(io.StringIO()):\n        rhochi_calc_chi_sq_by_dictionary(\n            cryspy_dict,\n            dict_in_out=cryspy_in_out_dict,\n            flag_use_precalculated_data=False,\n            flag_calc_analytical_derivatives=False,\n        )\n\n    prefixes = {\n        BeamModeEnum.CONSTANT_WAVELENGTH: 'pd',\n        BeamModeEnum.TIME_OF_FLIGHT: 'tof',\n    }\n    beam_mode = experiment.type.beam_mode.value\n    if beam_mode in prefixes:\n        cryspy_block_name = f'{prefixes[beam_mode]}_{experiment.name}'\n    else:\n        print(f'[CryspyCalculator] Error: Unknown beam mode {experiment.type.beam_mode.value}')\n        return []\n\n    try:\n        signal_plus = cryspy_in_out_dict[cryspy_block_name]['signal_plus']\n        signal_minus = cryspy_in_out_dict[cryspy_block_name]['signal_minus']\n        y_calc = signal_plus + signal_minus\n    except KeyError:\n        print(f'[CryspyCalculator] Error: No calculated data for {cryspy_block_name}')\n        return []\n\n    return y_calc\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.cryspy.CryspyCalculator.calculate_structure_factors","title":"<code>calculate_structure_factors(sample_model, experiment)</code>","text":"<p>Raises a NotImplementedError as HKL calculation is not implemented.</p> <p>Parameters:</p> Name Type Description Default <code>sample_model</code> <code>SampleModelBase</code> <p>The sample model to calculate structure factors for.</p> required <code>experiment</code> <code>ExperimentBase</code> <p>The experiment associated with the sample models.</p> required Source code in <code>src/easydiffraction/analysis/calculators/cryspy.py</code> <pre><code>def calculate_structure_factors(\n    self,\n    sample_model: SampleModelBase,\n    experiment: ExperimentBase,\n) -&gt; None:\n    \"\"\"Raises a NotImplementedError as HKL calculation is not\n    implemented.\n\n    Args:\n        sample_model: The sample model to calculate structure\n            factors for.\n        experiment: The experiment associated with the sample\n            models.\n    \"\"\"\n    raise NotImplementedError('HKL calculation is not implemented for CryspyCalculator.')\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.factory","title":"<code>factory</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.factory.CalculatorFactory","title":"<code>CalculatorFactory</code>","text":"<p>Factory for creating calculation engine instances.</p> <p>The factory exposes discovery helpers to list and show available calculators in the current environment and a creator that returns an instantiated calculator or <code>None</code> if the requested one is not available.</p> Source code in <code>src/easydiffraction/analysis/calculators/factory.py</code> <pre><code>class CalculatorFactory:\n    \"\"\"Factory for creating calculation engine instances.\n\n    The factory exposes discovery helpers to list and show available\n    calculators in the current environment and a creator that returns an\n    instantiated calculator or ``None`` if the requested one is not\n    available.\n    \"\"\"\n\n    _potential_calculators: Dict[str, Dict[str, Union[str, Type[CalculatorBase]]]] = {\n        'crysfml': {\n            'description': 'CrysFML library for crystallographic calculations',\n            'class': CrysfmlCalculator,\n        },\n        'cryspy': {\n            'description': 'CrysPy library for crystallographic calculations',\n            'class': CryspyCalculator,\n        },\n        'pdffit': {\n            'description': 'PDFfit2 library for pair distribution function calculations',\n            'class': PdffitCalculator,\n        },\n    }\n\n    @classmethod\n    def _supported_calculators(\n        cls,\n    ) -&gt; Dict[str, Dict[str, Union[str, Type[CalculatorBase]]]]:\n        \"\"\"Return calculators whose engines are importable.\n\n        This filters the list of potential calculators by instantiating\n        their classes and checking the ``engine_imported`` property.\n\n        Returns:\n            Mapping from calculator name to its config dict.\n        \"\"\"\n        return {\n            name: cfg\n            for name, cfg in cls._potential_calculators.items()\n            if cfg['class']().engine_imported  # instantiate and check the @property\n        }\n\n    @classmethod\n    def list_supported_calculators(cls) -&gt; List[str]:\n        \"\"\"List names of calculators available in the environment.\n\n        Returns:\n            List of calculator identifiers, e.g. ``[\"crysfml\", ...]``.\n        \"\"\"\n        return list(cls._supported_calculators().keys())\n\n    @classmethod\n    def show_supported_calculators(cls) -&gt; None:\n        \"\"\"Pretty-print supported calculators and their descriptions.\"\"\"\n        columns_headers: List[str] = ['Calculator', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data: List[List[str]] = []\n        for name, config in cls._supported_calculators().items():\n            description: str = config.get('description', 'No description provided.')\n            columns_data.append([name, description])\n\n        console.paragraph('Supported calculators')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    @classmethod\n    def create_calculator(cls, calculator_name: str) -&gt; Optional[CalculatorBase]:\n        \"\"\"Create a calculator instance by name.\n\n        Args:\n            calculator_name: Identifier of the calculator to create.\n\n        Returns:\n            A calculator instance or ``None`` if unknown or unsupported.\n        \"\"\"\n        config = cls._supported_calculators().get(calculator_name)\n        if not config:\n            log.warning(\n                f\"Unknown calculator '{calculator_name}', \"\n                f'Supported calculators: {cls.list_supported_calculators()}'\n            )\n            return None\n\n        return config['class']()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.factory.CalculatorFactory.create_calculator","title":"<code>create_calculator(calculator_name)</code>  <code>classmethod</code>","text":"<p>Create a calculator instance by name.</p> <p>Parameters:</p> Name Type Description Default <code>calculator_name</code> <code>str</code> <p>Identifier of the calculator to create.</p> required <p>Returns:</p> Type Description <code>Optional[CalculatorBase]</code> <p>A calculator instance or <code>None</code> if unknown or unsupported.</p> Source code in <code>src/easydiffraction/analysis/calculators/factory.py</code> <pre><code>@classmethod\ndef create_calculator(cls, calculator_name: str) -&gt; Optional[CalculatorBase]:\n    \"\"\"Create a calculator instance by name.\n\n    Args:\n        calculator_name: Identifier of the calculator to create.\n\n    Returns:\n        A calculator instance or ``None`` if unknown or unsupported.\n    \"\"\"\n    config = cls._supported_calculators().get(calculator_name)\n    if not config:\n        log.warning(\n            f\"Unknown calculator '{calculator_name}', \"\n            f'Supported calculators: {cls.list_supported_calculators()}'\n        )\n        return None\n\n    return config['class']()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.factory.CalculatorFactory.list_supported_calculators","title":"<code>list_supported_calculators()</code>  <code>classmethod</code>","text":"<p>List names of calculators available in the environment.</p> <p>Returns:</p> Type Description <code>List[str]</code> <p>List of calculator identifiers, e.g. <code>[\"crysfml\", ...]</code>.</p> Source code in <code>src/easydiffraction/analysis/calculators/factory.py</code> <pre><code>@classmethod\ndef list_supported_calculators(cls) -&gt; List[str]:\n    \"\"\"List names of calculators available in the environment.\n\n    Returns:\n        List of calculator identifiers, e.g. ``[\"crysfml\", ...]``.\n    \"\"\"\n    return list(cls._supported_calculators().keys())\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.factory.CalculatorFactory.show_supported_calculators","title":"<code>show_supported_calculators()</code>  <code>classmethod</code>","text":"<p>Pretty-print supported calculators and their descriptions.</p> Source code in <code>src/easydiffraction/analysis/calculators/factory.py</code> <pre><code>@classmethod\ndef show_supported_calculators(cls) -&gt; None:\n    \"\"\"Pretty-print supported calculators and their descriptions.\"\"\"\n    columns_headers: List[str] = ['Calculator', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data: List[List[str]] = []\n    for name, config in cls._supported_calculators().items():\n        description: str = config.get('description', 'No description provided.')\n        columns_data.append([name, description])\n\n    console.paragraph('Supported calculators')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.pdffit","title":"<code>pdffit</code>","text":"<p>PDF calculation backend using diffpy.pdffit2 if available.</p> <p>The class adapts the engine to EasyDiffraction calculator interface and silences stdio on import to avoid noisy output in notebooks and logs.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.calculators.pdffit.PdffitCalculator","title":"<code>PdffitCalculator</code>","text":"<p>               Bases: <code>CalculatorBase</code></p> <p>Wrapper for Pdffit library.</p> Source code in <code>src/easydiffraction/analysis/calculators/pdffit.py</code> <pre><code>class PdffitCalculator(CalculatorBase):\n    \"\"\"Wrapper for Pdffit library.\"\"\"\n\n    engine_imported: bool = PdfFit is not None\n\n    @property\n    def name(self):\n        return 'pdffit'\n\n    def calculate_structure_factors(self, sample_models, experiments):\n        # PDF doesn't compute HKL but we keep interface consistent\n        # Intentionally unused, required by public API/signature\n        del sample_models, experiments\n        print('[pdffit] Calculating HKLs (not applicable)...')\n        return []\n\n    def calculate_pattern(\n        self,\n        sample_model: SampleModelBase,\n        experiment: ExperimentBase,\n        called_by_minimizer: bool = False,\n    ):\n        # Intentionally unused, required by public API/signature\n        del called_by_minimizer\n\n        # Create PDF calculator object\n        calculator = PdfFit()\n\n        # ---------------------------\n        # Set sample model parameters\n        # ---------------------------\n\n        # TODO: move CIF v2 -&gt; CIF v1 conversion to a separate module\n        # Convert the sample model to CIF supported by PDFfit\n        cif_string_v2 = sample_model.as_cif\n        # convert to version 1 of CIF format\n        # this means: replace all dots with underscores for\n        # cases where the dot is surrounded by letters on both sides.\n        pattern = r'(?&lt;=[a-zA-Z])\\.(?=[a-zA-Z])'\n        cif_string_v1 = re.sub(pattern, '_', cif_string_v2)\n\n        # Create the PDFit structure\n        structure = pdffit_cif_parser().parse(cif_string_v1)\n\n        # Set all model parameters:\n        # space group, cell parameters, and atom sites (including ADPs)\n        calculator.add_structure(structure)\n\n        # -------------------------\n        # Set experiment parameters\n        # -------------------------\n\n        # Set some peak-related parameters\n        calculator.setvar('pscale', experiment.linked_phases[sample_model.name].scale.value)\n        calculator.setvar('delta1', experiment.peak.sharp_delta_1.value)\n        calculator.setvar('delta2', experiment.peak.sharp_delta_2.value)\n        calculator.setvar('spdiameter', experiment.peak.damp_particle_diameter.value)\n\n        # Data\n        x = list(experiment.data.x)\n        y_noise = list(np.zeros_like(x))\n\n        # Assign the data to the PDFfit calculator\n        calculator.read_data_lists(\n            stype=experiment.type.radiation_probe.value[0].upper(),\n            qmax=experiment.peak.cutoff_q.value,\n            qdamp=experiment.peak.damp_q.value,\n            r_data=x,\n            Gr_data=y_noise,\n        )\n\n        # qbroad must be set after read_data_lists\n        calculator.setvar('qbroad', experiment.peak.broad_q.value)\n\n        # -----------------\n        # Calculate pattern\n        # -----------------\n\n        # Calculate the PDF pattern\n        calculator.calc()\n\n        # Get the calculated PDF pattern\n        pattern = calculator.getpdf_fit()\n        pattern = np.array(pattern)\n\n        return pattern\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories","title":"<code>categories</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases","title":"<code>aliases</code>","text":"<p>Alias category for mapping friendly names to parameter UIDs.</p> <p>Defines a small record type used by analysis configuration to refer to parameters via readable labels instead of raw unique identifiers.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases.Alias","title":"<code>Alias</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Single alias entry.</p> <p>Maps a human-readable <code>label</code> to a concrete <code>param_uid</code> used by the engine.</p> <p>Parameters:</p> Name Type Description Default <code>label</code> <code>str</code> <p>Alias label. Must match <code>^[A-Za-z_][A-Za-z0-9_]*$</code>.</p> required <code>param_uid</code> <code>str</code> <p>Target parameter uid. Same identifier pattern as <code>label</code>.</p> required Source code in <code>src/easydiffraction/analysis/categories/aliases.py</code> <pre><code>class Alias(CategoryItem):\n    \"\"\"Single alias entry.\n\n    Maps a human-readable ``label`` to a concrete ``param_uid`` used by\n    the engine.\n\n    Args:\n        label: Alias label. Must match ``^[A-Za-z_][A-Za-z0-9_]*$``.\n        param_uid: Target parameter uid. Same identifier pattern as\n            ``label``.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        label: str,\n        param_uid: str,\n    ) -&gt; None:\n        super().__init__()\n\n        self._label: StringDescriptor = StringDescriptor(\n            name='label',\n            description='...',\n            value_spec=AttributeSpec(\n                value=label,\n                type_=DataTypes.STRING,\n                default='...',\n                content_validator=RegexValidator(pattern=r'^[A-Za-z_][A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_alias.label',\n                ]\n            ),\n        )\n        self._param_uid: StringDescriptor = StringDescriptor(\n            name='param_uid',\n            description='...',\n            value_spec=AttributeSpec(\n                value=param_uid,\n                type_=DataTypes.STRING,\n                default='...',\n                content_validator=RegexValidator(pattern=r'^[A-Za-z_][A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_alias.param_uid',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'alias'\n        self._identity.category_entry_name = lambda: str(self.label.value)\n\n    @property\n    def label(self):\n        \"\"\"Alias label descriptor.\"\"\"\n        return self._label\n\n    @label.setter\n    def label(self, value):\n        \"\"\"Set alias label.\n\n        Args:\n            value: New label.\n        \"\"\"\n        self._label.value = value\n\n    @property\n    def param_uid(self):\n        \"\"\"Parameter uid descriptor the alias points to.\"\"\"\n        return self._param_uid\n\n    @param_uid.setter\n    def param_uid(self, value):\n        \"\"\"Set the parameter uid.\n\n        Args:\n            value: New uid.\n        \"\"\"\n        self._param_uid.value = value\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases.Alias.label","title":"<code>label</code>  <code>property</code> <code>writable</code>","text":"<p>Alias label descriptor.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases.Alias.param_uid","title":"<code>param_uid</code>  <code>property</code> <code>writable</code>","text":"<p>Parameter uid descriptor the alias points to.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases.Aliases","title":"<code>Aliases</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of :class:<code>Alias</code> items.</p> Source code in <code>src/easydiffraction/analysis/categories/aliases.py</code> <pre><code>class Aliases(CategoryCollection):\n    \"\"\"Collection of :class:`Alias` items.\"\"\"\n\n    def __init__(self):\n        \"\"\"Create an empty collection of aliases.\"\"\"\n        super().__init__(item_type=Alias)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.aliases.Aliases.__init__","title":"<code>__init__()</code>","text":"<p>Create an empty collection of aliases.</p> Source code in <code>src/easydiffraction/analysis/categories/aliases.py</code> <pre><code>def __init__(self):\n    \"\"\"Create an empty collection of aliases.\"\"\"\n    super().__init__(item_type=Alias)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints","title":"<code>constraints</code>","text":"<p>Simple symbolic constraint between parameters.</p> <p>Represents an equation of the form <code>lhs_alias = rhs_expr</code> where <code>rhs_expr</code> is evaluated elsewhere by the analysis engine.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints.Constraint","title":"<code>Constraint</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Single constraint item.</p> <p>Parameters:</p> Name Type Description Default <code>lhs_alias</code> <code>str</code> <p>Left-hand side alias name being constrained.</p> required <code>rhs_expr</code> <code>str</code> <p>Right-hand side expression as a string.</p> required Source code in <code>src/easydiffraction/analysis/categories/constraints.py</code> <pre><code>class Constraint(CategoryItem):\n    \"\"\"Single constraint item.\n\n    Args:\n        lhs_alias: Left-hand side alias name being constrained.\n        rhs_expr: Right-hand side expression as a string.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        lhs_alias: str,\n        rhs_expr: str,\n    ) -&gt; None:\n        super().__init__()\n\n        self._lhs_alias: StringDescriptor = StringDescriptor(\n            name='lhs_alias',\n            description='...',\n            value_spec=AttributeSpec(\n                value=lhs_alias,\n                type_=DataTypes.STRING,\n                default='...',\n                content_validator=RegexValidator(pattern=r'.*'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_constraint.lhs_alias',\n                ]\n            ),\n        )\n        self._rhs_expr: StringDescriptor = StringDescriptor(\n            name='rhs_expr',\n            description='...',\n            value_spec=AttributeSpec(\n                value=rhs_expr,\n                type_=DataTypes.STRING,\n                default='...',\n                content_validator=RegexValidator(pattern=r'.*'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_constraint.rhs_expr',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'constraint'\n        self._identity.category_entry_name = lambda: str(self.lhs_alias.value)\n\n    @property\n    def lhs_alias(self):\n        \"\"\"Alias name on the left-hand side of the equation.\"\"\"\n        return self._lhs_alias\n\n    @lhs_alias.setter\n    def lhs_alias(self, value):\n        \"\"\"Set the left-hand side alias.\n\n        Args:\n            value: New alias string.\n        \"\"\"\n        self._lhs_alias.value = value\n\n    @property\n    def rhs_expr(self):\n        \"\"\"Right-hand side expression string.\"\"\"\n        return self._rhs_expr\n\n    @rhs_expr.setter\n    def rhs_expr(self, value):\n        \"\"\"Set the right-hand side expression.\n\n        Args:\n            value: New expression string.\n        \"\"\"\n        self._rhs_expr.value = value\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints.Constraint.lhs_alias","title":"<code>lhs_alias</code>  <code>property</code> <code>writable</code>","text":"<p>Alias name on the left-hand side of the equation.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints.Constraint.rhs_expr","title":"<code>rhs_expr</code>  <code>property</code> <code>writable</code>","text":"<p>Right-hand side expression string.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints.Constraints","title":"<code>Constraints</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of :class:<code>Constraint</code> items.</p> Source code in <code>src/easydiffraction/analysis/categories/constraints.py</code> <pre><code>class Constraints(CategoryCollection):\n    \"\"\"Collection of :class:`Constraint` items.\"\"\"\n\n    _update_priority = 90  # After most others, but before data categories\n\n    def __init__(self):\n        \"\"\"Create an empty constraints collection.\"\"\"\n        super().__init__(item_type=Constraint)\n\n    def _update(self, called_by_minimizer=False):\n        del called_by_minimizer\n\n        constraints = ConstraintsHandler.get()\n        constraints.apply()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.constraints.Constraints.__init__","title":"<code>__init__()</code>","text":"<p>Create an empty constraints collection.</p> Source code in <code>src/easydiffraction/analysis/categories/constraints.py</code> <pre><code>def __init__(self):\n    \"\"\"Create an empty constraints collection.\"\"\"\n    super().__init__(item_type=Constraint)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments","title":"<code>joint_fit_experiments</code>","text":"<p>Joint-fit experiment weighting configuration.</p> <p>Stores per-experiment weights to be used when multiple experiments are fitted simultaneously.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments.JointFitExperiment","title":"<code>JointFitExperiment</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>A single joint-fit entry.</p> <p>Parameters:</p> Name Type Description Default <code>id</code> <code>str</code> <p>Experiment identifier used in the fit session.</p> required <code>weight</code> <code>float</code> <p>Relative weight factor in the combined objective.</p> required Source code in <code>src/easydiffraction/analysis/categories/joint_fit_experiments.py</code> <pre><code>class JointFitExperiment(CategoryItem):\n    \"\"\"A single joint-fit entry.\n\n    Args:\n        id: Experiment identifier used in the fit session.\n        weight: Relative weight factor in the combined objective.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        id: str,\n        weight: float,\n    ) -&gt; None:\n        super().__init__()\n\n        self._id: StringDescriptor = StringDescriptor(\n            name='id',  # TODO: need new name instead of id\n            description='...',\n            value_spec=AttributeSpec(\n                value=id,\n                type_=DataTypes.STRING,\n                default='...',\n                content_validator=RegexValidator(pattern=r'^[A-Za-z_][A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_joint_fit_experiment.id',\n                ]\n            ),\n        )\n        self._weight: NumericDescriptor = NumericDescriptor(\n            name='weight',\n            description='...',\n            value_spec=AttributeSpec(\n                value=weight,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_joint_fit_experiment.weight',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'joint_fit_experiment'\n        self._identity.category_entry_name = lambda: str(self.id.value)\n\n    @property\n    def id(self):\n        \"\"\"Experiment identifier descriptor.\"\"\"\n        return self._id\n\n    @id.setter\n    def id(self, value):\n        \"\"\"Set the experiment identifier.\n\n        Args:\n            value: New id string.\n        \"\"\"\n        self._id.value = value\n\n    @property\n    def weight(self):\n        \"\"\"Weight factor descriptor.\"\"\"\n        return self._weight\n\n    @weight.setter\n    def weight(self, value):\n        \"\"\"Set the weight factor.\n\n        Args:\n            value: New weight value.\n        \"\"\"\n        self._weight.value = value\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments.JointFitExperiment.id","title":"<code>id</code>  <code>property</code> <code>writable</code>","text":"<p>Experiment identifier descriptor.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments.JointFitExperiment.weight","title":"<code>weight</code>  <code>property</code> <code>writable</code>","text":"<p>Weight factor descriptor.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments.JointFitExperiments","title":"<code>JointFitExperiments</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of :class:<code>JointFitExperiment</code> items.</p> Source code in <code>src/easydiffraction/analysis/categories/joint_fit_experiments.py</code> <pre><code>class JointFitExperiments(CategoryCollection):\n    \"\"\"Collection of :class:`JointFitExperiment` items.\"\"\"\n\n    def __init__(self):\n        \"\"\"Create an empty joint-fit experiments collection.\"\"\"\n        super().__init__(item_type=JointFitExperiment)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.categories.joint_fit_experiments.JointFitExperiments.__init__","title":"<code>__init__()</code>","text":"<p>Create an empty joint-fit experiments collection.</p> Source code in <code>src/easydiffraction/analysis/categories/joint_fit_experiments.py</code> <pre><code>def __init__(self):\n    \"\"\"Create an empty joint-fit experiments collection.\"\"\"\n    super().__init__(item_type=JointFitExperiment)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers","title":"<code>fit_helpers</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics","title":"<code>metrics</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.calculate_r_factor","title":"<code>calculate_r_factor(y_obs, y_calc)</code>","text":"<p>Calculate the R-factor (reliability factor) between observed and calculated data.</p> <p>Parameters:</p> Name Type Description Default <code>y_obs</code> <code>ndarray</code> <p>Observed data points.</p> required <code>y_calc</code> <code>ndarray</code> <p>Calculated data points.</p> required <p>Returns:</p> Type Description <code>float</code> <p>R-factor value.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def calculate_r_factor(\n    y_obs: np.ndarray,\n    y_calc: np.ndarray,\n) -&gt; float:\n    \"\"\"Calculate the R-factor (reliability factor) between observed and\n    calculated data.\n\n    Args:\n        y_obs: Observed data points.\n        y_calc: Calculated data points.\n\n    Returns:\n        R-factor value.\n    \"\"\"\n    y_obs = np.asarray(y_obs)\n    y_calc = np.asarray(y_calc)\n    numerator = np.sum(np.abs(y_obs - y_calc))\n    denominator = np.sum(np.abs(y_obs))\n    return numerator / denominator if denominator != 0 else np.nan\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.calculate_r_factor_squared","title":"<code>calculate_r_factor_squared(y_obs, y_calc)</code>","text":"<p>Calculate the R-factor squared between observed and calculated data.</p> <p>Parameters:</p> Name Type Description Default <code>y_obs</code> <code>ndarray</code> <p>Observed data points.</p> required <code>y_calc</code> <code>ndarray</code> <p>Calculated data points.</p> required <p>Returns:</p> Type Description <code>float</code> <p>R-factor squared value.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def calculate_r_factor_squared(\n    y_obs: np.ndarray,\n    y_calc: np.ndarray,\n) -&gt; float:\n    \"\"\"Calculate the R-factor squared between observed and calculated\n    data.\n\n    Args:\n        y_obs: Observed data points.\n        y_calc: Calculated data points.\n\n    Returns:\n        R-factor squared value.\n    \"\"\"\n    y_obs = np.asarray(y_obs)\n    y_calc = np.asarray(y_calc)\n    numerator = np.sum((y_obs - y_calc) ** 2)\n    denominator = np.sum(y_obs**2)\n    return np.sqrt(numerator / denominator) if denominator != 0 else np.nan\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.calculate_rb_factor","title":"<code>calculate_rb_factor(y_obs, y_calc)</code>","text":"<p>Calculate the Bragg R-factor between observed and calculated data.</p> <p>Parameters:</p> Name Type Description Default <code>y_obs</code> <code>ndarray</code> <p>Observed data points.</p> required <code>y_calc</code> <code>ndarray</code> <p>Calculated data points.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Bragg R-factor value.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def calculate_rb_factor(\n    y_obs: np.ndarray,\n    y_calc: np.ndarray,\n) -&gt; float:\n    \"\"\"Calculate the Bragg R-factor between observed and calculated\n    data.\n\n    Args:\n        y_obs: Observed data points.\n        y_calc: Calculated data points.\n\n    Returns:\n        Bragg R-factor value.\n    \"\"\"\n    y_obs = np.asarray(y_obs)\n    y_calc = np.asarray(y_calc)\n    numerator = np.sum(np.abs(y_obs - y_calc))\n    denominator = np.sum(y_obs)\n    return numerator / denominator if denominator != 0 else np.nan\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.calculate_reduced_chi_square","title":"<code>calculate_reduced_chi_square(residuals, num_parameters)</code>","text":"<p>Calculate the reduced chi-square statistic.</p> <p>Parameters:</p> Name Type Description Default <code>residuals</code> <code>ndarray</code> <p>Residuals between observed and calculated data.</p> required <code>num_parameters</code> <code>int</code> <p>Number of free parameters used in the model.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Reduced chi-square value.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def calculate_reduced_chi_square(\n    residuals: np.ndarray,\n    num_parameters: int,\n) -&gt; float:\n    \"\"\"Calculate the reduced chi-square statistic.\n\n    Args:\n        residuals: Residuals between observed and calculated data.\n        num_parameters: Number of free parameters used in the model.\n\n    Returns:\n        Reduced chi-square value.\n    \"\"\"\n    residuals = np.asarray(residuals)\n    chi_square = np.sum(residuals**2)\n    n_points = len(residuals)\n    dof = n_points - num_parameters\n    if dof &gt; 0:\n        return chi_square / dof\n    else:\n        return np.nan\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.calculate_weighted_r_factor","title":"<code>calculate_weighted_r_factor(y_obs, y_calc, weights)</code>","text":"<p>Calculate the weighted R-factor between observed and calculated data.</p> <p>Parameters:</p> Name Type Description Default <code>y_obs</code> <code>ndarray</code> <p>Observed data points.</p> required <code>y_calc</code> <code>ndarray</code> <p>Calculated data points.</p> required <code>weights</code> <code>ndarray</code> <p>Weights for each data point.</p> required <p>Returns:</p> Type Description <code>float</code> <p>Weighted R-factor value.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def calculate_weighted_r_factor(\n    y_obs: np.ndarray,\n    y_calc: np.ndarray,\n    weights: np.ndarray,\n) -&gt; float:\n    \"\"\"Calculate the weighted R-factor between observed and calculated\n    data.\n\n    Args:\n        y_obs: Observed data points.\n        y_calc: Calculated data points.\n        weights: Weights for each data point.\n\n    Returns:\n        Weighted R-factor value.\n    \"\"\"\n    y_obs = np.asarray(y_obs)\n    y_calc = np.asarray(y_calc)\n    weights = np.asarray(weights)\n    numerator = np.sum(weights * (y_obs - y_calc) ** 2)\n    denominator = np.sum(weights * y_obs**2)\n    return np.sqrt(numerator / denominator) if denominator != 0 else np.nan\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.metrics.get_reliability_inputs","title":"<code>get_reliability_inputs(sample_models, experiments)</code>","text":"<p>Collect observed and calculated data points for reliability calculations.</p> <p>Parameters:</p> Name Type Description Default <code>sample_models</code> <code>SampleModels</code> <p>Collection of sample models.</p> required <code>experiments</code> <code>Experiments</code> <p>Collection of experiments.</p> required <p>Returns:</p> Type Description <code>Tuple[ndarray, ndarray, Optional[ndarray]]</code> <p>Tuple containing arrays of (observed values, calculated values, error values)</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/metrics.py</code> <pre><code>def get_reliability_inputs(\n    sample_models: SampleModels,\n    experiments: Experiments,\n) -&gt; Tuple[np.ndarray, np.ndarray, Optional[np.ndarray]]:\n    \"\"\"Collect observed and calculated data points for reliability\n    calculations.\n\n    Args:\n        sample_models: Collection of sample models.\n        experiments: Collection of experiments.\n\n    Returns:\n        Tuple containing arrays of (observed values, calculated values,\n            error values)\n    \"\"\"\n    y_obs_all = []\n    y_calc_all = []\n    y_err_all = []\n    for experiment in experiments.values():\n        for sample_model in sample_models:\n            sample_model._update_categories()\n        experiment._update_categories()\n\n        y_calc = experiment.data.calc\n        y_meas = experiment.data.meas\n        y_meas_su = experiment.data.meas_su\n\n        if y_meas is not None and y_calc is not None:\n            # If standard uncertainty is not provided, use ones\n            if y_meas_su is None:\n                y_meas_su = np.ones_like(y_meas)\n\n            y_obs_all.extend(y_meas)\n            y_calc_all.extend(y_calc)\n            y_err_all.extend(y_meas_su)\n\n    return (\n        np.array(y_obs_all),\n        np.array(y_calc_all),\n        np.array(y_err_all) if y_err_all else None,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.reporting","title":"<code>reporting</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.reporting.FitResults","title":"<code>FitResults</code>","text":"<p>Container for results of a single optimization run.</p> <p>Holds success flag, chi-square metrics, iteration counts, timing, and parameter objects. Provides a printer to summarize key indicators and a table of fitted parameters.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/reporting.py</code> <pre><code>class FitResults:\n    \"\"\"Container for results of a single optimization run.\n\n    Holds success flag, chi-square metrics, iteration counts, timing,\n    and parameter objects. Provides a printer to summarize key\n    indicators and a table of fitted parameters.\n    \"\"\"\n\n    def __init__(\n        self,\n        success: bool = False,\n        parameters: Optional[List[Any]] = None,\n        chi_square: Optional[float] = None,\n        reduced_chi_square: Optional[float] = None,\n        message: str = '',\n        iterations: int = 0,\n        engine_result: Optional[Any] = None,\n        starting_parameters: Optional[List[Any]] = None,\n        fitting_time: Optional[float] = None,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Initialize FitResults with the given parameters.\n\n        Args:\n            success: Indicates if the fit was successful.\n            parameters: List of parameters used in the fit.\n            chi_square: Chi-square value of the fit.\n            reduced_chi_square: Reduced chi-square value of the fit.\n            message: Message related to the fit.\n            iterations: Number of iterations performed.\n            engine_result: Result from the fitting engine.\n            starting_parameters: Initial parameters for the fit.\n            fitting_time: Time taken for the fitting process.\n            **kwargs: Additional engine-specific fields. If ``redchi``\n                is provided and ``reduced_chi_square`` is not set, it is\n                used as the reduced chi-square value.\n        \"\"\"\n        self.success: bool = success\n        self.parameters: List[Any] = parameters if parameters is not None else []\n        self.chi_square: Optional[float] = chi_square\n        self.reduced_chi_square: Optional[float] = reduced_chi_square\n        self.message: str = message\n        self.iterations: int = iterations\n        self.engine_result: Optional[Any] = engine_result\n        self.result: Optional[Any] = None\n        self.starting_parameters: List[Any] = (\n            starting_parameters if starting_parameters is not None else []\n        )\n        self.fitting_time: Optional[float] = fitting_time\n\n        if 'redchi' in kwargs and self.reduced_chi_square is None:\n            self.reduced_chi_square = kwargs.get('redchi')\n\n        for key, value in kwargs.items():\n            setattr(self, key, value)\n\n    def display_results(\n        self,\n        y_obs: Optional[List[float]] = None,\n        y_calc: Optional[List[float]] = None,\n        y_err: Optional[List[float]] = None,\n        f_obs: Optional[List[float]] = None,\n        f_calc: Optional[List[float]] = None,\n    ) -&gt; None:\n        \"\"\"Render a human-readable summary of the fit.\n\n        Args:\n            y_obs: Observed intensities for pattern R-factor metrics.\n            y_calc: Calculated intensities for pattern R-factor metrics.\n            y_err: Standard deviations of observed intensities for wR.\n            f_obs: Observed structure-factor magnitudes for Bragg R.\n            f_calc: Calculated structure-factor magnitudes for Bragg R.\n        \"\"\"\n        status_icon = '\u2705' if self.success else '\u274c'\n        rf = rf2 = wr = br = None\n        if y_obs is not None and y_calc is not None:\n            rf = calculate_r_factor(y_obs, y_calc) * 100\n            rf2 = calculate_r_factor_squared(y_obs, y_calc) * 100\n        if y_obs is not None and y_calc is not None and y_err is not None:\n            wr = calculate_weighted_r_factor(y_obs, y_calc, y_err) * 100\n        if f_obs is not None and f_calc is not None:\n            br = calculate_rb_factor(f_obs, f_calc) * 100\n\n        console.paragraph('Fit results')\n        console.print(f'{status_icon} Success: {self.success}')\n        console.print(f'\u23f1\ufe0f Fitting time: {self.fitting_time:.2f} seconds')\n        console.print(f'\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): {self.reduced_chi_square:.2f}')\n        if rf is not None:\n            console.print(f'\ud83d\udccf R-factor (Rf): {rf:.2f}%')\n        if rf2 is not None:\n            console.print(f'\ud83d\udccf R-factor squared (Rf\u00b2): {rf2:.2f}%')\n        if wr is not None:\n            console.print(f'\ud83d\udccf Weighted R-factor (wR): {wr:.2f}%')\n        if br is not None:\n            console.print(f'\ud83d\udccf Bragg R-factor (BR): {br:.2f}%')\n        console.print('\ud83d\udcc8 Fitted parameters:')\n\n        headers = [\n            'datablock',\n            'category',\n            'entry',\n            'parameter',\n            'start',\n            'fitted',\n            'uncertainty',\n            'units',\n            'change',\n        ]\n        alignments = [\n            'left',\n            'left',\n            'left',\n            'left',\n            'right',\n            'right',\n            'right',\n            'left',\n            'right',\n        ]\n\n        rows = []\n        for param in self.parameters:\n            datablock_entry_name = (\n                param._identity.datablock_entry_name\n            )  # getattr(param, 'datablock_name', 'N/A')\n            category_code = param._identity.category_code  # getattr(param, 'category_key', 'N/A')\n            category_entry_name = (\n                param._identity.category_entry_name or ''\n            )  # getattr(param, 'category_entry_name', 'N/A')\n            name = getattr(param, 'name', 'N/A')\n            start = (\n                f'{getattr(param, \"_fit_start_value\", \"N/A\"):.4f}'\n                if param._fit_start_value is not None\n                else 'N/A'\n            )\n            fitted = f'{param.value:.4f}' if param.value is not None else 'N/A'\n            uncertainty = f'{param.uncertainty:.4f}' if param.uncertainty is not None else 'N/A'\n            units = getattr(param, 'units', 'N/A')\n\n            if param._fit_start_value and param.value:\n                change = ((param.value - param._fit_start_value) / param._fit_start_value) * 100\n                arrow = '\u2191' if change &gt; 0 else '\u2193'\n                relative_change = f'{abs(change):.2f} % {arrow}'\n            else:\n                relative_change = 'N/A'\n\n            rows.append([\n                datablock_entry_name,\n                category_code,\n                category_entry_name,\n                name,\n                start,\n                fitted,\n                uncertainty,\n                units,\n                relative_change,\n            ])\n\n        render_table(\n            columns_headers=headers,\n            columns_alignment=alignments,\n            columns_data=rows,\n        )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.reporting.FitResults.__init__","title":"<code>__init__(success=False, parameters=None, chi_square=None, reduced_chi_square=None, message='', iterations=0, engine_result=None, starting_parameters=None, fitting_time=None, **kwargs)</code>","text":"<p>Initialize FitResults with the given parameters.</p> <p>Parameters:</p> Name Type Description Default <code>success</code> <code>bool</code> <p>Indicates if the fit was successful.</p> <code>False</code> <code>parameters</code> <code>Optional[List[Any]]</code> <p>List of parameters used in the fit.</p> <code>None</code> <code>chi_square</code> <code>Optional[float]</code> <p>Chi-square value of the fit.</p> <code>None</code> <code>reduced_chi_square</code> <code>Optional[float]</code> <p>Reduced chi-square value of the fit.</p> <code>None</code> <code>message</code> <code>str</code> <p>Message related to the fit.</p> <code>''</code> <code>iterations</code> <code>int</code> <p>Number of iterations performed.</p> <code>0</code> <code>engine_result</code> <code>Optional[Any]</code> <p>Result from the fitting engine.</p> <code>None</code> <code>starting_parameters</code> <code>Optional[List[Any]]</code> <p>Initial parameters for the fit.</p> <code>None</code> <code>fitting_time</code> <code>Optional[float]</code> <p>Time taken for the fitting process.</p> <code>None</code> <code>**kwargs</code> <code>Any</code> <p>Additional engine-specific fields. If <code>redchi</code> is provided and <code>reduced_chi_square</code> is not set, it is used as the reduced chi-square value.</p> <code>{}</code> Source code in <code>src/easydiffraction/analysis/fit_helpers/reporting.py</code> <pre><code>def __init__(\n    self,\n    success: bool = False,\n    parameters: Optional[List[Any]] = None,\n    chi_square: Optional[float] = None,\n    reduced_chi_square: Optional[float] = None,\n    message: str = '',\n    iterations: int = 0,\n    engine_result: Optional[Any] = None,\n    starting_parameters: Optional[List[Any]] = None,\n    fitting_time: Optional[float] = None,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Initialize FitResults with the given parameters.\n\n    Args:\n        success: Indicates if the fit was successful.\n        parameters: List of parameters used in the fit.\n        chi_square: Chi-square value of the fit.\n        reduced_chi_square: Reduced chi-square value of the fit.\n        message: Message related to the fit.\n        iterations: Number of iterations performed.\n        engine_result: Result from the fitting engine.\n        starting_parameters: Initial parameters for the fit.\n        fitting_time: Time taken for the fitting process.\n        **kwargs: Additional engine-specific fields. If ``redchi``\n            is provided and ``reduced_chi_square`` is not set, it is\n            used as the reduced chi-square value.\n    \"\"\"\n    self.success: bool = success\n    self.parameters: List[Any] = parameters if parameters is not None else []\n    self.chi_square: Optional[float] = chi_square\n    self.reduced_chi_square: Optional[float] = reduced_chi_square\n    self.message: str = message\n    self.iterations: int = iterations\n    self.engine_result: Optional[Any] = engine_result\n    self.result: Optional[Any] = None\n    self.starting_parameters: List[Any] = (\n        starting_parameters if starting_parameters is not None else []\n    )\n    self.fitting_time: Optional[float] = fitting_time\n\n    if 'redchi' in kwargs and self.reduced_chi_square is None:\n        self.reduced_chi_square = kwargs.get('redchi')\n\n    for key, value in kwargs.items():\n        setattr(self, key, value)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.reporting.FitResults.display_results","title":"<code>display_results(y_obs=None, y_calc=None, y_err=None, f_obs=None, f_calc=None)</code>","text":"<p>Render a human-readable summary of the fit.</p> <p>Parameters:</p> Name Type Description Default <code>y_obs</code> <code>Optional[List[float]]</code> <p>Observed intensities for pattern R-factor metrics.</p> <code>None</code> <code>y_calc</code> <code>Optional[List[float]]</code> <p>Calculated intensities for pattern R-factor metrics.</p> <code>None</code> <code>y_err</code> <code>Optional[List[float]]</code> <p>Standard deviations of observed intensities for wR.</p> <code>None</code> <code>f_obs</code> <code>Optional[List[float]]</code> <p>Observed structure-factor magnitudes for Bragg R.</p> <code>None</code> <code>f_calc</code> <code>Optional[List[float]]</code> <p>Calculated structure-factor magnitudes for Bragg R.</p> <code>None</code> Source code in <code>src/easydiffraction/analysis/fit_helpers/reporting.py</code> <pre><code>def display_results(\n    self,\n    y_obs: Optional[List[float]] = None,\n    y_calc: Optional[List[float]] = None,\n    y_err: Optional[List[float]] = None,\n    f_obs: Optional[List[float]] = None,\n    f_calc: Optional[List[float]] = None,\n) -&gt; None:\n    \"\"\"Render a human-readable summary of the fit.\n\n    Args:\n        y_obs: Observed intensities for pattern R-factor metrics.\n        y_calc: Calculated intensities for pattern R-factor metrics.\n        y_err: Standard deviations of observed intensities for wR.\n        f_obs: Observed structure-factor magnitudes for Bragg R.\n        f_calc: Calculated structure-factor magnitudes for Bragg R.\n    \"\"\"\n    status_icon = '\u2705' if self.success else '\u274c'\n    rf = rf2 = wr = br = None\n    if y_obs is not None and y_calc is not None:\n        rf = calculate_r_factor(y_obs, y_calc) * 100\n        rf2 = calculate_r_factor_squared(y_obs, y_calc) * 100\n    if y_obs is not None and y_calc is not None and y_err is not None:\n        wr = calculate_weighted_r_factor(y_obs, y_calc, y_err) * 100\n    if f_obs is not None and f_calc is not None:\n        br = calculate_rb_factor(f_obs, f_calc) * 100\n\n    console.paragraph('Fit results')\n    console.print(f'{status_icon} Success: {self.success}')\n    console.print(f'\u23f1\ufe0f Fitting time: {self.fitting_time:.2f} seconds')\n    console.print(f'\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): {self.reduced_chi_square:.2f}')\n    if rf is not None:\n        console.print(f'\ud83d\udccf R-factor (Rf): {rf:.2f}%')\n    if rf2 is not None:\n        console.print(f'\ud83d\udccf R-factor squared (Rf\u00b2): {rf2:.2f}%')\n    if wr is not None:\n        console.print(f'\ud83d\udccf Weighted R-factor (wR): {wr:.2f}%')\n    if br is not None:\n        console.print(f'\ud83d\udccf Bragg R-factor (BR): {br:.2f}%')\n    console.print('\ud83d\udcc8 Fitted parameters:')\n\n    headers = [\n        'datablock',\n        'category',\n        'entry',\n        'parameter',\n        'start',\n        'fitted',\n        'uncertainty',\n        'units',\n        'change',\n    ]\n    alignments = [\n        'left',\n        'left',\n        'left',\n        'left',\n        'right',\n        'right',\n        'right',\n        'left',\n        'right',\n    ]\n\n    rows = []\n    for param in self.parameters:\n        datablock_entry_name = (\n            param._identity.datablock_entry_name\n        )  # getattr(param, 'datablock_name', 'N/A')\n        category_code = param._identity.category_code  # getattr(param, 'category_key', 'N/A')\n        category_entry_name = (\n            param._identity.category_entry_name or ''\n        )  # getattr(param, 'category_entry_name', 'N/A')\n        name = getattr(param, 'name', 'N/A')\n        start = (\n            f'{getattr(param, \"_fit_start_value\", \"N/A\"):.4f}'\n            if param._fit_start_value is not None\n            else 'N/A'\n        )\n        fitted = f'{param.value:.4f}' if param.value is not None else 'N/A'\n        uncertainty = f'{param.uncertainty:.4f}' if param.uncertainty is not None else 'N/A'\n        units = getattr(param, 'units', 'N/A')\n\n        if param._fit_start_value and param.value:\n            change = ((param.value - param._fit_start_value) / param._fit_start_value) * 100\n            arrow = '\u2191' if change &gt; 0 else '\u2193'\n            relative_change = f'{abs(change):.2f} % {arrow}'\n        else:\n            relative_change = 'N/A'\n\n        rows.append([\n            datablock_entry_name,\n            category_code,\n            category_entry_name,\n            name,\n            start,\n            fitted,\n            uncertainty,\n            units,\n            relative_change,\n        ])\n\n    render_table(\n        columns_headers=headers,\n        columns_alignment=alignments,\n        columns_data=rows,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking","title":"<code>tracking</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker","title":"<code>FitProgressTracker</code>","text":"<p>Track and report reduced chi-square during optimization.</p> <p>The tracker keeps iteration counters, remembers the best observed reduced chi-square and when it occurred, and can display progress as a table in notebooks or a text UI in terminals.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>class FitProgressTracker:\n    \"\"\"Track and report reduced chi-square during optimization.\n\n    The tracker keeps iteration counters, remembers the best observed\n    reduced chi-square and when it occurred, and can display progress as\n    a table in notebooks or a text UI in terminals.\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        self._iteration: int = 0\n        self._previous_chi2: Optional[float] = None\n        self._last_chi2: Optional[float] = None\n        self._last_iteration: Optional[int] = None\n        self._best_chi2: Optional[float] = None\n        self._best_iteration: Optional[int] = None\n        self._fitting_time: Optional[float] = None\n\n        self._df_rows: List[List[str]] = []\n        self._display_handle: Optional[Any] = None\n        self._live: Optional[Any] = None\n\n    def reset(self) -&gt; None:\n        \"\"\"Reset internal state before a new optimization run.\"\"\"\n        self._iteration = 0\n        self._previous_chi2 = None\n        self._last_chi2 = None\n        self._last_iteration = None\n        self._best_chi2 = None\n        self._best_iteration = None\n        self._fitting_time = None\n\n    def track(\n        self,\n        residuals: np.ndarray,\n        parameters: List[float],\n    ) -&gt; np.ndarray:\n        \"\"\"Update progress with current residuals and parameters.\n\n        Args:\n            residuals: Residuals between measured and calculated data.\n            parameters: Current free parameters being fitted.\n\n        Returns:\n            Residuals unchanged, for optimizer consumption.\n        \"\"\"\n        self._iteration += 1\n\n        reduced_chi2 = calculate_reduced_chi_square(residuals, len(parameters))\n\n        row: List[str] = []\n\n        # First iteration, initialize tracking\n        if self._previous_chi2 is None:\n            self._previous_chi2 = reduced_chi2\n            self._best_chi2 = reduced_chi2\n            self._best_iteration = self._iteration\n\n            row = [\n                str(self._iteration),\n                f'{reduced_chi2:.2f}',\n                '',\n            ]\n\n        # Subsequent iterations, check for significant changes\n        else:\n            change = (self._previous_chi2 - reduced_chi2) / self._previous_chi2\n\n            # Improvement check\n            if change &gt; SIGNIFICANT_CHANGE_THRESHOLD:\n                change_in_percent = change * 100\n\n                row = [\n                    str(self._iteration),\n                    f'{reduced_chi2:.2f}',\n                    f'{change_in_percent:.1f}% \u2193',\n                ]\n\n                self._previous_chi2 = reduced_chi2\n\n        # Output if there is something new to display\n        if row:\n            self.add_tracking_info(row)\n\n        # Update best chi-square if better\n        if reduced_chi2 &lt; self._best_chi2:\n            self._best_chi2 = reduced_chi2\n            self._best_iteration = self._iteration\n\n        # Store last chi-square and iteration\n        self._last_chi2 = reduced_chi2\n        self._last_iteration = self._iteration\n\n        return residuals\n\n    @property\n    def best_chi2(self) -&gt; Optional[float]:\n        \"\"\"Best recorded reduced chi-square value or None.\"\"\"\n        return self._best_chi2\n\n    @property\n    def best_iteration(self) -&gt; Optional[int]:\n        \"\"\"Iteration index at which the best chi-square was observed.\"\"\"\n        return self._best_iteration\n\n    @property\n    def iteration(self) -&gt; int:\n        \"\"\"Current iteration counter.\"\"\"\n        return self._iteration\n\n    @property\n    def fitting_time(self) -&gt; Optional[float]:\n        \"\"\"Elapsed time of the last run in seconds, if available.\"\"\"\n        return self._fitting_time\n\n    def start_timer(self) -&gt; None:\n        \"\"\"Begin timing of a fit run.\"\"\"\n        self._start_time = time.perf_counter()\n\n    def stop_timer(self) -&gt; None:\n        \"\"\"Stop timing and store elapsed time for the run.\"\"\"\n        self._end_time = time.perf_counter()\n        self._fitting_time = self._end_time - self._start_time\n\n    def start_tracking(self, minimizer_name: str) -&gt; None:\n        \"\"\"Initialize display and headers and announce the minimizer.\n\n        Args:\n            minimizer_name: Name of the minimizer used for the run.\n        \"\"\"\n        console.print(f\"\ud83d\ude80 Starting fit process with '{minimizer_name}'...\")\n        console.print('\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:')\n\n        # Reset rows and create an environment-appropriate handle\n        self._df_rows = []\n        self._display_handle = _make_display_handle()\n\n        # Initial empty table; subsequent updates will reuse the handle\n        render_table(\n            columns_headers=DEFAULT_HEADERS,\n            columns_alignment=DEFAULT_ALIGNMENTS,\n            columns_data=self._df_rows,\n            display_handle=self._display_handle,\n        )\n\n    def add_tracking_info(self, row: List[str]) -&gt; None:\n        \"\"\"Append a formatted row to the progress display.\n\n        Args:\n            row: Columns corresponding to DEFAULT_HEADERS.\n        \"\"\"\n        # Append and update via the active handle (Jupyter or\n        # terminal live)\n        self._df_rows.append(row)\n        render_table(\n            columns_headers=DEFAULT_HEADERS,\n            columns_alignment=DEFAULT_ALIGNMENTS,\n            columns_data=self._df_rows,\n            display_handle=self._display_handle,\n        )\n\n    def finish_tracking(self) -&gt; None:\n        \"\"\"Finalize progress display and print best result summary.\"\"\"\n        # Add last iteration as last row\n        row: List[str] = [\n            str(self._last_iteration),\n            f'{self._last_chi2:.2f}' if self._last_chi2 is not None else '',\n            '',\n        ]\n        self.add_tracking_info(row)\n\n        # Close terminal live if used\n        if self._display_handle is not None and hasattr(self._display_handle, 'close'):\n            with suppress(Exception):\n                self._display_handle.close()\n\n        # Print best result\n        console.print(\n            f'\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is {self._best_chi2:.2f} '\n            f'at iteration {self._best_iteration}'\n        )\n        console.print('\u2705 Fitting complete.')\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.add_tracking_info","title":"<code>add_tracking_info(row)</code>","text":"<p>Append a formatted row to the progress display.</p> <p>Parameters:</p> Name Type Description Default <code>row</code> <code>List[str]</code> <p>Columns corresponding to DEFAULT_HEADERS.</p> required Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def add_tracking_info(self, row: List[str]) -&gt; None:\n    \"\"\"Append a formatted row to the progress display.\n\n    Args:\n        row: Columns corresponding to DEFAULT_HEADERS.\n    \"\"\"\n    # Append and update via the active handle (Jupyter or\n    # terminal live)\n    self._df_rows.append(row)\n    render_table(\n        columns_headers=DEFAULT_HEADERS,\n        columns_alignment=DEFAULT_ALIGNMENTS,\n        columns_data=self._df_rows,\n        display_handle=self._display_handle,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.best_chi2","title":"<code>best_chi2</code>  <code>property</code>","text":"<p>Best recorded reduced chi-square value or None.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.best_iteration","title":"<code>best_iteration</code>  <code>property</code>","text":"<p>Iteration index at which the best chi-square was observed.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.finish_tracking","title":"<code>finish_tracking()</code>","text":"<p>Finalize progress display and print best result summary.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def finish_tracking(self) -&gt; None:\n    \"\"\"Finalize progress display and print best result summary.\"\"\"\n    # Add last iteration as last row\n    row: List[str] = [\n        str(self._last_iteration),\n        f'{self._last_chi2:.2f}' if self._last_chi2 is not None else '',\n        '',\n    ]\n    self.add_tracking_info(row)\n\n    # Close terminal live if used\n    if self._display_handle is not None and hasattr(self._display_handle, 'close'):\n        with suppress(Exception):\n            self._display_handle.close()\n\n    # Print best result\n    console.print(\n        f'\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is {self._best_chi2:.2f} '\n        f'at iteration {self._best_iteration}'\n    )\n    console.print('\u2705 Fitting complete.')\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.fitting_time","title":"<code>fitting_time</code>  <code>property</code>","text":"<p>Elapsed time of the last run in seconds, if available.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.iteration","title":"<code>iteration</code>  <code>property</code>","text":"<p>Current iteration counter.</p>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.reset","title":"<code>reset()</code>","text":"<p>Reset internal state before a new optimization run.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def reset(self) -&gt; None:\n    \"\"\"Reset internal state before a new optimization run.\"\"\"\n    self._iteration = 0\n    self._previous_chi2 = None\n    self._last_chi2 = None\n    self._last_iteration = None\n    self._best_chi2 = None\n    self._best_iteration = None\n    self._fitting_time = None\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.start_timer","title":"<code>start_timer()</code>","text":"<p>Begin timing of a fit run.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def start_timer(self) -&gt; None:\n    \"\"\"Begin timing of a fit run.\"\"\"\n    self._start_time = time.perf_counter()\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.start_tracking","title":"<code>start_tracking(minimizer_name)</code>","text":"<p>Initialize display and headers and announce the minimizer.</p> <p>Parameters:</p> Name Type Description Default <code>minimizer_name</code> <code>str</code> <p>Name of the minimizer used for the run.</p> required Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def start_tracking(self, minimizer_name: str) -&gt; None:\n    \"\"\"Initialize display and headers and announce the minimizer.\n\n    Args:\n        minimizer_name: Name of the minimizer used for the run.\n    \"\"\"\n    console.print(f\"\ud83d\ude80 Starting fit process with '{minimizer_name}'...\")\n    console.print('\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:')\n\n    # Reset rows and create an environment-appropriate handle\n    self._df_rows = []\n    self._display_handle = _make_display_handle()\n\n    # Initial empty table; subsequent updates will reuse the handle\n    render_table(\n        columns_headers=DEFAULT_HEADERS,\n        columns_alignment=DEFAULT_ALIGNMENTS,\n        columns_data=self._df_rows,\n        display_handle=self._display_handle,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.stop_timer","title":"<code>stop_timer()</code>","text":"<p>Stop timing and store elapsed time for the run.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def stop_timer(self) -&gt; None:\n    \"\"\"Stop timing and store elapsed time for the run.\"\"\"\n    self._end_time = time.perf_counter()\n    self._fitting_time = self._end_time - self._start_time\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fit_helpers.tracking.FitProgressTracker.track","title":"<code>track(residuals, parameters)</code>","text":"<p>Update progress with current residuals and parameters.</p> <p>Parameters:</p> Name Type Description Default <code>residuals</code> <code>ndarray</code> <p>Residuals between measured and calculated data.</p> required <code>parameters</code> <code>List[float]</code> <p>Current free parameters being fitted.</p> required <p>Returns:</p> Type Description <code>ndarray</code> <p>Residuals unchanged, for optimizer consumption.</p> Source code in <code>src/easydiffraction/analysis/fit_helpers/tracking.py</code> <pre><code>def track(\n    self,\n    residuals: np.ndarray,\n    parameters: List[float],\n) -&gt; np.ndarray:\n    \"\"\"Update progress with current residuals and parameters.\n\n    Args:\n        residuals: Residuals between measured and calculated data.\n        parameters: Current free parameters being fitted.\n\n    Returns:\n        Residuals unchanged, for optimizer consumption.\n    \"\"\"\n    self._iteration += 1\n\n    reduced_chi2 = calculate_reduced_chi_square(residuals, len(parameters))\n\n    row: List[str] = []\n\n    # First iteration, initialize tracking\n    if self._previous_chi2 is None:\n        self._previous_chi2 = reduced_chi2\n        self._best_chi2 = reduced_chi2\n        self._best_iteration = self._iteration\n\n        row = [\n            str(self._iteration),\n            f'{reduced_chi2:.2f}',\n            '',\n        ]\n\n    # Subsequent iterations, check for significant changes\n    else:\n        change = (self._previous_chi2 - reduced_chi2) / self._previous_chi2\n\n        # Improvement check\n        if change &gt; SIGNIFICANT_CHANGE_THRESHOLD:\n            change_in_percent = change * 100\n\n            row = [\n                str(self._iteration),\n                f'{reduced_chi2:.2f}',\n                f'{change_in_percent:.1f}% \u2193',\n            ]\n\n            self._previous_chi2 = reduced_chi2\n\n    # Output if there is something new to display\n    if row:\n        self.add_tracking_info(row)\n\n    # Update best chi-square if better\n    if reduced_chi2 &lt; self._best_chi2:\n        self._best_chi2 = reduced_chi2\n        self._best_iteration = self._iteration\n\n    # Store last chi-square and iteration\n    self._last_chi2 = reduced_chi2\n    self._last_iteration = self._iteration\n\n    return residuals\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fitting","title":"<code>fitting</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.fitting.Fitter","title":"<code>Fitter</code>","text":"<p>Handles the fitting workflow using a pluggable minimizer.</p> Source code in <code>src/easydiffraction/analysis/fitting.py</code> <pre><code>class Fitter:\n    \"\"\"Handles the fitting workflow using a pluggable minimizer.\"\"\"\n\n    def __init__(self, selection: str = 'lmfit (leastsq)') -&gt; None:\n        self.selection: str = selection\n        self.engine: str = selection.split(' ')[0]  # Extracts 'lmfit' or 'dfols'\n        self.minimizer = MinimizerFactory.create_minimizer(selection)\n        self.results: Optional[FitResults] = None\n\n    def fit(\n        self,\n        sample_models: SampleModels,\n        experiments: Experiments,\n        weights: Optional[np.array] = None,\n        analysis=None,\n    ) -&gt; None:\n        \"\"\"Run the fitting process.\n\n        This method performs the optimization but does not display\n        results. Use :meth:`show_fit_results` on the Analysis object\n        to display the fit results after fitting is complete.\n\n        Args:\n            sample_models: Collection of sample models.\n            experiments: Collection of experiments.\n            weights: Optional weights for joint fitting.\n            analysis: Optional Analysis object to update its categories\n                during fitting.\n        \"\"\"\n        params = sample_models.free_parameters + experiments.free_parameters\n\n        if not params:\n            print('\u26a0\ufe0f No parameters selected for fitting.')\n            return None\n\n        for param in params:\n            param._fit_start_value = param.value\n\n        def objective_function(engine_params: Dict[str, Any]) -&gt; np.ndarray:\n            return self._residual_function(\n                engine_params=engine_params,\n                parameters=params,\n                sample_models=sample_models,\n                experiments=experiments,\n                weights=weights,\n                analysis=analysis,\n            )\n\n        # Perform fitting\n        self.results = self.minimizer.fit(params, objective_function)\n\n    def _process_fit_results(\n        self,\n        sample_models: SampleModels,\n        experiments: Experiments,\n    ) -&gt; None:\n        \"\"\"Collect reliability inputs and display fit results.\n\n        This method is typically called by\n        :meth:`Analysis.show_fit_results` rather than directly. It\n        calculates R-factors and other metrics, then renders them to\n        the console.\n\n        Args:\n            sample_models: Collection of sample models.\n            experiments: Collection of experiments.\n        \"\"\"\n        y_obs, y_calc, y_err = get_reliability_inputs(\n            sample_models,\n            experiments,\n        )\n\n        # Placeholder for future f_obs / f_calc retrieval\n        f_obs, f_calc = None, None\n\n        if self.results:\n            self.results.display_results(\n                y_obs=y_obs,\n                y_calc=y_calc,\n                y_err=y_err,\n                f_obs=f_obs,\n                f_calc=f_calc,\n            )\n\n    def _collect_free_parameters(\n        self,\n        sample_models: SampleModels,\n        experiments: Experiments,\n    ) -&gt; List[Parameter]:\n        \"\"\"Collect free parameters from sample models and experiments.\n\n        Args:\n            sample_models: Collection of sample models.\n            experiments: Collection of experiments.\n\n        Returns:\n            List of free parameters.\n        \"\"\"\n        free_params: List[Parameter] = sample_models.free_parameters + experiments.free_parameters\n        return free_params\n\n    def _residual_function(\n        self,\n        engine_params: Dict[str, Any],\n        parameters: List[Parameter],\n        sample_models: SampleModels,\n        experiments: Experiments,\n        weights: Optional[np.array] = None,\n        analysis=None,\n    ) -&gt; np.ndarray:\n        \"\"\"Residual function computes the difference between measured\n        and calculated patterns. It updates the parameter values\n        according to the optimizer-provided engine_params.\n\n        Args:\n            engine_params: Engine-specific parameter dict.\n            parameters: List of parameters being optimized.\n            sample_models: Collection of sample models.\n            experiments: Collection of experiments.\n            weights: Optional weights for joint fitting.\n            analysis: Optional Analysis object to update its categories\n                during fitting.\n\n        Returns:\n            Array of weighted residuals.\n        \"\"\"\n        # Sync parameters back to objects\n        self.minimizer._sync_result_to_parameters(parameters, engine_params)\n\n        # Update categories to reflect new parameter values\n        # Order matters: sample models first (symmetry, structure),\n        # then analysis (constraints), then experiments (calculations)\n        for sample_model in sample_models:\n            sample_model._update_categories()\n\n        if analysis is not None:\n            analysis._update_categories(called_by_minimizer=True)\n\n        # Prepare weights for joint fitting\n        num_expts: int = len(experiments.names)\n        if weights is None:\n            _weights = np.ones(num_expts)\n        else:\n            _weights_list: List[float] = []\n            for name in experiments.names:\n                _weight = weights[name].weight.value\n                _weights_list.append(_weight)\n            _weights = np.array(_weights_list, dtype=np.float64)\n\n        # Normalize weights so they sum to num_expts\n        # We should obtain the same reduced chi_squared when a single\n        # dataset is split into two parts and fit together. If weights\n        # sum to one, then reduced chi_squared will be half as large as\n        # expected.\n        _weights *= num_expts / np.sum(_weights)\n        residuals: List[float] = []\n\n        for experiment, weight in zip(experiments.values(), _weights, strict=True):\n            # Update experiment-specific calculations\n            experiment._update_categories(called_by_minimizer=True)\n\n            # Calculate the difference between measured and calculated\n            # patterns\n            y_calc: np.ndarray = experiment.data.calc\n            y_meas: np.ndarray = experiment.data.meas\n            y_meas_su: np.ndarray = experiment.data.meas_su\n            diff = (y_meas - y_calc) / y_meas_su\n\n            # Residuals are squared before going into reduced\n            # chi-squared\n            diff *= np.sqrt(weight)\n\n            # Append the residuals for this experiment\n            residuals.extend(diff)\n\n        return self.minimizer.tracker.track(np.array(residuals), parameters)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.fitting.Fitter.fit","title":"<code>fit(sample_models, experiments, weights=None, analysis=None)</code>","text":"<p>Run the fitting process.</p> <p>This method performs the optimization but does not display results. Use :meth:<code>show_fit_results</code> on the Analysis object to display the fit results after fitting is complete.</p> <p>Parameters:</p> Name Type Description Default <code>sample_models</code> <code>SampleModels</code> <p>Collection of sample models.</p> required <code>experiments</code> <code>Experiments</code> <p>Collection of experiments.</p> required <code>weights</code> <code>Optional[array]</code> <p>Optional weights for joint fitting.</p> <code>None</code> <code>analysis</code> <p>Optional Analysis object to update its categories during fitting.</p> <code>None</code> Source code in <code>src/easydiffraction/analysis/fitting.py</code> <pre><code>def fit(\n    self,\n    sample_models: SampleModels,\n    experiments: Experiments,\n    weights: Optional[np.array] = None,\n    analysis=None,\n) -&gt; None:\n    \"\"\"Run the fitting process.\n\n    This method performs the optimization but does not display\n    results. Use :meth:`show_fit_results` on the Analysis object\n    to display the fit results after fitting is complete.\n\n    Args:\n        sample_models: Collection of sample models.\n        experiments: Collection of experiments.\n        weights: Optional weights for joint fitting.\n        analysis: Optional Analysis object to update its categories\n            during fitting.\n    \"\"\"\n    params = sample_models.free_parameters + experiments.free_parameters\n\n    if not params:\n        print('\u26a0\ufe0f No parameters selected for fitting.')\n        return None\n\n    for param in params:\n        param._fit_start_value = param.value\n\n    def objective_function(engine_params: Dict[str, Any]) -&gt; np.ndarray:\n        return self._residual_function(\n            engine_params=engine_params,\n            parameters=params,\n            sample_models=sample_models,\n            experiments=experiments,\n            weights=weights,\n            analysis=analysis,\n        )\n\n    # Perform fitting\n    self.results = self.minimizer.fit(params, objective_function)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers","title":"<code>minimizers</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.base","title":"<code>base</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.base.MinimizerBase","title":"<code>MinimizerBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract base for concrete minimizers.</p> <p>Contract: - Subclasses must implement <code>_prepare_solver_args</code>,     <code>_run_solver</code>, <code>_sync_result_to_parameters</code> and     <code>_check_success</code>. - The <code>fit</code> method orchestrates the full workflow and returns     :class:<code>FitResults</code>.</p> Source code in <code>src/easydiffraction/analysis/minimizers/base.py</code> <pre><code>class MinimizerBase(ABC):\n    \"\"\"Abstract base for concrete minimizers.\n\n    Contract:\n    - Subclasses must implement ``_prepare_solver_args``,\n        ``_run_solver``, ``_sync_result_to_parameters`` and\n        ``_check_success``.\n    - The ``fit`` method orchestrates the full workflow and returns\n        :class:`FitResults`.\n    \"\"\"\n\n    def __init__(\n        self,\n        name: Optional[str] = None,\n        method: Optional[str] = None,\n        max_iterations: Optional[int] = None,\n    ) -&gt; None:\n        self.name: Optional[str] = name\n        self.method: Optional[str] = method\n        self.max_iterations: Optional[int] = max_iterations\n        self.result: Optional[FitResults] = None\n        self._previous_chi2: Optional[float] = None\n        self._iteration: Optional[int] = None\n        self._best_chi2: Optional[float] = None\n        self._best_iteration: Optional[int] = None\n        self._fitting_time: Optional[float] = None\n        self.tracker: FitProgressTracker = FitProgressTracker()\n\n    def _start_tracking(self, minimizer_name: str) -&gt; None:\n        \"\"\"Initialize progress tracking and timer.\n\n        Args:\n            minimizer_name: Human-readable name shown in progress.\n        \"\"\"\n        self.tracker.reset()\n        self.tracker.start_tracking(minimizer_name)\n        self.tracker.start_timer()\n\n    def _stop_tracking(self) -&gt; None:\n        \"\"\"Stop timer and finalize tracking.\"\"\"\n        self.tracker.stop_timer()\n        self.tracker.finish_tracking()\n\n    @abstractmethod\n    def _prepare_solver_args(self, parameters: List[Any]) -&gt; Dict[str, Any]:\n        \"\"\"Prepare keyword-arguments for the underlying solver.\n\n        Args:\n            parameters: List of free parameters to be fitted.\n\n        Returns:\n            Mapping of keyword arguments to pass into ``_run_solver``.\n        \"\"\"\n        pass\n\n    @abstractmethod\n    def _run_solver(\n        self,\n        objective_function: Callable[..., Any],\n        engine_parameters: Dict[str, Any],\n    ) -&gt; Any:\n        \"\"\"Execute the concrete solver and return its raw result.\"\"\"\n        pass\n\n    @abstractmethod\n    def _sync_result_to_parameters(\n        self,\n        raw_result: Any,\n        parameters: List[Any],\n    ) -&gt; None:\n        \"\"\"Copy values from ``raw_result`` back to ``parameters`` in-\n        place.\n        \"\"\"\n        pass\n\n    def _finalize_fit(\n        self,\n        parameters: List[Any],\n        raw_result: Any,\n    ) -&gt; FitResults:\n        \"\"\"Build :class:`FitResults` and store it on ``self.result``.\n\n        Args:\n            parameters: Parameters after the solver finished.\n            raw_result: Backend-specific solver output object.\n\n        Returns:\n            FitResults: Aggregated outcome of the fit.\n        \"\"\"\n        self._sync_result_to_parameters(parameters, raw_result)\n        success = self._check_success(raw_result)\n        self.result = FitResults(\n            success=success,\n            parameters=parameters,\n            reduced_chi_square=self.tracker.best_chi2,\n            engine_result=raw_result,\n            starting_parameters=parameters,\n            fitting_time=self.tracker.fitting_time,\n        )\n        return self.result\n\n    @abstractmethod\n    def _check_success(self, raw_result: Any) -&gt; bool:\n        \"\"\"Determine whether the fit was successful.\"\"\"\n        pass\n\n    def fit(\n        self,\n        parameters: List[Any],\n        objective_function: Callable[..., Any],\n    ) -&gt; FitResults:\n        \"\"\"Run the full minimization workflow.\n\n        Args:\n            parameters: Free parameters to optimize.\n            objective_function: Callable returning residuals for a given\n                set of engine arguments.\n\n        Returns:\n            FitResults with success flag, best chi2 and timing.\n        \"\"\"\n        minimizer_name = self.name or 'Unnamed Minimizer'\n        if self.method is not None:\n            minimizer_name += f' ({self.method})'\n\n        self._start_tracking(minimizer_name)\n\n        solver_args = self._prepare_solver_args(parameters)\n        raw_result = self._run_solver(objective_function, **solver_args)\n\n        self._stop_tracking()\n\n        result = self._finalize_fit(parameters, raw_result)\n\n        return result\n\n    def _objective_function(\n        self,\n        engine_params: Dict[str, Any],\n        parameters: List[Any],\n        sample_models: Any,\n        experiments: Any,\n        calculator: Any,\n    ) -&gt; np.ndarray:\n        \"\"\"Default objective helper computing residuals array.\"\"\"\n        return self._compute_residuals(\n            engine_params,\n            parameters,\n            sample_models,\n            experiments,\n            calculator,\n        )\n\n    def _create_objective_function(\n        self,\n        parameters: List[Any],\n        sample_models: Any,\n        experiments: Any,\n        calculator: Any,\n    ) -&gt; Callable[[Dict[str, Any]], np.ndarray]:\n        \"\"\"Return a closure capturing problem context for the solver.\"\"\"\n        return lambda engine_params: self._objective_function(\n            engine_params,\n            parameters,\n            sample_models,\n            experiments,\n            calculator,\n        )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.base.MinimizerBase.fit","title":"<code>fit(parameters, objective_function)</code>","text":"<p>Run the full minimization workflow.</p> <p>Parameters:</p> Name Type Description Default <code>parameters</code> <code>List[Any]</code> <p>Free parameters to optimize.</p> required <code>objective_function</code> <code>Callable[..., Any]</code> <p>Callable returning residuals for a given set of engine arguments.</p> required <p>Returns:</p> Type Description <code>FitResults</code> <p>FitResults with success flag, best chi2 and timing.</p> Source code in <code>src/easydiffraction/analysis/minimizers/base.py</code> <pre><code>def fit(\n    self,\n    parameters: List[Any],\n    objective_function: Callable[..., Any],\n) -&gt; FitResults:\n    \"\"\"Run the full minimization workflow.\n\n    Args:\n        parameters: Free parameters to optimize.\n        objective_function: Callable returning residuals for a given\n            set of engine arguments.\n\n    Returns:\n        FitResults with success flag, best chi2 and timing.\n    \"\"\"\n    minimizer_name = self.name or 'Unnamed Minimizer'\n    if self.method is not None:\n        minimizer_name += f' ({self.method})'\n\n    self._start_tracking(minimizer_name)\n\n    solver_args = self._prepare_solver_args(parameters)\n    raw_result = self._run_solver(objective_function, **solver_args)\n\n    self._stop_tracking()\n\n    result = self._finalize_fit(parameters, raw_result)\n\n    return result\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.dfols","title":"<code>dfols</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.dfols.DfolsMinimizer","title":"<code>DfolsMinimizer</code>","text":"<p>               Bases: <code>MinimizerBase</code></p> <p>Minimizer using the DFO-LS package (Derivative-Free Optimization for Least-Squares).</p> Source code in <code>src/easydiffraction/analysis/minimizers/dfols.py</code> <pre><code>class DfolsMinimizer(MinimizerBase):\n    \"\"\"Minimizer using the DFO-LS package (Derivative-Free Optimization\n    for Least-Squares).\n    \"\"\"\n\n    def __init__(\n        self,\n        name: str = 'dfols',\n        max_iterations: int = DEFAULT_MAX_ITERATIONS,\n        **kwargs: Any,\n    ) -&gt; None:\n        super().__init__(name=name, method=None, max_iterations=max_iterations)\n        # Intentionally unused, accepted for API compatibility\n        del kwargs\n\n    def _prepare_solver_args(self, parameters: List[Any]) -&gt; Dict[str, Any]:\n        x0 = []\n        bounds_lower = []\n        bounds_upper = []\n        for param in parameters:\n            x0.append(param.value)\n            bounds_lower.append(param.fit_min)\n            bounds_upper.append(param.fit_max)\n        bounds = (np.array(bounds_lower), np.array(bounds_upper))\n        return {'x0': np.array(x0), 'bounds': bounds}\n\n    def _run_solver(self, objective_function: Any, **kwargs: Any) -&gt; Any:\n        x0 = kwargs.get('x0')\n        bounds = kwargs.get('bounds')\n        return solve(objective_function, x0=x0, bounds=bounds, maxfun=self.max_iterations)\n\n    def _sync_result_to_parameters(\n        self,\n        parameters: List[Any],\n        raw_result: Any,\n    ) -&gt; None:\n        \"\"\"Synchronizes the result from the solver to the parameters.\n\n        Args:\n            parameters: List of parameters being optimized.\n            raw_result: The result object returned by the solver.\n        \"\"\"\n        # Ensure compatibility with raw_result coming from dfols.solve()\n        result_values = raw_result.x if hasattr(raw_result, 'x') else raw_result\n\n        for i, param in enumerate(parameters):\n            param.value = result_values[i]\n            # DFO-LS doesn't provide uncertainties; set to None or\n            # calculate later if needed\n            param.uncertainty = None\n\n    def _check_success(self, raw_result: Any) -&gt; bool:\n        \"\"\"Determines success from DFO-LS result dictionary.\n\n        Args:\n            raw_result: The result object returned by the solver.\n\n        Returns:\n            True if the optimization was successful, False otherwise.\n        \"\"\"\n        return raw_result.flag == raw_result.EXIT_SUCCESS\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory","title":"<code>factory</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory.MinimizerFactory","title":"<code>MinimizerFactory</code>","text":"Source code in <code>src/easydiffraction/analysis/minimizers/factory.py</code> <pre><code>class MinimizerFactory:\n    _available_minimizers: Dict[str, Dict[str, Any]] = {\n        'lmfit': {\n            'engine': 'lmfit',\n            'method': 'leastsq',\n            'description': 'LMFIT library using the default Levenberg-Marquardt '\n            'least squares method',\n            'class': LmfitMinimizer,\n        },\n        'lmfit (leastsq)': {\n            'engine': 'lmfit',\n            'method': 'leastsq',\n            'description': 'LMFIT library with Levenberg-Marquardt least squares method',\n            'class': LmfitMinimizer,\n        },\n        'lmfit (least_squares)': {\n            'engine': 'lmfit',\n            'method': 'least_squares',\n            'description': 'LMFIT library with SciPy\u2019s trust region reflective algorithm',\n            'class': LmfitMinimizer,\n        },\n        'dfols': {\n            'engine': 'dfols',\n            'method': None,\n            'description': 'DFO-LS library for derivative-free least-squares optimization',\n            'class': DfolsMinimizer,\n        },\n    }\n\n    @classmethod\n    def list_available_minimizers(cls) -&gt; List[str]:\n        \"\"\"List all available minimizers.\n\n        Returns:\n            A list of minimizer names.\n        \"\"\"\n        return list(cls._available_minimizers.keys())\n\n    @classmethod\n    def show_available_minimizers(cls) -&gt; None:\n        # TODO: Rename this method to `show_supported_minimizers` for\n        #  consistency with other methods in the library. E.g.\n        #  `show_supported_calculators`, etc.\n        \"\"\"Display a table of available minimizers and their\n        descriptions.\n        \"\"\"\n        columns_headers: List[str] = ['Minimizer', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data: List[List[str]] = []\n        for name, config in cls._available_minimizers.items():\n            description: str = config.get('description', 'No description provided.')\n            columns_data.append([name, description])\n\n        console.paragraph('Supported minimizers')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    @classmethod\n    def create_minimizer(cls, selection: str) -&gt; MinimizerBase:\n        \"\"\"Create a minimizer instance based on the selection.\n\n        Args:\n            selection: The name of the minimizer to create.\n\n        Returns:\n            An instance of the selected minimizer.\n\n        Raises:\n            ValueError: If the selection is not a valid minimizer.\n        \"\"\"\n        config = cls._available_minimizers.get(selection)\n        if not config:\n            raise ValueError(\n                f\"Unknown minimizer '{selection}'. Use one of {cls.list_available_minimizers()}\"\n            )\n\n        minimizer_class: Type[MinimizerBase] = config.get('class')\n        method: Optional[str] = config.get('method')\n\n        kwargs: Dict[str, Any] = {}\n        if method is not None:\n            kwargs['method'] = method\n\n        return minimizer_class(**kwargs)\n\n    @classmethod\n    def register_minimizer(\n        cls,\n        name: str,\n        minimizer_cls: Type[MinimizerBase],\n        method: Optional[str] = None,\n        description: str = 'No description provided.',\n    ) -&gt; None:\n        \"\"\"Register a new minimizer.\n\n        Args:\n            name: The name of the minimizer.\n            minimizer_cls: The class of the minimizer.\n            method: The method used by the minimizer (optional).\n            description: A description of the minimizer.\n        \"\"\"\n        cls._available_minimizers[name] = {\n            'engine': name,\n            'method': method,\n            'description': description,\n            'class': minimizer_cls,\n        }\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory.MinimizerFactory.create_minimizer","title":"<code>create_minimizer(selection)</code>  <code>classmethod</code>","text":"<p>Create a minimizer instance based on the selection.</p> <p>Parameters:</p> Name Type Description Default <code>selection</code> <code>str</code> <p>The name of the minimizer to create.</p> required <p>Returns:</p> Type Description <code>MinimizerBase</code> <p>An instance of the selected minimizer.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If the selection is not a valid minimizer.</p> Source code in <code>src/easydiffraction/analysis/minimizers/factory.py</code> <pre><code>@classmethod\ndef create_minimizer(cls, selection: str) -&gt; MinimizerBase:\n    \"\"\"Create a minimizer instance based on the selection.\n\n    Args:\n        selection: The name of the minimizer to create.\n\n    Returns:\n        An instance of the selected minimizer.\n\n    Raises:\n        ValueError: If the selection is not a valid minimizer.\n    \"\"\"\n    config = cls._available_minimizers.get(selection)\n    if not config:\n        raise ValueError(\n            f\"Unknown minimizer '{selection}'. Use one of {cls.list_available_minimizers()}\"\n        )\n\n    minimizer_class: Type[MinimizerBase] = config.get('class')\n    method: Optional[str] = config.get('method')\n\n    kwargs: Dict[str, Any] = {}\n    if method is not None:\n        kwargs['method'] = method\n\n    return minimizer_class(**kwargs)\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory.MinimizerFactory.list_available_minimizers","title":"<code>list_available_minimizers()</code>  <code>classmethod</code>","text":"<p>List all available minimizers.</p> <p>Returns:</p> Type Description <code>List[str]</code> <p>A list of minimizer names.</p> Source code in <code>src/easydiffraction/analysis/minimizers/factory.py</code> <pre><code>@classmethod\ndef list_available_minimizers(cls) -&gt; List[str]:\n    \"\"\"List all available minimizers.\n\n    Returns:\n        A list of minimizer names.\n    \"\"\"\n    return list(cls._available_minimizers.keys())\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory.MinimizerFactory.register_minimizer","title":"<code>register_minimizer(name, minimizer_cls, method=None, description='No description provided.')</code>  <code>classmethod</code>","text":"<p>Register a new minimizer.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>The name of the minimizer.</p> required <code>minimizer_cls</code> <code>Type[MinimizerBase]</code> <p>The class of the minimizer.</p> required <code>method</code> <code>Optional[str]</code> <p>The method used by the minimizer (optional).</p> <code>None</code> <code>description</code> <code>str</code> <p>A description of the minimizer.</p> <code>'No description provided.'</code> Source code in <code>src/easydiffraction/analysis/minimizers/factory.py</code> <pre><code>@classmethod\ndef register_minimizer(\n    cls,\n    name: str,\n    minimizer_cls: Type[MinimizerBase],\n    method: Optional[str] = None,\n    description: str = 'No description provided.',\n) -&gt; None:\n    \"\"\"Register a new minimizer.\n\n    Args:\n        name: The name of the minimizer.\n        minimizer_cls: The class of the minimizer.\n        method: The method used by the minimizer (optional).\n        description: A description of the minimizer.\n    \"\"\"\n    cls._available_minimizers[name] = {\n        'engine': name,\n        'method': method,\n        'description': description,\n        'class': minimizer_cls,\n    }\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.factory.MinimizerFactory.show_available_minimizers","title":"<code>show_available_minimizers()</code>  <code>classmethod</code>","text":"<p>Display a table of available minimizers and their descriptions.</p> Source code in <code>src/easydiffraction/analysis/minimizers/factory.py</code> <pre><code>@classmethod\ndef show_available_minimizers(cls) -&gt; None:\n    # TODO: Rename this method to `show_supported_minimizers` for\n    #  consistency with other methods in the library. E.g.\n    #  `show_supported_calculators`, etc.\n    \"\"\"Display a table of available minimizers and their\n    descriptions.\n    \"\"\"\n    columns_headers: List[str] = ['Minimizer', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data: List[List[str]] = []\n    for name, config in cls._available_minimizers.items():\n        description: str = config.get('description', 'No description provided.')\n        columns_data.append([name, description])\n\n    console.paragraph('Supported minimizers')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.lmfit","title":"<code>lmfit</code>","text":""},{"location":"api-reference/analysis/#easydiffraction.analysis.minimizers.lmfit.LmfitMinimizer","title":"<code>LmfitMinimizer</code>","text":"<p>               Bases: <code>MinimizerBase</code></p> <p>Minimizer using the lmfit package.</p> Source code in <code>src/easydiffraction/analysis/minimizers/lmfit.py</code> <pre><code>class LmfitMinimizer(MinimizerBase):\n    \"\"\"Minimizer using the lmfit package.\"\"\"\n\n    def __init__(\n        self,\n        name: str = 'lmfit',\n        method: str = DEFAULT_METHOD,\n        max_iterations: int = DEFAULT_MAX_ITERATIONS,\n    ) -&gt; None:\n        super().__init__(\n            name=name,\n            method=method,\n            max_iterations=max_iterations,\n        )\n\n    def _prepare_solver_args(\n        self,\n        parameters: List[Any],\n    ) -&gt; Dict[str, Any]:\n        \"\"\"Prepares the solver arguments for the lmfit minimizer.\n\n        Args:\n            parameters: List of parameters to be optimized.\n\n        Returns:\n            A dictionary containing the prepared lmfit. Parameters\n                object.\n        \"\"\"\n        engine_parameters = lmfit.Parameters()\n        for param in parameters:\n            engine_parameters.add(\n                name=param._minimizer_uid,\n                value=param.value,\n                vary=param.free,\n                min=param.fit_min,\n                max=param.fit_max,\n            )\n        return {'engine_parameters': engine_parameters}\n\n    def _run_solver(self, objective_function: Any, **kwargs: Any) -&gt; Any:\n        \"\"\"Runs the lmfit solver.\n\n        Args:\n            objective_function: The objective function to minimize.\n            **kwargs: Additional arguments for the solver.\n\n        Returns:\n            The result of the lmfit minimization.\n        \"\"\"\n        engine_parameters = kwargs.get('engine_parameters')\n\n        return lmfit.minimize(\n            objective_function,\n            params=engine_parameters,\n            method=self.method,\n            nan_policy='propagate',\n            max_nfev=self.max_iterations,\n        )\n\n    def _sync_result_to_parameters(\n        self,\n        parameters: List[Any],\n        raw_result: Any,\n    ) -&gt; None:\n        \"\"\"Synchronizes the result from the solver to the parameters.\n\n        Args:\n            parameters: List of parameters being optimized.\n            raw_result: The result object returned by the solver.\n        \"\"\"\n        param_values = raw_result.params if hasattr(raw_result, 'params') else raw_result\n\n        for param in parameters:\n            param_result = param_values.get(param._minimizer_uid)\n            if param_result is not None:\n                param._value = param_result.value  # Bypass ranges check\n                param.uncertainty = getattr(param_result, 'stderr', None)\n\n    def _check_success(self, raw_result: Any) -&gt; bool:\n        \"\"\"Determines success from lmfit MinimizerResult.\n\n        Args:\n            raw_result: The result object returned by the solver.\n\n        Returns:\n            True if the optimization was successful, False otherwise.\n        \"\"\"\n        return getattr(raw_result, 'success', False)\n\n    def _iteration_callback(\n        self,\n        params: lmfit.Parameters,\n        iter: int,\n        resid: Any,\n        *args: Any,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Callback function for each iteration of the minimizer.\n\n        Args:\n            params: The current parameters.\n            iter: The current iteration number.\n            resid: The residuals.\n            *args: Additional positional arguments.\n            **kwargs: Additional keyword arguments.\n        \"\"\"\n        # Intentionally unused, required by callback signature\n        del params, resid, args, kwargs\n        self._iteration = iter\n</code></pre>"},{"location":"api-reference/core/","title":"core","text":""},{"location":"api-reference/core/#easydiffraction.core","title":"<code>core</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.category","title":"<code>category</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection","title":"<code>CategoryCollection</code>","text":"<p>               Bases: <code>CollectionBase</code></p> <p>Handles loop-style category containers (e.g. AtomSites).</p> <p>Each item is a CategoryItem (component).</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>class CategoryCollection(CollectionBase):\n    \"\"\"Handles loop-style category containers (e.g. AtomSites).\n\n    Each item is a CategoryItem (component).\n    \"\"\"\n\n    # TODO: Common for all categories\n    _update_priority = 10  # Default. Lower values run first.\n\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation of this component.\"\"\"\n        name = self._log_name\n        size = len(self)\n        return f'&lt;{name} collection ({size} items)&gt;'\n\n    # TODO: Common for all categories\n    def _update(self, called_by_minimizer=False):\n        del called_by_minimizer\n        pass\n\n    @property\n    def unique_name(self):\n        return None\n\n    @property\n    def parameters(self):\n        \"\"\"All parameters from all items in this collection.\"\"\"\n        params = []\n        for item in self._items:\n            params.extend(item.parameters)\n        return params\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Return CIF representation of this object.\"\"\"\n        return category_collection_to_cif(self)\n\n    def from_cif(self, block):\n        \"\"\"Populate this collection from a CIF block.\"\"\"\n        category_collection_from_cif(self, block)\n\n    @checktype\n    def _add(self, item) -&gt; None:\n        \"\"\"Add an item to the collection.\"\"\"\n        self[item._identity.category_entry_name] = item\n\n    # TODO: Disallow args and only allow kwargs?\n    # TODO: Check kwargs as for, e.g.,\n    #  ExperimentFactory.create(**kwargs)?\n    @checktype\n    def add(self, *args, **kwargs) -&gt; None:\n        \"\"\"Create and add a new child instance from the provided\n        arguments.\n        \"\"\"\n        child_obj = self._item_type(*args, **kwargs)\n        self._add(child_obj)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation of this component.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation of this component.\"\"\"\n    name = self._log_name\n    size = len(self)\n    return f'&lt;{name} collection ({size} items)&gt;'\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection.add","title":"<code>add(*args, **kwargs)</code>","text":"<p>Create and add a new child instance from the provided arguments.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>@checktype\ndef add(self, *args, **kwargs) -&gt; None:\n    \"\"\"Create and add a new child instance from the provided\n    arguments.\n    \"\"\"\n    child_obj = self._item_type(*args, **kwargs)\n    self._add(child_obj)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Return CIF representation of this object.</p>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection.from_cif","title":"<code>from_cif(block)</code>","text":"<p>Populate this collection from a CIF block.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>def from_cif(self, block):\n    \"\"\"Populate this collection from a CIF block.\"\"\"\n    category_collection_from_cif(self, block)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryCollection.parameters","title":"<code>parameters</code>  <code>property</code>","text":"<p>All parameters from all items in this collection.</p>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryItem","title":"<code>CategoryItem</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>Base class for items in a category collection.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>class CategoryItem(GuardedBase):\n    \"\"\"Base class for items in a category collection.\"\"\"\n\n    # TODO: Set different default priorities for CategoryItem and\n    #  CategoryCollection and use them when serializing to CIF!\n    # TODO: Common for all categories\n    _update_priority = 10  # Default. Lower values run first.\n\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation of this component.\"\"\"\n        name = self._log_name\n        params = ', '.join(f'{p.name}={p.value!r}' for p in self.parameters)\n        return f'&lt;{name} ({params})&gt;'\n\n    # TODO: Common for all categories\n    def _update(self, called_by_minimizer=False):\n        del called_by_minimizer\n        pass\n\n    @property\n    def unique_name(self):\n        parts = [\n            self._identity.datablock_entry_name,\n            self._identity.category_code,\n            self._identity.category_entry_name,\n        ]\n        # Convert all parts to strings and filter out None/empty values\n        str_parts = [str(part) for part in parts if part is not None]\n        return '.'.join(str_parts)\n\n    @property\n    def parameters(self):\n        return [v for v in vars(self).values() if isinstance(v, GenericDescriptorBase)]\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Return CIF representation of this object.\"\"\"\n        return category_item_to_cif(self)\n\n    def from_cif(self, block, idx=0):\n        \"\"\"Populate this item from a CIF block.\"\"\"\n        category_item_from_cif(self, block, idx)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryItem.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation of this component.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation of this component.\"\"\"\n    name = self._log_name\n    params = ', '.join(f'{p.name}={p.value!r}' for p in self.parameters)\n    return f'&lt;{name} ({params})&gt;'\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryItem.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Return CIF representation of this object.</p>"},{"location":"api-reference/core/#easydiffraction.core.category.CategoryItem.from_cif","title":"<code>from_cif(block, idx=0)</code>","text":"<p>Populate this item from a CIF block.</p> Source code in <code>src/easydiffraction/core/category.py</code> <pre><code>def from_cif(self, block, idx=0):\n    \"\"\"Populate this item from a CIF block.\"\"\"\n    category_item_from_cif(self, block, idx)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection","title":"<code>collection</code>","text":"<p>Lightweight container for guarded items with name-based indexing.</p> <p><code>CollectionBase</code> maintains an ordered list of items and a lazily rebuilt index by the item's identity key. It supports dict-like access for get, set and delete, along with iteration over the items.</p>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase","title":"<code>CollectionBase</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>A minimal collection with stable iteration and name indexing.</p> <p>Parameters:</p> Name Type Description Default <code>item_type</code> <p>Type of items accepted by the collection. Used for validation and tooling; not enforced at runtime here.</p> required Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>class CollectionBase(GuardedBase):\n    \"\"\"A minimal collection with stable iteration and name indexing.\n\n    Args:\n        item_type: Type of items accepted by the collection. Used for\n            validation and tooling; not enforced at runtime here.\n    \"\"\"\n\n    def __init__(self, item_type) -&gt; None:\n        super().__init__()\n        self._items: list = []\n        self._index: dict = {}\n        self._item_type = item_type\n\n    def __getitem__(self, name: str):\n        \"\"\"Return an item by its identity key.\n\n        Rebuilds the internal index on a cache miss to stay consistent\n        with recent mutations.\n        \"\"\"\n        try:\n            return self._index[name]\n        except KeyError:\n            self._rebuild_index()\n            return self._index[name]\n\n    def __setitem__(self, name: str, item) -&gt; None:\n        \"\"\"Insert or replace an item under the given identity key.\"\"\"\n        # Check if item with same identity exists; if so, replace it\n        for i, existing_item in enumerate(self._items):\n            if existing_item._identity.category_entry_name == name:\n                self._items[i] = item\n                self._rebuild_index()\n                return\n        # Otherwise append new item\n        item._parent = self  # Explicitly set the parent for the item\n        self._items.append(item)\n        self._rebuild_index()\n\n    def __delitem__(self, name: str) -&gt; None:\n        \"\"\"Delete an item by key or raise ``KeyError`` if missing.\"\"\"\n        # Remove from _items by identity entry name\n        for i, item in enumerate(self._items):\n            if item._identity.category_entry_name == name:\n                object.__setattr__(item, '_parent', None)  # Unlink the parent before removal\n                del self._items[i]\n                self._rebuild_index()\n                return\n        raise KeyError(name)\n\n    def __iter__(self):\n        \"\"\"Iterate over items in insertion order.\"\"\"\n        return iter(self._items)\n\n    def __len__(self) -&gt; int:\n        \"\"\"Return the number of items in the collection.\"\"\"\n        return len(self._items)\n\n    def _key_for(self, item):\n        \"\"\"Return the identity key for ``item`` (category or\n        datablock).\n        \"\"\"\n        return item._identity.category_entry_name or item._identity.datablock_entry_name\n\n    def _rebuild_index(self) -&gt; None:\n        \"\"\"Rebuild the name-to-item index from the ordered item list.\"\"\"\n        self._index.clear()\n        for item in self._items:\n            key = self._key_for(item)\n            if key:\n                self._index[key] = item\n\n    def keys(self):\n        \"\"\"Yield keys for all items in insertion order.\"\"\"\n        return (self._key_for(item) for item in self._items)\n\n    def values(self):\n        \"\"\"Yield items in insertion order.\"\"\"\n        return (item for item in self._items)\n\n    def items(self):\n        \"\"\"Yield ``(key, item)`` pairs in insertion order.\"\"\"\n        return ((self._key_for(item), item) for item in self._items)\n\n    @property\n    def names(self):\n        \"\"\"List of all item keys in the collection.\"\"\"\n        return list(self.keys())\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.__delitem__","title":"<code>__delitem__(name)</code>","text":"<p>Delete an item by key or raise <code>KeyError</code> if missing.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def __delitem__(self, name: str) -&gt; None:\n    \"\"\"Delete an item by key or raise ``KeyError`` if missing.\"\"\"\n    # Remove from _items by identity entry name\n    for i, item in enumerate(self._items):\n        if item._identity.category_entry_name == name:\n            object.__setattr__(item, '_parent', None)  # Unlink the parent before removal\n            del self._items[i]\n            self._rebuild_index()\n            return\n    raise KeyError(name)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.__getitem__","title":"<code>__getitem__(name)</code>","text":"<p>Return an item by its identity key.</p> <p>Rebuilds the internal index on a cache miss to stay consistent with recent mutations.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def __getitem__(self, name: str):\n    \"\"\"Return an item by its identity key.\n\n    Rebuilds the internal index on a cache miss to stay consistent\n    with recent mutations.\n    \"\"\"\n    try:\n        return self._index[name]\n    except KeyError:\n        self._rebuild_index()\n        return self._index[name]\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.__iter__","title":"<code>__iter__()</code>","text":"<p>Iterate over items in insertion order.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def __iter__(self):\n    \"\"\"Iterate over items in insertion order.\"\"\"\n    return iter(self._items)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.__len__","title":"<code>__len__()</code>","text":"<p>Return the number of items in the collection.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def __len__(self) -&gt; int:\n    \"\"\"Return the number of items in the collection.\"\"\"\n    return len(self._items)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.__setitem__","title":"<code>__setitem__(name, item)</code>","text":"<p>Insert or replace an item under the given identity key.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def __setitem__(self, name: str, item) -&gt; None:\n    \"\"\"Insert or replace an item under the given identity key.\"\"\"\n    # Check if item with same identity exists; if so, replace it\n    for i, existing_item in enumerate(self._items):\n        if existing_item._identity.category_entry_name == name:\n            self._items[i] = item\n            self._rebuild_index()\n            return\n    # Otherwise append new item\n    item._parent = self  # Explicitly set the parent for the item\n    self._items.append(item)\n    self._rebuild_index()\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.items","title":"<code>items()</code>","text":"<p>Yield <code>(key, item)</code> pairs in insertion order.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def items(self):\n    \"\"\"Yield ``(key, item)`` pairs in insertion order.\"\"\"\n    return ((self._key_for(item), item) for item in self._items)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.keys","title":"<code>keys()</code>","text":"<p>Yield keys for all items in insertion order.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def keys(self):\n    \"\"\"Yield keys for all items in insertion order.\"\"\"\n    return (self._key_for(item) for item in self._items)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.names","title":"<code>names</code>  <code>property</code>","text":"<p>List of all item keys in the collection.</p>"},{"location":"api-reference/core/#easydiffraction.core.collection.CollectionBase.values","title":"<code>values()</code>","text":"<p>Yield items in insertion order.</p> Source code in <code>src/easydiffraction/core/collection.py</code> <pre><code>def values(self):\n    \"\"\"Yield items in insertion order.\"\"\"\n    return (item for item in self._items)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.datablock","title":"<code>datablock</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockCollection","title":"<code>DatablockCollection</code>","text":"<p>               Bases: <code>CollectionBase</code></p> <p>Handles top-level category collections (e.g. SampleModels, Experiments).</p> <p>Each item is a DatablockItem.</p> Source code in <code>src/easydiffraction/core/datablock.py</code> <pre><code>class DatablockCollection(CollectionBase):\n    \"\"\"Handles top-level category collections (e.g. SampleModels,\n    Experiments).\n\n    Each item is a DatablockItem.\n    \"\"\"\n\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation of this component.\"\"\"\n        name = self._log_name\n        size = len(self)\n        return f'&lt;{name} collection ({size} items)&gt;'\n\n    @property\n    def unique_name(self):\n        return None\n\n    @property\n    def parameters(self):\n        \"\"\"All parameters from all datablocks in this collection.\"\"\"\n        params = []\n        for db in self._items:\n            params.extend(db.parameters)\n        return params\n\n    # was in class AbstractDatablock(ABC):\n    @property\n    def fittable_parameters(self) -&gt; list:\n        return [p for p in self.parameters if isinstance(p, Parameter) and not p.constrained]\n\n    # was in class AbstractDatablock(ABC):\n    @property\n    def free_parameters(self) -&gt; list:\n        return [p for p in self.fittable_parameters if p.free]\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Return CIF representation of this object.\"\"\"\n        from easydiffraction.io.cif.serialize import datablock_collection_to_cif\n\n        return datablock_collection_to_cif(self)\n\n    @typechecked\n    def _add(self, item) -&gt; None:\n        \"\"\"Add an item to the collection.\"\"\"\n        self[item._identity.datablock_entry_name] = item\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockCollection.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation of this component.</p> Source code in <code>src/easydiffraction/core/datablock.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation of this component.\"\"\"\n    name = self._log_name\n    size = len(self)\n    return f'&lt;{name} collection ({size} items)&gt;'\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockCollection.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Return CIF representation of this object.</p>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockCollection.parameters","title":"<code>parameters</code>  <code>property</code>","text":"<p>All parameters from all datablocks in this collection.</p>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockItem","title":"<code>DatablockItem</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>Base class for items in a datablock collection.</p> Source code in <code>src/easydiffraction/core/datablock.py</code> <pre><code>class DatablockItem(GuardedBase):\n    \"\"\"Base class for items in a datablock collection.\"\"\"\n\n    def __init__(self):\n        super().__init__()\n        self._need_categories_update = False\n\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation of this component.\"\"\"\n        name = self._log_name\n        items = getattr(self, '_items', None)\n        return f'&lt;{name} ({items})&gt;'\n\n    def _update_categories(\n        self,\n        called_by_minimizer=False,\n    ) -&gt; None:\n        # TODO: Make abstract method and implement in subclasses.\n        # This should call apply_symmetry and apply_constraints in the\n        # case of sample models. In the case of experiments, it should\n        # run calculations to update the \"data\" categories.\n        # Any parameter change should set _need_categories_update to\n        # True.\n        # Calling as_cif or data getter should first check this flag\n        # and call this method if True.\n        # Should this be also called when parameters are accessed? E.g.\n        # if one change background coefficients, then access the\n        # background points in the data category?\n        # return\n        # if not self._need_categories_update:\n        #    return\n\n        for category in self.categories:\n            category._update(called_by_minimizer=called_by_minimizer)\n\n        self._need_categories_update = False\n\n    @property\n    def unique_name(self):\n        return self._identity.datablock_entry_name\n\n    @property\n    def categories(self):\n        cats = [\n            v for v in vars(self).values() if isinstance(v, (CategoryItem, CategoryCollection))\n        ]\n        # Sort by _update_priority (lower values first)\n        return sorted(cats, key=lambda c: type(c)._update_priority)\n\n    @property\n    def parameters(self):\n        \"\"\"All parameters from all categories contained in this\n        datablock.\n        \"\"\"\n        params = []\n        for v in self.categories:\n            params.extend(v.parameters)\n        return params\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Return CIF representation of this object.\"\"\"\n        from easydiffraction.io.cif.serialize import datablock_item_to_cif\n\n        self._update_categories()\n        return datablock_item_to_cif(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockItem.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation of this component.</p> Source code in <code>src/easydiffraction/core/datablock.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation of this component.\"\"\"\n    name = self._log_name\n    items = getattr(self, '_items', None)\n    return f'&lt;{name} ({items})&gt;'\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockItem.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Return CIF representation of this object.</p>"},{"location":"api-reference/core/#easydiffraction.core.datablock.DatablockItem.parameters","title":"<code>parameters</code>  <code>property</code>","text":"<p>All parameters from all categories contained in this datablock.</p>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic","title":"<code>diagnostic</code>","text":"<p>Diagnostics helpers for logging validation messages.</p> <p>This module centralizes human-friendly error and debug logs for attribute validation and configuration checks.</p>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics","title":"<code>Diagnostics</code>","text":"<p>Centralized logger for attribute errors and validation hints.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>class Diagnostics:\n    \"\"\"Centralized logger for attribute errors and validation hints.\"\"\"\n\n    # ==============================================================\n    # Configuration / definition diagnostics\n    # ==============================================================\n\n    @staticmethod\n    def type_override_error(cls_name: str, expected, got):\n        \"\"\"Report an invalid DataTypes override.\n\n        Used when descriptor and AttributeSpec types conflict.\n        \"\"\"\n        expected_label = str(expected)\n        got_label = str(got)\n        msg = (\n            f'Invalid type override in &lt;{cls_name}&gt;. '\n            f'Descriptor enforces `{expected_label}`, '\n            f'but AttributeSpec defines `{got_label}`.'\n        )\n        Diagnostics._log_error(msg, exc_type=TypeError)\n\n    # ==============================================================\n    # Attribute diagnostics\n    # ==============================================================\n\n    @staticmethod\n    def readonly_error(\n        name: str,\n        key: str | None = None,\n    ):\n        \"\"\"Log an attempt to change a read-only attribute.\"\"\"\n        Diagnostics._log_error(\n            f\"Cannot modify read-only attribute '{key}' of &lt;{name}&gt;.\",\n            exc_type=AttributeError,\n        )\n\n    @staticmethod\n    def attr_error(\n        name: str,\n        key: str,\n        allowed: set[str],\n        label='Allowed',\n    ):\n        \"\"\"Log access to an unknown attribute and suggest closest\n        key.\n        \"\"\"\n        suggestion = Diagnostics._build_suggestion(key, allowed)\n        # Use consistent (label) logic for allowed\n        hint = suggestion or Diagnostics._build_allowed(allowed, label=label)\n        Diagnostics._log_error(\n            f\"Unknown attribute '{key}' of &lt;{name}&gt;.{hint}\",\n            exc_type=AttributeError,\n        )\n\n    # ==============================================================\n    # Validation diagnostics\n    # ==============================================================\n\n    @staticmethod\n    def type_mismatch(\n        name: str,\n        value,\n        expected_type,\n        current=None,\n        default=None,\n    ):\n        \"\"\"Log a type mismatch and keep current or default value.\"\"\"\n        got_type = type(value).__name__\n        msg = (\n            f'Type mismatch for &lt;{name}&gt;. '\n            f'Expected `{expected_type}`, got `{got_type}` ({value!r}).'\n        )\n        Diagnostics._log_error_with_fallback(\n            msg, current=current, default=default, exc_type=TypeError\n        )\n\n    @staticmethod\n    def range_mismatch(\n        name: str,\n        value,\n        ge,\n        le,\n        current=None,\n        default=None,\n    ):\n        \"\"\"Log range violation for a numeric value.\"\"\"\n        msg = f'Value mismatch for &lt;{name}&gt;. Provided {value!r} outside [{ge}, {le}].'\n        Diagnostics._log_error_with_fallback(\n            msg, current=current, default=default, exc_type=TypeError\n        )\n\n    @staticmethod\n    def choice_mismatch(\n        name: str,\n        value,\n        allowed,\n        current=None,\n        default=None,\n    ):\n        \"\"\"Log an invalid choice against allowed values.\"\"\"\n        msg = f'Value mismatch for &lt;{name}&gt;. Provided {value!r} is unknown.'\n        if allowed is not None:\n            msg += Diagnostics._build_allowed(allowed, label='Allowed values')\n        Diagnostics._log_error_with_fallback(\n            msg, current=current, default=default, exc_type=TypeError\n        )\n\n    @staticmethod\n    def regex_mismatch(\n        name: str,\n        value,\n        pattern,\n        current=None,\n        default=None,\n    ):\n        \"\"\"Log a regex mismatch with the expected pattern.\"\"\"\n        msg = (\n            f\"Value mismatch for &lt;{name}&gt;. Provided {value!r} does not match pattern '{pattern}'.\"\n        )\n        Diagnostics._log_error_with_fallback(\n            msg, current=current, default=default, exc_type=TypeError\n        )\n\n    @staticmethod\n    def no_value(name, default):\n        \"\"\"Log that default will be used due to missing value.\"\"\"\n        Diagnostics._log_debug(f'No value provided for &lt;{name}&gt;. Using default {default!r}.')\n\n    @staticmethod\n    def none_value(name):\n        \"\"\"Log explicit None provided by a user.\"\"\"\n        Diagnostics._log_debug(f'Using `None` explicitly provided for &lt;{name}&gt;.')\n\n    @staticmethod\n    def none_value_skip_range(name):\n        \"\"\"Log that range validation is skipped due to None.\"\"\"\n        Diagnostics._log_debug(\n            f'Skipping range validation as `None` is explicitly provided for &lt;{name}&gt;.'\n        )\n\n    @staticmethod\n    def validated(name, value, stage: str | None = None):\n        \"\"\"Log that a value passed a validation stage.\"\"\"\n        stage_info = f' {stage}' if stage else ''\n        Diagnostics._log_debug(f'Value {value!r} for &lt;{name}&gt; passed{stage_info} validation.')\n\n    # ==============================================================\n    # Helper log methods\n    # ==============================================================\n\n    @staticmethod\n    def _log_error(msg, exc_type=Exception):\n        \"\"\"Emit an error-level message via shared logger.\"\"\"\n        log.error(msg, exc_type=exc_type)\n\n    @staticmethod\n    def _log_error_with_fallback(\n        msg,\n        current=None,\n        default=None,\n        exc_type=Exception,\n    ):\n        \"\"\"Emit an error message and mention kept or default value.\"\"\"\n        if current is not None:\n            msg += f' Keeping current {current!r}.'\n        else:\n            msg += f' Using default {default!r}.'\n        log.error(msg, exc_type=exc_type)\n\n    @staticmethod\n    def _log_debug(msg):\n        \"\"\"Emit a debug-level message via shared logger.\"\"\"\n        log.debug(msg)\n\n    # ==============================================================\n    # Suggestion and allowed value helpers\n    # ==============================================================\n\n    @staticmethod\n    def _suggest(key: str, allowed: set[str]):\n        \"\"\"Suggest closest allowed key using string similarity.\"\"\"\n        if not allowed:\n            return None\n        # Return the allowed key with smallest Levenshtein distance\n        matches = difflib.get_close_matches(key, allowed, n=1)\n        return matches[0] if matches else None\n\n    @staticmethod\n    def _build_suggestion(key: str, allowed: set[str]):\n        s = Diagnostics._suggest(key, allowed)\n        return f\" Did you mean '{s}'?\" if s else ''\n\n    @staticmethod\n    def _build_allowed(allowed, label='Allowed attributes'):\n        # allowed may be a set, list, or other iterable\n        if allowed:\n            allowed_list = list(allowed)\n            if len(allowed_list) &lt;= 10:\n                s = ', '.join(map(repr, sorted(allowed_list)))\n                return f' {label}: {s}.'\n            else:\n                return f' ({len(allowed_list)} {label.lower()} not listed here).'\n        return ''\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.attr_error","title":"<code>attr_error(name, key, allowed, label='Allowed')</code>  <code>staticmethod</code>","text":"<p>Log access to an unknown attribute and suggest closest key.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef attr_error(\n    name: str,\n    key: str,\n    allowed: set[str],\n    label='Allowed',\n):\n    \"\"\"Log access to an unknown attribute and suggest closest\n    key.\n    \"\"\"\n    suggestion = Diagnostics._build_suggestion(key, allowed)\n    # Use consistent (label) logic for allowed\n    hint = suggestion or Diagnostics._build_allowed(allowed, label=label)\n    Diagnostics._log_error(\n        f\"Unknown attribute '{key}' of &lt;{name}&gt;.{hint}\",\n        exc_type=AttributeError,\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.choice_mismatch","title":"<code>choice_mismatch(name, value, allowed, current=None, default=None)</code>  <code>staticmethod</code>","text":"<p>Log an invalid choice against allowed values.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef choice_mismatch(\n    name: str,\n    value,\n    allowed,\n    current=None,\n    default=None,\n):\n    \"\"\"Log an invalid choice against allowed values.\"\"\"\n    msg = f'Value mismatch for &lt;{name}&gt;. Provided {value!r} is unknown.'\n    if allowed is not None:\n        msg += Diagnostics._build_allowed(allowed, label='Allowed values')\n    Diagnostics._log_error_with_fallback(\n        msg, current=current, default=default, exc_type=TypeError\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.no_value","title":"<code>no_value(name, default)</code>  <code>staticmethod</code>","text":"<p>Log that default will be used due to missing value.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef no_value(name, default):\n    \"\"\"Log that default will be used due to missing value.\"\"\"\n    Diagnostics._log_debug(f'No value provided for &lt;{name}&gt;. Using default {default!r}.')\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.none_value","title":"<code>none_value(name)</code>  <code>staticmethod</code>","text":"<p>Log explicit None provided by a user.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef none_value(name):\n    \"\"\"Log explicit None provided by a user.\"\"\"\n    Diagnostics._log_debug(f'Using `None` explicitly provided for &lt;{name}&gt;.')\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.none_value_skip_range","title":"<code>none_value_skip_range(name)</code>  <code>staticmethod</code>","text":"<p>Log that range validation is skipped due to None.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef none_value_skip_range(name):\n    \"\"\"Log that range validation is skipped due to None.\"\"\"\n    Diagnostics._log_debug(\n        f'Skipping range validation as `None` is explicitly provided for &lt;{name}&gt;.'\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.range_mismatch","title":"<code>range_mismatch(name, value, ge, le, current=None, default=None)</code>  <code>staticmethod</code>","text":"<p>Log range violation for a numeric value.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef range_mismatch(\n    name: str,\n    value,\n    ge,\n    le,\n    current=None,\n    default=None,\n):\n    \"\"\"Log range violation for a numeric value.\"\"\"\n    msg = f'Value mismatch for &lt;{name}&gt;. Provided {value!r} outside [{ge}, {le}].'\n    Diagnostics._log_error_with_fallback(\n        msg, current=current, default=default, exc_type=TypeError\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.readonly_error","title":"<code>readonly_error(name, key=None)</code>  <code>staticmethod</code>","text":"<p>Log an attempt to change a read-only attribute.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef readonly_error(\n    name: str,\n    key: str | None = None,\n):\n    \"\"\"Log an attempt to change a read-only attribute.\"\"\"\n    Diagnostics._log_error(\n        f\"Cannot modify read-only attribute '{key}' of &lt;{name}&gt;.\",\n        exc_type=AttributeError,\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.regex_mismatch","title":"<code>regex_mismatch(name, value, pattern, current=None, default=None)</code>  <code>staticmethod</code>","text":"<p>Log a regex mismatch with the expected pattern.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef regex_mismatch(\n    name: str,\n    value,\n    pattern,\n    current=None,\n    default=None,\n):\n    \"\"\"Log a regex mismatch with the expected pattern.\"\"\"\n    msg = (\n        f\"Value mismatch for &lt;{name}&gt;. Provided {value!r} does not match pattern '{pattern}'.\"\n    )\n    Diagnostics._log_error_with_fallback(\n        msg, current=current, default=default, exc_type=TypeError\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.type_mismatch","title":"<code>type_mismatch(name, value, expected_type, current=None, default=None)</code>  <code>staticmethod</code>","text":"<p>Log a type mismatch and keep current or default value.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef type_mismatch(\n    name: str,\n    value,\n    expected_type,\n    current=None,\n    default=None,\n):\n    \"\"\"Log a type mismatch and keep current or default value.\"\"\"\n    got_type = type(value).__name__\n    msg = (\n        f'Type mismatch for &lt;{name}&gt;. '\n        f'Expected `{expected_type}`, got `{got_type}` ({value!r}).'\n    )\n    Diagnostics._log_error_with_fallback(\n        msg, current=current, default=default, exc_type=TypeError\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.type_override_error","title":"<code>type_override_error(cls_name, expected, got)</code>  <code>staticmethod</code>","text":"<p>Report an invalid DataTypes override.</p> <p>Used when descriptor and AttributeSpec types conflict.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef type_override_error(cls_name: str, expected, got):\n    \"\"\"Report an invalid DataTypes override.\n\n    Used when descriptor and AttributeSpec types conflict.\n    \"\"\"\n    expected_label = str(expected)\n    got_label = str(got)\n    msg = (\n        f'Invalid type override in &lt;{cls_name}&gt;. '\n        f'Descriptor enforces `{expected_label}`, '\n        f'but AttributeSpec defines `{got_label}`.'\n    )\n    Diagnostics._log_error(msg, exc_type=TypeError)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.diagnostic.Diagnostics.validated","title":"<code>validated(name, value, stage=None)</code>  <code>staticmethod</code>","text":"<p>Log that a value passed a validation stage.</p> Source code in <code>src/easydiffraction/core/diagnostic.py</code> <pre><code>@staticmethod\ndef validated(name, value, stage: str | None = None):\n    \"\"\"Log that a value passed a validation stage.\"\"\"\n    stage_info = f' {stage}' if stage else ''\n    Diagnostics._log_debug(f'Value {value!r} for &lt;{name}&gt; passed{stage_info} validation.')\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.factory","title":"<code>factory</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.factory.FactoryBase","title":"<code>FactoryBase</code>","text":"<p>Reusable argument validation mixin.</p> Source code in <code>src/easydiffraction/core/factory.py</code> <pre><code>class FactoryBase:\n    \"\"\"Reusable argument validation mixin.\"\"\"\n\n    @staticmethod\n    def _validate_args(\n        present: set[str],\n        allowed_specs: Iterable[Mapping[str, Iterable[str]]],\n        factory_name: str,\n    ) -&gt; None:\n        \"\"\"Validate provided arguments against allowed combinations.\"\"\"\n        for spec in allowed_specs:\n            required = set(spec.get('required', []))\n            optional = set(spec.get('optional', []))\n            if required.issubset(present) and present &lt;= (required | optional):\n                return  # valid combo\n        # build readable error message\n        combos = []\n        for spec in allowed_specs:\n            req = ', '.join(spec.get('required', []))\n            opt = ', '.join(spec.get('optional', []))\n            if opt:\n                combos.append(f'({req}[, {opt}])')\n            else:\n                combos.append(f'({req})')\n        raise ValueError(\n            f'Invalid argument combination for {factory_name} creation.\\n'\n            f'Provided: {sorted(present)}\\n'\n            f'Allowed combinations:\\n  ' + '\\n  '.join(combos)\n        )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.guard","title":"<code>guard</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.guard.GuardedBase","title":"<code>GuardedBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Base class enforcing controlled attribute access and parent linkage.</p> Source code in <code>src/easydiffraction/core/guard.py</code> <pre><code>class GuardedBase(ABC):\n    \"\"\"Base class enforcing controlled attribute access and parent\n    linkage.\n    \"\"\"\n\n    _diagnoser = Diagnostics()\n\n    def __init__(self):\n        self._identity = Identity(owner=self)\n\n    def __str__(self) -&gt; str:\n        return f'&lt;{self.unique_name}&gt;'\n\n    def __repr__(self) -&gt; str:\n        return self.__str__()\n\n    def __getattr__(self, key: str):\n        cls = type(self)\n        allowed = cls._public_attrs()\n        if key not in allowed:\n            type(self)._diagnoser.attr_error(\n                self._log_name,\n                key,\n                allowed,\n                label='Allowed readable/writable',\n            )\n\n    def __setattr__(self, key: str, value):\n        # Always allow private or special attributes without diagnostics\n        if key.startswith('_'):\n            object.__setattr__(self, key, value)\n            # Also maintain parent linkage for nested objects\n            if key != '_parent' and isinstance(value, GuardedBase):\n                object.__setattr__(value, '_parent', self)\n            return\n\n        # Handle public attributes with diagnostics\n        cls = type(self)\n        # Prevent modification of read-only attributes\n        if key in cls._public_readonly_attrs():\n            cls._diagnoser.readonly_error(\n                self._log_name,\n                key,\n            )\n            return\n        # Prevent assignment to unknown attributes\n        # Show writable attributes only as allowed\n        if key not in cls._public_attrs():\n            allowed = cls._public_writable_attrs()\n            cls._diagnoser.attr_error(\n                self._log_name,\n                key,\n                allowed,\n                label='Allowed writable',\n            )\n            return\n\n        self._assign_attr(key, value)\n\n    def _assign_attr(self, key, value):\n        \"\"\"Low-level assignment with parent linkage.\"\"\"\n        object.__setattr__(self, key, value)\n        if key != '_parent' and isinstance(value, GuardedBase):\n            object.__setattr__(value, '_parent', self)\n\n    @classmethod\n    def _iter_properties(cls):\n        \"\"\"Iterate over all public properties defined in the class\n        hierarchy.\n\n        Yields:\n            tuple[str, property]: Each (key, property) pair for public\n            attributes.\n        \"\"\"\n        for base in cls.mro():\n            for key, attr in base.__dict__.items():\n                if key.startswith('_') or not isinstance(attr, property):\n                    continue\n                yield key, attr\n\n    @classmethod\n    def _public_attrs(cls):\n        \"\"\"All public properties (read-only + writable).\"\"\"\n        return {key for key, _ in cls._iter_properties()}\n\n    @classmethod\n    def _public_readonly_attrs(cls):\n        \"\"\"Public properties without a setter.\"\"\"\n        return {key for key, prop in cls._iter_properties() if prop.fset is None}\n\n    @classmethod\n    def _public_writable_attrs(cls) -&gt; set[str]:\n        \"\"\"Public properties with a setter.\"\"\"\n        return {key for key, prop in cls._iter_properties() if prop.fset is not None}\n\n    def _allowed_attrs(self, writable_only=False):\n        cls = type(self)\n        if writable_only:\n            return cls._public_writable_attrs()\n        return cls._public_attrs()\n\n    @property\n    def _log_name(self):\n        return self.unique_name or type(self).__name__\n\n    @property\n    def unique_name(self):\n        return type(self).__name__\n\n    # @property\n    # def identity(self):\n    #    \"\"\"Expose a limited read-only view of identity attributes.\"\"\"\n    #    return SimpleNamespace(\n    #        datablock_entry_name=self._identity.datablock_entry_name,\n    #        category_code=self._identity.category_code,\n    #        category_entry_name=self._identity.category_entry_name,\n    #    )\n\n    @property\n    @abstractmethod\n    def parameters(self):\n        \"\"\"Return a list of parameter objects (to be implemented by\n        subclasses).\n        \"\"\"\n        raise NotImplementedError\n\n    @property\n    @abstractmethod\n    def as_cif(self) -&gt; str:\n        \"\"\"Return CIF representation of this object (to be implemented\n        by subclasses).\n        \"\"\"\n        raise NotImplementedError\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.guard.GuardedBase.as_cif","title":"<code>as_cif</code>  <code>abstractmethod</code> <code>property</code>","text":"<p>Return CIF representation of this object (to be implemented by subclasses).</p>"},{"location":"api-reference/core/#easydiffraction.core.guard.GuardedBase.parameters","title":"<code>parameters</code>  <code>abstractmethod</code> <code>property</code>","text":"<p>Return a list of parameter objects (to be implemented by subclasses).</p>"},{"location":"api-reference/core/#easydiffraction.core.identity","title":"<code>identity</code>","text":"<p>Identity helpers to build CIF-like hierarchical names.</p> <p>Used by containers and items to expose datablock/category/entry names without tight coupling.</p>"},{"location":"api-reference/core/#easydiffraction.core.identity.Identity","title":"<code>Identity</code>","text":"<p>Resolve datablock/category/entry relationships lazily.</p> Source code in <code>src/easydiffraction/core/identity.py</code> <pre><code>class Identity:\n    \"\"\"Resolve datablock/category/entry relationships lazily.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        owner: object,\n        datablock_entry: Callable | None = None,\n        category_code: str | None = None,\n        category_entry: Callable | None = None,\n    ):\n        self._owner = owner\n        self._datablock_entry = datablock_entry\n        self._category_code = category_code\n        self._category_entry = category_entry\n\n    def _resolve_up(self, attr: str, visited=None):\n        \"\"\"Resolve attribute by walking up parent chain safely.\"\"\"\n        if visited is None:\n            visited = set()\n        if id(self) in visited:\n            return None\n        visited.add(id(self))\n\n        # Direct callable or value on self\n        value = getattr(self, f'_{attr}', None)\n        if callable(value):\n            return value()\n        if isinstance(value, str):\n            return value\n\n        # Climb to parent if available\n        parent = getattr(self._owner, '__dict__', {}).get('_parent')\n        if parent and hasattr(parent, '_identity'):\n            return parent._identity._resolve_up(attr, visited)\n        return None\n\n    @property\n    def datablock_entry_name(self):\n        \"\"\"Datablock entry name or None if not set.\"\"\"\n        return self._resolve_up('datablock_entry')\n\n    @datablock_entry_name.setter\n    def datablock_entry_name(self, func: callable):\n        \"\"\"Set callable returning datablock entry name.\"\"\"\n        self._datablock_entry = func\n\n    @property\n    def category_code(self):\n        \"\"\"Category code like 'atom_site' or 'background'.\"\"\"\n        return self._resolve_up('category_code')\n\n    @category_code.setter\n    def category_code(self, value: str):\n        \"\"\"Set category code value.\"\"\"\n        self._category_code = value\n\n    @property\n    def category_entry_name(self):\n        \"\"\"Category entry name or None if not set.\"\"\"\n        return self._resolve_up('category_entry')\n\n    @category_entry_name.setter\n    def category_entry_name(self, func: callable):\n        \"\"\"Set callable returning category entry name.\"\"\"\n        self._category_entry = func\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.identity.Identity.category_code","title":"<code>category_code</code>  <code>property</code> <code>writable</code>","text":"<p>Category code like 'atom_site' or 'background'.</p>"},{"location":"api-reference/core/#easydiffraction.core.identity.Identity.category_entry_name","title":"<code>category_entry_name</code>  <code>property</code> <code>writable</code>","text":"<p>Category entry name or None if not set.</p>"},{"location":"api-reference/core/#easydiffraction.core.identity.Identity.datablock_entry_name","title":"<code>datablock_entry_name</code>  <code>property</code> <code>writable</code>","text":"<p>Datablock entry name or None if not set.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters","title":"<code>parameters</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase","title":"<code>GenericDescriptorBase</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>Base class for all parameter-like descriptors.</p> <p>A descriptor encapsulates a typed value with validation, human-readable name/description and a globally unique identifier that is stable across the session. Concrete subclasses specialize the expected data type and can extend the public API with additional behavior (e.g. units).</p> <p>Attributes:</p> Name Type Description <code>name</code> <code>str</code> <p>Local parameter name (e.g. 'a', 'b_iso').</p> <code>description</code> <p>Optional human-readable description.</p> <code>uid</code> <p>Stable random identifier for external references.</p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class GenericDescriptorBase(GuardedBase):\n    \"\"\"Base class for all parameter-like descriptors.\n\n    A descriptor encapsulates a typed value with validation,\n    human-readable name/description and a globally unique identifier\n    that is stable across the session. Concrete subclasses specialize\n    the expected data type and can extend the public API with\n    additional behavior (e.g. units).\n\n    Attributes:\n        name: Local parameter name (e.g. 'a', 'b_iso').\n        description: Optional human-readable description.\n        uid: Stable random identifier for external references.\n    \"\"\"\n\n    _BOOL_SPEC_TEMPLATE = AttributeSpec(\n        type_=DataTypes.BOOL,\n        default=False,\n    )\n\n    def __init__(\n        self,\n        *,\n        value_spec: AttributeSpec,\n        name: str,\n        description: str = None,\n    ):\n        \"\"\"Initialize the descriptor with validation and identity.\n\n        Args:\n            value_spec: Validation specification for the value.\n            name: Local name of the descriptor within its category.\n            description: Optional human-readable description.\n        \"\"\"\n        super().__init__()\n\n        expected_type = getattr(self, '_value_type', None)\n\n        if expected_type:\n            user_type = (\n                value_spec._type_validator.expected_type\n                if value_spec._type_validator is not None\n                else None\n            )\n            if user_type and user_type is not expected_type:\n                Diagnostics.type_override_error(\n                    type(self).__name__,\n                    expected_type,\n                    user_type,\n                )\n            else:\n                # Enforce descriptor's own type if not already defined\n                value_spec._type_validator = TypeValidator(expected_type)\n\n        self._value_spec = value_spec\n        self._name = name\n        self._description = description\n\n        # Initial validated states\n        self._value = self._value_spec.validated(\n            value_spec.value,\n            name=self.unique_name,\n        )\n\n    def __str__(self) -&gt; str:\n        return f'&lt;{self.unique_name} = {self.value!r}&gt;'\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Local name of the descriptor (without category/datablock).\"\"\"\n        return self._name\n\n    @property\n    def unique_name(self):\n        \"\"\"Fully qualified name including datablock, category and entry\n        name.\n        \"\"\"\n        # 7c: Use filter(None, [...])\n        parts = [\n            self._identity.datablock_entry_name,\n            self._identity.category_code,\n            self._identity.category_entry_name,\n            self.name,\n        ]\n        return '.'.join(filter(None, parts))\n\n    def _parent_of_type(self, cls):\n        \"\"\"Walk up the parent chain and return the first parent of type\n        `cls`.\n        \"\"\"\n        obj = getattr(self, '_parent', None)\n        visited = set()\n        while obj is not None and id(obj) not in visited:\n            visited.add(id(obj))\n            if isinstance(obj, cls):\n                return obj\n            obj = getattr(obj, '_parent', None)\n        return None\n\n    def _datablock_item(self):\n        \"\"\"Return the DatablockItem ancestor, if any.\"\"\"\n        from easydiffraction.core.datablock import DatablockItem\n\n        return self._parent_of_type(DatablockItem)\n\n    @property\n    def value(self):\n        \"\"\"Current validated value.\"\"\"\n        return self._value\n\n    @value.setter\n    def value(self, v):\n        \"\"\"Set a new value after validating against the spec.\"\"\"\n        # Do nothing if the value is unchanged\n        if self._value == v:\n            return\n\n        # Validate and set the new value\n        self._value = self._value_spec.validated(\n            v,\n            name=self.unique_name,\n            current=self._value,\n        )\n\n        # Mark parent datablock as needing categories update\n        # TODO: Check if it is actually in use?\n        parent_datablock = self._datablock_item()\n        if parent_datablock is not None:\n            parent_datablock._need_categories_update = True\n\n    @property\n    def description(self):\n        \"\"\"Optional human-readable description.\"\"\"\n        return self._description\n\n    @property\n    def parameters(self):\n        \"\"\"Return a flat list of parameters contained by this object.\n\n        For a single descriptor, it returns a one-element list with\n        itself. Composite objects override this to flatten nested\n        structures.\n        \"\"\"\n        return [self]\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Serialize this descriptor to a CIF-formatted string.\"\"\"\n        return param_to_cif(self)\n\n    def from_cif(self, block, idx=0):\n        \"\"\"Populate this parameter from a CIF block.\"\"\"\n        param_from_cif(self, block, idx)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.__init__","title":"<code>__init__(*, value_spec, name, description=None)</code>","text":"<p>Initialize the descriptor with validation and identity.</p> <p>Parameters:</p> Name Type Description Default <code>value_spec</code> <code>AttributeSpec</code> <p>Validation specification for the value.</p> required <code>name</code> <code>str</code> <p>Local name of the descriptor within its category.</p> required <code>description</code> <code>str</code> <p>Optional human-readable description.</p> <code>None</code> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>def __init__(\n    self,\n    *,\n    value_spec: AttributeSpec,\n    name: str,\n    description: str = None,\n):\n    \"\"\"Initialize the descriptor with validation and identity.\n\n    Args:\n        value_spec: Validation specification for the value.\n        name: Local name of the descriptor within its category.\n        description: Optional human-readable description.\n    \"\"\"\n    super().__init__()\n\n    expected_type = getattr(self, '_value_type', None)\n\n    if expected_type:\n        user_type = (\n            value_spec._type_validator.expected_type\n            if value_spec._type_validator is not None\n            else None\n        )\n        if user_type and user_type is not expected_type:\n            Diagnostics.type_override_error(\n                type(self).__name__,\n                expected_type,\n                user_type,\n            )\n        else:\n            # Enforce descriptor's own type if not already defined\n            value_spec._type_validator = TypeValidator(expected_type)\n\n    self._value_spec = value_spec\n    self._name = name\n    self._description = description\n\n    # Initial validated states\n    self._value = self._value_spec.validated(\n        value_spec.value,\n        name=self.unique_name,\n    )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Serialize this descriptor to a CIF-formatted string.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.description","title":"<code>description</code>  <code>property</code>","text":"<p>Optional human-readable description.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.from_cif","title":"<code>from_cif(block, idx=0)</code>","text":"<p>Populate this parameter from a CIF block.</p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>def from_cif(self, block, idx=0):\n    \"\"\"Populate this parameter from a CIF block.\"\"\"\n    param_from_cif(self, block, idx)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.name","title":"<code>name</code>  <code>property</code>","text":"<p>Local name of the descriptor (without category/datablock).</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.parameters","title":"<code>parameters</code>  <code>property</code>","text":"<p>Return a flat list of parameters contained by this object.</p> <p>For a single descriptor, it returns a one-element list with itself. Composite objects override this to flatten nested structures.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.unique_name","title":"<code>unique_name</code>  <code>property</code>","text":"<p>Fully qualified name including datablock, category and entry name.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericDescriptorBase.value","title":"<code>value</code>  <code>property</code> <code>writable</code>","text":"<p>Current validated value.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericNumericDescriptor","title":"<code>GenericNumericDescriptor</code>","text":"<p>               Bases: <code>GenericDescriptorBase</code></p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class GenericNumericDescriptor(GenericDescriptorBase):\n    _value_type = DataTypes.NUMERIC\n\n    def __init__(\n        self,\n        *,\n        units: str = '',\n        **kwargs: Any,\n    ) -&gt; None:\n        super().__init__(**kwargs)\n        self._units: str = units\n\n    def __str__(self) -&gt; str:\n        s: str = super().__str__()\n        s = s[1:-1]  # strip &lt;&gt;\n        if self.units:\n            s += f' {self.units}'\n        return f'&lt;{s}&gt;'\n\n    @property\n    def units(self) -&gt; str:\n        \"\"\"Units associated with the numeric value, if any.\"\"\"\n        return self._units\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericNumericDescriptor.units","title":"<code>units</code>  <code>property</code>","text":"<p>Units associated with the numeric value, if any.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter","title":"<code>GenericParameter</code>","text":"<p>               Bases: <code>GenericNumericDescriptor</code></p> <p>Numeric descriptor extended with fitting-related attributes.</p> <p>Adds standard attributes used by minimizers: \"free\" flag, uncertainty, bounds and an optional starting value. Subclasses can integrate with specific backends while preserving this interface.</p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class GenericParameter(GenericNumericDescriptor):\n    \"\"\"Numeric descriptor extended with fitting-related attributes.\n\n    Adds standard attributes used by minimizers: \"free\" flag,\n    uncertainty, bounds and an optional starting value. Subclasses can\n    integrate with specific backends while preserving this interface.\n    \"\"\"\n\n    def __init__(\n        self,\n        **kwargs: Any,\n    ):\n        super().__init__(**kwargs)\n\n        # Initial validated states\n        self._free_spec = self._BOOL_SPEC_TEMPLATE\n        self._free = self._free_spec.default\n        self._uncertainty_spec = AttributeSpec(\n            type_=DataTypes.NUMERIC,\n            content_validator=RangeValidator(ge=0),\n            allow_none=True,\n        )\n        self._uncertainty = self._uncertainty_spec.default\n        self._fit_min_spec = AttributeSpec(type_=DataTypes.NUMERIC, default=-np.inf)\n        self._fit_min = self._fit_min_spec.default\n        self._fit_max_spec = AttributeSpec(type_=DataTypes.NUMERIC, default=np.inf)\n        self._fit_max = self._fit_max_spec.default\n        self._start_value_spec = AttributeSpec(type_=DataTypes.NUMERIC, default=0.0)\n        self._start_value = self._start_value_spec.default\n        self._constrained_spec = self._BOOL_SPEC_TEMPLATE\n        self._constrained = self._constrained_spec.default\n\n        self._uid: str = self._generate_uid()\n        UidMapHandler.get().add_to_uid_map(self)\n\n    def __str__(self) -&gt; str:\n        s = GenericDescriptorBase.__str__(self)\n        s = s[1:-1]  # strip &lt;&gt;\n        if self.uncertainty is not None:\n            s += f' \u00b1 {self.uncertainty}'\n        if self.units is not None:\n            s += f' {self.units}'\n        s += f' (free={self.free})'\n        return f'&lt;{s}&gt;'\n\n    @staticmethod\n    def _generate_uid(length: int = 16) -&gt; str:\n        letters = string.ascii_lowercase\n        return ''.join(secrets.choice(letters) for _ in range(length))\n\n    @property\n    def uid(self):\n        \"\"\"Stable random identifier for this descriptor.\"\"\"\n        return self._uid\n\n    @property\n    def _minimizer_uid(self):\n        \"\"\"Variant of uid that is safe for minimizer engines.\"\"\"\n        # return self.unique_name.replace('.', '__')\n        return self.uid\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Local name of the parameter (without category/datablock).\"\"\"\n        return self._name\n\n    @property\n    def unique_name(self):\n        \"\"\"Fully qualified parameter name including its context path.\"\"\"\n        parts = [\n            self._identity.datablock_entry_name,\n            self._identity.category_code,\n            self._identity.category_entry_name,\n            self.name,\n        ]\n        return '.'.join(filter(None, parts))\n\n    @property\n    def constrained(self):\n        \"\"\"Whether this parameter is part of a constraint expression.\"\"\"\n        return self._constrained\n\n    @property\n    def free(self):\n        \"\"\"Whether this parameter is currently varied during fitting.\"\"\"\n        return self._free\n\n    @free.setter\n    def free(self, v):\n        \"\"\"Set the \"free\" flag after validation.\"\"\"\n        self._free = self._free_spec.validated(\n            v, name=f'{self.unique_name}.free', current=self._free\n        )\n\n    @property\n    def uncertainty(self):\n        \"\"\"Estimated standard uncertainty of the fitted value, if\n        available.\n        \"\"\"\n        return self._uncertainty\n\n    @uncertainty.setter\n    def uncertainty(self, v):\n        \"\"\"Set the uncertainty value (must be non-negative or None).\"\"\"\n        self._uncertainty = self._uncertainty_spec.validated(\n            v, name=f'{self.unique_name}.uncertainty', current=self._uncertainty\n        )\n\n    @property\n    def fit_min(self):\n        \"\"\"Lower fitting bound.\"\"\"\n        return self._fit_min\n\n    @fit_min.setter\n    def fit_min(self, v):\n        \"\"\"Set the lower bound for the parameter value.\"\"\"\n        self._fit_min = self._fit_min_spec.validated(\n            v, name=f'{self.unique_name}.fit_min', current=self._fit_min\n        )\n\n    @property\n    def fit_max(self):\n        \"\"\"Upper fitting bound.\"\"\"\n        return self._fit_max\n\n    @fit_max.setter\n    def fit_max(self, v):\n        \"\"\"Set the upper bound for the parameter value.\"\"\"\n        self._fit_max = self._fit_max_spec.validated(\n            v, name=f'{self.unique_name}.fit_max', current=self._fit_max\n        )\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.constrained","title":"<code>constrained</code>  <code>property</code>","text":"<p>Whether this parameter is part of a constraint expression.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.fit_max","title":"<code>fit_max</code>  <code>property</code> <code>writable</code>","text":"<p>Upper fitting bound.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.fit_min","title":"<code>fit_min</code>  <code>property</code> <code>writable</code>","text":"<p>Lower fitting bound.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.free","title":"<code>free</code>  <code>property</code> <code>writable</code>","text":"<p>Whether this parameter is currently varied during fitting.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.name","title":"<code>name</code>  <code>property</code>","text":"<p>Local name of the parameter (without category/datablock).</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.uid","title":"<code>uid</code>  <code>property</code>","text":"<p>Stable random identifier for this descriptor.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.uncertainty","title":"<code>uncertainty</code>  <code>property</code> <code>writable</code>","text":"<p>Estimated standard uncertainty of the fitted value, if available.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.GenericParameter.unique_name","title":"<code>unique_name</code>  <code>property</code>","text":"<p>Fully qualified parameter name including its context path.</p>"},{"location":"api-reference/core/#easydiffraction.core.parameters.NumericDescriptor","title":"<code>NumericDescriptor</code>","text":"<p>               Bases: <code>GenericNumericDescriptor</code></p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class NumericDescriptor(GenericNumericDescriptor):\n    def __init__(\n        self,\n        *,\n        cif_handler: CifHandler,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Numeric descriptor bound to a CIF handler.\n\n        Args:\n            cif_handler: Object that tracks CIF identifiers.\n            **kwargs: Forwarded to GenericNumericDescriptor.\n        \"\"\"\n        super().__init__(**kwargs)\n        self._cif_handler = cif_handler\n        self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.NumericDescriptor.__init__","title":"<code>__init__(*, cif_handler, **kwargs)</code>","text":"<p>Numeric descriptor bound to a CIF handler.</p> <p>Parameters:</p> Name Type Description Default <code>cif_handler</code> <code>CifHandler</code> <p>Object that tracks CIF identifiers.</p> required <code>**kwargs</code> <code>Any</code> <p>Forwarded to GenericNumericDescriptor.</p> <code>{}</code> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>def __init__(\n    self,\n    *,\n    cif_handler: CifHandler,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Numeric descriptor bound to a CIF handler.\n\n    Args:\n        cif_handler: Object that tracks CIF identifiers.\n        **kwargs: Forwarded to GenericNumericDescriptor.\n    \"\"\"\n    super().__init__(**kwargs)\n    self._cif_handler = cif_handler\n    self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.Parameter","title":"<code>Parameter</code>","text":"<p>               Bases: <code>GenericParameter</code></p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class Parameter(GenericParameter):\n    def __init__(\n        self,\n        *,\n        cif_handler: CifHandler,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"Fittable parameter bound to a CIF handler.\n\n        Args:\n            cif_handler: Object that tracks CIF identifiers.\n            **kwargs: Forwarded to GenericParameter.\n        \"\"\"\n        super().__init__(**kwargs)\n        self._cif_handler = cif_handler\n        self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.Parameter.__init__","title":"<code>__init__(*, cif_handler, **kwargs)</code>","text":"<p>Fittable parameter bound to a CIF handler.</p> <p>Parameters:</p> Name Type Description Default <code>cif_handler</code> <code>CifHandler</code> <p>Object that tracks CIF identifiers.</p> required <code>**kwargs</code> <code>Any</code> <p>Forwarded to GenericParameter.</p> <code>{}</code> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>def __init__(\n    self,\n    *,\n    cif_handler: CifHandler,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"Fittable parameter bound to a CIF handler.\n\n    Args:\n        cif_handler: Object that tracks CIF identifiers.\n        **kwargs: Forwarded to GenericParameter.\n    \"\"\"\n    super().__init__(**kwargs)\n    self._cif_handler = cif_handler\n    self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.StringDescriptor","title":"<code>StringDescriptor</code>","text":"<p>               Bases: <code>GenericStringDescriptor</code></p> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>class StringDescriptor(GenericStringDescriptor):\n    def __init__(\n        self,\n        *,\n        cif_handler: CifHandler,\n        **kwargs: Any,\n    ) -&gt; None:\n        \"\"\"String descriptor bound to a CIF handler.\n\n        Args:\n            cif_handler: Object that tracks CIF identifiers.\n            **kwargs: Forwarded to GenericStringDescriptor.\n        \"\"\"\n        super().__init__(**kwargs)\n        self._cif_handler = cif_handler\n        self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.parameters.StringDescriptor.__init__","title":"<code>__init__(*, cif_handler, **kwargs)</code>","text":"<p>String descriptor bound to a CIF handler.</p> <p>Parameters:</p> Name Type Description Default <code>cif_handler</code> <code>CifHandler</code> <p>Object that tracks CIF identifiers.</p> required <code>**kwargs</code> <code>Any</code> <p>Forwarded to GenericStringDescriptor.</p> <code>{}</code> Source code in <code>src/easydiffraction/core/parameters.py</code> <pre><code>def __init__(\n    self,\n    *,\n    cif_handler: CifHandler,\n    **kwargs: Any,\n) -&gt; None:\n    \"\"\"String descriptor bound to a CIF handler.\n\n    Args:\n        cif_handler: Object that tracks CIF identifiers.\n        **kwargs: Forwarded to GenericStringDescriptor.\n    \"\"\"\n    super().__init__(**kwargs)\n    self._cif_handler = cif_handler\n    self._cif_handler.attach(self)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons","title":"<code>singletons</code>","text":""},{"location":"api-reference/core/#easydiffraction.core.singletons.ConstraintsHandler","title":"<code>ConstraintsHandler</code>","text":"<p>               Bases: <code>SingletonBase</code></p> <p>Manages user-defined parameter constraints using aliases and expressions.</p> <p>Uses the asteval interpreter for safe evaluation of mathematical expressions. Constraints are defined as: lhs_alias = expression(rhs_aliases).</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>class ConstraintsHandler(SingletonBase):\n    \"\"\"Manages user-defined parameter constraints using aliases and\n    expressions.\n\n    Uses the asteval interpreter for safe evaluation of mathematical\n    expressions. Constraints are defined as: lhs_alias =\n    expression(rhs_aliases).\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        # Maps alias names\n        # (like 'biso_La') \u2192 ConstraintAlias(param=Parameter)\n        self._alias_to_param: Dict[str, Any] = {}\n\n        # Stores raw user-defined constraints indexed by lhs_alias\n        # Each value should contain: lhs_alias, rhs_expr\n        self._constraints = {}\n\n        # Internally parsed constraints as (lhs_alias, rhs_expr) tuples\n        self._parsed_constraints: List[Tuple[str, str]] = []\n\n    def set_aliases(self, aliases):\n        \"\"\"Sets the alias map (name \u2192 parameter wrapper).\n\n        Called when user registers parameter aliases like:\n            alias='biso_La', param=model.atom_sites['La'].b_iso\n        \"\"\"\n        self._alias_to_param = dict(aliases.items())\n\n    def set_constraints(self, constraints):\n        \"\"\"Sets the constraints and triggers parsing into internal\n        format.\n\n        Called when user registers expressions like:\n            lhs_alias='occ_Ba', rhs_expr='1 - occ_La'\n        \"\"\"\n        self._constraints = constraints._items\n        self._parse_constraints()\n\n    def _parse_constraints(self) -&gt; None:\n        \"\"\"Converts raw expression input into a normalized internal list\n        of (lhs_alias, rhs_expr) pairs, stripping whitespace and\n        skipping invalid entries.\n        \"\"\"\n        self._parsed_constraints = []\n\n        for expr_obj in self._constraints:\n            lhs_alias = expr_obj.lhs_alias.value\n            rhs_expr = expr_obj.rhs_expr.value\n\n            if lhs_alias and rhs_expr:\n                constraint = (lhs_alias.strip(), rhs_expr.strip())\n                self._parsed_constraints.append(constraint)\n\n    def apply(self) -&gt; None:\n        \"\"\"Evaluates constraints and applies them to dependent\n        parameters.\n\n        For each constraint:\n        - Evaluate RHS using current values of aliases\n        - Locate the dependent parameter by alias \u2192 uid \u2192 param\n        - Update its value and mark it as constrained\n        \"\"\"\n        if not self._parsed_constraints:\n            return  # Nothing to apply\n\n        # Retrieve global UID \u2192 Parameter object map\n        uid_map = UidMapHandler.get().get_uid_map()\n\n        # Prepare a flat dict of {alias: value} for use in expressions\n        param_values = {}\n        for alias, alias_obj in self._alias_to_param.items():\n            uid = alias_obj.param_uid.value\n            param = uid_map[uid]\n            value = param.value\n            param_values[alias] = value\n\n        # Create an asteval interpreter for safe expression evaluation\n        ae = Interpreter()\n        ae.symtable.update(param_values)\n\n        for lhs_alias, rhs_expr in self._parsed_constraints:\n            try:\n                # Evaluate the RHS expression using the current values\n                rhs_value = ae(rhs_expr)\n\n                # Get the actual parameter object we want to update\n                dependent_uid = self._alias_to_param[lhs_alias].param_uid.value\n                param = uid_map[dependent_uid]\n\n                # Update its value and mark it as constrained\n                param._value = rhs_value  # To bypass ranges check\n                param._constrained = True  # To bypass read-only check\n\n            except Exception as error:\n                print(f\"Failed to apply constraint '{lhs_alias} = {rhs_expr}': {error}\")\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.ConstraintsHandler.apply","title":"<code>apply()</code>","text":"<p>Evaluates constraints and applies them to dependent parameters.</p> <p>For each constraint: - Evaluate RHS using current values of aliases - Locate the dependent parameter by alias \u2192 uid \u2192 param - Update its value and mark it as constrained</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def apply(self) -&gt; None:\n    \"\"\"Evaluates constraints and applies them to dependent\n    parameters.\n\n    For each constraint:\n    - Evaluate RHS using current values of aliases\n    - Locate the dependent parameter by alias \u2192 uid \u2192 param\n    - Update its value and mark it as constrained\n    \"\"\"\n    if not self._parsed_constraints:\n        return  # Nothing to apply\n\n    # Retrieve global UID \u2192 Parameter object map\n    uid_map = UidMapHandler.get().get_uid_map()\n\n    # Prepare a flat dict of {alias: value} for use in expressions\n    param_values = {}\n    for alias, alias_obj in self._alias_to_param.items():\n        uid = alias_obj.param_uid.value\n        param = uid_map[uid]\n        value = param.value\n        param_values[alias] = value\n\n    # Create an asteval interpreter for safe expression evaluation\n    ae = Interpreter()\n    ae.symtable.update(param_values)\n\n    for lhs_alias, rhs_expr in self._parsed_constraints:\n        try:\n            # Evaluate the RHS expression using the current values\n            rhs_value = ae(rhs_expr)\n\n            # Get the actual parameter object we want to update\n            dependent_uid = self._alias_to_param[lhs_alias].param_uid.value\n            param = uid_map[dependent_uid]\n\n            # Update its value and mark it as constrained\n            param._value = rhs_value  # To bypass ranges check\n            param._constrained = True  # To bypass read-only check\n\n        except Exception as error:\n            print(f\"Failed to apply constraint '{lhs_alias} = {rhs_expr}': {error}\")\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.ConstraintsHandler.set_aliases","title":"<code>set_aliases(aliases)</code>","text":"<p>Sets the alias map (name \u2192 parameter wrapper).</p> Called when user registers parameter aliases like <p>alias='biso_La', param=model.atom_sites['La'].b_iso</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def set_aliases(self, aliases):\n    \"\"\"Sets the alias map (name \u2192 parameter wrapper).\n\n    Called when user registers parameter aliases like:\n        alias='biso_La', param=model.atom_sites['La'].b_iso\n    \"\"\"\n    self._alias_to_param = dict(aliases.items())\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.ConstraintsHandler.set_constraints","title":"<code>set_constraints(constraints)</code>","text":"<p>Sets the constraints and triggers parsing into internal format.</p> Called when user registers expressions like <p>lhs_alias='occ_Ba', rhs_expr='1 - occ_La'</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def set_constraints(self, constraints):\n    \"\"\"Sets the constraints and triggers parsing into internal\n    format.\n\n    Called when user registers expressions like:\n        lhs_alias='occ_Ba', rhs_expr='1 - occ_La'\n    \"\"\"\n    self._constraints = constraints._items\n    self._parse_constraints()\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.SingletonBase","title":"<code>SingletonBase</code>","text":"<p>Base class to implement Singleton pattern.</p> <p>Ensures only one shared instance of a class is ever created. Useful for managing shared state across the library.</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>class SingletonBase:\n    \"\"\"Base class to implement Singleton pattern.\n\n    Ensures only one shared instance of a class is ever created. Useful\n    for managing shared state across the library.\n    \"\"\"\n\n    _instance = None  # Class-level shared instance\n\n    @classmethod\n    def get(cls: Type[T]) -&gt; T:\n        \"\"\"Returns the shared instance, creating it if needed.\"\"\"\n        if cls._instance is None:\n            cls._instance = cls()\n        return cls._instance\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.SingletonBase.get","title":"<code>get()</code>  <code>classmethod</code>","text":"<p>Returns the shared instance, creating it if needed.</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>@classmethod\ndef get(cls: Type[T]) -&gt; T:\n    \"\"\"Returns the shared instance, creating it if needed.\"\"\"\n    if cls._instance is None:\n        cls._instance = cls()\n    return cls._instance\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.UidMapHandler","title":"<code>UidMapHandler</code>","text":"<p>               Bases: <code>SingletonBase</code></p> <p>Global handler to manage UID-to-Parameter object mapping.</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>class UidMapHandler(SingletonBase):\n    \"\"\"Global handler to manage UID-to-Parameter object mapping.\"\"\"\n\n    def __init__(self) -&gt; None:\n        # Internal map: uid (str) \u2192 Parameter instance\n        self._uid_map: Dict[str, Any] = {}\n\n    def get_uid_map(self) -&gt; Dict[str, Any]:\n        \"\"\"Returns the current UID-to-Parameter map.\"\"\"\n        return self._uid_map\n\n    def add_to_uid_map(self, parameter):\n        \"\"\"Adds a single Parameter or Descriptor object to the UID map.\n\n        Only Descriptor or Parameter instances are allowed (not\n        Components or others).\n        \"\"\"\n        from easydiffraction.core.parameters import GenericDescriptorBase\n\n        if not isinstance(parameter, GenericDescriptorBase):\n            raise TypeError(\n                f'Cannot add object of type {type(parameter).__name__} to UID map. '\n                'Only Descriptor or Parameter instances are allowed.'\n            )\n        self._uid_map[parameter.uid] = parameter\n\n    def replace_uid(self, old_uid, new_uid):\n        \"\"\"Replaces an existing UID key in the UID map with a new UID.\n\n        Moves the associated parameter from old_uid to new_uid. Raises a\n        KeyError if the old_uid doesn't exist.\n        \"\"\"\n        if old_uid not in self._uid_map:\n            # Only raise if old_uid is not None and not empty\n            print('DEBUG: replace_uid failed', old_uid, 'current map:', list(self._uid_map.keys()))\n            raise KeyError(f\"UID '{old_uid}' not found in the UID map.\")\n        self._uid_map[new_uid] = self._uid_map.pop(old_uid)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.UidMapHandler.add_to_uid_map","title":"<code>add_to_uid_map(parameter)</code>","text":"<p>Adds a single Parameter or Descriptor object to the UID map.</p> <p>Only Descriptor or Parameter instances are allowed (not Components or others).</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def add_to_uid_map(self, parameter):\n    \"\"\"Adds a single Parameter or Descriptor object to the UID map.\n\n    Only Descriptor or Parameter instances are allowed (not\n    Components or others).\n    \"\"\"\n    from easydiffraction.core.parameters import GenericDescriptorBase\n\n    if not isinstance(parameter, GenericDescriptorBase):\n        raise TypeError(\n            f'Cannot add object of type {type(parameter).__name__} to UID map. '\n            'Only Descriptor or Parameter instances are allowed.'\n        )\n    self._uid_map[parameter.uid] = parameter\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.UidMapHandler.get_uid_map","title":"<code>get_uid_map()</code>","text":"<p>Returns the current UID-to-Parameter map.</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def get_uid_map(self) -&gt; Dict[str, Any]:\n    \"\"\"Returns the current UID-to-Parameter map.\"\"\"\n    return self._uid_map\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.singletons.UidMapHandler.replace_uid","title":"<code>replace_uid(old_uid, new_uid)</code>","text":"<p>Replaces an existing UID key in the UID map with a new UID.</p> <p>Moves the associated parameter from old_uid to new_uid. Raises a KeyError if the old_uid doesn't exist.</p> Source code in <code>src/easydiffraction/core/singletons.py</code> <pre><code>def replace_uid(self, old_uid, new_uid):\n    \"\"\"Replaces an existing UID key in the UID map with a new UID.\n\n    Moves the associated parameter from old_uid to new_uid. Raises a\n    KeyError if the old_uid doesn't exist.\n    \"\"\"\n    if old_uid not in self._uid_map:\n        # Only raise if old_uid is not None and not empty\n        print('DEBUG: replace_uid failed', old_uid, 'current map:', list(self._uid_map.keys()))\n        raise KeyError(f\"UID '{old_uid}' not found in the UID map.\")\n    self._uid_map[new_uid] = self._uid_map.pop(old_uid)\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation","title":"<code>validation</code>","text":"<p>Lightweight runtime validation utilities.</p> <p>Provides DataTypes, type/content validators, and AttributeSpec used by descriptors and parameters. Only documentation was added here.</p>"},{"location":"api-reference/core/#easydiffraction.core.validation.AttributeSpec","title":"<code>AttributeSpec</code>","text":"<p>Hold metadata and validators for a single attribute.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class AttributeSpec:\n    \"\"\"Hold metadata and validators for a single attribute.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        value=None,\n        type_=None,\n        default=None,\n        content_validator=None,\n        allow_none: bool = False,\n    ):\n        self.value = value\n        self.default = default\n        self.allow_none = allow_none\n        self._type_validator = TypeValidator(type_) if type_ else None\n        self._content_validator = content_validator\n\n    def validated(\n        self,\n        value,\n        name,\n        current=None,\n    ):\n        \"\"\"Validate through type and content validators.\n\n        Returns validated value, possibly default or current if errors\n        occur. None may short-circuit further checks when allowed.\n        \"\"\"\n        val = value\n        # Evaluate callable defaults dynamically\n        default = self.default() if callable(self.default) else self.default\n\n        # Type validation\n        if self._type_validator:\n            val = self._type_validator.validated(\n                val,\n                name,\n                default=default,\n                current=current,\n                allow_none=self.allow_none,\n            )\n\n        # Skip further validation: Special case for None\n        if val is None and self.allow_none:\n            Diagnostics.none_value_skip_range(name)\n            return None\n\n        # Content validation\n        if self._content_validator and val is not None:\n            val = self._content_validator.validated(\n                val,\n                name,\n                default=default,\n                current=current,\n            )\n\n        return val\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.AttributeSpec.validated","title":"<code>validated(value, name, current=None)</code>","text":"<p>Validate through type and content validators.</p> <p>Returns validated value, possibly default or current if errors occur. None may short-circuit further checks when allowed.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def validated(\n    self,\n    value,\n    name,\n    current=None,\n):\n    \"\"\"Validate through type and content validators.\n\n    Returns validated value, possibly default or current if errors\n    occur. None may short-circuit further checks when allowed.\n    \"\"\"\n    val = value\n    # Evaluate callable defaults dynamically\n    default = self.default() if callable(self.default) else self.default\n\n    # Type validation\n    if self._type_validator:\n        val = self._type_validator.validated(\n            val,\n            name,\n            default=default,\n            current=current,\n            allow_none=self.allow_none,\n        )\n\n    # Skip further validation: Special case for None\n    if val is None and self.allow_none:\n        Diagnostics.none_value_skip_range(name)\n        return None\n\n    # Content validation\n    if self._content_validator and val is not None:\n        val = self._content_validator.validated(\n            val,\n            name,\n            default=default,\n            current=current,\n        )\n\n    return val\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.DataTypes","title":"<code>DataTypes</code>","text":"<p>               Bases: <code>Enum</code></p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class DataTypes(Enum):\n    NUMERIC = (int, float, np.integer, np.floating, np.number)\n    STRING = (str,)\n    BOOL = (bool,)\n    ANY = (object,)  # fallback for unconstrained\n\n    def __str__(self):\n        return self.name.lower()\n\n    @property\n    def expected_type(self):\n        \"\"\"Convenience alias for tuple of allowed Python types.\"\"\"\n        return self.value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.DataTypes.expected_type","title":"<code>expected_type</code>  <code>property</code>","text":"<p>Convenience alias for tuple of allowed Python types.</p>"},{"location":"api-reference/core/#easydiffraction.core.validation.MembershipValidator","title":"<code>MembershipValidator</code>","text":"<p>               Bases: <code>ValidatorBase</code></p> <p>Ensure that a value is among allowed choices.</p> <p><code>allowed</code> may be an iterable or a callable returning a collection.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class MembershipValidator(ValidatorBase):\n    \"\"\"Ensure that a value is among allowed choices.\n\n    `allowed` may be an iterable or a callable returning a collection.\n    \"\"\"\n\n    def __init__(self, allowed):\n        # Do not convert immediately to list \u2014 may be callable\n        self.allowed = allowed\n\n    def validated(\n        self,\n        value,\n        name,\n        default=None,\n        current=None,\n    ):\n        \"\"\"Validate membership and return value or fallback.\"\"\"\n        # Dynamically evaluate allowed if callable (e.g. lambda)\n        allowed_values = self.allowed() if callable(self.allowed) else self.allowed\n\n        if value not in allowed_values:\n            Diagnostics.choice_mismatch(\n                name,\n                value,\n                allowed_values,\n                current=current,\n                default=default,\n            )\n            return self._fallback(current, default)\n\n        Diagnostics.validated(\n            name,\n            value,\n            stage=ValidationStage.MEMBERSHIP,\n        )\n        return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.MembershipValidator.validated","title":"<code>validated(value, name, default=None, current=None)</code>","text":"<p>Validate membership and return value or fallback.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def validated(\n    self,\n    value,\n    name,\n    default=None,\n    current=None,\n):\n    \"\"\"Validate membership and return value or fallback.\"\"\"\n    # Dynamically evaluate allowed if callable (e.g. lambda)\n    allowed_values = self.allowed() if callable(self.allowed) else self.allowed\n\n    if value not in allowed_values:\n        Diagnostics.choice_mismatch(\n            name,\n            value,\n            allowed_values,\n            current=current,\n            default=default,\n        )\n        return self._fallback(current, default)\n\n    Diagnostics.validated(\n        name,\n        value,\n        stage=ValidationStage.MEMBERSHIP,\n    )\n    return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.RangeValidator","title":"<code>RangeValidator</code>","text":"<p>               Bases: <code>ValidatorBase</code></p> <p>Ensure a numeric value lies within [ge, le].</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class RangeValidator(ValidatorBase):\n    \"\"\"Ensure a numeric value lies within [ge, le].\"\"\"\n\n    def __init__(\n        self,\n        *,\n        ge=-np.inf,\n        le=np.inf,\n    ):\n        self.ge, self.le = ge, le\n\n    def validated(\n        self,\n        value,\n        name,\n        default=None,\n        current=None,\n    ):\n        \"\"\"Validate range and return value or fallback.\"\"\"\n        if not (self.ge &lt;= value &lt;= self.le):\n            Diagnostics.range_mismatch(\n                name,\n                value,\n                self.ge,\n                self.le,\n                current=current,\n                default=default,\n            )\n            return self._fallback(current, default)\n\n        Diagnostics.validated(\n            name,\n            value,\n            stage=ValidationStage.RANGE,\n        )\n        return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.RangeValidator.validated","title":"<code>validated(value, name, default=None, current=None)</code>","text":"<p>Validate range and return value or fallback.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def validated(\n    self,\n    value,\n    name,\n    default=None,\n    current=None,\n):\n    \"\"\"Validate range and return value or fallback.\"\"\"\n    if not (self.ge &lt;= value &lt;= self.le):\n        Diagnostics.range_mismatch(\n            name,\n            value,\n            self.ge,\n            self.le,\n            current=current,\n            default=default,\n        )\n        return self._fallback(current, default)\n\n    Diagnostics.validated(\n        name,\n        value,\n        stage=ValidationStage.RANGE,\n    )\n    return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.RegexValidator","title":"<code>RegexValidator</code>","text":"<p>               Bases: <code>ValidatorBase</code></p> <p>Ensure that a string matches a given regular expression.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class RegexValidator(ValidatorBase):\n    \"\"\"Ensure that a string matches a given regular expression.\"\"\"\n\n    def __init__(self, pattern):\n        self.pattern = re.compile(pattern)\n\n    def validated(\n        self,\n        value,\n        name,\n        default=None,\n        current=None,\n    ):\n        \"\"\"Validate regex and return value or fallback.\"\"\"\n        if not self.pattern.fullmatch(value):\n            Diagnostics.regex_mismatch(\n                name,\n                value,\n                self.pattern.pattern,\n                current=current,\n                default=default,\n            )\n            return self._fallback(current, default)\n\n        Diagnostics.validated(\n            name,\n            value,\n            stage=ValidationStage.REGEX,\n        )\n        return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.RegexValidator.validated","title":"<code>validated(value, name, default=None, current=None)</code>","text":"<p>Validate regex and return value or fallback.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def validated(\n    self,\n    value,\n    name,\n    default=None,\n    current=None,\n):\n    \"\"\"Validate regex and return value or fallback.\"\"\"\n    if not self.pattern.fullmatch(value):\n        Diagnostics.regex_mismatch(\n            name,\n            value,\n            self.pattern.pattern,\n            current=current,\n            default=default,\n        )\n        return self._fallback(current, default)\n\n    Diagnostics.validated(\n        name,\n        value,\n        stage=ValidationStage.REGEX,\n    )\n    return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.TypeValidator","title":"<code>TypeValidator</code>","text":"<p>               Bases: <code>ValidatorBase</code></p> <p>Ensure a value is of the expected Python type.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class TypeValidator(ValidatorBase):\n    \"\"\"Ensure a value is of the expected Python type.\"\"\"\n\n    def __init__(self, expected_type: DataTypes):\n        if isinstance(expected_type, DataTypes):\n            self.expected_type = expected_type\n            self.expected_label = str(expected_type)\n        else:\n            raise TypeError(f'TypeValidator expected a DataTypes member, got {expected_type!r}')\n\n    def validated(\n        self,\n        value,\n        name,\n        default=None,\n        current=None,\n        allow_none=False,\n    ):\n        \"\"\"Validate type and return value or fallback.\n\n        If allow_none is True, None bypasses content checks.\n        \"\"\"\n        # Fresh initialization, use default\n        if current is None and value is None:\n            Diagnostics.no_value(name, default)\n            return default\n\n        # Explicit None (allowed)\n        if value is None and allow_none:\n            Diagnostics.none_value(name)\n            return None\n\n        # Normal type validation\n        if not isinstance(value, self.expected_type.value):\n            Diagnostics.type_mismatch(\n                name,\n                value,\n                expected_type=self.expected_label,\n                current=current,\n                default=default,\n            )\n            return self._fallback(current, default)\n\n        Diagnostics.validated(\n            name,\n            value,\n            stage=ValidationStage.TYPE,\n        )\n        return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.TypeValidator.validated","title":"<code>validated(value, name, default=None, current=None, allow_none=False)</code>","text":"<p>Validate type and return value or fallback.</p> <p>If allow_none is True, None bypasses content checks.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def validated(\n    self,\n    value,\n    name,\n    default=None,\n    current=None,\n    allow_none=False,\n):\n    \"\"\"Validate type and return value or fallback.\n\n    If allow_none is True, None bypasses content checks.\n    \"\"\"\n    # Fresh initialization, use default\n    if current is None and value is None:\n        Diagnostics.no_value(name, default)\n        return default\n\n    # Explicit None (allowed)\n    if value is None and allow_none:\n        Diagnostics.none_value(name)\n        return None\n\n    # Normal type validation\n    if not isinstance(value, self.expected_type.value):\n        Diagnostics.type_mismatch(\n            name,\n            value,\n            expected_type=self.expected_label,\n            current=current,\n            default=default,\n        )\n        return self._fallback(current, default)\n\n    Diagnostics.validated(\n        name,\n        value,\n        stage=ValidationStage.TYPE,\n    )\n    return value\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.ValidationStage","title":"<code>ValidationStage</code>","text":"<p>               Bases: <code>Enum</code></p> <p>Phases of validation for diagnostic logging.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class ValidationStage(Enum):\n    \"\"\"Phases of validation for diagnostic logging.\"\"\"\n\n    TYPE = auto()\n    RANGE = auto()\n    MEMBERSHIP = auto()\n    REGEX = auto()\n\n    def __str__(self):\n        return self.name.lower()\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.ValidatorBase","title":"<code>ValidatorBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract base class for all validators.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>class ValidatorBase(ABC):\n    \"\"\"Abstract base class for all validators.\"\"\"\n\n    @abstractmethod\n    def validated(self, value, name, default=None, current=None):\n        \"\"\"Return a validated value or fallback.\n\n        Subclasses must implement this method.\n        \"\"\"\n        raise NotImplementedError\n\n    def _fallback(\n        self,\n        current=None,\n        default=None,\n    ):\n        \"\"\"Return current if set, else default.\"\"\"\n        return current if current is not None else default\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.ValidatorBase.validated","title":"<code>validated(value, name, default=None, current=None)</code>  <code>abstractmethod</code>","text":"<p>Return a validated value or fallback.</p> <p>Subclasses must implement this method.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>@abstractmethod\ndef validated(self, value, name, default=None, current=None):\n    \"\"\"Return a validated value or fallback.\n\n    Subclasses must implement this method.\n    \"\"\"\n    raise NotImplementedError\n</code></pre>"},{"location":"api-reference/core/#easydiffraction.core.validation.checktype","title":"<code>checktype(func=None, *, context=None)</code>","text":"<p>Runtime type check decorator using typeguard.</p> <p>When a TypeCheckError occurs, the error is logged and None is returned. If context is provided, it is added to the message.</p> Source code in <code>src/easydiffraction/core/validation.py</code> <pre><code>def checktype(func=None, *, context=None):\n    \"\"\"Runtime type check decorator using typeguard.\n\n    When a TypeCheckError occurs, the error is logged and None is\n    returned. If context is provided, it is added to the message.\n    \"\"\"\n\n    def decorator(f):\n        checked_func = typechecked(f)\n\n        @functools.wraps(f)\n        def wrapper(*args, **kwargs):\n            try:\n                return checked_func(*args, **kwargs)\n            except TypeCheckError as err:\n                msg = str(err)\n                if context:\n                    msg = f'{context}: {msg}'\n                log.error(message=msg, exc_type=TypeError)\n                return None\n\n        return wrapper\n\n    if func is None:\n        return decorator\n    return decorator(func)\n</code></pre>"},{"location":"api-reference/crystallography/","title":"crystallography","text":""},{"location":"api-reference/crystallography/#easydiffraction.crystallography","title":"<code>crystallography</code>","text":""},{"location":"api-reference/crystallography/#easydiffraction.crystallography.crystallography","title":"<code>crystallography</code>","text":""},{"location":"api-reference/crystallography/#easydiffraction.crystallography.crystallography.apply_atom_site_symmetry_constraints","title":"<code>apply_atom_site_symmetry_constraints(atom_site, name_hm, coord_code, wyckoff_letter)</code>","text":"<p>Apply symmetry constraints to atomic coordinates based on site symmetry.</p> <p>Parameters:</p> Name Type Description Default <code>atom_site</code> <code>Dict[str, Any]</code> <p>Dictionary containing atom position data.</p> required <code>name_hm</code> <code>str</code> <p>Hermann-Mauguin symbol of the space group.</p> required <code>coord_code</code> <code>int</code> <p>Coordinate system code.</p> required <code>wyckoff_letter</code> <code>str</code> <p>Wyckoff position letter.</p> required <p>Returns:</p> Type Description <code>Dict[str, Any]</code> <p>The atom_site dictionary with applied symmetry constraints.</p> Source code in <code>src/easydiffraction/crystallography/crystallography.py</code> <pre><code>def apply_atom_site_symmetry_constraints(\n    atom_site: Dict[str, Any],\n    name_hm: str,\n    coord_code: int,\n    wyckoff_letter: str,\n) -&gt; Dict[str, Any]:\n    \"\"\"Apply symmetry constraints to atomic coordinates based on site\n    symmetry.\n\n    Args:\n        atom_site: Dictionary containing atom position data.\n        name_hm: Hermann-Mauguin symbol of the space group.\n        coord_code: Coordinate system code.\n        wyckoff_letter: Wyckoff position letter.\n\n    Returns:\n        The atom_site dictionary with applied symmetry constraints.\n    \"\"\"\n    it_number = get_it_number_by_name_hm_short(name_hm)\n    if it_number is None:\n        error_msg = f\"Failed to get IT_number for name_H-M '{name_hm}'\"\n        log.error(error_msg)  # TODO: ValueError? Diagnostics?\n        return atom_site\n\n    it_coordinate_system_code = coord_code\n    if it_coordinate_system_code is None:\n        error_msg = 'IT_coordinate_system_code is not set'\n        log.error(error_msg)  # TODO: ValueError? Diagnostics?\n        return atom_site\n\n    space_group_entry = SPACE_GROUPS[(it_number, it_coordinate_system_code)]\n    wyckoff_positions = space_group_entry['Wyckoff_positions'][wyckoff_letter]\n    coords_xyz = wyckoff_positions['coords_xyz']\n\n    first_position = coords_xyz[0]\n    components = first_position.strip('()').split(',')\n    parsed_exprs: List[Expr] = [sympify(comp.strip()) for comp in components]\n\n    x_val: Expr = sympify(atom_site['fract_x'])\n    y_val: Expr = sympify(atom_site['fract_y'])\n    z_val: Expr = sympify(atom_site['fract_z'])\n\n    substitutions: Dict[str, Expr] = {'x': x_val, 'y': y_val, 'z': z_val}\n\n    axes: tuple[str, ...] = ('x', 'y', 'z')\n    x, y, z = symbols('x y z')\n    symbols_xyz: tuple[Symbol, ...] = (x, y, z)\n\n    for i, axis in enumerate(axes):\n        symbol = symbols_xyz[i]\n        is_free = any(symbol in expr.free_symbols for expr in parsed_exprs)\n\n        if not is_free:\n            evaluated = parsed_exprs[i].subs(substitutions)\n            simplified = simplify(evaluated)\n            atom_site[f'fract_{axis}'] = float(simplified)\n\n    return atom_site\n</code></pre>"},{"location":"api-reference/crystallography/#easydiffraction.crystallography.crystallography.apply_cell_symmetry_constraints","title":"<code>apply_cell_symmetry_constraints(cell, name_hm)</code>","text":"<p>Apply symmetry constraints to unit cell parameters based on space group.</p> <p>Parameters:</p> Name Type Description Default <code>cell</code> <code>Dict[str, float]</code> <p>Dictionary containing lattice parameters.</p> required <code>name_hm</code> <code>str</code> <p>Hermann-Mauguin symbol of the space group.</p> required <p>Returns:</p> Type Description <code>Dict[str, float]</code> <p>The cell dictionary with applied symmetry constraints.</p> Source code in <code>src/easydiffraction/crystallography/crystallography.py</code> <pre><code>def apply_cell_symmetry_constraints(\n    cell: Dict[str, float],\n    name_hm: str,\n) -&gt; Dict[str, float]:\n    \"\"\"Apply symmetry constraints to unit cell parameters based on space\n    group.\n\n    Args:\n        cell: Dictionary containing lattice parameters.\n        name_hm: Hermann-Mauguin symbol of the space group.\n\n    Returns:\n        The cell dictionary with applied symmetry constraints.\n    \"\"\"\n    it_number = get_it_number_by_name_hm_short(name_hm)\n    if it_number is None:\n        error_msg = f\"Failed to get IT_number for name_H-M '{name_hm}'\"\n        log.error(error_msg)  # TODO: ValueError? Diagnostics?\n        return cell\n\n    crystal_system = get_crystal_system_by_it_number(it_number)\n    if crystal_system is None:\n        error_msg = f\"Failed to get crystal system for IT_number '{it_number}'\"\n        log.error(error_msg)  # TODO: ValueError? Diagnostics?\n        return cell\n\n    if crystal_system == 'cubic':\n        a = cell['lattice_a']\n        cell['lattice_b'] = a\n        cell['lattice_c'] = a\n        cell['angle_alpha'] = 90.0\n        cell['angle_beta'] = 90.0\n        cell['angle_gamma'] = 90.0\n\n    elif crystal_system == 'tetragonal':\n        a = cell['lattice_a']\n        cell['lattice_b'] = a\n        cell['angle_alpha'] = 90.0\n        cell['angle_beta'] = 90.0\n        cell['angle_gamma'] = 90.0\n\n    elif crystal_system == 'orthorhombic':\n        cell['angle_alpha'] = 90.0\n        cell['angle_beta'] = 90.0\n        cell['angle_gamma'] = 90.0\n\n    elif crystal_system in {'hexagonal', 'trigonal'}:\n        a = cell['lattice_a']\n        cell['lattice_b'] = a\n        cell['angle_alpha'] = 90.0\n        cell['angle_beta'] = 90.0\n        cell['angle_gamma'] = 120.0\n\n    elif crystal_system == 'monoclinic':\n        cell['angle_alpha'] = 90.0\n        cell['angle_gamma'] = 90.0\n\n    elif crystal_system == 'triclinic':\n        pass  # No constraints to apply\n\n    else:\n        error_msg = f'Unknown or unsupported crystal system: {crystal_system}'\n        log.error(error_msg)  # TODO: ValueError? Diagnostics?\n\n    return cell\n</code></pre>"},{"location":"api-reference/crystallography/#easydiffraction.crystallography.space_groups","title":"<code>space_groups</code>","text":"<p>Space group reference data.</p> <p>Loads a gzipped, packaged pickle with crystallographic space-group information. The file is part of the distribution; user input is not involved.</p>"},{"location":"api-reference/display/","title":"display","text":""},{"location":"api-reference/display/#easydiffraction.display","title":"<code>display</code>","text":"<p>Display subsystem for tables and plots.</p> <p>This package contains user-facing facades and backend implementations to render tabular data and plots in different environments.</p> <ul> <li>Tables: see :mod:<code>easydiffraction.display.tables</code> and the engines in         :mod:<code>easydiffraction.display.tablers</code>.</li> <li>Plots: see :mod:<code>easydiffraction.display.plotting</code> and the engines in         :mod:<code>easydiffraction.display.plotters</code>.</li> </ul>"},{"location":"api-reference/display/#easydiffraction.display.base","title":"<code>base</code>","text":"<p>Common base classes for display components and their factories.</p>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererBase","title":"<code>RendererBase</code>","text":"<p>               Bases: <code>SingletonBase</code>, <code>ABC</code></p> <p>Base class for display components with pluggable engines.</p> <p>Subclasses provide a factory and a default engine. This class manages the active backend instance and exposes helpers to inspect supported engines in a table-friendly format.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>class RendererBase(SingletonBase, ABC):\n    \"\"\"Base class for display components with pluggable engines.\n\n    Subclasses provide a factory and a default engine. This class\n    manages the active backend instance and exposes helpers to inspect\n    supported engines in a table-friendly format.\n    \"\"\"\n\n    def __init__(self):\n        self._engine = self._default_engine()\n        self._backend = self._factory().create(self._engine)\n\n    @classmethod\n    @abstractmethod\n    def _factory(cls) -&gt; type[RendererFactoryBase]:\n        \"\"\"Return the factory class for this renderer type.\"\"\"\n        raise NotImplementedError\n\n    @classmethod\n    @abstractmethod\n    def _default_engine(cls) -&gt; str:\n        \"\"\"Return the default engine name for this renderer.\"\"\"\n        raise NotImplementedError\n\n    @property\n    def engine(self) -&gt; str:\n        return self._engine\n\n    @engine.setter\n    def engine(self, new_engine: str) -&gt; None:\n        if new_engine == self._engine:\n            log.info(f\"Engine is already set to '{new_engine}'. No change made.\")\n            return\n        try:\n            self._backend = self._factory().create(new_engine)\n        except ValueError as exc:\n            # Log a friendly message and leave engine unchanged\n            log.warning(str(exc))\n            return\n        else:\n            self._engine = new_engine\n            console.paragraph('Current engine changed to')\n            console.print(f\"'{self._engine}'\")\n\n    @abstractmethod\n    def show_config(self) -&gt; None:\n        \"\"\"Display the current renderer configuration.\"\"\"\n        raise NotImplementedError\n\n    def show_supported_engines(self) -&gt; None:\n        \"\"\"List supported engines with descriptions in a table.\"\"\"\n        headers = [\n            ('Engine', 'left'),\n            ('Description', 'left'),\n        ]\n        rows = self._factory().descriptions()\n        df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n        console.paragraph('Supported engines')\n        # Delegate table rendering to the TableRenderer singleton\n        from easydiffraction.display.tables import TableRenderer  # local import to avoid cycles\n\n        TableRenderer.get().render(df)\n\n    def show_current_engine(self) -&gt; None:\n        \"\"\"Display the currently selected engine.\"\"\"\n        console.paragraph('Current engine')\n        console.print(f\"'{self._engine}'\")\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererBase.show_config","title":"<code>show_config()</code>  <code>abstractmethod</code>","text":"<p>Display the current renderer configuration.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>@abstractmethod\ndef show_config(self) -&gt; None:\n    \"\"\"Display the current renderer configuration.\"\"\"\n    raise NotImplementedError\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererBase.show_current_engine","title":"<code>show_current_engine()</code>","text":"<p>Display the currently selected engine.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>def show_current_engine(self) -&gt; None:\n    \"\"\"Display the currently selected engine.\"\"\"\n    console.paragraph('Current engine')\n    console.print(f\"'{self._engine}'\")\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererBase.show_supported_engines","title":"<code>show_supported_engines()</code>","text":"<p>List supported engines with descriptions in a table.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>def show_supported_engines(self) -&gt; None:\n    \"\"\"List supported engines with descriptions in a table.\"\"\"\n    headers = [\n        ('Engine', 'left'),\n        ('Description', 'left'),\n    ]\n    rows = self._factory().descriptions()\n    df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n    console.paragraph('Supported engines')\n    # Delegate table rendering to the TableRenderer singleton\n    from easydiffraction.display.tables import TableRenderer  # local import to avoid cycles\n\n    TableRenderer.get().render(df)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererFactoryBase","title":"<code>RendererFactoryBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Base factory that manages discovery and creation of backends.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>class RendererFactoryBase(ABC):\n    \"\"\"Base factory that manages discovery and creation of backends.\"\"\"\n\n    @classmethod\n    def create(cls, engine_name: str) -&gt; Any:\n        \"\"\"Create a backend instance for the given engine.\n\n        Args:\n            engine_name: Identifier of the engine to instantiate as\n                listed in ``_registry()``.\n\n        Returns:\n            A new backend instance corresponding to ``engine_name``.\n\n        Raises:\n            ValueError: If the engine name is not supported.\n        \"\"\"\n        registry = cls._registry()\n        if engine_name not in registry:\n            supported = list(registry.keys())\n            raise ValueError(f\"Unsupported engine '{engine_name}'. Supported engines: {supported}\")\n        engine_class = registry[engine_name]['class']\n        return engine_class()\n\n    @classmethod\n    def supported_engines(cls) -&gt; List[str]:\n        \"\"\"Return a list of supported engine identifiers.\"\"\"\n        return list(cls._registry().keys())\n\n    @classmethod\n    def descriptions(cls) -&gt; List[Tuple[str, str]]:\n        \"\"\"Return pairs of engine name and human-friendly\n        description.\n        \"\"\"\n        items = cls._registry().items()\n        return [(name, config.get('description')) for name, config in items]\n\n    @classmethod\n    @abstractmethod\n    def _registry(cls) -&gt; dict:\n        \"\"\"Return engine registry. Implementations must provide this.\n\n        The returned mapping should have keys as engine names and values\n        as a config dict with 'description' and 'class'. Lazy imports\n        are allowed to avoid circular dependencies.\n        \"\"\"\n        raise NotImplementedError\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererFactoryBase.create","title":"<code>create(engine_name)</code>  <code>classmethod</code>","text":"<p>Create a backend instance for the given engine.</p> <p>Parameters:</p> Name Type Description Default <code>engine_name</code> <code>str</code> <p>Identifier of the engine to instantiate as listed in <code>_registry()</code>.</p> required <p>Returns:</p> Type Description <code>Any</code> <p>A new backend instance corresponding to <code>engine_name</code>.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If the engine name is not supported.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>@classmethod\ndef create(cls, engine_name: str) -&gt; Any:\n    \"\"\"Create a backend instance for the given engine.\n\n    Args:\n        engine_name: Identifier of the engine to instantiate as\n            listed in ``_registry()``.\n\n    Returns:\n        A new backend instance corresponding to ``engine_name``.\n\n    Raises:\n        ValueError: If the engine name is not supported.\n    \"\"\"\n    registry = cls._registry()\n    if engine_name not in registry:\n        supported = list(registry.keys())\n        raise ValueError(f\"Unsupported engine '{engine_name}'. Supported engines: {supported}\")\n    engine_class = registry[engine_name]['class']\n    return engine_class()\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererFactoryBase.descriptions","title":"<code>descriptions()</code>  <code>classmethod</code>","text":"<p>Return pairs of engine name and human-friendly description.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>@classmethod\ndef descriptions(cls) -&gt; List[Tuple[str, str]]:\n    \"\"\"Return pairs of engine name and human-friendly\n    description.\n    \"\"\"\n    items = cls._registry().items()\n    return [(name, config.get('description')) for name, config in items]\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.base.RendererFactoryBase.supported_engines","title":"<code>supported_engines()</code>  <code>classmethod</code>","text":"<p>Return a list of supported engine identifiers.</p> Source code in <code>src/easydiffraction/display/base.py</code> <pre><code>@classmethod\ndef supported_engines(cls) -&gt; List[str]:\n    \"\"\"Return a list of supported engine identifiers.\"\"\"\n    return list(cls._registry().keys())\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters","title":"<code>plotters</code>","text":"<p>Plotting backends.</p> <p>This subpackage implements plotting engines used by the high-level plotting facade:</p> <ul> <li>:mod:<code>.ascii</code> for terminal-friendly ASCII plots.</li> <li>:mod:<code>.plotly</code> for interactive plots in notebooks or browsers.</li> </ul>"},{"location":"api-reference/display/#easydiffraction.display.plotters.ascii","title":"<code>ascii</code>","text":"<p>ASCII plotting backend.</p> <p>Renders compact line charts in the terminal using <code>asciichartpy</code>. This backend is well suited for quick feedback in CLI environments and keeps a consistent API with other plotters.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotters.ascii.AsciiPlotter","title":"<code>AsciiPlotter</code>","text":"<p>               Bases: <code>PlotterBase</code></p> <p>Terminal-based plotter using ASCII art.</p> Source code in <code>src/easydiffraction/display/plotters/ascii.py</code> <pre><code>class AsciiPlotter(PlotterBase):\n    \"\"\"Terminal-based plotter using ASCII art.\"\"\"\n\n    def _get_legend_item(self, label):\n        \"\"\"Return a colored legend entry for a given series label.\n\n        The legend uses a colored line matching the series color and\n        the human-readable name from :data:`SERIES_CONFIG`.\n\n        Args:\n            label: Series identifier (e.g., ``'meas'``).\n\n        Returns:\n            A formatted legend string with color escapes.\n        \"\"\"\n        color_start = DEFAULT_COLORS[label]\n        color_end = asciichartpy.reset\n        line = '\u2500\u2500\u2500\u2500'\n        name = SERIES_CONFIG[label]['name']\n        item = f'{color_start}{line}{color_end} {name}'\n        return item\n\n    def plot(\n        self,\n        x,\n        y_series,\n        labels,\n        axes_labels,\n        title,\n        height=None,\n    ):\n        \"\"\"Render a compact ASCII chart in the terminal.\n\n        Args:\n            x: 1D array-like of x values (only used for range\n                display).\n            y_series: Sequence of y arrays to plot.\n            labels: Series identifiers corresponding to y_series.\n            axes_labels: Ignored; kept for API compatibility.\n            title: Figure title printed above the chart.\n            height: Number of text rows to allocate for the chart.\n        \"\"\"\n        # Intentionally unused; kept for a consistent display API\n        del axes_labels\n        legend = '\\n'.join([self._get_legend_item(label) for label in labels])\n\n        if height is None:\n            height = DEFAULT_HEIGHT\n        colors = [DEFAULT_COLORS[label] for label in labels]\n        config = {'height': height, 'colors': colors}\n        y_series = [y.tolist() for y in y_series]\n\n        chart = asciichartpy.plot(y_series, config)\n\n        console.paragraph(f'{title}')  # TODO: f''?\n        console.print(\n            f'Displaying data for selected x-range from {x[0]} to {x[-1]} ({len(x)} points)'\n        )\n        console.print(f'Legend:\\n{legend}')\n\n        padded = '\\n'.join(' ' + line for line in chart.splitlines())\n\n        print(padded)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters.ascii.AsciiPlotter.plot","title":"<code>plot(x, y_series, labels, axes_labels, title, height=None)</code>","text":"<p>Render a compact ASCII chart in the terminal.</p> <p>Parameters:</p> Name Type Description Default <code>x</code> <p>1D array-like of x values (only used for range display).</p> required <code>y_series</code> <p>Sequence of y arrays to plot.</p> required <code>labels</code> <p>Series identifiers corresponding to y_series.</p> required <code>axes_labels</code> <p>Ignored; kept for API compatibility.</p> required <code>title</code> <p>Figure title printed above the chart.</p> required <code>height</code> <p>Number of text rows to allocate for the chart.</p> <code>None</code> Source code in <code>src/easydiffraction/display/plotters/ascii.py</code> <pre><code>def plot(\n    self,\n    x,\n    y_series,\n    labels,\n    axes_labels,\n    title,\n    height=None,\n):\n    \"\"\"Render a compact ASCII chart in the terminal.\n\n    Args:\n        x: 1D array-like of x values (only used for range\n            display).\n        y_series: Sequence of y arrays to plot.\n        labels: Series identifiers corresponding to y_series.\n        axes_labels: Ignored; kept for API compatibility.\n        title: Figure title printed above the chart.\n        height: Number of text rows to allocate for the chart.\n    \"\"\"\n    # Intentionally unused; kept for a consistent display API\n    del axes_labels\n    legend = '\\n'.join([self._get_legend_item(label) for label in labels])\n\n    if height is None:\n        height = DEFAULT_HEIGHT\n    colors = [DEFAULT_COLORS[label] for label in labels]\n    config = {'height': height, 'colors': colors}\n    y_series = [y.tolist() for y in y_series]\n\n    chart = asciichartpy.plot(y_series, config)\n\n    console.paragraph(f'{title}')  # TODO: f''?\n    console.print(\n        f'Displaying data for selected x-range from {x[0]} to {x[-1]} ({len(x)} points)'\n    )\n    console.print(f'Legend:\\n{legend}')\n\n    padded = '\\n'.join(' ' + line for line in chart.splitlines())\n\n    print(padded)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters.base","title":"<code>base</code>","text":"<p>Abstract base and shared constants for plotting backends.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotters.base.PlotterBase","title":"<code>PlotterBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract base for plotting backends.</p> <p>Implementations accept x values, multiple y-series, optional labels and render a plot to the chosen medium.</p> Source code in <code>src/easydiffraction/display/plotters/base.py</code> <pre><code>class PlotterBase(ABC):\n    \"\"\"Abstract base for plotting backends.\n\n    Implementations accept x values, multiple y-series, optional labels\n    and render a plot to the chosen medium.\n    \"\"\"\n\n    @abstractmethod\n    def plot(\n        self,\n        x,\n        y_series,\n        labels,\n        axes_labels,\n        title,\n        height,\n    ):\n        \"\"\"Render a plot.\n\n        Args:\n            x: 1D array of x-axis values.\n            y_series: Sequence of y arrays to plot.\n            labels: Identifiers corresponding to y_series.\n            axes_labels: Pair of strings for the x and y titles.\n            title: Figure title.\n            height: Backend-specific height (text rows or pixels).\n        \"\"\"\n        pass\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters.base.PlotterBase.plot","title":"<code>plot(x, y_series, labels, axes_labels, title, height)</code>  <code>abstractmethod</code>","text":"<p>Render a plot.</p> <p>Parameters:</p> Name Type Description Default <code>x</code> <p>1D array of x-axis values.</p> required <code>y_series</code> <p>Sequence of y arrays to plot.</p> required <code>labels</code> <p>Identifiers corresponding to y_series.</p> required <code>axes_labels</code> <p>Pair of strings for the x and y titles.</p> required <code>title</code> <p>Figure title.</p> required <code>height</code> <p>Backend-specific height (text rows or pixels).</p> required Source code in <code>src/easydiffraction/display/plotters/base.py</code> <pre><code>@abstractmethod\ndef plot(\n    self,\n    x,\n    y_series,\n    labels,\n    axes_labels,\n    title,\n    height,\n):\n    \"\"\"Render a plot.\n\n    Args:\n        x: 1D array of x-axis values.\n        y_series: Sequence of y arrays to plot.\n        labels: Identifiers corresponding to y_series.\n        axes_labels: Pair of strings for the x and y titles.\n        title: Figure title.\n        height: Backend-specific height (text rows or pixels).\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters.plotly","title":"<code>plotly</code>","text":"<p>Plotly plotting backend.</p> <p>Provides an interactive plotting implementation using Plotly. In notebooks, figures are displayed inline; in other environments a browser renderer may be used depending on configuration.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotters.plotly.PlotlyPlotter","title":"<code>PlotlyPlotter</code>","text":"<p>               Bases: <code>PlotterBase</code></p> <p>Interactive plotter using Plotly for notebooks and browsers.</p> Source code in <code>src/easydiffraction/display/plotters/plotly.py</code> <pre><code>class PlotlyPlotter(PlotterBase):\n    \"\"\"Interactive plotter using Plotly for notebooks and browsers.\"\"\"\n\n    pio.templates.default = 'plotly_dark' if darkdetect.isDark() else 'plotly_white'\n    if in_pycharm():\n        pio.renderers.default = 'browser'\n\n    def _get_trace(self, x, y, label):\n        \"\"\"Create a Plotly trace for a single data series.\n\n        Args:\n            x: 1D array-like of x-axis values.\n            y: 1D array-like of y-axis values.\n            label: Series identifier (``'meas'``, ``'calc'``, or\n                ``'resid'``).\n\n        Returns:\n            A configured :class:`plotly.graph_objects.Scatter` trace.\n        \"\"\"\n        mode = SERIES_CONFIG[label]['mode']\n        name = SERIES_CONFIG[label]['name']\n        color = DEFAULT_COLORS[label]\n        line = {'color': color}\n\n        trace = go.Scatter(\n            x=x,\n            y=y,\n            line=line,\n            mode=mode,\n            name=name,\n        )\n\n        return trace\n\n    def plot(\n        self,\n        x,\n        y_series,\n        labels,\n        axes_labels,\n        title,\n        height=None,\n    ):\n        \"\"\"Render an interactive Plotly figure.\n\n        Args:\n            x: 1D array-like of x-axis values.\n            y_series: Sequence of y arrays to plot.\n            labels: Series identifiers corresponding to y_series.\n            axes_labels: Pair of strings for the x and y titles.\n            title: Figure title.\n            height: Ignored; Plotly auto-sizes based on renderer.\n        \"\"\"\n        # Intentionally unused; accepted for API compatibility\n        del height\n        data = []\n        for idx, y in enumerate(y_series):\n            label = labels[idx]\n            trace = self._get_trace(x, y, label)\n            data.append(trace)\n\n        layout = go.Layout(\n            margin=dict(\n                autoexpand=True,\n                r=30,\n                t=40,\n                b=45,\n            ),\n            title=dict(\n                text=title,\n            ),\n            legend=dict(\n                xanchor='right',\n                x=1.0,\n                yanchor='top',\n                y=1.0,\n            ),\n            xaxis=dict(\n                title_text=axes_labels[0],\n                showline=True,\n                mirror=True,\n                zeroline=False,\n            ),\n            yaxis=dict(\n                title_text=axes_labels[1],\n                showline=True,\n                mirror=True,\n                zeroline=False,\n            ),\n        )\n\n        config = dict(\n            displaylogo=False,\n            modeBarButtonsToRemove=[\n                'select2d',\n                'lasso2d',\n                'zoomIn2d',\n                'zoomOut2d',\n                'autoScale2d',\n            ],\n        )\n\n        fig = go.Figure(\n            data=data,\n            layout=layout,\n        )\n\n        # Format the axes ticks.\n        # Keeps decimals for small numbers; groups thousands for large\n        # ones\n        fig.update_xaxes(tickformat=',.6~g', separatethousands=True)\n        fig.update_yaxes(tickformat=',.6~g', separatethousands=True)\n\n        # Show the figure\n        if in_pycharm() or display is None or HTML is None:\n            fig.show(config=config)\n        else:\n            html_fig = pio.to_html(\n                fig,\n                include_plotlyjs='cdn',\n                full_html=False,\n                config=config,\n            )\n            display(HTML(html_fig))\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotters.plotly.PlotlyPlotter.plot","title":"<code>plot(x, y_series, labels, axes_labels, title, height=None)</code>","text":"<p>Render an interactive Plotly figure.</p> <p>Parameters:</p> Name Type Description Default <code>x</code> <p>1D array-like of x-axis values.</p> required <code>y_series</code> <p>Sequence of y arrays to plot.</p> required <code>labels</code> <p>Series identifiers corresponding to y_series.</p> required <code>axes_labels</code> <p>Pair of strings for the x and y titles.</p> required <code>title</code> <p>Figure title.</p> required <code>height</code> <p>Ignored; Plotly auto-sizes based on renderer.</p> <code>None</code> Source code in <code>src/easydiffraction/display/plotters/plotly.py</code> <pre><code>def plot(\n    self,\n    x,\n    y_series,\n    labels,\n    axes_labels,\n    title,\n    height=None,\n):\n    \"\"\"Render an interactive Plotly figure.\n\n    Args:\n        x: 1D array-like of x-axis values.\n        y_series: Sequence of y arrays to plot.\n        labels: Series identifiers corresponding to y_series.\n        axes_labels: Pair of strings for the x and y titles.\n        title: Figure title.\n        height: Ignored; Plotly auto-sizes based on renderer.\n    \"\"\"\n    # Intentionally unused; accepted for API compatibility\n    del height\n    data = []\n    for idx, y in enumerate(y_series):\n        label = labels[idx]\n        trace = self._get_trace(x, y, label)\n        data.append(trace)\n\n    layout = go.Layout(\n        margin=dict(\n            autoexpand=True,\n            r=30,\n            t=40,\n            b=45,\n        ),\n        title=dict(\n            text=title,\n        ),\n        legend=dict(\n            xanchor='right',\n            x=1.0,\n            yanchor='top',\n            y=1.0,\n        ),\n        xaxis=dict(\n            title_text=axes_labels[0],\n            showline=True,\n            mirror=True,\n            zeroline=False,\n        ),\n        yaxis=dict(\n            title_text=axes_labels[1],\n            showline=True,\n            mirror=True,\n            zeroline=False,\n        ),\n    )\n\n    config = dict(\n        displaylogo=False,\n        modeBarButtonsToRemove=[\n            'select2d',\n            'lasso2d',\n            'zoomIn2d',\n            'zoomOut2d',\n            'autoScale2d',\n        ],\n    )\n\n    fig = go.Figure(\n        data=data,\n        layout=layout,\n    )\n\n    # Format the axes ticks.\n    # Keeps decimals for small numbers; groups thousands for large\n    # ones\n    fig.update_xaxes(tickformat=',.6~g', separatethousands=True)\n    fig.update_yaxes(tickformat=',.6~g', separatethousands=True)\n\n    # Show the figure\n    if in_pycharm() or display is None or HTML is None:\n        fig.show(config=config)\n    else:\n        html_fig = pio.to_html(\n            fig,\n            include_plotlyjs='cdn',\n            full_html=False,\n            config=config,\n        )\n        display(HTML(html_fig))\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting","title":"<code>plotting</code>","text":"<p>Plotting facade for measured and calculated patterns.</p> <p>Uses the common :class:<code>RendererBase</code> so plotters and tablers share a consistent configuration surface and engine handling.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter","title":"<code>Plotter</code>","text":"<p>               Bases: <code>RendererBase</code></p> <p>User-facing plotting facade backed by concrete plotters.</p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>class Plotter(RendererBase):\n    \"\"\"User-facing plotting facade backed by concrete plotters.\"\"\"\n\n    def __init__(self):\n        super().__init__()\n        # X-axis limits\n        self._x_min = DEFAULT_MIN\n        self._x_max = DEFAULT_MAX\n        # Chart height\n        self.height = DEFAULT_HEIGHT\n\n    @classmethod\n    def _factory(cls) -&gt; type[RendererFactoryBase]:  # type: ignore[override]\n        return PlotterFactory\n\n    @classmethod\n    def _default_engine(cls) -&gt; str:\n        return PlotterEngineEnum.default().value\n\n    def show_config(self):\n        \"\"\"Display the current plotting configuration.\"\"\"\n        headers = [\n            ('Parameter', 'left'),\n            ('Value', 'left'),\n        ]\n        rows = [\n            ['Plotting engine', self.engine],\n            ['x-axis limits', f'[{self.x_min}, {self.x_max}]'],\n            ['Chart height', self.height],\n        ]\n        df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n        console.paragraph('Current plotter configuration')\n        TableRenderer.get().render(df)\n\n    @property\n    def x_min(self):\n        \"\"\"Minimum x-axis limit.\"\"\"\n        return self._x_min\n\n    @x_min.setter\n    def x_min(self, value):\n        \"\"\"Set the minimum x-axis limit.\n\n        Args:\n            value: Minimum limit or ``None`` to reset to default.\n        \"\"\"\n        if value is not None:\n            self._x_min = value\n        else:\n            self._x_min = DEFAULT_MIN\n\n    @property\n    def x_max(self):\n        \"\"\"Maximum x-axis limit.\"\"\"\n        return self._x_max\n\n    @x_max.setter\n    def x_max(self, value):\n        \"\"\"Set the maximum x-axis limit.\n\n        Args:\n            value: Maximum limit or ``None`` to reset to default.\n        \"\"\"\n        if value is not None:\n            self._x_max = value\n        else:\n            self._x_max = DEFAULT_MAX\n\n    @property\n    def height(self):\n        \"\"\"Plot height (rows for ASCII, pixels for Plotly).\"\"\"\n        return self._height\n\n    @height.setter\n    def height(self, value):\n        \"\"\"Set plot height.\n\n        Args:\n            value: Height value or ``None`` to reset to default.\n        \"\"\"\n        if value is not None:\n            self._height = value\n        else:\n            self._height = DEFAULT_HEIGHT\n\n    def plot_meas(\n        self,\n        pattern,\n        expt_name,\n        expt_type,\n        x_min=None,\n        x_max=None,\n        d_spacing=False,\n    ):\n        \"\"\"Plot measured pattern using the current engine.\n\n        Args:\n            pattern: Object with ``x`` and ``meas`` arrays (and\n                ``d`` when ``d_spacing`` is true).\n            expt_name: Experiment name for the title.\n            expt_type: Experiment type with scattering/beam enums.\n            x_min: Optional minimum x-axis limit.\n            x_max: Optional maximum x-axis limit.\n            d_spacing: If ``True``, plot against d-spacing values.\n        \"\"\"\n        if pattern.x is None:\n            log.error(f'No data available for experiment {expt_name}')\n            return\n        if pattern.meas is None:\n            log.error(f'No measured data available for experiment {expt_name}')\n            return\n\n        # Select x-axis data based on d-spacing or original x values\n        x_array = pattern.d if d_spacing else pattern.x\n\n        # For asciichartpy, if x_min or x_max is not provided, center\n        # around the maximum intensity peak\n        if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n            max_intensity_pos = np.argmax(pattern.meas)\n            half_range = 50\n            start = max(0, max_intensity_pos - half_range)\n            end = min(len(x_array) - 1, max_intensity_pos + half_range)\n            x_min = x_array[start]\n            x_max = x_array[end]\n\n        # Filter x, y_meas, and y_calc based on x_min and x_max\n        x = self._filtered_y_array(\n            y_array=x_array,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n        y_meas = self._filtered_y_array(\n            y_array=pattern.meas,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n\n        y_series = [y_meas]\n        y_labels = ['meas']\n\n        if d_spacing:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    'd-spacing',\n                )\n            ]\n        else:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    expt_type.beam_mode.value,\n                )\n            ]\n\n        # TODO: Before, it was self._plotter.plot. Check what is better.\n        self._backend.plot(\n            x=x,\n            y_series=y_series,\n            labels=y_labels,\n            axes_labels=axes_labels,\n            title=f\"Measured data for experiment \ud83d\udd2c '{expt_name}'\",\n            height=self.height,\n        )\n\n    def plot_calc(\n        self,\n        pattern,\n        expt_name,\n        expt_type,\n        x_min=None,\n        x_max=None,\n        d_spacing=False,\n    ):\n        \"\"\"Plot calculated pattern using the current engine.\n\n        Args:\n            pattern: Object with ``x`` and ``calc`` arrays (and\n                ``d`` when ``d_spacing`` is true).\n            expt_name: Experiment name for the title.\n            expt_type: Experiment type with scattering/beam enums.\n            x_min: Optional minimum x-axis limit.\n            x_max: Optional maximum x-axis limit.\n            d_spacing: If ``True``, plot against d-spacing values.\n        \"\"\"\n        if pattern.x is None:\n            log.error(f'No data available for experiment {expt_name}')\n            return\n        if pattern.calc is None:\n            log.error(f'No calculated data available for experiment {expt_name}')\n            return\n\n        # Select x-axis data based on d-spacing or original x values\n        x_array = pattern.d if d_spacing else pattern.x\n\n        # For asciichartpy, if x_min or x_max is not provided, center\n        # around the maximum intensity peak\n        if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n            max_intensity_pos = np.argmax(pattern.meas)\n            half_range = 50\n            start = max(0, max_intensity_pos - half_range)\n            end = min(len(x_array) - 1, max_intensity_pos + half_range)\n            x_min = x_array[start]\n            x_max = x_array[end]\n\n        # Filter x, y_meas, and y_calc based on x_min and x_max\n        x = self._filtered_y_array(\n            y_array=x_array,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n        y_calc = self._filtered_y_array(\n            y_array=pattern.calc,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n\n        y_series = [y_calc]\n        y_labels = ['calc']\n\n        if d_spacing:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    'd-spacing',\n                )\n            ]\n        else:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    expt_type.beam_mode.value,\n                )\n            ]\n\n        self._backend.plot(\n            x=x,\n            y_series=y_series,\n            labels=y_labels,\n            axes_labels=axes_labels,\n            title=f\"Calculated data for experiment \ud83d\udd2c '{expt_name}'\",\n            height=self.height,\n        )\n\n    def plot_meas_vs_calc(\n        self,\n        pattern,\n        expt_name,\n        expt_type,\n        x_min=None,\n        x_max=None,\n        show_residual=False,\n        d_spacing=False,\n    ):\n        \"\"\"Plot measured and calculated series and optional residual.\n\n        Args:\n            pattern: Object with ``x``, ``meas`` and ``calc`` arrays\n                (and ``d`` when ``d_spacing`` is true).\n            expt_name: Experiment name for the title.\n            expt_type: Experiment type with scattering/beam enums.\n            x_min: Optional minimum x-axis limit.\n            x_max: Optional maximum x-axis limit.\n            show_residual: If ``True``, add residual series.\n            d_spacing: If ``True``, plot against d-spacing values.\n        \"\"\"\n        if pattern.x is None:\n            log.error(f'No data available for experiment {expt_name}')\n            return\n        if pattern.meas is None:\n            log.error(f'No measured data available for experiment {expt_name}')\n            return\n        if pattern.calc is None:\n            log.error(f'No calculated data available for experiment {expt_name}')\n            return\n\n        # Select x-axis data based on d-spacing or original x values\n        x_array = pattern.d if d_spacing else pattern.x\n\n        # For asciichartpy, if x_min or x_max is not provided, center\n        # around the maximum intensity peak\n        if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n            max_intensity_pos = np.argmax(pattern.meas)\n            half_range = 50\n            start = max(0, max_intensity_pos - half_range)\n            end = min(len(x_array) - 1, max_intensity_pos + half_range)\n            x_min = x_array[start]\n            x_max = x_array[end]\n\n        # Filter x, y_meas, and y_calc based on x_min and x_max\n        x = self._filtered_y_array(\n            y_array=x_array,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n        y_meas = self._filtered_y_array(\n            y_array=pattern.meas,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n        y_calc = self._filtered_y_array(\n            y_array=pattern.calc,\n            x_array=x_array,\n            x_min=x_min,\n            x_max=x_max,\n        )\n\n        y_series = [y_meas, y_calc]\n        y_labels = ['meas', 'calc']\n\n        if d_spacing:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    'd-spacing',\n                )\n            ]\n        else:\n            axes_labels = DEFAULT_AXES_LABELS[\n                (\n                    expt_type.scattering_type.value,\n                    expt_type.beam_mode.value,\n                )\n            ]\n\n        if show_residual:\n            y_resid = y_meas - y_calc\n            y_series.append(y_resid)\n            y_labels.append('resid')\n\n        self._backend.plot(\n            x=x,\n            y_series=y_series,\n            labels=y_labels,\n            axes_labels=axes_labels,\n            title=f\"Measured vs Calculated data for experiment \ud83d\udd2c '{expt_name}'\",\n            height=self.height,\n        )\n\n    def _filtered_y_array(\n        self,\n        y_array,\n        x_array,\n        x_min,\n        x_max,\n    ):\n        \"\"\"Filter an array by the inclusive x-range limits.\n\n        Args:\n            y_array: 1D array-like of y values.\n            x_array: 1D array-like of x values (same length as\n                ``y_array``).\n            x_min: Minimum x limit (or ``None`` to use default).\n            x_max: Maximum x limit (or ``None`` to use default).\n\n        Returns:\n            Filtered ``y_array`` values where ``x_array`` lies within\n            ``[x_min, x_max]``.\n        \"\"\"\n        if x_min is None:\n            x_min = self.x_min\n        if x_max is None:\n            x_max = self.x_max\n\n        mask = (x_array &gt;= x_min) &amp; (x_array &lt;= x_max)\n        filtered_y_array = y_array[mask]\n\n        return filtered_y_array\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.height","title":"<code>height</code>  <code>property</code> <code>writable</code>","text":"<p>Plot height (rows for ASCII, pixels for Plotly).</p>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.plot_calc","title":"<code>plot_calc(pattern, expt_name, expt_type, x_min=None, x_max=None, d_spacing=False)</code>","text":"<p>Plot calculated pattern using the current engine.</p> <p>Parameters:</p> Name Type Description Default <code>pattern</code> <p>Object with <code>x</code> and <code>calc</code> arrays (and <code>d</code> when <code>d_spacing</code> is true).</p> required <code>expt_name</code> <p>Experiment name for the title.</p> required <code>expt_type</code> <p>Experiment type with scattering/beam enums.</p> required <code>x_min</code> <p>Optional minimum x-axis limit.</p> <code>None</code> <code>x_max</code> <p>Optional maximum x-axis limit.</p> <code>None</code> <code>d_spacing</code> <p>If <code>True</code>, plot against d-spacing values.</p> <code>False</code> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>def plot_calc(\n    self,\n    pattern,\n    expt_name,\n    expt_type,\n    x_min=None,\n    x_max=None,\n    d_spacing=False,\n):\n    \"\"\"Plot calculated pattern using the current engine.\n\n    Args:\n        pattern: Object with ``x`` and ``calc`` arrays (and\n            ``d`` when ``d_spacing`` is true).\n        expt_name: Experiment name for the title.\n        expt_type: Experiment type with scattering/beam enums.\n        x_min: Optional minimum x-axis limit.\n        x_max: Optional maximum x-axis limit.\n        d_spacing: If ``True``, plot against d-spacing values.\n    \"\"\"\n    if pattern.x is None:\n        log.error(f'No data available for experiment {expt_name}')\n        return\n    if pattern.calc is None:\n        log.error(f'No calculated data available for experiment {expt_name}')\n        return\n\n    # Select x-axis data based on d-spacing or original x values\n    x_array = pattern.d if d_spacing else pattern.x\n\n    # For asciichartpy, if x_min or x_max is not provided, center\n    # around the maximum intensity peak\n    if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n        max_intensity_pos = np.argmax(pattern.meas)\n        half_range = 50\n        start = max(0, max_intensity_pos - half_range)\n        end = min(len(x_array) - 1, max_intensity_pos + half_range)\n        x_min = x_array[start]\n        x_max = x_array[end]\n\n    # Filter x, y_meas, and y_calc based on x_min and x_max\n    x = self._filtered_y_array(\n        y_array=x_array,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n    y_calc = self._filtered_y_array(\n        y_array=pattern.calc,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n\n    y_series = [y_calc]\n    y_labels = ['calc']\n\n    if d_spacing:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                'd-spacing',\n            )\n        ]\n    else:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                expt_type.beam_mode.value,\n            )\n        ]\n\n    self._backend.plot(\n        x=x,\n        y_series=y_series,\n        labels=y_labels,\n        axes_labels=axes_labels,\n        title=f\"Calculated data for experiment \ud83d\udd2c '{expt_name}'\",\n        height=self.height,\n    )\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.plot_meas","title":"<code>plot_meas(pattern, expt_name, expt_type, x_min=None, x_max=None, d_spacing=False)</code>","text":"<p>Plot measured pattern using the current engine.</p> <p>Parameters:</p> Name Type Description Default <code>pattern</code> <p>Object with <code>x</code> and <code>meas</code> arrays (and <code>d</code> when <code>d_spacing</code> is true).</p> required <code>expt_name</code> <p>Experiment name for the title.</p> required <code>expt_type</code> <p>Experiment type with scattering/beam enums.</p> required <code>x_min</code> <p>Optional minimum x-axis limit.</p> <code>None</code> <code>x_max</code> <p>Optional maximum x-axis limit.</p> <code>None</code> <code>d_spacing</code> <p>If <code>True</code>, plot against d-spacing values.</p> <code>False</code> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>def plot_meas(\n    self,\n    pattern,\n    expt_name,\n    expt_type,\n    x_min=None,\n    x_max=None,\n    d_spacing=False,\n):\n    \"\"\"Plot measured pattern using the current engine.\n\n    Args:\n        pattern: Object with ``x`` and ``meas`` arrays (and\n            ``d`` when ``d_spacing`` is true).\n        expt_name: Experiment name for the title.\n        expt_type: Experiment type with scattering/beam enums.\n        x_min: Optional minimum x-axis limit.\n        x_max: Optional maximum x-axis limit.\n        d_spacing: If ``True``, plot against d-spacing values.\n    \"\"\"\n    if pattern.x is None:\n        log.error(f'No data available for experiment {expt_name}')\n        return\n    if pattern.meas is None:\n        log.error(f'No measured data available for experiment {expt_name}')\n        return\n\n    # Select x-axis data based on d-spacing or original x values\n    x_array = pattern.d if d_spacing else pattern.x\n\n    # For asciichartpy, if x_min or x_max is not provided, center\n    # around the maximum intensity peak\n    if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n        max_intensity_pos = np.argmax(pattern.meas)\n        half_range = 50\n        start = max(0, max_intensity_pos - half_range)\n        end = min(len(x_array) - 1, max_intensity_pos + half_range)\n        x_min = x_array[start]\n        x_max = x_array[end]\n\n    # Filter x, y_meas, and y_calc based on x_min and x_max\n    x = self._filtered_y_array(\n        y_array=x_array,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n    y_meas = self._filtered_y_array(\n        y_array=pattern.meas,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n\n    y_series = [y_meas]\n    y_labels = ['meas']\n\n    if d_spacing:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                'd-spacing',\n            )\n        ]\n    else:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                expt_type.beam_mode.value,\n            )\n        ]\n\n    # TODO: Before, it was self._plotter.plot. Check what is better.\n    self._backend.plot(\n        x=x,\n        y_series=y_series,\n        labels=y_labels,\n        axes_labels=axes_labels,\n        title=f\"Measured data for experiment \ud83d\udd2c '{expt_name}'\",\n        height=self.height,\n    )\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.plot_meas_vs_calc","title":"<code>plot_meas_vs_calc(pattern, expt_name, expt_type, x_min=None, x_max=None, show_residual=False, d_spacing=False)</code>","text":"<p>Plot measured and calculated series and optional residual.</p> <p>Parameters:</p> Name Type Description Default <code>pattern</code> <p>Object with <code>x</code>, <code>meas</code> and <code>calc</code> arrays (and <code>d</code> when <code>d_spacing</code> is true).</p> required <code>expt_name</code> <p>Experiment name for the title.</p> required <code>expt_type</code> <p>Experiment type with scattering/beam enums.</p> required <code>x_min</code> <p>Optional minimum x-axis limit.</p> <code>None</code> <code>x_max</code> <p>Optional maximum x-axis limit.</p> <code>None</code> <code>show_residual</code> <p>If <code>True</code>, add residual series.</p> <code>False</code> <code>d_spacing</code> <p>If <code>True</code>, plot against d-spacing values.</p> <code>False</code> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>def plot_meas_vs_calc(\n    self,\n    pattern,\n    expt_name,\n    expt_type,\n    x_min=None,\n    x_max=None,\n    show_residual=False,\n    d_spacing=False,\n):\n    \"\"\"Plot measured and calculated series and optional residual.\n\n    Args:\n        pattern: Object with ``x``, ``meas`` and ``calc`` arrays\n            (and ``d`` when ``d_spacing`` is true).\n        expt_name: Experiment name for the title.\n        expt_type: Experiment type with scattering/beam enums.\n        x_min: Optional minimum x-axis limit.\n        x_max: Optional maximum x-axis limit.\n        show_residual: If ``True``, add residual series.\n        d_spacing: If ``True``, plot against d-spacing values.\n    \"\"\"\n    if pattern.x is None:\n        log.error(f'No data available for experiment {expt_name}')\n        return\n    if pattern.meas is None:\n        log.error(f'No measured data available for experiment {expt_name}')\n        return\n    if pattern.calc is None:\n        log.error(f'No calculated data available for experiment {expt_name}')\n        return\n\n    # Select x-axis data based on d-spacing or original x values\n    x_array = pattern.d if d_spacing else pattern.x\n\n    # For asciichartpy, if x_min or x_max is not provided, center\n    # around the maximum intensity peak\n    if self._engine == 'asciichartpy' and (x_min is None or x_max is None):\n        max_intensity_pos = np.argmax(pattern.meas)\n        half_range = 50\n        start = max(0, max_intensity_pos - half_range)\n        end = min(len(x_array) - 1, max_intensity_pos + half_range)\n        x_min = x_array[start]\n        x_max = x_array[end]\n\n    # Filter x, y_meas, and y_calc based on x_min and x_max\n    x = self._filtered_y_array(\n        y_array=x_array,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n    y_meas = self._filtered_y_array(\n        y_array=pattern.meas,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n    y_calc = self._filtered_y_array(\n        y_array=pattern.calc,\n        x_array=x_array,\n        x_min=x_min,\n        x_max=x_max,\n    )\n\n    y_series = [y_meas, y_calc]\n    y_labels = ['meas', 'calc']\n\n    if d_spacing:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                'd-spacing',\n            )\n        ]\n    else:\n        axes_labels = DEFAULT_AXES_LABELS[\n            (\n                expt_type.scattering_type.value,\n                expt_type.beam_mode.value,\n            )\n        ]\n\n    if show_residual:\n        y_resid = y_meas - y_calc\n        y_series.append(y_resid)\n        y_labels.append('resid')\n\n    self._backend.plot(\n        x=x,\n        y_series=y_series,\n        labels=y_labels,\n        axes_labels=axes_labels,\n        title=f\"Measured vs Calculated data for experiment \ud83d\udd2c '{expt_name}'\",\n        height=self.height,\n    )\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.show_config","title":"<code>show_config()</code>","text":"<p>Display the current plotting configuration.</p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>def show_config(self):\n    \"\"\"Display the current plotting configuration.\"\"\"\n    headers = [\n        ('Parameter', 'left'),\n        ('Value', 'left'),\n    ]\n    rows = [\n        ['Plotting engine', self.engine],\n        ['x-axis limits', f'[{self.x_min}, {self.x_max}]'],\n        ['Chart height', self.height],\n    ]\n    df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n    console.paragraph('Current plotter configuration')\n    TableRenderer.get().render(df)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.x_max","title":"<code>x_max</code>  <code>property</code> <code>writable</code>","text":"<p>Maximum x-axis limit.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotting.Plotter.x_min","title":"<code>x_min</code>  <code>property</code> <code>writable</code>","text":"<p>Minimum x-axis limit.</p>"},{"location":"api-reference/display/#easydiffraction.display.plotting.PlotterEngineEnum","title":"<code>PlotterEngineEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>class PlotterEngineEnum(str, Enum):\n    ASCII = 'asciichartpy'\n    PLOTLY = 'plotly'\n\n    @classmethod\n    def default(cls) -&gt; 'PlotterEngineEnum':\n        \"\"\"Select default engine based on environment.\"\"\"\n        if in_jupyter():\n            log.debug('Setting default plotting engine to Plotly for Jupyter')\n            return cls.PLOTLY\n        log.debug('Setting default plotting engine to Asciichartpy for console')\n        return cls.ASCII\n\n    def description(self) -&gt; str:\n        \"\"\"Human-readable description for UI listings.\"\"\"\n        if self is PlotterEngineEnum.ASCII:\n            return 'Console ASCII line charts'\n        elif self is PlotterEngineEnum.PLOTLY:\n            return 'Interactive browser-based graphing library'\n        return ''\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.PlotterEngineEnum.default","title":"<code>default()</code>  <code>classmethod</code>","text":"<p>Select default engine based on environment.</p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>@classmethod\ndef default(cls) -&gt; 'PlotterEngineEnum':\n    \"\"\"Select default engine based on environment.\"\"\"\n    if in_jupyter():\n        log.debug('Setting default plotting engine to Plotly for Jupyter')\n        return cls.PLOTLY\n    log.debug('Setting default plotting engine to Asciichartpy for console')\n    return cls.ASCII\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.PlotterEngineEnum.description","title":"<code>description()</code>","text":"<p>Human-readable description for UI listings.</p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>def description(self) -&gt; str:\n    \"\"\"Human-readable description for UI listings.\"\"\"\n    if self is PlotterEngineEnum.ASCII:\n        return 'Console ASCII line charts'\n    elif self is PlotterEngineEnum.PLOTLY:\n        return 'Interactive browser-based graphing library'\n    return ''\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.plotting.PlotterFactory","title":"<code>PlotterFactory</code>","text":"<p>               Bases: <code>RendererFactoryBase</code></p> <p>Factory for plotter implementations.</p> Source code in <code>src/easydiffraction/display/plotting.py</code> <pre><code>class PlotterFactory(RendererFactoryBase):\n    \"\"\"Factory for plotter implementations.\"\"\"\n\n    @classmethod\n    def _registry(cls) -&gt; dict:\n        return {\n            PlotterEngineEnum.ASCII.value: {\n                'description': PlotterEngineEnum.ASCII.description(),\n                'class': AsciiPlotter,\n            },\n            PlotterEngineEnum.PLOTLY.value: {\n                'description': PlotterEngineEnum.PLOTLY.description(),\n                'class': PlotlyPlotter,\n            },\n        }\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers","title":"<code>tablers</code>","text":"<p>Tabular rendering backends.</p> <p>This subpackage provides concrete implementations for rendering tables in different environments:</p> <ul> <li>:mod:<code>.rich</code> for terminal and notebooks using the Rich library.</li> <li>:mod:<code>.pandas</code> for notebooks using DataFrame Styler.</li> </ul>"},{"location":"api-reference/display/#easydiffraction.display.tablers.base","title":"<code>base</code>","text":"<p>Low-level backends for rendering tables.</p> <p>This module defines the abstract base for tabular renderers and small helpers for consistent styling across terminal and notebook outputs.</p>"},{"location":"api-reference/display/#easydiffraction.display.tablers.base.TableBackendBase","title":"<code>TableBackendBase</code>","text":"<p>               Bases: <code>ABC</code></p> <p>Abstract base class for concrete table backends.</p> <p>Subclasses implement the <code>render</code> method which receives an index-aware pandas DataFrame and the alignment for each column header.</p> Source code in <code>src/easydiffraction/display/tablers/base.py</code> <pre><code>class TableBackendBase(ABC):\n    \"\"\"Abstract base class for concrete table backends.\n\n    Subclasses implement the ``render`` method which receives an\n    index-aware pandas DataFrame and the alignment for each column\n    header.\n    \"\"\"\n\n    FLOAT_PRECISION = 5\n    RICH_BORDER_DARK_THEME = 'grey35'\n    RICH_BORDER_LIGHT_THEME = 'grey85'\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._float_fmt = f'{{:.{self.FLOAT_PRECISION}f}}'.format\n\n    def _format_value(self, value: Any) -&gt; Any:\n        \"\"\"Format floats with fixed precision and others as strings.\n\n        Args:\n            value: Cell value to format.\n\n        Returns:\n            A string representation with fixed precision for floats or\n            ``str(value)`` for other types.\n        \"\"\"\n        return self._float_fmt(value) if isinstance(value, float) else str(value)\n\n    def _is_dark_theme(self) -&gt; bool:\n        \"\"\"Return True when a dark theme is detected in Jupyter.\n\n        If not running inside Jupyter, return a sane default (True).\n        \"\"\"\n        default = True\n\n        in_jupyter = (\n            get_ipython() is not None and get_ipython().__class__.__name__ == 'ZMQInteractiveShell'\n        )\n\n        if not in_jupyter:\n            return default\n\n        return is_dark()\n\n    def _rich_to_hex(self, color):\n        \"\"\"Convert a Rich color name to a CSS-style hex string.\n\n        Args:\n            color: Rich color name or specification parsable by\n                :mod:`rich`.\n\n        Returns:\n            Hex color string in the form ``#RRGGBB``.\n        \"\"\"\n        c = Color.parse(color)\n        rgb = c.get_truecolor()\n        hex_value = '#{:02x}{:02x}{:02x}'.format(*rgb)\n        return hex_value\n\n    @property\n    def _rich_border_color(self) -&gt; str:\n        return (\n            self.RICH_BORDER_DARK_THEME if self._is_dark_theme() else self.RICH_BORDER_LIGHT_THEME\n        )\n\n    @property\n    def _pandas_border_color(self) -&gt; str:\n        return self._rich_to_hex(self._rich_border_color)\n\n    @abstractmethod\n    def render(\n        self,\n        alignments,\n        df,\n        display_handle: Any | None = None,\n    ) -&gt; Any:\n        \"\"\"Render the provided DataFrame with backend-specific styling.\n\n        Args:\n            alignments: Iterable of column justifications (e.g.,\n                ``'left'`` or ``'center'``) corresponding to the data\n                columns.\n            df: Index-aware DataFrame with data to render.\n            display_handle: Optional environment-specific handle to\n                enable in-place updates.\n\n        Returns:\n            Backend-defined return value (commonly ``None``).\n        \"\"\"\n        pass\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers.base.TableBackendBase.render","title":"<code>render(alignments, df, display_handle=None)</code>  <code>abstractmethod</code>","text":"<p>Render the provided DataFrame with backend-specific styling.</p> <p>Parameters:</p> Name Type Description Default <code>alignments</code> <p>Iterable of column justifications (e.g., <code>'left'</code> or <code>'center'</code>) corresponding to the data columns.</p> required <code>df</code> <p>Index-aware DataFrame with data to render.</p> required <code>display_handle</code> <code>Any | None</code> <p>Optional environment-specific handle to enable in-place updates.</p> <code>None</code> <p>Returns:</p> Type Description <code>Any</code> <p>Backend-defined return value (commonly <code>None</code>).</p> Source code in <code>src/easydiffraction/display/tablers/base.py</code> <pre><code>@abstractmethod\ndef render(\n    self,\n    alignments,\n    df,\n    display_handle: Any | None = None,\n) -&gt; Any:\n    \"\"\"Render the provided DataFrame with backend-specific styling.\n\n    Args:\n        alignments: Iterable of column justifications (e.g.,\n            ``'left'`` or ``'center'``) corresponding to the data\n            columns.\n        df: Index-aware DataFrame with data to render.\n        display_handle: Optional environment-specific handle to\n            enable in-place updates.\n\n    Returns:\n        Backend-defined return value (commonly ``None``).\n    \"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers.pandas","title":"<code>pandas</code>","text":"<p>Pandas-based table renderer for notebooks using DataFrame Styler.</p>"},{"location":"api-reference/display/#easydiffraction.display.tablers.pandas.PandasTableBackend","title":"<code>PandasTableBackend</code>","text":"<p>               Bases: <code>TableBackendBase</code></p> <p>Render tables using the pandas Styler in Jupyter environments.</p> Source code in <code>src/easydiffraction/display/tablers/pandas.py</code> <pre><code>class PandasTableBackend(TableBackendBase):\n    \"\"\"Render tables using the pandas Styler in Jupyter environments.\"\"\"\n\n    def _build_base_styles(self, color: str) -&gt; list[dict]:\n        \"\"\"Return base CSS table styles for a given border color.\n\n        Args:\n            color: CSS color value (e.g., ``#RRGGBB``) to use for\n                borders and header accents.\n\n        Returns:\n            A list of ``Styler.set_table_styles`` dictionaries.\n        \"\"\"\n        return [\n            # Margins and outer border on the entire table\n            {\n                'selector': ' ',\n                'props': [\n                    ('border', f'1px solid {color}'),\n                    ('border-collapse', 'collapse'),\n                    ('margin-top', '0.5em'),\n                    ('margin-left', '0.5em'),\n                ],\n            },\n            # Horizontal border under header row\n            {\n                'selector': 'thead',\n                'props': [\n                    ('border-bottom', f'1px solid {color}'),\n                ],\n            },\n            # Cell border, padding and line height\n            {\n                'selector': 'th, td',\n                'props': [\n                    ('border', 'none'),\n                    ('padding-top', '0.25em'),\n                    ('padding-bottom', '0.25em'),\n                    ('line-height', '1.15em'),\n                ],\n            },\n            # Style for index column\n            {\n                'selector': 'th.row_heading',\n                'props': [\n                    ('color', color),\n                    ('font-weight', 'normal'),\n                ],\n            },\n            # Remove zebra-row background\n            {\n                'selector': 'tbody tr:nth-child(odd), tbody tr:nth-child(even)',\n                'props': [\n                    ('background-color', 'transparent'),\n                ],\n            },\n        ]\n\n    def _build_header_alignment_styles(self, df, alignments) -&gt; list[dict]:\n        \"\"\"Generate header cell alignment styles per column.\n\n        Args:\n            df: DataFrame whose columns are being rendered.\n            alignments: Iterable of text alignment values (e.g.,\n                ``'left'``, ``'center'``) matching ``df`` columns.\n\n        Returns:\n            A list of CSS rules for header cell alignment.\n        \"\"\"\n        return [\n            {\n                'selector': f'th.col{df.columns.get_loc(column)}',\n                'props': [('text-align', align)],\n            }\n            for column, align in zip(df.columns, alignments, strict=False)\n        ]\n\n    def _apply_styling(self, df, alignments, color: str):\n        \"\"\"Build a configured Styler with alignments and base styles.\n\n        Args:\n            df: DataFrame to style.\n            alignments: Iterable of text alignment values for columns.\n            color: CSS color value used for borders/header.\n\n        Returns:\n            A configured pandas Styler ready for display.\n        \"\"\"\n        table_styles = self._build_base_styles(color)\n        header_alignment_styles = self._build_header_alignment_styles(df, alignments)\n\n        styler = df.style.format(precision=self.FLOAT_PRECISION)\n        styler = styler.set_table_attributes('class=\"dataframe\"')  # For mkdocs-jupyter\n        styler = styler.set_table_styles(table_styles + header_alignment_styles)\n\n        for column, align in zip(df.columns, alignments, strict=False):\n            styler = styler.set_properties(\n                subset=[column],\n                **{'text-align': align},\n            )\n        return styler\n\n    def _update_display(self, styler, display_handle) -&gt; None:\n        \"\"\"Single, consistent update path for Jupyter.\n\n        If a handle with ``update()`` is provided and it's a\n        DisplayHandle, update the output area in-place using HTML.\n        Otherwise, display once via IPython ``display()``.\n\n        Args:\n            styler: Configured DataFrame Styler to be rendered.\n            display_handle: Optional IPython DisplayHandle used for\n                in-place updates.\n        \"\"\"\n        # Handle with update() method\n        if display_handle is not None and hasattr(display_handle, 'update'):\n            # IPython DisplayHandle path\n            if can_use_ipython_display(display_handle) and HTML is not None:\n                try:\n                    html = styler.to_html()\n                    display_handle.update(HTML(html))\n                    return\n                except Exception as err:\n                    log.debug(f'Pandas DisplayHandle update failed: {err!r}')\n\n            # This should not happen in Pandas backend\n            else:\n                pass\n\n        # Normal display\n        display(styler)\n\n    def render(\n        self,\n        alignments,\n        df,\n        display_handle: Any | None = None,\n    ) -&gt; Any:\n        \"\"\"Render a styled DataFrame.\n\n        Args:\n            alignments: Iterable of column justifications (e.g. 'left').\n            df: DataFrame whose index is displayed as the first column.\n            display_handle: Optional IPython DisplayHandle to update an\n                existing output area in place when running in Jupyter.\n        \"\"\"\n        color = self._pandas_border_color\n        styler = self._apply_styling(df, alignments, color)\n        self._update_display(styler, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers.pandas.PandasTableBackend.render","title":"<code>render(alignments, df, display_handle=None)</code>","text":"<p>Render a styled DataFrame.</p> <p>Parameters:</p> Name Type Description Default <code>alignments</code> <p>Iterable of column justifications (e.g. 'left').</p> required <code>df</code> <p>DataFrame whose index is displayed as the first column.</p> required <code>display_handle</code> <code>Any | None</code> <p>Optional IPython DisplayHandle to update an existing output area in place when running in Jupyter.</p> <code>None</code> Source code in <code>src/easydiffraction/display/tablers/pandas.py</code> <pre><code>def render(\n    self,\n    alignments,\n    df,\n    display_handle: Any | None = None,\n) -&gt; Any:\n    \"\"\"Render a styled DataFrame.\n\n    Args:\n        alignments: Iterable of column justifications (e.g. 'left').\n        df: DataFrame whose index is displayed as the first column.\n        display_handle: Optional IPython DisplayHandle to update an\n            existing output area in place when running in Jupyter.\n    \"\"\"\n    color = self._pandas_border_color\n    styler = self._apply_styling(df, alignments, color)\n    self._update_display(styler, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers.rich","title":"<code>rich</code>","text":"<p>Rich-based table renderer for terminals and notebooks.</p>"},{"location":"api-reference/display/#easydiffraction.display.tablers.rich.RichTableBackend","title":"<code>RichTableBackend</code>","text":"<p>               Bases: <code>TableBackendBase</code></p> <p>Render tables to terminal or Jupyter using the Rich library.</p> Source code in <code>src/easydiffraction/display/tablers/rich.py</code> <pre><code>class RichTableBackend(TableBackendBase):\n    \"\"\"Render tables to terminal or Jupyter using the Rich library.\"\"\"\n\n    def _to_html(self, table: Table) -&gt; str:\n        \"\"\"Render a Rich table to HTML using an off-screen console.\n\n        A fresh ``Console(record=True, file=StringIO())`` avoids\n        private attribute access and guarantees no visible output\n        in notebooks.\n\n        Args:\n            table: Rich :class:`~rich.table.Table` to export.\n\n        Returns:\n            HTML string with inline styles for notebook display.\n        \"\"\"\n        tmp = Console(force_jupyter=False, record=True, file=io.StringIO())\n        tmp.print(table)\n        html = tmp.export_html(inline_styles=True)\n        # Remove margins inside pre blocks and adjust font size\n        html = html.replace(\n            '&lt;pre ',\n            \"&lt;pre style='margin:0; font-size: 0.9em !important; ' \",\n        )\n        return html\n\n    def _build_table(self, df, alignments, color: str) -&gt; Table:\n        \"\"\"Construct a Rich Table with formatted data and alignment.\n\n        Args:\n            df: DataFrame-like object providing rows to render.\n            alignments: Iterable of text alignment values for columns.\n            color: Rich color name used for borders/index style.\n\n        Returns:\n            A :class:`~rich.table.Table` configured for display.\n        \"\"\"\n        table = Table(\n            title=None,\n            box=RICH_TABLE_BOX,\n            show_header=True,\n            header_style='bold',\n            border_style=color,\n        )\n\n        # Index column\n        table.add_column(justify='right', style=color)\n\n        # Data columns\n        for col, align in zip(df, alignments, strict=False):\n            table.add_column(str(col), justify=align, no_wrap=False)\n\n        # Rows\n        for idx, row_values in df.iterrows():\n            formatted_row = [self._format_value(v) for v in row_values]\n            table.add_row(str(idx), *formatted_row)\n\n        return table\n\n    def _update_display(self, table: Table, display_handle) -&gt; None:\n        \"\"\"Single, consistent update path for Jupyter and terminal.\n\n        - With a handle that has ``update()``:\n          * If it's an IPython DisplayHandle, export to HTML and\n            update.\n          * Otherwise, treat it as a terminal/live-like handle and\n            update with the Rich renderable.\n        - Without a handle, print once to the shared console.\n\n        Args:\n            table: Rich :class:`~rich.table.Table` to display.\n            display_handle: Optional environment-specific handle for\n                in-place updates (IPython or terminal live).\n        \"\"\"\n        # Handle with update() method\n        if display_handle is not None and hasattr(display_handle, 'update'):\n            # IPython DisplayHandle path\n            if can_use_ipython_display(display_handle) and HTML is not None:\n                try:\n                    html = self._to_html(table)\n                    display_handle.update(HTML(html))\n                    return\n                except Exception as err:\n                    log.debug(f'Rich to HTML DisplayHandle update failed: {err!r}')\n\n            # Assume terminal/live-like handle\n            else:\n                try:\n                    display_handle.update(table)\n                    return\n                except Exception as err:\n                    log.debug(f'Rich live handle update failed: {err!r}')\n\n        # Normal print to console\n        console = ConsoleManager.get()\n        console.print(table)\n\n    def render(\n        self,\n        alignments,\n        df,\n        display_handle=None,\n    ) -&gt; Any:\n        \"\"\"Render a styled table using Rich.\n\n        Args:\n            alignments: Iterable of text-align values for columns.\n            df: Index-aware DataFrame to render.\n            display_handle: Optional environment handle for in-place\n                updates.\n        \"\"\"\n        color = self._rich_border_color\n        table = self._build_table(df, alignments, color)\n        self._update_display(table, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tablers.rich.RichTableBackend.render","title":"<code>render(alignments, df, display_handle=None)</code>","text":"<p>Render a styled table using Rich.</p> <p>Parameters:</p> Name Type Description Default <code>alignments</code> <p>Iterable of text-align values for columns.</p> required <code>df</code> <p>Index-aware DataFrame to render.</p> required <code>display_handle</code> <p>Optional environment handle for in-place updates.</p> <code>None</code> Source code in <code>src/easydiffraction/display/tablers/rich.py</code> <pre><code>def render(\n    self,\n    alignments,\n    df,\n    display_handle=None,\n) -&gt; Any:\n    \"\"\"Render a styled table using Rich.\n\n    Args:\n        alignments: Iterable of text-align values for columns.\n        df: Index-aware DataFrame to render.\n        display_handle: Optional environment handle for in-place\n            updates.\n    \"\"\"\n    color = self._rich_border_color\n    table = self._build_table(df, alignments, color)\n    self._update_display(table, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables","title":"<code>tables</code>","text":"<p>Table rendering engines: console (Rich) and Jupyter (pandas).</p>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableEngineEnum","title":"<code>TableEngineEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>class TableEngineEnum(str, Enum):\n    RICH = 'rich'\n    PANDAS = 'pandas'\n\n    @classmethod\n    def default(cls) -&gt; 'TableEngineEnum':\n        \"\"\"Select default engine based on environment.\n\n        Returns Pandas when running in Jupyter, otherwise Rich.\n        \"\"\"\n        if in_jupyter():\n            log.debug('Setting default table engine to Pandas for Jupyter')\n            return cls.PANDAS\n        log.debug('Setting default table engine to Rich for console')\n        return cls.RICH\n\n    def description(self) -&gt; str:\n        if self is TableEngineEnum.RICH:\n            return 'Console rendering with Rich'\n        elif self is TableEngineEnum.PANDAS:\n            return 'Jupyter DataFrame rendering with Pandas'\n        return ''\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableEngineEnum.default","title":"<code>default()</code>  <code>classmethod</code>","text":"<p>Select default engine based on environment.</p> <p>Returns Pandas when running in Jupyter, otherwise Rich.</p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>@classmethod\ndef default(cls) -&gt; 'TableEngineEnum':\n    \"\"\"Select default engine based on environment.\n\n    Returns Pandas when running in Jupyter, otherwise Rich.\n    \"\"\"\n    if in_jupyter():\n        log.debug('Setting default table engine to Pandas for Jupyter')\n        return cls.PANDAS\n    log.debug('Setting default table engine to Rich for console')\n    return cls.RICH\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableRenderer","title":"<code>TableRenderer</code>","text":"<p>               Bases: <code>RendererBase</code></p> <p>Renderer for tabular data with selectable engines (singleton).</p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>class TableRenderer(RendererBase):\n    \"\"\"Renderer for tabular data with selectable engines (singleton).\"\"\"\n\n    @classmethod\n    def _factory(cls) -&gt; RendererFactoryBase:\n        return TableRendererFactory\n\n    @classmethod\n    def _default_engine(cls) -&gt; str:\n        \"\"\"Default engine derived from TableEngineEnum.\"\"\"\n        return TableEngineEnum.default().value\n\n    def show_config(self) -&gt; None:\n        \"\"\"Display minimal configuration for this renderer.\"\"\"\n        headers = [\n            ('Parameter', 'left'),\n            ('Value', 'left'),\n        ]\n        rows = [['engine', self._engine]]\n        df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n        console.paragraph('Current tabler configuration')\n        TableRenderer.get().render(df)\n\n    def render(self, df, display_handle: Any | None = None) -&gt; Any:\n        \"\"\"Render a DataFrame as a table using the active backend.\n\n        Args:\n            df: DataFrame with a two-level column index where the\n                second level provides per-column alignment.\n            display_handle: Optional environment-specific handle used\n                to update an existing output area in-place (e.g., an\n                IPython DisplayHandle or a terminal live handle).\n\n        Returns:\n            Backend-specific return value (usually ``None``).\n        \"\"\"\n        # Work on a copy to avoid mutating the original DataFrame\n        df = df.copy()\n\n        # Force starting index from 1\n        df.index += 1\n\n        # Extract column alignments\n        alignments = df.columns.get_level_values(1)\n\n        # Remove alignments from df (Keep only the first index level)\n        df.columns = df.columns.get_level_values(0)\n\n        return self._backend.render(alignments, df, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableRenderer.render","title":"<code>render(df, display_handle=None)</code>","text":"<p>Render a DataFrame as a table using the active backend.</p> <p>Parameters:</p> Name Type Description Default <code>df</code> <p>DataFrame with a two-level column index where the second level provides per-column alignment.</p> required <code>display_handle</code> <code>Any | None</code> <p>Optional environment-specific handle used to update an existing output area in-place (e.g., an IPython DisplayHandle or a terminal live handle).</p> <code>None</code> <p>Returns:</p> Type Description <code>Any</code> <p>Backend-specific return value (usually <code>None</code>).</p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>def render(self, df, display_handle: Any | None = None) -&gt; Any:\n    \"\"\"Render a DataFrame as a table using the active backend.\n\n    Args:\n        df: DataFrame with a two-level column index where the\n            second level provides per-column alignment.\n        display_handle: Optional environment-specific handle used\n            to update an existing output area in-place (e.g., an\n            IPython DisplayHandle or a terminal live handle).\n\n    Returns:\n        Backend-specific return value (usually ``None``).\n    \"\"\"\n    # Work on a copy to avoid mutating the original DataFrame\n    df = df.copy()\n\n    # Force starting index from 1\n    df.index += 1\n\n    # Extract column alignments\n    alignments = df.columns.get_level_values(1)\n\n    # Remove alignments from df (Keep only the first index level)\n    df.columns = df.columns.get_level_values(0)\n\n    return self._backend.render(alignments, df, display_handle)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableRenderer.show_config","title":"<code>show_config()</code>","text":"<p>Display minimal configuration for this renderer.</p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>def show_config(self) -&gt; None:\n    \"\"\"Display minimal configuration for this renderer.\"\"\"\n    headers = [\n        ('Parameter', 'left'),\n        ('Value', 'left'),\n    ]\n    rows = [['engine', self._engine]]\n    df = pd.DataFrame(rows, columns=pd.MultiIndex.from_tuples(headers))\n    console.paragraph('Current tabler configuration')\n    TableRenderer.get().render(df)\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.tables.TableRendererFactory","title":"<code>TableRendererFactory</code>","text":"<p>               Bases: <code>RendererFactoryBase</code></p> <p>Factory for creating tabler instances.</p> Source code in <code>src/easydiffraction/display/tables.py</code> <pre><code>class TableRendererFactory(RendererFactoryBase):\n    \"\"\"Factory for creating tabler instances.\"\"\"\n\n    @classmethod\n    def _registry(cls) -&gt; dict:\n        \"\"\"Build registry, adapting available engines to the\n        environment.\n\n        - In Jupyter: expose both 'rich' and 'pandas'.\n        - In terminal: expose only 'rich' (pandas is notebook-only).\n        \"\"\"\n        base = {\n            TableEngineEnum.RICH.value: {\n                'description': TableEngineEnum.RICH.description(),\n                'class': RichTableBackend,\n            }\n        }\n        if in_jupyter():\n            base[TableEngineEnum.PANDAS.value] = {\n                'description': TableEngineEnum.PANDAS.description(),\n                'class': PandasTableBackend,\n            }\n        return base\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.utils","title":"<code>utils</code>","text":""},{"location":"api-reference/display/#easydiffraction.display.utils.JupyterScrollManager","title":"<code>JupyterScrollManager</code>","text":"<p>Ensures that Jupyter output cells are not scrollable (applied once).</p> Source code in <code>src/easydiffraction/display/utils.py</code> <pre><code>class JupyterScrollManager:\n    \"\"\"Ensures that Jupyter output cells are not scrollable (applied\n    once).\n    \"\"\"\n\n    _applied: ClassVar[bool] = False\n\n    @classmethod\n    def disable_jupyter_scroll(cls) -&gt; None:\n        \"\"\"Inject CSS to prevent output cells from being scrollable.\"\"\"\n        if cls._applied or not in_jupyter() or display is None or HTML is None:\n            return\n\n        css = \"\"\"\n        &lt;style&gt;\n        /* Disable scrolling (already present) */\n        .jp-OutputArea,\n        .jp-OutputArea-child,\n        .jp-OutputArea-scrollable,\n        .output_scroll {\n            max-height: none !important;\n            overflow-y: visible !important;\n        }\n        \"\"\"\n        try:\n            display(HTML(css))\n            cls._applied = True\n        except Exception:\n            log.debug('Failed to inject Jupyter CSS to disable scrolling.')\n</code></pre>"},{"location":"api-reference/display/#easydiffraction.display.utils.JupyterScrollManager.disable_jupyter_scroll","title":"<code>disable_jupyter_scroll()</code>  <code>classmethod</code>","text":"<p>Inject CSS to prevent output cells from being scrollable.</p> Source code in <code>src/easydiffraction/display/utils.py</code> <pre><code>@classmethod\ndef disable_jupyter_scroll(cls) -&gt; None:\n    \"\"\"Inject CSS to prevent output cells from being scrollable.\"\"\"\n    if cls._applied or not in_jupyter() or display is None or HTML is None:\n        return\n\n    css = \"\"\"\n    &lt;style&gt;\n    /* Disable scrolling (already present) */\n    .jp-OutputArea,\n    .jp-OutputArea-child,\n    .jp-OutputArea-scrollable,\n    .output_scroll {\n        max-height: none !important;\n        overflow-y: visible !important;\n    }\n    \"\"\"\n    try:\n        display(HTML(css))\n        cls._applied = True\n    except Exception:\n        log.debug('Failed to inject Jupyter CSS to disable scrolling.')\n</code></pre>"},{"location":"api-reference/experiments/","title":"experiments","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments","title":"<code>experiments</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories","title":"<code>categories</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background","title":"<code>background</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.base","title":"<code>base</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.base.BackgroundBase","title":"<code>BackgroundBase</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Abstract base for background subcategories in experiments.</p> <p>Concrete implementations provide parameterized background models and compute background intensities on the experiment grid.</p> Source code in <code>src/easydiffraction/experiments/categories/background/base.py</code> <pre><code>class BackgroundBase(CategoryCollection):\n    \"\"\"Abstract base for background subcategories in experiments.\n\n    Concrete implementations provide parameterized background models and\n    compute background intensities on the experiment grid.\n    \"\"\"\n\n    # TODO: Consider moving to CategoryCollection\n    @abstractmethod\n    def show(self) -&gt; None:\n        \"\"\"Print a human-readable view of background components.\"\"\"\n        pass\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.base.BackgroundBase.show","title":"<code>show()</code>  <code>abstractmethod</code>","text":"<p>Print a human-readable view of background components.</p> Source code in <code>src/easydiffraction/experiments/categories/background/base.py</code> <pre><code>@abstractmethod\ndef show(self) -&gt; None:\n    \"\"\"Print a human-readable view of background components.\"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.chebyshev","title":"<code>chebyshev</code>","text":"<p>Chebyshev polynomial background model.</p> <p>Provides a collection of polynomial terms and evaluation helpers.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.chebyshev.ChebyshevPolynomialBackground","title":"<code>ChebyshevPolynomialBackground</code>","text":"<p>               Bases: <code>BackgroundBase</code></p> Source code in <code>src/easydiffraction/experiments/categories/background/chebyshev.py</code> <pre><code>class ChebyshevPolynomialBackground(BackgroundBase):\n    _description: str = 'Chebyshev polynomial background'\n\n    def __init__(self):\n        super().__init__(item_type=PolynomialTerm)\n\n    def _update(self, called_by_minimizer=False):\n        \"\"\"Evaluate polynomial background over x data.\"\"\"\n        del called_by_minimizer\n\n        data = self._parent.data\n        x = data.x\n\n        if not self._items:\n            log.warning('No background points found. Setting background to zero.')\n            data._set_bkg(np.zeros_like(x))\n            return\n\n        u = (x - x.min()) / (x.max() - x.min()) * 2 - 1\n        coefs = [term.coef.value for term in self._items]\n\n        y = chebval(u, coefs)\n        data._set_bkg(y)\n\n    def show(self) -&gt; None:\n        \"\"\"Print a table of polynomial orders and coefficients.\"\"\"\n        columns_headers: List[str] = ['Order', 'Coefficient']\n        columns_alignment = ['left', 'left']\n        columns_data: List[List[Union[int, float]]] = [\n            [t.order.value, t.coef.value] for t in self._items\n        ]\n\n        console.paragraph('Chebyshev polynomial background terms')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.chebyshev.ChebyshevPolynomialBackground.show","title":"<code>show()</code>","text":"<p>Print a table of polynomial orders and coefficients.</p> Source code in <code>src/easydiffraction/experiments/categories/background/chebyshev.py</code> <pre><code>def show(self) -&gt; None:\n    \"\"\"Print a table of polynomial orders and coefficients.\"\"\"\n    columns_headers: List[str] = ['Order', 'Coefficient']\n    columns_alignment = ['left', 'left']\n    columns_data: List[List[Union[int, float]]] = [\n        [t.order.value, t.coef.value] for t in self._items\n    ]\n\n    console.paragraph('Chebyshev polynomial background terms')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.chebyshev.PolynomialTerm","title":"<code>PolynomialTerm</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Chebyshev polynomial term.</p> <p>New public attribute names: <code>order</code> and <code>coef</code> replacing the longer <code>chebyshev_order</code> / <code>chebyshev_coef</code>. Backward-compatible aliases are kept so existing serialized data / external code does not break immediately. Tests should migrate to the short names.</p> Source code in <code>src/easydiffraction/experiments/categories/background/chebyshev.py</code> <pre><code>class PolynomialTerm(CategoryItem):\n    \"\"\"Chebyshev polynomial term.\n\n    New public attribute names: ``order`` and ``coef`` replacing the\n    longer ``chebyshev_order`` / ``chebyshev_coef``. Backward-compatible\n    aliases are kept so existing serialized data / external code does\n    not break immediately. Tests should migrate to the short names.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        id=None,  # TODO: rename as in the case of data points?\n        order=None,\n        coef=None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._id = StringDescriptor(\n            name='id',\n            description='Identifier for this background polynomial term.',\n            value_spec=AttributeSpec(\n                type_=DataTypes.STRING,\n                value=id,\n                default='0',\n                # TODO: the following pattern is valid for dict key\n                #  (keywords are not checked). CIF label is less strict.\n                #  Do we need conversion between CIF and internal label?\n                content_validator=RegexValidator(pattern=r'^[A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.id',\n                ]\n            ),\n        )\n        self._order = NumericDescriptor(\n            name='order',\n            description='Order used in a Chebyshev polynomial background term',\n            value_spec=AttributeSpec(\n                value=order,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.Chebyshev_order',\n                ]\n            ),\n        )\n        self._coef = Parameter(\n            name='coef',\n            description='Coefficient used in a Chebyshev polynomial background term',\n            value_spec=AttributeSpec(\n                value=coef,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.Chebyshev_coef',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'background'\n        self._identity.category_entry_name = lambda: str(self._id.value)\n\n    @property\n    def id(self):\n        return self._id\n\n    @id.setter\n    def id(self, value):\n        self._id.value = value\n\n    @property\n    def order(self):\n        return self._order\n\n    @order.setter\n    def order(self, value):\n        self._order.value = value\n\n    @property\n    def coef(self):\n        return self._coef\n\n    @coef.setter\n    def coef(self, value):\n        self._coef.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.enums","title":"<code>enums</code>","text":"<p>Enumerations for background model types.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.enums.BackgroundTypeEnum","title":"<code>BackgroundTypeEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Supported background model types.</p> Source code in <code>src/easydiffraction/experiments/categories/background/enums.py</code> <pre><code>class BackgroundTypeEnum(str, Enum):\n    \"\"\"Supported background model types.\"\"\"\n\n    LINE_SEGMENT = 'line-segment'\n    CHEBYSHEV = 'chebyshev polynomial'\n\n    @classmethod\n    def default(cls) -&gt; 'BackgroundTypeEnum':\n        \"\"\"Return a default background type.\"\"\"\n        return cls.LINE_SEGMENT\n\n    def description(self) -&gt; str:\n        \"\"\"Human-friendly description for the enum value.\"\"\"\n        if self is BackgroundTypeEnum.LINE_SEGMENT:\n            return 'Linear interpolation between points'\n        elif self is BackgroundTypeEnum.CHEBYSHEV:\n            return 'Chebyshev polynomial background'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.enums.BackgroundTypeEnum.default","title":"<code>default()</code>  <code>classmethod</code>","text":"<p>Return a default background type.</p> Source code in <code>src/easydiffraction/experiments/categories/background/enums.py</code> <pre><code>@classmethod\ndef default(cls) -&gt; 'BackgroundTypeEnum':\n    \"\"\"Return a default background type.\"\"\"\n    return cls.LINE_SEGMENT\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.enums.BackgroundTypeEnum.description","title":"<code>description()</code>","text":"<p>Human-friendly description for the enum value.</p> Source code in <code>src/easydiffraction/experiments/categories/background/enums.py</code> <pre><code>def description(self) -&gt; str:\n    \"\"\"Human-friendly description for the enum value.\"\"\"\n    if self is BackgroundTypeEnum.LINE_SEGMENT:\n        return 'Linear interpolation between points'\n    elif self is BackgroundTypeEnum.CHEBYSHEV:\n        return 'Chebyshev polynomial background'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.factory","title":"<code>factory</code>","text":"<p>Background collection entry point (public facade).</p> <p>End users should import Background classes from this module. Internals live under the package <code>easydiffraction.experiments.category_collections.background_types</code> and are re-exported here for a stable and readable API.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.factory.BackgroundFactory","title":"<code>BackgroundFactory</code>","text":"<p>Create background collections by type.</p> Source code in <code>src/easydiffraction/experiments/categories/background/factory.py</code> <pre><code>class BackgroundFactory:\n    \"\"\"Create background collections by type.\"\"\"\n\n    BT = BackgroundTypeEnum\n\n    @classmethod\n    def _supported_map(cls) -&gt; dict:\n        \"\"\"Return mapping of enum values to concrete background\n        classes.\n        \"\"\"\n        # Lazy import to avoid circulars\n        from easydiffraction.experiments.categories.background.chebyshev import (\n            ChebyshevPolynomialBackground,\n        )\n        from easydiffraction.experiments.categories.background.line_segment import (\n            LineSegmentBackground,\n        )\n\n        return {\n            cls.BT.LINE_SEGMENT: LineSegmentBackground,\n            cls.BT.CHEBYSHEV: ChebyshevPolynomialBackground,\n        }\n\n    @classmethod\n    def create(\n        cls,\n        background_type: Optional[BackgroundTypeEnum] = None,\n    ) -&gt; BackgroundBase:\n        \"\"\"Instantiate a background collection of requested type.\n\n        If type is None, the default enum value is used.\n        \"\"\"\n        if background_type is None:\n            background_type = BackgroundTypeEnum.default()\n\n        supported = cls._supported_map()\n        if background_type not in supported:\n            supported_types = list(supported.keys())\n            raise ValueError(\n                f\"Unsupported background type: '{background_type}'. \"\n                f'Supported background types: {[bt.value for bt in supported_types]}'\n            )\n\n        background_class = supported[background_type]\n        return background_class()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.factory.BackgroundFactory.create","title":"<code>create(background_type=None)</code>  <code>classmethod</code>","text":"<p>Instantiate a background collection of requested type.</p> <p>If type is None, the default enum value is used.</p> Source code in <code>src/easydiffraction/experiments/categories/background/factory.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    background_type: Optional[BackgroundTypeEnum] = None,\n) -&gt; BackgroundBase:\n    \"\"\"Instantiate a background collection of requested type.\n\n    If type is None, the default enum value is used.\n    \"\"\"\n    if background_type is None:\n        background_type = BackgroundTypeEnum.default()\n\n    supported = cls._supported_map()\n    if background_type not in supported:\n        supported_types = list(supported.keys())\n        raise ValueError(\n            f\"Unsupported background type: '{background_type}'. \"\n            f'Supported background types: {[bt.value for bt in supported_types]}'\n        )\n\n    background_class = supported[background_type]\n    return background_class()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.line_segment","title":"<code>line_segment</code>","text":"<p>Line-segment background model.</p> <p>Interpolate user-specified points to form a background curve.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.line_segment.LineSegment","title":"<code>LineSegment</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Single background control point for interpolation.</p> Source code in <code>src/easydiffraction/experiments/categories/background/line_segment.py</code> <pre><code>class LineSegment(CategoryItem):\n    \"\"\"Single background control point for interpolation.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        id=None,  # TODO: rename as in the case of data points?\n        x=None,\n        y=None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._id = StringDescriptor(\n            name='id',\n            description='Identifier for this background line segment.',\n            value_spec=AttributeSpec(\n                type_=DataTypes.STRING,\n                value=id,\n                default='0',\n                # TODO: the following pattern is valid for dict key\n                #  (keywords are not checked). CIF label is less strict.\n                #  Do we need conversion between CIF and internal label?\n                content_validator=RegexValidator(pattern=r'^[A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.id',\n                ]\n            ),\n        )\n        self._x = NumericDescriptor(\n            name='x',\n            description=(\n                'X-coordinates used to create many straight-line segments '\n                'representing the background in a calculated diffractogram.'\n            ),\n            value_spec=AttributeSpec(\n                value=x,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.line_segment_X',\n                    '_pd_background_line_segment_X',\n                ]\n            ),\n        )\n        self._y = Parameter(\n            name='y',  # TODO: rename to intensity\n            description=(\n                'Intensity used to create many straight-line segments '\n                'representing the background in a calculated diffractogram'\n            ),\n            value_spec=AttributeSpec(\n                value=y,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),  # TODO: rename to intensity\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_background.line_segment_intensity',\n                    '_pd_background_line_segment_intensity',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'background'\n        self._identity.category_entry_name = lambda: str(self._id.value)\n\n    @property\n    def id(self):\n        return self._id\n\n    @id.setter\n    def id(self, value):\n        self._id.value = value\n\n    @property\n    def x(self):\n        return self._x\n\n    @x.setter\n    def x(self, value):\n        self._x.value = value\n\n    @property\n    def y(self):\n        return self._y\n\n    @y.setter\n    def y(self, value):\n        self._y.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.line_segment.LineSegmentBackground","title":"<code>LineSegmentBackground</code>","text":"<p>               Bases: <code>BackgroundBase</code></p> Source code in <code>src/easydiffraction/experiments/categories/background/line_segment.py</code> <pre><code>class LineSegmentBackground(BackgroundBase):\n    _description: str = 'Linear interpolation between points'\n\n    def __init__(self):\n        super().__init__(item_type=LineSegment)\n\n    def _update(self, called_by_minimizer=False):\n        \"\"\"Interpolate background points over x data.\"\"\"\n        del called_by_minimizer\n\n        data = self._parent.data\n        x = data.x\n\n        if not self._items:\n            log.debug('No background points found. Setting background to zero.')\n            data._set_bkg(np.zeros_like(x))\n            return\n\n        segments_x = np.array([point.x.value for point in self._items])\n        segments_y = np.array([point.y.value for point in self._items])\n        interp_func = interp1d(\n            segments_x,\n            segments_y,\n            kind='linear',\n            bounds_error=False,\n            fill_value=(segments_y[0], segments_y[-1]),\n        )\n\n        y = interp_func(x)\n        data._set_bkg(y)\n\n    def show(self) -&gt; None:\n        \"\"\"Print a table of control points (x, intensity).\"\"\"\n        columns_headers: List[str] = ['X', 'Intensity']\n        columns_alignment = ['left', 'left']\n        columns_data: List[List[float]] = [[p.x.value, p.y.value] for p in self._items]\n\n        console.paragraph('Line-segment background points')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.background.line_segment.LineSegmentBackground.show","title":"<code>show()</code>","text":"<p>Print a table of control points (x, intensity).</p> Source code in <code>src/easydiffraction/experiments/categories/background/line_segment.py</code> <pre><code>def show(self) -&gt; None:\n    \"\"\"Print a table of control points (x, intensity).\"\"\"\n    columns_headers: List[str] = ['X', 'Intensity']\n    columns_alignment = ['left', 'left']\n    columns_data: List[List[float]] = [[p.x.value, p.y.value] for p in self._items]\n\n    console.paragraph('Line-segment background points')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.excluded_regions","title":"<code>excluded_regions</code>","text":"<p>Exclude ranges of x from fitting/plotting (masked regions).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.excluded_regions.ExcludedRegion","title":"<code>ExcludedRegion</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Closed interval [start, end] to be excluded.</p> Source code in <code>src/easydiffraction/experiments/categories/excluded_regions.py</code> <pre><code>class ExcludedRegion(CategoryItem):\n    \"\"\"Closed interval [start, end] to be excluded.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        id=None,  # TODO: rename as in the case of data points?\n        start=None,\n        end=None,\n    ):\n        super().__init__()\n\n        # TODO: Add point_id as for the background\n        self._id = StringDescriptor(\n            name='id',\n            description='Identifier for this excluded region.',\n            value_spec=AttributeSpec(\n                type_=DataTypes.STRING,\n                value=id,\n                default='0',\n                # TODO: the following pattern is valid for dict key\n                #  (keywords are not checked). CIF label is less strict.\n                #  Do we need conversion between CIF and internal label?\n                content_validator=RegexValidator(pattern=r'^[A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_excluded_region.id',\n                ]\n            ),\n        )\n        self._start = NumericDescriptor(\n            name='start',\n            description='Start of the excluded region.',\n            value_spec=AttributeSpec(\n                value=start,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_excluded_region.start',\n                ]\n            ),\n        )\n        self._end = NumericDescriptor(\n            name='end',\n            description='End of the excluded region.',\n            value_spec=AttributeSpec(\n                value=end,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_excluded_region.end',\n                ]\n            ),\n        )\n        # self._category_entry_attr_name = f'{start}-{end}'\n        # self._category_entry_attr_name = self.start.name\n        # self.name = self.start.value\n        self._identity.category_code = 'excluded_regions'\n        self._identity.category_entry_name = lambda: str(self._id.value)\n\n    @property\n    def id(self):\n        return self._id\n\n    @id.setter\n    def id(self, value):\n        self._id.value = value\n\n    @property\n    def start(self) -&gt; NumericDescriptor:\n        return self._start\n\n    @start.setter\n    def start(self, value: float):\n        self._start.value = value\n\n    @property\n    def end(self) -&gt; NumericDescriptor:\n        return self._end\n\n    @end.setter\n    def end(self, value: float):\n        self._end.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.excluded_regions.ExcludedRegions","title":"<code>ExcludedRegions</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of ExcludedRegion instances.</p> <p>Excluded regions define closed intervals [start, end] on the x-axis that are to be excluded from calculations and, as a result, from fitting and plotting.</p> Source code in <code>src/easydiffraction/experiments/categories/excluded_regions.py</code> <pre><code>class ExcludedRegions(CategoryCollection):\n    \"\"\"Collection of ExcludedRegion instances.\n\n    Excluded regions define closed intervals [start, end] on the x-axis\n    that are to be excluded from calculations and, as a result, from\n    fitting and plotting.\n    \"\"\"\n\n    def __init__(self):\n        super().__init__(item_type=ExcludedRegion)\n\n    def _update(self, called_by_minimizer=False):\n        del called_by_minimizer\n\n        data = self._parent.data\n        x = data.all_x\n\n        # Start with a mask of all False (nothing excluded yet)\n        combined_mask = np.full_like(x, fill_value=False, dtype=bool)\n\n        # Combine masks for all excluded regions\n        for region in self.values():\n            start = region.start.value\n            end = region.end.value\n            region_mask = (x &gt;= start) &amp; (x &lt;= end)\n            combined_mask |= region_mask\n\n        # Invert mask, as refinement status is opposite of excluded\n        inverted_mask = ~combined_mask\n\n        # Set refinement status in the data object\n        data._set_calc_status(inverted_mask)\n\n    def show(self) -&gt; None:\n        \"\"\"Print a table of excluded [start, end] intervals.\"\"\"\n        # TODO: Consider moving this to the base class\n        #  to avoid code duplication with implementations in Background,\n        #  etc. Consider using parameter names as column headers\n        columns_headers: List[str] = ['start', 'end']\n        columns_alignment = ['left', 'left']\n        columns_data: List[List[float]] = [[r.start.value, r.end.value] for r in self._items]\n\n        console.paragraph('Excluded regions')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.excluded_regions.ExcludedRegions.show","title":"<code>show()</code>","text":"<p>Print a table of excluded [start, end] intervals.</p> Source code in <code>src/easydiffraction/experiments/categories/excluded_regions.py</code> <pre><code>def show(self) -&gt; None:\n    \"\"\"Print a table of excluded [start, end] intervals.\"\"\"\n    # TODO: Consider moving this to the base class\n    #  to avoid code duplication with implementations in Background,\n    #  etc. Consider using parameter names as column headers\n    columns_headers: List[str] = ['start', 'end']\n    columns_alignment = ['left', 'left']\n    columns_data: List[List[float]] = [[r.start.value, r.end.value] for r in self._items]\n\n    console.paragraph('Excluded regions')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type","title":"<code>experiment_type</code>","text":"<p>Experiment type descriptor (form, beam, probe, scattering).</p> <p>This lightweight container stores the categorical attributes defining an experiment configuration and handles CIF serialization via <code>CifHandler</code>.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type.ExperimentType","title":"<code>ExperimentType</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Container of categorical attributes defining experiment flavor.</p> <p>Parameters:</p> Name Type Description Default <code>sample_form</code> <p>Powder or Single crystal.</p> <code>None</code> <code>beam_mode</code> <p>Constant wavelength (CW) or time-of-flight (TOF).</p> <code>None</code> <code>radiation_probe</code> <p>Neutrons or X-rays.</p> <code>None</code> <code>scattering_type</code> <p>Bragg or Total.</p> <code>None</code> Source code in <code>src/easydiffraction/experiments/categories/experiment_type.py</code> <pre><code>class ExperimentType(CategoryItem):\n    \"\"\"Container of categorical attributes defining experiment flavor.\n\n    Args:\n        sample_form: Powder or Single crystal.\n        beam_mode: Constant wavelength (CW) or time-of-flight (TOF).\n        radiation_probe: Neutrons or X-rays.\n        scattering_type: Bragg or Total.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        sample_form=None,\n        beam_mode=None,\n        radiation_probe=None,\n        scattering_type=None,\n    ):\n        super().__init__()\n\n        self._sample_form: StringDescriptor = StringDescriptor(\n            name='sample_form',\n            description='Specifies whether the diffraction data corresponds to '\n            'powder diffraction or single crystal diffraction',\n            value_spec=AttributeSpec(\n                value=sample_form,\n                type_=DataTypes.STRING,\n                default=SampleFormEnum.default().value,\n                content_validator=MembershipValidator(\n                    allowed=[member.value for member in SampleFormEnum]\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_expt_type.sample_form',\n                ]\n            ),\n        )\n\n        self._beam_mode: StringDescriptor = StringDescriptor(\n            name='beam_mode',\n            description='Defines whether the measurement is performed with a '\n            'constant wavelength (CW) or time-of-flight (TOF) method',\n            value_spec=AttributeSpec(\n                value=beam_mode,\n                type_=DataTypes.STRING,\n                default=BeamModeEnum.default().value,\n                content_validator=MembershipValidator(\n                    allowed=[member.value for member in BeamModeEnum]\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_expt_type.beam_mode',\n                ]\n            ),\n        )\n        self._radiation_probe: StringDescriptor = StringDescriptor(\n            name='radiation_probe',\n            description='Specifies whether the measurement uses neutrons or X-rays',\n            value_spec=AttributeSpec(\n                value=radiation_probe,\n                type_=DataTypes.STRING,\n                default=RadiationProbeEnum.default().value,\n                content_validator=MembershipValidator(\n                    allowed=[member.value for member in RadiationProbeEnum]\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_expt_type.radiation_probe',\n                ]\n            ),\n        )\n        self._scattering_type: StringDescriptor = StringDescriptor(\n            name='scattering_type',\n            description='Specifies whether the experiment uses Bragg scattering '\n            '(for conventional structure refinement) or total scattering '\n            '(for pair distribution function analysis - PDF)',\n            value_spec=AttributeSpec(\n                value=scattering_type,\n                type_=DataTypes.STRING,\n                default=ScatteringTypeEnum.default().value,\n                content_validator=MembershipValidator(\n                    allowed=[member.value for member in ScatteringTypeEnum]\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_expt_type.scattering_type',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'expt_type'\n\n    @property\n    def sample_form(self):\n        \"\"\"Sample form descriptor (powder/single crystal).\"\"\"\n        return self._sample_form\n\n    @sample_form.setter\n    def sample_form(self, value):\n        \"\"\"Set sample form value.\"\"\"\n        self._sample_form.value = value\n\n    @property\n    def beam_mode(self):\n        \"\"\"Beam mode descriptor (CW/TOF).\"\"\"\n        return self._beam_mode\n\n    @beam_mode.setter\n    def beam_mode(self, value):\n        \"\"\"Set beam mode value.\"\"\"\n        self._beam_mode.value = value\n\n    @property\n    def radiation_probe(self):\n        \"\"\"Radiation probe descriptor (neutrons/X-rays).\"\"\"\n        return self._radiation_probe\n\n    @radiation_probe.setter\n    def radiation_probe(self, value):\n        \"\"\"Set radiation probe value.\"\"\"\n        self._radiation_probe.value = value\n\n    @property\n    def scattering_type(self):\n        \"\"\"Scattering type descriptor (Bragg/Total).\"\"\"\n        return self._scattering_type\n\n    @scattering_type.setter\n    def scattering_type(self, value):\n        \"\"\"Set scattering type value.\"\"\"\n        self._scattering_type.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type.ExperimentType.beam_mode","title":"<code>beam_mode</code>  <code>property</code> <code>writable</code>","text":"<p>Beam mode descriptor (CW/TOF).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type.ExperimentType.radiation_probe","title":"<code>radiation_probe</code>  <code>property</code> <code>writable</code>","text":"<p>Radiation probe descriptor (neutrons/X-rays).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type.ExperimentType.sample_form","title":"<code>sample_form</code>  <code>property</code> <code>writable</code>","text":"<p>Sample form descriptor (powder/single crystal).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.experiment_type.ExperimentType.scattering_type","title":"<code>scattering_type</code>  <code>property</code> <code>writable</code>","text":"<p>Scattering type descriptor (Bragg/Total).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument","title":"<code>instrument</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.base","title":"<code>base</code>","text":"<p>Instrument category base definitions for CWL/TOF instruments.</p> <p>This module provides the shared parent used by concrete instrument implementations under the instrument category.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.base.InstrumentBase","title":"<code>InstrumentBase</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Base class for instrument category items.</p> <p>This class sets the common <code>category_code</code> and is used as a base for concrete CWL/TOF instrument definitions.</p> Source code in <code>src/easydiffraction/experiments/categories/instrument/base.py</code> <pre><code>class InstrumentBase(CategoryItem):\n    \"\"\"Base class for instrument category items.\n\n    This class sets the common ``category_code`` and is used as a base\n    for concrete CWL/TOF instrument definitions.\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        \"\"\"Initialize instrument base and set category code.\"\"\"\n        super().__init__()\n        self._identity.category_code = 'instrument'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.base.InstrumentBase.__init__","title":"<code>__init__()</code>","text":"<p>Initialize instrument base and set category code.</p> Source code in <code>src/easydiffraction/experiments/categories/instrument/base.py</code> <pre><code>def __init__(self) -&gt; None:\n    \"\"\"Initialize instrument base and set category code.\"\"\"\n    super().__init__()\n    self._identity.category_code = 'instrument'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.cwl","title":"<code>cwl</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.cwl.CwlInstrument","title":"<code>CwlInstrument</code>","text":"<p>               Bases: <code>InstrumentBase</code></p> Source code in <code>src/easydiffraction/experiments/categories/instrument/cwl.py</code> <pre><code>class CwlInstrument(InstrumentBase):\n    def __init__(\n        self,\n        *,\n        setup_wavelength=None,\n        calib_twotheta_offset=None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._setup_wavelength: Parameter = Parameter(\n            name='wavelength',\n            description='Incident neutron or X-ray wavelength',\n            value_spec=AttributeSpec(\n                value=setup_wavelength,\n                type_=DataTypes.NUMERIC,\n                default=1.5406,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.wavelength',\n                ]\n            ),\n        )\n        self._calib_twotheta_offset: Parameter = Parameter(\n            name='twotheta_offset',\n            description='Instrument misalignment offset',\n            value_spec=AttributeSpec(\n                value=calib_twotheta_offset,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.2theta_offset',\n                ]\n            ),\n        )\n\n    @property\n    def setup_wavelength(self):\n        \"\"\"Incident wavelength parameter (\u00c5).\"\"\"\n        return self._setup_wavelength\n\n    @setup_wavelength.setter\n    def setup_wavelength(self, value):\n        \"\"\"Set incident wavelength value (\u00c5).\"\"\"\n        self._setup_wavelength.value = value\n\n    @property\n    def calib_twotheta_offset(self):\n        \"\"\"Instrument misalignment two-theta offset (deg).\"\"\"\n        return self._calib_twotheta_offset\n\n    @calib_twotheta_offset.setter\n    def calib_twotheta_offset(self, value):\n        \"\"\"Set two-theta offset value (deg).\"\"\"\n        self._calib_twotheta_offset.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.cwl.CwlInstrument.calib_twotheta_offset","title":"<code>calib_twotheta_offset</code>  <code>property</code> <code>writable</code>","text":"<p>Instrument misalignment two-theta offset (deg).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.cwl.CwlInstrument.setup_wavelength","title":"<code>setup_wavelength</code>  <code>property</code> <code>writable</code>","text":"<p>Incident wavelength parameter (\u00c5).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.factory","title":"<code>factory</code>","text":"<p>Factory for instrument category items.</p> <p>Provides a stable entry point for creating instrument objects from the experiment's scattering type and beam mode.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.factory.InstrumentFactory","title":"<code>InstrumentFactory</code>","text":"<p>Create instrument instances for supported modes.</p> <p>The factory hides implementation details and lazy-loads concrete instrument classes to avoid circular imports.</p> Source code in <code>src/easydiffraction/experiments/categories/instrument/factory.py</code> <pre><code>class InstrumentFactory:\n    \"\"\"Create instrument instances for supported modes.\n\n    The factory hides implementation details and lazy-loads concrete\n    instrument classes to avoid circular imports.\n    \"\"\"\n\n    ST = ScatteringTypeEnum\n    BM = BeamModeEnum\n\n    @classmethod\n    def _supported_map(cls) -&gt; dict:\n        # Lazy import to avoid circulars\n        from easydiffraction.experiments.categories.instrument.cwl import CwlInstrument\n        from easydiffraction.experiments.categories.instrument.tof import TofInstrument\n\n        return {\n            cls.ST.BRAGG: {\n                cls.BM.CONSTANT_WAVELENGTH: CwlInstrument,\n                cls.BM.TIME_OF_FLIGHT: TofInstrument,\n            }\n        }\n\n    @classmethod\n    def create(\n        cls,\n        scattering_type: Optional[ScatteringTypeEnum] = None,\n        beam_mode: Optional[BeamModeEnum] = None,\n    ) -&gt; InstrumentBase:\n        if beam_mode is None:\n            beam_mode = BeamModeEnum.default()\n        if scattering_type is None:\n            scattering_type = ScatteringTypeEnum.default()\n\n        supported = cls._supported_map()\n\n        supported_scattering_types = list(supported.keys())\n        if scattering_type not in supported_scattering_types:\n            raise ValueError(\n                f\"Unsupported scattering type: '{scattering_type}'.\\n \"\n                f'Supported scattering types: {supported_scattering_types}'\n            )\n\n        supported_beam_modes = list(supported[scattering_type].keys())\n        if beam_mode not in supported_beam_modes:\n            raise ValueError(\n                f\"Unsupported beam mode: '{beam_mode}' for scattering type: \"\n                f\"'{scattering_type}'.\\n \"\n                f'Supported beam modes: {supported_beam_modes}'\n            )\n\n        instrument_class: Type[InstrumentBase] = supported[scattering_type][beam_mode]\n        return instrument_class()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof","title":"<code>tof</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument","title":"<code>TofInstrument</code>","text":"<p>               Bases: <code>InstrumentBase</code></p> Source code in <code>src/easydiffraction/experiments/categories/instrument/tof.py</code> <pre><code>class TofInstrument(InstrumentBase):\n    def __init__(\n        self,\n        *,\n        setup_twotheta_bank=None,\n        calib_d_to_tof_offset=None,\n        calib_d_to_tof_linear=None,\n        calib_d_to_tof_quad=None,\n        calib_d_to_tof_recip=None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._setup_twotheta_bank: Parameter = Parameter(\n            name='twotheta_bank',\n            description='Detector bank position',\n            value_spec=AttributeSpec(\n                value=setup_twotheta_bank,\n                type_=DataTypes.NUMERIC,\n                default=150.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.2theta_bank',\n                ]\n            ),\n        )\n        self._calib_d_to_tof_offset: Parameter = Parameter(\n            name='d_to_tof_offset',\n            description='TOF offset',\n            value_spec=AttributeSpec(\n                value=calib_d_to_tof_offset,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.d_to_tof_offset',\n                ]\n            ),\n        )\n        self._calib_d_to_tof_linear: Parameter = Parameter(\n            name='d_to_tof_linear',\n            description='TOF linear conversion',\n            value_spec=AttributeSpec(\n                value=calib_d_to_tof_linear,\n                type_=DataTypes.NUMERIC,\n                default=10000.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s/\u212b',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.d_to_tof_linear',\n                ]\n            ),\n        )\n        self._calib_d_to_tof_quad: Parameter = Parameter(\n            name='d_to_tof_quad',\n            description='TOF quadratic correction',\n            value_spec=AttributeSpec(\n                value=calib_d_to_tof_quad,\n                type_=DataTypes.NUMERIC,\n                default=-0.00001,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s/\u212b\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.d_to_tof_quad',\n                ]\n            ),\n        )\n        self._calib_d_to_tof_recip: Parameter = Parameter(\n            name='d_to_tof_recip',\n            description='TOF reciprocal velocity correction',\n            value_spec=AttributeSpec(\n                value=calib_d_to_tof_recip,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s\u00b7\u212b',\n            cif_handler=CifHandler(\n                names=[\n                    '_instr.d_to_tof_recip',\n                ]\n            ),\n        )\n\n    @property\n    def setup_twotheta_bank(self):\n        \"\"\"Detector bank two-theta position (deg).\"\"\"\n        return self._setup_twotheta_bank\n\n    @setup_twotheta_bank.setter\n    def setup_twotheta_bank(self, value):\n        \"\"\"Set detector bank two-theta position (deg).\"\"\"\n        self._setup_twotheta_bank.value = value\n\n    @property\n    def calib_d_to_tof_offset(self):\n        \"\"\"TOF offset calibration parameter (\u00b5s).\"\"\"\n        return self._calib_d_to_tof_offset\n\n    @calib_d_to_tof_offset.setter\n    def calib_d_to_tof_offset(self, value):\n        \"\"\"Set TOF offset (\u00b5s).\"\"\"\n        self._calib_d_to_tof_offset.value = value\n\n    @property\n    def calib_d_to_tof_linear(self):\n        \"\"\"Linear d to TOF conversion coefficient (\u00b5s/\u00c5).\"\"\"\n        return self._calib_d_to_tof_linear\n\n    @calib_d_to_tof_linear.setter\n    def calib_d_to_tof_linear(self, value):\n        \"\"\"Set linear d to TOF coefficient (\u00b5s/\u00c5).\"\"\"\n        self._calib_d_to_tof_linear.value = value\n\n    @property\n    def calib_d_to_tof_quad(self):\n        \"\"\"Quadratic d to TOF correction coefficient (\u00b5s/\u00c5\u00b2).\"\"\"\n        return self._calib_d_to_tof_quad\n\n    @calib_d_to_tof_quad.setter\n    def calib_d_to_tof_quad(self, value):\n        \"\"\"Set quadratic d to TOF correction (\u00b5s/\u00c5\u00b2).\"\"\"\n        self._calib_d_to_tof_quad.value = value\n\n    @property\n    def calib_d_to_tof_recip(self):\n        \"\"\"Reciprocal-velocity d to TOF correction (\u00b5s\u00b7\u00c5).\"\"\"\n        return self._calib_d_to_tof_recip\n\n    @calib_d_to_tof_recip.setter\n    def calib_d_to_tof_recip(self, value):\n        \"\"\"Set reciprocal-velocity d to TOF correction (\u00b5s\u00b7\u00c5).\"\"\"\n        self._calib_d_to_tof_recip.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument.calib_d_to_tof_linear","title":"<code>calib_d_to_tof_linear</code>  <code>property</code> <code>writable</code>","text":"<p>Linear d to TOF conversion coefficient (\u00b5s/\u00c5).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument.calib_d_to_tof_offset","title":"<code>calib_d_to_tof_offset</code>  <code>property</code> <code>writable</code>","text":"<p>TOF offset calibration parameter (\u00b5s).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument.calib_d_to_tof_quad","title":"<code>calib_d_to_tof_quad</code>  <code>property</code> <code>writable</code>","text":"<p>Quadratic d to TOF correction coefficient (\u00b5s/\u00c5\u00b2).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument.calib_d_to_tof_recip","title":"<code>calib_d_to_tof_recip</code>  <code>property</code> <code>writable</code>","text":"<p>Reciprocal-velocity d to TOF correction (\u00b5s\u00b7\u00c5).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.instrument.tof.TofInstrument.setup_twotheta_bank","title":"<code>setup_twotheta_bank</code>  <code>property</code> <code>writable</code>","text":"<p>Detector bank two-theta position (deg).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases","title":"<code>linked_phases</code>","text":"<p>Linked phases allow combining phases with scale factors.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases.LinkedPhase","title":"<code>LinkedPhase</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Link to a phase by id with a scale factor.</p> Source code in <code>src/easydiffraction/experiments/categories/linked_phases.py</code> <pre><code>class LinkedPhase(CategoryItem):\n    \"\"\"Link to a phase by id with a scale factor.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        id=None,  # TODO: need new name instead of id\n        scale=None,\n    ):\n        super().__init__()\n\n        self._id = StringDescriptor(\n            name='id',\n            description='Identifier of the linked phase.',\n            value_spec=AttributeSpec(\n                value=id,\n                type_=DataTypes.STRING,\n                default='Si',\n                content_validator=RegexValidator(pattern=r'^[A-Za-z_][A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_phase_block.id',\n                ]\n            ),\n        )\n        self._scale = Parameter(\n            name='scale',\n            description='Scale factor of the linked phase.',\n            value_spec=AttributeSpec(\n                value=scale,\n                type_=DataTypes.NUMERIC,\n                default=1.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_pd_phase_block.scale',\n                ]\n            ),\n        )\n        self._identity.category_code = 'linked_phases'\n        self._identity.category_entry_name = lambda: str(self.id.value)\n\n    @property\n    def id(self) -&gt; StringDescriptor:\n        \"\"\"Identifier of the linked phase.\"\"\"\n        return self._id\n\n    @id.setter\n    def id(self, value: str):\n        \"\"\"Set the linked phase identifier.\"\"\"\n        self._id.value = value\n\n    @property\n    def scale(self) -&gt; Parameter:\n        \"\"\"Scale factor parameter.\"\"\"\n        return self._scale\n\n    @scale.setter\n    def scale(self, value: float):\n        \"\"\"Set scale factor value.\"\"\"\n        self._scale.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases.LinkedPhase.id","title":"<code>id</code>  <code>property</code> <code>writable</code>","text":"<p>Identifier of the linked phase.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases.LinkedPhase.scale","title":"<code>scale</code>  <code>property</code> <code>writable</code>","text":"<p>Scale factor parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases.LinkedPhases","title":"<code>LinkedPhases</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of LinkedPhase instances.</p> Source code in <code>src/easydiffraction/experiments/categories/linked_phases.py</code> <pre><code>class LinkedPhases(CategoryCollection):\n    \"\"\"Collection of LinkedPhase instances.\"\"\"\n\n    def __init__(self):\n        \"\"\"Create an empty collection of linked phases.\"\"\"\n        super().__init__(item_type=LinkedPhase)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.linked_phases.LinkedPhases.__init__","title":"<code>__init__()</code>","text":"<p>Create an empty collection of linked phases.</p> Source code in <code>src/easydiffraction/experiments/categories/linked_phases.py</code> <pre><code>def __init__(self):\n    \"\"\"Create an empty collection of linked phases.\"\"\"\n    super().__init__(item_type=LinkedPhase)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak","title":"<code>peak</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.base","title":"<code>base</code>","text":"<p>Base class for peak profile categories.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.base.PeakBase","title":"<code>PeakBase</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Base class for peak profile categories.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/base.py</code> <pre><code>class PeakBase(CategoryItem):\n    \"\"\"Base class for peak profile categories.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._identity.category_code = 'peak'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl","title":"<code>cwl</code>","text":"<p>Constant-wavelength peak profile classes.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl.CwlPseudoVoigt","title":"<code>CwlPseudoVoigt</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>CwlBroadeningMixin</code></p> <p>Constant-wavelength pseudo-Voigt peak shape.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl.py</code> <pre><code>class CwlPseudoVoigt(\n    PeakBase,\n    CwlBroadeningMixin,\n):\n    \"\"\"Constant-wavelength pseudo-Voigt peak shape.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_constant_wavelength_broadening()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl.CwlSplitPseudoVoigt","title":"<code>CwlSplitPseudoVoigt</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>CwlBroadeningMixin</code>, <code>EmpiricalAsymmetryMixin</code></p> <p>Split pseudo-Voigt (empirical asymmetry) for CWL mode.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl.py</code> <pre><code>class CwlSplitPseudoVoigt(\n    PeakBase,\n    CwlBroadeningMixin,\n    EmpiricalAsymmetryMixin,\n):\n    \"\"\"Split pseudo-Voigt (empirical asymmetry) for CWL mode.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_constant_wavelength_broadening()\n        self._add_empirical_asymmetry()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl.CwlThompsonCoxHastings","title":"<code>CwlThompsonCoxHastings</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>CwlBroadeningMixin</code>, <code>FcjAsymmetryMixin</code></p> <p>Thompson\u2013Cox\u2013Hastings with FCJ asymmetry for CWL mode.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl.py</code> <pre><code>class CwlThompsonCoxHastings(\n    PeakBase,\n    CwlBroadeningMixin,\n    FcjAsymmetryMixin,\n):\n    \"\"\"Thompson\u2013Cox\u2013Hastings with FCJ asymmetry for CWL mode.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_constant_wavelength_broadening()\n        self._add_fcj_asymmetry()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins","title":"<code>cwl_mixins</code>","text":"<p>Constant-wavelength (CWL) peak-profile mixins.</p> <p>This module provides mixins that add broadening and asymmetry parameters for constant-wavelength powder diffraction peak profiles. They are composed into concrete peak classes elsewhere.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin","title":"<code>CwlBroadeningMixin</code>","text":"<p>Mixin that adds CWL Gaussian and Lorentz broadening parameters.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl_mixins.py</code> <pre><code>class CwlBroadeningMixin:\n    \"\"\"Mixin that adds CWL Gaussian and Lorentz broadening\n    parameters.\n    \"\"\"\n\n    # TODO: Rename to cwl. Check other mixins for naming consistency.\n    def _add_constant_wavelength_broadening(self) -&gt; None:\n        \"\"\"Create CWL broadening parameters and attach them to the\n        class.\n\n        Defines Gaussian (U, V, W) and Lorentz (X, Y) terms\n        often used in the TCH formulation. Values are stored as\n        ``Parameter`` objects.\n        \"\"\"\n        self._broad_gauss_u: Parameter = Parameter(\n            name='broad_gauss_u',\n            description='Gaussian broadening coefficient (dependent on '\n            'sample size and instrument resolution)',\n            value_spec=AttributeSpec(\n                value=0.01,\n                type_=DataTypes.NUMERIC,\n                default=0.01,\n                content_validator=RangeValidator(),\n            ),\n            units='deg\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_gauss_u',\n                ]\n            ),\n        )\n        self._broad_gauss_v: Parameter = Parameter(\n            name='broad_gauss_v',\n            description='Gaussian broadening coefficient (instrumental broadening contribution)',\n            value_spec=AttributeSpec(\n                value=-0.01,\n                type_=DataTypes.NUMERIC,\n                default=-0.01,\n                content_validator=RangeValidator(),\n            ),\n            units='deg\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_gauss_v',\n                ]\n            ),\n        )\n        self._broad_gauss_w: Parameter = Parameter(\n            name='broad_gauss_w',\n            description='Gaussian broadening coefficient (instrumental broadening contribution)',\n            value_spec=AttributeSpec(\n                value=0.02,\n                type_=DataTypes.NUMERIC,\n                default=0.02,\n                content_validator=RangeValidator(),\n            ),\n            units='deg\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_gauss_w',\n                ]\n            ),\n        )\n        self._broad_lorentz_x: Parameter = Parameter(\n            name='broad_lorentz_x',\n            description='Lorentzian broadening coefficient (dependent on sample strain effects)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_lorentz_x',\n                ]\n            ),\n        )\n        self._broad_lorentz_y: Parameter = Parameter(\n            name='broad_lorentz_y',\n            description='Lorentzian broadening coefficient (dependent on '\n            'microstructural defects and strain)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_lorentz_y',\n                ]\n            ),\n        )\n\n    @property\n    def broad_gauss_u(self) -&gt; Parameter:\n        \"\"\"Get Gaussian U broadening parameter.\"\"\"\n        return self._broad_gauss_u\n\n    @broad_gauss_u.setter\n    def broad_gauss_u(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian U broadening parameter.\"\"\"\n        self._broad_gauss_u.value = value\n\n    @property\n    def broad_gauss_v(self) -&gt; Parameter:\n        \"\"\"Get Gaussian V broadening parameter.\"\"\"\n        return self._broad_gauss_v\n\n    @broad_gauss_v.setter\n    def broad_gauss_v(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian V broadening parameter.\"\"\"\n        self._broad_gauss_v.value = value\n\n    @property\n    def broad_gauss_w(self) -&gt; Parameter:\n        \"\"\"Get Gaussian W broadening parameter.\"\"\"\n        return self._broad_gauss_w\n\n    @broad_gauss_w.setter\n    def broad_gauss_w(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian W broadening parameter.\"\"\"\n        self._broad_gauss_w.value = value\n\n    @property\n    def broad_lorentz_x(self) -&gt; Parameter:\n        \"\"\"Get Lorentz X broadening parameter.\"\"\"\n        return self._broad_lorentz_x\n\n    @broad_lorentz_x.setter\n    def broad_lorentz_x(self, value: float) -&gt; None:\n        \"\"\"Set Lorentz X broadening parameter.\"\"\"\n        self._broad_lorentz_x.value = value\n\n    @property\n    def broad_lorentz_y(self) -&gt; Parameter:\n        \"\"\"Get Lorentz Y broadening parameter.\"\"\"\n        return self._broad_lorentz_y\n\n    @broad_lorentz_y.setter\n    def broad_lorentz_y(self, value: float) -&gt; None:\n        \"\"\"Set Lorentz Y broadening parameter.\"\"\"\n        self._broad_lorentz_y.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin.broad_gauss_u","title":"<code>broad_gauss_u</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian U broadening parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin.broad_gauss_v","title":"<code>broad_gauss_v</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian V broadening parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin.broad_gauss_w","title":"<code>broad_gauss_w</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian W broadening parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin.broad_lorentz_x","title":"<code>broad_lorentz_x</code>  <code>property</code> <code>writable</code>","text":"<p>Get Lorentz X broadening parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.CwlBroadeningMixin.broad_lorentz_y","title":"<code>broad_lorentz_y</code>  <code>property</code> <code>writable</code>","text":"<p>Get Lorentz Y broadening parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.EmpiricalAsymmetryMixin","title":"<code>EmpiricalAsymmetryMixin</code>","text":"<p>Mixin that adds empirical CWL peak asymmetry parameters.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl_mixins.py</code> <pre><code>class EmpiricalAsymmetryMixin:\n    \"\"\"Mixin that adds empirical CWL peak asymmetry parameters.\"\"\"\n\n    def _add_empirical_asymmetry(self) -&gt; None:\n        \"\"\"Create empirical asymmetry parameters p1..p4.\"\"\"\n        self._asym_empir_1: Parameter = Parameter(\n            name='asym_empir_1',\n            description='Empirical asymmetry coefficient p1',\n            value_spec=AttributeSpec(\n                value=0.1,\n                type_=DataTypes.NUMERIC,\n                default=0.1,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_empir_1',\n                ]\n            ),\n        )\n        self._asym_empir_2: Parameter = Parameter(\n            name='asym_empir_2',\n            description='Empirical asymmetry coefficient p2',\n            value_spec=AttributeSpec(\n                value=0.2,\n                type_=DataTypes.NUMERIC,\n                default=0.2,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_empir_2',\n                ]\n            ),\n        )\n        self._asym_empir_3: Parameter = Parameter(\n            name='asym_empir_3',\n            description='Empirical asymmetry coefficient p3',\n            value_spec=AttributeSpec(\n                value=0.3,\n                type_=DataTypes.NUMERIC,\n                default=0.3,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_empir_3',\n                ]\n            ),\n        )\n        self._asym_empir_4: Parameter = Parameter(\n            name='asym_empir_4',\n            description='Empirical asymmetry coefficient p4',\n            value_spec=AttributeSpec(\n                value=0.4,\n                type_=DataTypes.NUMERIC,\n                default=0.4,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_empir_4',\n                ]\n            ),\n        )\n\n    @property\n    def asym_empir_1(self) -&gt; Parameter:\n        \"\"\"Get empirical asymmetry coefficient p1.\"\"\"\n        return self._asym_empir_1\n\n    @asym_empir_1.setter\n    def asym_empir_1(self, value: float) -&gt; None:\n        \"\"\"Set empirical asymmetry coefficient p1.\"\"\"\n        self._asym_empir_1.value = value\n\n    @property\n    def asym_empir_2(self) -&gt; Parameter:\n        \"\"\"Get empirical asymmetry coefficient p2.\"\"\"\n        return self._asym_empir_2\n\n    @asym_empir_2.setter\n    def asym_empir_2(self, value: float) -&gt; None:\n        \"\"\"Set empirical asymmetry coefficient p2.\"\"\"\n        self._asym_empir_2.value = value\n\n    @property\n    def asym_empir_3(self) -&gt; Parameter:\n        \"\"\"Get empirical asymmetry coefficient p3.\"\"\"\n        return self._asym_empir_3\n\n    @asym_empir_3.setter\n    def asym_empir_3(self, value: float) -&gt; None:\n        \"\"\"Set empirical asymmetry coefficient p3.\"\"\"\n        self._asym_empir_3.value = value\n\n    @property\n    def asym_empir_4(self) -&gt; Parameter:\n        \"\"\"Get empirical asymmetry coefficient p4.\"\"\"\n        return self._asym_empir_4\n\n    @asym_empir_4.setter\n    def asym_empir_4(self, value: float) -&gt; None:\n        \"\"\"Set empirical asymmetry coefficient p4.\"\"\"\n        self._asym_empir_4.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.EmpiricalAsymmetryMixin.asym_empir_1","title":"<code>asym_empir_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get empirical asymmetry coefficient p1.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.EmpiricalAsymmetryMixin.asym_empir_2","title":"<code>asym_empir_2</code>  <code>property</code> <code>writable</code>","text":"<p>Get empirical asymmetry coefficient p2.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.EmpiricalAsymmetryMixin.asym_empir_3","title":"<code>asym_empir_3</code>  <code>property</code> <code>writable</code>","text":"<p>Get empirical asymmetry coefficient p3.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.EmpiricalAsymmetryMixin.asym_empir_4","title":"<code>asym_empir_4</code>  <code>property</code> <code>writable</code>","text":"<p>Get empirical asymmetry coefficient p4.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.FcjAsymmetryMixin","title":"<code>FcjAsymmetryMixin</code>","text":"<p>Mixin that adds Finger\u2013Cox\u2013Jephcoat (FCJ) asymmetry params.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/cwl_mixins.py</code> <pre><code>class FcjAsymmetryMixin:\n    \"\"\"Mixin that adds Finger\u2013Cox\u2013Jephcoat (FCJ) asymmetry params.\"\"\"\n\n    def _add_fcj_asymmetry(self) -&gt; None:\n        \"\"\"Create FCJ asymmetry parameters.\"\"\"\n        self._asym_fcj_1: Parameter = Parameter(\n            name='asym_fcj_1',\n            description='Finger-Cox-Jephcoat asymmetry parameter 1',\n            value_spec=AttributeSpec(\n                value=0.01,\n                type_=DataTypes.NUMERIC,\n                default=0.01,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_fcj_1',\n                ]\n            ),\n        )\n        self._asym_fcj_2: Parameter = Parameter(\n            name='asym_fcj_2',\n            description='Finger-Cox-Jephcoat asymmetry parameter 2',\n            value_spec=AttributeSpec(\n                value=0.02,\n                type_=DataTypes.NUMERIC,\n                default=0.02,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_fcj_2',\n                ]\n            ),\n        )\n\n    @property\n    def asym_fcj_1(self) -&gt; Parameter:\n        \"\"\"Get FCJ asymmetry parameter 1.\"\"\"\n        return self._asym_fcj_1\n\n    @asym_fcj_1.setter\n    def asym_fcj_1(self, value: float) -&gt; None:\n        \"\"\"Set FCJ asymmetry parameter 1.\"\"\"\n        self._asym_fcj_1.value = value\n\n    @property\n    def asym_fcj_2(self) -&gt; Parameter:\n        \"\"\"Get FCJ asymmetry parameter 2.\"\"\"\n        return self._asym_fcj_2\n\n    @asym_fcj_2.setter\n    def asym_fcj_2(self, value: float) -&gt; None:\n        \"\"\"Set FCJ asymmetry parameter 2.\"\"\"\n        self._asym_fcj_2.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.FcjAsymmetryMixin.asym_fcj_1","title":"<code>asym_fcj_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get FCJ asymmetry parameter 1.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.cwl_mixins.FcjAsymmetryMixin.asym_fcj_2","title":"<code>asym_fcj_2</code>  <code>property</code> <code>writable</code>","text":"<p>Get FCJ asymmetry parameter 2.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.factory","title":"<code>factory</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.factory.PeakFactory","title":"<code>PeakFactory</code>","text":"<p>Factory for creating peak profile objects.</p> <p>Lazily imports implementations to avoid circular dependencies and selects the appropriate class based on scattering type, beam mode and requested profile type.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/factory.py</code> <pre><code>class PeakFactory:\n    \"\"\"Factory for creating peak profile objects.\n\n    Lazily imports implementations to avoid circular dependencies and\n    selects the appropriate class based on scattering type, beam mode\n    and requested profile type.\n    \"\"\"\n\n    ST = ScatteringTypeEnum\n    BM = BeamModeEnum\n    PPT = PeakProfileTypeEnum\n    _supported = None  # type: ignore[var-annotated]\n\n    @classmethod\n    def _supported_map(cls):\n        \"\"\"Return nested mapping of supported profile classes.\n\n        Structure:\n            ``{ScatteringType: {BeamMode: {ProfileType: Class}}}``.\n        \"\"\"\n        # Lazy import to avoid circular imports between\n        # base and cw/tof/pdf modules\n        if cls._supported is None:\n            from easydiffraction.experiments.categories.peak.cwl import CwlPseudoVoigt as CwPv\n            from easydiffraction.experiments.categories.peak.cwl import (\n                CwlSplitPseudoVoigt as CwSpv,\n            )\n            from easydiffraction.experiments.categories.peak.cwl import (\n                CwlThompsonCoxHastings as CwTch,\n            )\n            from easydiffraction.experiments.categories.peak.tof import TofPseudoVoigt as TofPv\n            from easydiffraction.experiments.categories.peak.tof import (\n                TofPseudoVoigtBackToBack as TofBtb,\n            )\n            from easydiffraction.experiments.categories.peak.tof import (\n                TofPseudoVoigtIkedaCarpenter as TofIc,\n            )\n            from easydiffraction.experiments.categories.peak.total import (\n                TotalGaussianDampedSinc as PdfGds,\n            )\n\n            cls._supported = {\n                cls.ST.BRAGG: {\n                    cls.BM.CONSTANT_WAVELENGTH: {\n                        cls.PPT.PSEUDO_VOIGT: CwPv,\n                        cls.PPT.SPLIT_PSEUDO_VOIGT: CwSpv,\n                        cls.PPT.THOMPSON_COX_HASTINGS: CwTch,\n                    },\n                    cls.BM.TIME_OF_FLIGHT: {\n                        cls.PPT.PSEUDO_VOIGT: TofPv,\n                        cls.PPT.PSEUDO_VOIGT_IKEDA_CARPENTER: TofIc,\n                        cls.PPT.PSEUDO_VOIGT_BACK_TO_BACK: TofBtb,\n                    },\n                },\n                cls.ST.TOTAL: {\n                    cls.BM.CONSTANT_WAVELENGTH: {\n                        cls.PPT.GAUSSIAN_DAMPED_SINC: PdfGds,\n                    },\n                    cls.BM.TIME_OF_FLIGHT: {\n                        cls.PPT.GAUSSIAN_DAMPED_SINC: PdfGds,\n                    },\n                },\n            }\n        return cls._supported\n\n    @classmethod\n    def create(\n        cls,\n        scattering_type: Optional[ScatteringTypeEnum] = None,\n        beam_mode: Optional[BeamModeEnum] = None,\n        profile_type: Optional[PeakProfileTypeEnum] = None,\n    ):\n        \"\"\"Instantiate a peak profile for the given configuration.\n\n        Args:\n            scattering_type: Bragg or Total. Defaults to library\n                default.\n            beam_mode: CW or TOF. Defaults to library default.\n            profile_type: Concrete profile within the mode. If omitted,\n                a sensible default is chosen based on the other args.\n\n        Returns:\n            A newly created peak profile object.\n\n        Raises:\n            ValueError: If a requested option is not supported.\n        \"\"\"\n        if beam_mode is None:\n            beam_mode = BeamModeEnum.default()\n        if scattering_type is None:\n            scattering_type = ScatteringTypeEnum.default()\n        if profile_type is None:\n            profile_type = PeakProfileTypeEnum.default(scattering_type, beam_mode)\n        supported = cls._supported_map()\n        supported_scattering_types = list(supported.keys())\n        if scattering_type not in supported_scattering_types:\n            raise ValueError(\n                f\"Unsupported scattering type: '{scattering_type}'.\\n\"\n                f'Supported scattering types: {supported_scattering_types}'\n            )\n\n        supported_beam_modes = list(supported[scattering_type].keys())\n        if beam_mode not in supported_beam_modes:\n            raise ValueError(\n                f\"Unsupported beam mode: '{beam_mode}' for scattering type: \"\n                f\"'{scattering_type}'.\\n Supported beam modes: '{supported_beam_modes}'\"\n            )\n\n        supported_profile_types = list(supported[scattering_type][beam_mode].keys())\n        if profile_type not in supported_profile_types:\n            raise ValueError(\n                f\"Unsupported profile type '{profile_type}' for beam mode '{beam_mode}'.\\n\"\n                f'Supported profile types: {supported_profile_types}'\n            )\n\n        peak_class = supported[scattering_type][beam_mode][profile_type]\n        peak_obj = peak_class()\n\n        return peak_obj\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.factory.PeakFactory.create","title":"<code>create(scattering_type=None, beam_mode=None, profile_type=None)</code>  <code>classmethod</code>","text":"<p>Instantiate a peak profile for the given configuration.</p> <p>Parameters:</p> Name Type Description Default <code>scattering_type</code> <code>Optional[ScatteringTypeEnum]</code> <p>Bragg or Total. Defaults to library default.</p> <code>None</code> <code>beam_mode</code> <code>Optional[BeamModeEnum]</code> <p>CW or TOF. Defaults to library default.</p> <code>None</code> <code>profile_type</code> <code>Optional[PeakProfileTypeEnum]</code> <p>Concrete profile within the mode. If omitted, a sensible default is chosen based on the other args.</p> <code>None</code> <p>Returns:</p> Type Description <p>A newly created peak profile object.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If a requested option is not supported.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/factory.py</code> <pre><code>@classmethod\ndef create(\n    cls,\n    scattering_type: Optional[ScatteringTypeEnum] = None,\n    beam_mode: Optional[BeamModeEnum] = None,\n    profile_type: Optional[PeakProfileTypeEnum] = None,\n):\n    \"\"\"Instantiate a peak profile for the given configuration.\n\n    Args:\n        scattering_type: Bragg or Total. Defaults to library\n            default.\n        beam_mode: CW or TOF. Defaults to library default.\n        profile_type: Concrete profile within the mode. If omitted,\n            a sensible default is chosen based on the other args.\n\n    Returns:\n        A newly created peak profile object.\n\n    Raises:\n        ValueError: If a requested option is not supported.\n    \"\"\"\n    if beam_mode is None:\n        beam_mode = BeamModeEnum.default()\n    if scattering_type is None:\n        scattering_type = ScatteringTypeEnum.default()\n    if profile_type is None:\n        profile_type = PeakProfileTypeEnum.default(scattering_type, beam_mode)\n    supported = cls._supported_map()\n    supported_scattering_types = list(supported.keys())\n    if scattering_type not in supported_scattering_types:\n        raise ValueError(\n            f\"Unsupported scattering type: '{scattering_type}'.\\n\"\n            f'Supported scattering types: {supported_scattering_types}'\n        )\n\n    supported_beam_modes = list(supported[scattering_type].keys())\n    if beam_mode not in supported_beam_modes:\n        raise ValueError(\n            f\"Unsupported beam mode: '{beam_mode}' for scattering type: \"\n            f\"'{scattering_type}'.\\n Supported beam modes: '{supported_beam_modes}'\"\n        )\n\n    supported_profile_types = list(supported[scattering_type][beam_mode].keys())\n    if profile_type not in supported_profile_types:\n        raise ValueError(\n            f\"Unsupported profile type '{profile_type}' for beam mode '{beam_mode}'.\\n\"\n            f'Supported profile types: {supported_profile_types}'\n        )\n\n    peak_class = supported[scattering_type][beam_mode][profile_type]\n    peak_obj = peak_class()\n\n    return peak_obj\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof","title":"<code>tof</code>","text":"<p>Time-of-flight peak profile classes.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof.TofPseudoVoigt","title":"<code>TofPseudoVoigt</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>TofBroadeningMixin</code></p> <p>Time-of-flight pseudo-Voigt peak shape.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/tof.py</code> <pre><code>class TofPseudoVoigt(\n    PeakBase,\n    TofBroadeningMixin,\n):\n    \"\"\"Time-of-flight pseudo-Voigt peak shape.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_time_of_flight_broadening()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof.TofPseudoVoigtBackToBack","title":"<code>TofPseudoVoigtBackToBack</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>TofBroadeningMixin</code>, <code>IkedaCarpenterAsymmetryMixin</code></p> <p>TOF back-to-back pseudo-Voigt with asymmetry.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/tof.py</code> <pre><code>class TofPseudoVoigtBackToBack(\n    PeakBase,\n    TofBroadeningMixin,\n    IkedaCarpenterAsymmetryMixin,\n):\n    \"\"\"TOF back-to-back pseudo-Voigt with asymmetry.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_time_of_flight_broadening()\n        self._add_ikeda_carpenter_asymmetry()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof.TofPseudoVoigtIkedaCarpenter","title":"<code>TofPseudoVoigtIkedaCarpenter</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>TofBroadeningMixin</code>, <code>IkedaCarpenterAsymmetryMixin</code></p> <p>TOF pseudo-Voigt with Ikeda\u2013Carpenter asymmetry.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/tof.py</code> <pre><code>class TofPseudoVoigtIkedaCarpenter(\n    PeakBase,\n    TofBroadeningMixin,\n    IkedaCarpenterAsymmetryMixin,\n):\n    \"\"\"TOF pseudo-Voigt with Ikeda\u2013Carpenter asymmetry.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_time_of_flight_broadening()\n        self._add_ikeda_carpenter_asymmetry()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins","title":"<code>tof_mixins</code>","text":"<p>Time-of-flight (TOF) peak-profile mixins.</p> <p>Defines mixins that add Gaussian/Lorentz broadening, mixing, and Ikeda\u2013Carpenter asymmetry parameters used by TOF peak shapes.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.IkedaCarpenterAsymmetryMixin","title":"<code>IkedaCarpenterAsymmetryMixin</code>","text":"<p>Mixin that adds Ikeda\u2013Carpenter asymmetry parameters.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/tof_mixins.py</code> <pre><code>class IkedaCarpenterAsymmetryMixin:\n    \"\"\"Mixin that adds Ikeda\u2013Carpenter asymmetry parameters.\"\"\"\n\n    def _add_ikeda_carpenter_asymmetry(self) -&gt; None:\n        \"\"\"Create Ikeda\u2013Carpenter asymmetry parameters alpha_0 and\n        alpha_1.\n        \"\"\"\n        self._asym_alpha_0: Parameter = Parameter(\n            name='asym_alpha_0',\n            description='Ikeda-Carpenter asymmetry parameter \u03b1\u2080',\n            value_spec=AttributeSpec(\n                value=0.01,\n                type_=DataTypes.NUMERIC,\n                default=0.01,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_alpha_0',\n                ]\n            ),\n        )\n        self._asym_alpha_1: Parameter = Parameter(\n            name='asym_alpha_1',\n            description='Ikeda-Carpenter asymmetry parameter \u03b1\u2081',\n            value_spec=AttributeSpec(\n                value=0.02,\n                type_=DataTypes.NUMERIC,\n                default=0.02,\n                content_validator=RangeValidator(),\n            ),\n            units='',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.asym_alpha_1',\n                ]\n            ),\n        )\n\n    @property\n    def asym_alpha_0(self) -&gt; Parameter:\n        \"\"\"Get Ikeda\u2013Carpenter asymmetry alpha_0.\"\"\"\n        return self._asym_alpha_0\n\n    @asym_alpha_0.setter\n    def asym_alpha_0(self, value: float) -&gt; None:\n        \"\"\"Set Ikeda\u2013Carpenter asymmetry alpha_0.\"\"\"\n        self._asym_alpha_0.value = value\n\n    @property\n    def asym_alpha_1(self) -&gt; Parameter:\n        \"\"\"Get Ikeda\u2013Carpenter asymmetry alpha_1.\"\"\"\n        return self._asym_alpha_1\n\n    @asym_alpha_1.setter\n    def asym_alpha_1(self, value: float) -&gt; None:\n        \"\"\"Set Ikeda\u2013Carpenter asymmetry alpha_1.\"\"\"\n        self._asym_alpha_1.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.IkedaCarpenterAsymmetryMixin.asym_alpha_0","title":"<code>asym_alpha_0</code>  <code>property</code> <code>writable</code>","text":"<p>Get Ikeda\u2013Carpenter asymmetry alpha_0.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.IkedaCarpenterAsymmetryMixin.asym_alpha_1","title":"<code>asym_alpha_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get Ikeda\u2013Carpenter asymmetry alpha_1.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin","title":"<code>TofBroadeningMixin</code>","text":"<p>Mixin that adds TOF Gaussian/Lorentz broadening and mixing terms.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/tof_mixins.py</code> <pre><code>class TofBroadeningMixin:\n    \"\"\"Mixin that adds TOF Gaussian/Lorentz broadening and mixing\n    terms.\n    \"\"\"\n\n    def _add_time_of_flight_broadening(self) -&gt; None:\n        \"\"\"Create TOF broadening and mixing parameters.\"\"\"\n        self._broad_gauss_sigma_0: Parameter = Parameter(\n            name='gauss_sigma_0',\n            description='Gaussian broadening coefficient (instrumental resolution)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.gauss_sigma_0',\n                ]\n            ),\n        )\n        self._broad_gauss_sigma_1: Parameter = Parameter(\n            name='gauss_sigma_1',\n            description='Gaussian broadening coefficient (dependent on d-spacing)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s/\u212b',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.gauss_sigma_1',\n                ]\n            ),\n        )\n        self._broad_gauss_sigma_2: Parameter = Parameter(\n            name='gauss_sigma_2',\n            description='Gaussian broadening coefficient (instrument-dependent term)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s\u00b2/\u212b\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.gauss_sigma_2',\n                ]\n            ),\n        )\n        self._broad_lorentz_gamma_0: Parameter = Parameter(\n            name='lorentz_gamma_0',\n            description='Lorentzian broadening coefficient (dependent on microstrain effects)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.lorentz_gamma_0',\n                ]\n            ),\n        )\n        self._broad_lorentz_gamma_1: Parameter = Parameter(\n            name='lorentz_gamma_1',\n            description='Lorentzian broadening coefficient (dependent on d-spacing)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s/\u212b',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.lorentz_gamma_1',\n                ]\n            ),\n        )\n        self._broad_lorentz_gamma_2: Parameter = Parameter(\n            name='lorentz_gamma_2',\n            description='Lorentzian broadening coefficient (instrument-dependent term)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00b5s\u00b2/\u212b\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.lorentz_gamma_2',\n                ]\n            ),\n        )\n        self._broad_mix_beta_0: Parameter = Parameter(\n            name='mix_beta_0',\n            description='Mixing parameter. Defines the ratio of Gaussian '\n            'to Lorentzian contributions in TOF profiles',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.mix_beta_0',\n                ]\n            ),\n        )\n        self._broad_mix_beta_1: Parameter = Parameter(\n            name='mix_beta_1',\n            description='Mixing parameter. Defines the ratio of Gaussian '\n            'to Lorentzian contributions in TOF profiles',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='deg',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.mix_beta_1',\n                ]\n            ),\n        )\n\n    @property\n    def broad_gauss_sigma_0(self) -&gt; Parameter:\n        \"\"\"Get Gaussian sigma_0 parameter.\"\"\"\n        return self._broad_gauss_sigma_0\n\n    @broad_gauss_sigma_0.setter\n    def broad_gauss_sigma_0(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian sigma_0 parameter.\"\"\"\n        self._broad_gauss_sigma_0.value = value\n\n    @property\n    def broad_gauss_sigma_1(self) -&gt; Parameter:\n        \"\"\"Get Gaussian sigma_1 parameter.\"\"\"\n        return self._broad_gauss_sigma_1\n\n    @broad_gauss_sigma_1.setter\n    def broad_gauss_sigma_1(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian sigma_1 parameter.\"\"\"\n        self._broad_gauss_sigma_1.value = value\n\n    @property\n    def broad_gauss_sigma_2(self) -&gt; Parameter:\n        \"\"\"Get Gaussian sigma_2 parameter.\"\"\"\n        return self._broad_gauss_sigma_2\n\n    @broad_gauss_sigma_2.setter\n    def broad_gauss_sigma_2(self, value: float) -&gt; None:\n        \"\"\"Set Gaussian sigma_2 parameter.\"\"\"\n        self._broad_gauss_sigma_2.value = value\n\n    @property\n    def broad_lorentz_gamma_0(self) -&gt; Parameter:\n        \"\"\"Get Lorentz gamma_0 parameter.\"\"\"\n        return self._broad_lorentz_gamma_0\n\n    @broad_lorentz_gamma_0.setter\n    def broad_lorentz_gamma_0(self, value: float) -&gt; None:\n        \"\"\"Set Lorentz gamma_0 parameter.\"\"\"\n        self._broad_lorentz_gamma_0.value = value\n\n    @property\n    def broad_lorentz_gamma_1(self) -&gt; Parameter:\n        \"\"\"Get Lorentz gamma_1 parameter.\"\"\"\n        return self._broad_lorentz_gamma_1\n\n    @broad_lorentz_gamma_1.setter\n    def broad_lorentz_gamma_1(self, value: float) -&gt; None:\n        \"\"\"Set Lorentz gamma_1 parameter.\"\"\"\n        self._broad_lorentz_gamma_1.value = value\n\n    @property\n    def broad_lorentz_gamma_2(self) -&gt; Parameter:\n        \"\"\"Get Lorentz gamma_2 parameter.\"\"\"\n        return self._broad_lorentz_gamma_2\n\n    @broad_lorentz_gamma_2.setter\n    def broad_lorentz_gamma_2(self, value: float) -&gt; None:\n        \"\"\"Set Lorentz gamma_2 parameter.\"\"\"\n        self._broad_lorentz_gamma_2.value = value\n\n    @property\n    def broad_mix_beta_0(self) -&gt; Parameter:\n        \"\"\"Get mixing parameter beta_0.\"\"\"\n        return self._broad_mix_beta_0\n\n    @broad_mix_beta_0.setter\n    def broad_mix_beta_0(self, value: float) -&gt; None:\n        \"\"\"Set mixing parameter beta_0.\"\"\"\n        self._broad_mix_beta_0.value = value\n\n    @property\n    def broad_mix_beta_1(self) -&gt; Parameter:\n        \"\"\"Get mixing parameter beta_1.\"\"\"\n        return self._broad_mix_beta_1\n\n    @broad_mix_beta_1.setter\n    def broad_mix_beta_1(self, value: float) -&gt; None:\n        \"\"\"Set mixing parameter beta_1.\"\"\"\n        self._broad_mix_beta_1.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_gauss_sigma_0","title":"<code>broad_gauss_sigma_0</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian sigma_0 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_gauss_sigma_1","title":"<code>broad_gauss_sigma_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian sigma_1 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_gauss_sigma_2","title":"<code>broad_gauss_sigma_2</code>  <code>property</code> <code>writable</code>","text":"<p>Get Gaussian sigma_2 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_lorentz_gamma_0","title":"<code>broad_lorentz_gamma_0</code>  <code>property</code> <code>writable</code>","text":"<p>Get Lorentz gamma_0 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_lorentz_gamma_1","title":"<code>broad_lorentz_gamma_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get Lorentz gamma_1 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_lorentz_gamma_2","title":"<code>broad_lorentz_gamma_2</code>  <code>property</code> <code>writable</code>","text":"<p>Get Lorentz gamma_2 parameter.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_mix_beta_0","title":"<code>broad_mix_beta_0</code>  <code>property</code> <code>writable</code>","text":"<p>Get mixing parameter beta_0.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.tof_mixins.TofBroadeningMixin.broad_mix_beta_1","title":"<code>broad_mix_beta_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get mixing parameter beta_1.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total","title":"<code>total</code>","text":"<p>Total-scattering (PDF) peak profile classes.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total.TotalGaussianDampedSinc","title":"<code>TotalGaussianDampedSinc</code>","text":"<p>               Bases: <code>PeakBase</code>, <code>TotalBroadeningMixin</code></p> <p>Gaussian-damped sinc peak for total scattering (PDF).</p> Source code in <code>src/easydiffraction/experiments/categories/peak/total.py</code> <pre><code>class TotalGaussianDampedSinc(\n    PeakBase,\n    TotalBroadeningMixin,\n):\n    \"\"\"Gaussian-damped sinc peak for total scattering (PDF).\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__()\n        self._add_pair_distribution_function_broadening()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins","title":"<code>total_mixins</code>","text":"<p>Total scattering/PDF peak-profile mixins.</p> <p>Adds damping, broadening, sharpening and envelope parameters used in pair distribution function (PDF) modeling.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin","title":"<code>TotalBroadeningMixin</code>","text":"<p>Mixin adding PDF broadening/damping/sharpening parameters.</p> Source code in <code>src/easydiffraction/experiments/categories/peak/total_mixins.py</code> <pre><code>class TotalBroadeningMixin:\n    \"\"\"Mixin adding PDF broadening/damping/sharpening parameters.\"\"\"\n\n    def _add_pair_distribution_function_broadening(self):\n        \"\"\"Create PDF parameters: damp_q, broad_q, cutoff_q,\n        sharp deltas, and particle diameter envelope.\n        \"\"\"\n        self._damp_q: Parameter = Parameter(\n            name='damp_q',\n            description='Instrumental Q-resolution damping factor '\n            '(affects high-r PDF peak amplitude)',\n            value_spec=AttributeSpec(\n                value=0.05,\n                type_=DataTypes.NUMERIC,\n                default=0.05,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5\u207b\u00b9',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.damp_q',\n                ]\n            ),\n        )\n        self._broad_q: Parameter = Parameter(\n            name='broad_q',\n            description='Quadratic PDF peak broadening coefficient '\n            '(thermal and model uncertainty contribution)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5\u207b\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.broad_q',\n                ]\n            ),\n        )\n        self._cutoff_q: Parameter = Parameter(\n            name='cutoff_q',\n            description='Q-value cutoff applied to model PDF for Fourier '\n            'transform (controls real-space resolution)',\n            value_spec=AttributeSpec(\n                value=25.0,\n                type_=DataTypes.NUMERIC,\n                default=25.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5\u207b\u00b9',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.cutoff_q',\n                ]\n            ),\n        )\n        self._sharp_delta_1: Parameter = Parameter(\n            name='sharp_delta_1',\n            description='PDF peak sharpening coefficient (1/r dependence)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.sharp_delta_1',\n                ]\n            ),\n        )\n        self._sharp_delta_2: Parameter = Parameter(\n            name='sharp_delta_2',\n            description='PDF peak sharpening coefficient (1/r\u00b2 dependence)',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.sharp_delta_2',\n                ]\n            ),\n        )\n        self._damp_particle_diameter: Parameter = Parameter(\n            name='damp_particle_diameter',\n            description='Particle diameter for spherical envelope damping correction in PDF',\n            value_spec=AttributeSpec(\n                value=0.0,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(\n                names=[\n                    '_peak.damp_particle_diameter',\n                ]\n            ),\n        )\n\n    @property\n    def damp_q(self) -&gt; Parameter:\n        \"\"\"Get Q-resolution damping factor.\"\"\"\n        return self._damp_q\n\n    @damp_q.setter\n    def damp_q(self, value: float) -&gt; None:\n        \"\"\"Set Q-resolution damping factor.\"\"\"\n        self._damp_q.value = value\n\n    @property\n    def broad_q(self) -&gt; Parameter:\n        \"\"\"Get quadratic PDF broadening coefficient.\"\"\"\n        return self._broad_q\n\n    @broad_q.setter\n    def broad_q(self, value: float) -&gt; None:\n        \"\"\"Set quadratic PDF broadening coefficient.\"\"\"\n        self._broad_q.value = value\n\n    @property\n    def cutoff_q(self) -&gt; Parameter:\n        \"\"\"Get Q cutoff used for Fourier transform.\"\"\"\n        return self._cutoff_q\n\n    @cutoff_q.setter\n    def cutoff_q(self, value: float) -&gt; None:\n        \"\"\"Set Q cutoff used for Fourier transform.\"\"\"\n        self._cutoff_q.value = value\n\n    @property\n    def sharp_delta_1(self) -&gt; Parameter:\n        \"\"\"Get sharpening coefficient with 1/r dependence.\"\"\"\n        return self._sharp_delta_1\n\n    @sharp_delta_1.setter\n    def sharp_delta_1(self, value: float) -&gt; None:\n        \"\"\"Set sharpening coefficient with 1/r dependence.\"\"\"\n        self._sharp_delta_1.value = value\n\n    @property\n    def sharp_delta_2(self) -&gt; Parameter:\n        \"\"\"Get sharpening coefficient with 1/r^2 dependence.\"\"\"\n        return self._sharp_delta_2\n\n    @sharp_delta_2.setter\n    def sharp_delta_2(self, value: float) -&gt; None:\n        \"\"\"Set sharpening coefficient with 1/r^2 dependence.\"\"\"\n        self._sharp_delta_2.value = value\n\n    @property\n    def damp_particle_diameter(self) -&gt; Parameter:\n        \"\"\"Get particle diameter for spherical envelope damping.\"\"\"\n        return self._damp_particle_diameter\n\n    @damp_particle_diameter.setter\n    def damp_particle_diameter(self, value: float) -&gt; None:\n        \"\"\"Set particle diameter for spherical envelope damping.\"\"\"\n        self._damp_particle_diameter.value = value\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.broad_q","title":"<code>broad_q</code>  <code>property</code> <code>writable</code>","text":"<p>Get quadratic PDF broadening coefficient.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.cutoff_q","title":"<code>cutoff_q</code>  <code>property</code> <code>writable</code>","text":"<p>Get Q cutoff used for Fourier transform.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.damp_particle_diameter","title":"<code>damp_particle_diameter</code>  <code>property</code> <code>writable</code>","text":"<p>Get particle diameter for spherical envelope damping.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.damp_q","title":"<code>damp_q</code>  <code>property</code> <code>writable</code>","text":"<p>Get Q-resolution damping factor.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.sharp_delta_1","title":"<code>sharp_delta_1</code>  <code>property</code> <code>writable</code>","text":"<p>Get sharpening coefficient with 1/r dependence.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.categories.peak.total_mixins.TotalBroadeningMixin.sharp_delta_2","title":"<code>sharp_delta_2</code>  <code>property</code> <code>writable</code>","text":"<p>Get sharpening coefficient with 1/r^2 dependence.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment","title":"<code>experiment</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.BraggPdExperiment","title":"<code>BraggPdExperiment</code>","text":"<p>               Bases: <code>InstrumentMixin</code>, <code>PdExperimentBase</code></p> <p>Powder diffraction experiment.</p> <p>Wraps background model, peak profile and linked phases for Bragg PD.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>class BraggPdExperiment(InstrumentMixin, PdExperimentBase):\n    \"\"\"Powder diffraction experiment.\n\n    Wraps background model, peak profile and linked phases for Bragg PD.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n\n        self._background_type: BackgroundTypeEnum = BackgroundTypeEnum.default()\n        self._background = BackgroundFactory.create(background_type=self.background_type)\n\n    @property\n    def background(self):\n        return self._background\n\n    @background.setter\n    def background(self, value):\n        self._background = value\n\n    # -------------\n    # Measured data\n    # -------------\n\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load (x, y, sy) data from an ASCII file into the data\n        category.\n\n        The file format is space/column separated with 2 or 3 columns:\n        ``x y [sy]``. If ``sy`` is missing, it is approximated as\n        ``sqrt(y)`` with small values clamped to ``1.0``.\n        \"\"\"\n        try:\n            data = np.loadtxt(data_path)\n        except Exception as e:\n            raise IOError(f'Failed to read data from {data_path}: {e}') from e\n\n        if data.shape[1] &lt; 2:\n            raise ValueError('Data file must have at least two columns: x and y.')\n\n        if data.shape[1] &lt; 3:\n            print('Warning: No uncertainty (sy) column provided. Defaulting to sqrt(y).')\n\n        # Extract x, y data\n        x: np.ndarray = data[:, 0]\n        y: np.ndarray = data[:, 1]\n\n        # Round x to 4 decimal places\n        x = np.round(x, 4)\n\n        # Determine sy from column 3 if available, otherwise use sqrt(y)\n        sy: np.ndarray = data[:, 2] if data.shape[1] &gt; 2 else np.sqrt(y)\n\n        # Replace values smaller than 0.0001 with 1.0\n        sy = np.where(sy &lt; 0.0001, 1.0, sy)\n\n        # Set the experiment data\n        self.data._set_x(x)\n        self.data._set_meas(y)\n        self.data._set_meas_su(sy)\n\n        console.paragraph('Data loaded successfully')\n        console.print(f\"Experiment \ud83d\udd2c '{self.name}'. Number of data points: {len(x)}\")\n\n    @property\n    def background_type(self):\n        \"\"\"Current background type enum value.\"\"\"\n        return self._background_type\n\n    @background_type.setter\n    def background_type(self, new_type):\n        \"\"\"Set and apply a new background type.\n\n        Falls back to printing supported types if the new value is not\n        supported.\n        \"\"\"\n        if new_type not in BackgroundFactory._supported_map():\n            supported_types = list(BackgroundFactory._supported_map().keys())\n            log.warning(\n                f\"Unknown background type '{new_type}'. \"\n                f'Supported background types: {[bt.value for bt in supported_types]}. '\n                f\"For more information, use 'show_supported_background_types()'\"\n            )\n            return\n        self.background = BackgroundFactory.create(new_type)\n        self._background_type = new_type\n        console.paragraph(f\"Background type for experiment '{self.name}' changed to\")\n        console.print(new_type)\n\n    def show_supported_background_types(self):\n        \"\"\"Print a table of supported background types.\"\"\"\n        columns_headers = ['Background type', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data = []\n        for bt in BackgroundFactory._supported_map():\n            columns_data.append([bt.value, bt.description()])\n\n        console.paragraph('Supported background types')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_background_type(self):\n        \"\"\"Print the currently used background type.\"\"\"\n        console.paragraph('Current background type')\n        console.print(self.background_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.BraggPdExperiment.background_type","title":"<code>background_type</code>  <code>property</code> <code>writable</code>","text":"<p>Current background type enum value.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.BraggPdExperiment.show_current_background_type","title":"<code>show_current_background_type()</code>","text":"<p>Print the currently used background type.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>def show_current_background_type(self):\n    \"\"\"Print the currently used background type.\"\"\"\n    console.paragraph('Current background type')\n    console.print(self.background_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.BraggPdExperiment.show_supported_background_types","title":"<code>show_supported_background_types()</code>","text":"<p>Print a table of supported background types.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>def show_supported_background_types(self):\n    \"\"\"Print a table of supported background types.\"\"\"\n    columns_headers = ['Background type', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data = []\n    for bt in BackgroundFactory._supported_map():\n        columns_data.append([bt.value, bt.description()])\n\n    console.paragraph('Supported background types')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.BraggScExperiment","title":"<code>BraggScExperiment</code>","text":"<p>               Bases: <code>ExperimentBase</code></p> <p>Single crystal experiment class with specific attributes.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_sc.py</code> <pre><code>class BraggScExperiment(ExperimentBase):\n    \"\"\"Single crystal experiment class with specific attributes.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n        self.linked_crystal = None\n\n    def show_meas_chart(self) -&gt; None:\n        print('Showing measured data chart is not implemented yet.')\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase","title":"<code>ExperimentBase</code>","text":"<p>               Bases: <code>DatablockItem</code></p> <p>Base class for all experiments with only core attributes.</p> <p>Wraps experiment type and instrument.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>class ExperimentBase(DatablockItem):\n    \"\"\"Base class for all experiments with only core attributes.\n\n    Wraps experiment type and instrument.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ):\n        super().__init__()\n        self._name = name\n        self._type = type\n        # TODO: Should return default calculator based on experiment\n        #  type\n        from easydiffraction.analysis.calculators.factory import CalculatorFactory\n\n        self._calculator = CalculatorFactory.create_calculator('cryspy')\n        self._identity.datablock_entry_name = lambda: self.name\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Human-readable name of the experiment.\"\"\"\n        return self._name\n\n    @name.setter\n    def name(self, new: str) -&gt; None:\n        \"\"\"Rename the experiment.\n\n        Args:\n            new: New name for this experiment.\n        \"\"\"\n        self._name = new\n\n    @property\n    def type(self):  # TODO: Consider another name\n        \"\"\"Experiment type descriptor (sample form, probe, beam\n        mode).\n        \"\"\"\n        return self._type\n\n    @property\n    def calculator(self):\n        \"\"\"Calculator engine used for pattern calculations.\"\"\"\n        return self._calculator\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Serialize this experiment to a CIF fragment.\"\"\"\n        return experiment_to_cif(self)\n\n    def show_as_cif(self) -&gt; None:\n        \"\"\"Pretty-print the experiment as CIF text.\"\"\"\n        experiment_cif = super().as_cif\n        paragraph_title: str = f\"Experiment \ud83d\udd2c '{self.name}' as cif\"\n        console.paragraph(paragraph_title)\n        render_cif(experiment_cif)\n\n    @abstractmethod\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load ASCII data from file into the experiment data category.\n\n        Args:\n            data_path: Path to the ASCII file to load.\n        \"\"\"\n        raise NotImplementedError()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Serialize this experiment to a CIF fragment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase.calculator","title":"<code>calculator</code>  <code>property</code>","text":"<p>Calculator engine used for pattern calculations.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase.name","title":"<code>name</code>  <code>property</code> <code>writable</code>","text":"<p>Human-readable name of the experiment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase.show_as_cif","title":"<code>show_as_cif()</code>","text":"<p>Pretty-print the experiment as CIF text.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_as_cif(self) -&gt; None:\n    \"\"\"Pretty-print the experiment as CIF text.\"\"\"\n    experiment_cif = super().as_cif\n    paragraph_title: str = f\"Experiment \ud83d\udd2c '{self.name}' as cif\"\n    console.paragraph(paragraph_title)\n    render_cif(experiment_cif)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.ExperimentBase.type","title":"<code>type</code>  <code>property</code>","text":"<p>Experiment type descriptor (sample form, probe, beam mode).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase","title":"<code>PdExperimentBase</code>","text":"<p>               Bases: <code>ExperimentBase</code></p> <p>Base class for all powder experiments.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>class PdExperimentBase(ExperimentBase):\n    \"\"\"Base class for all powder experiments.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n\n        self._linked_phases: LinkedPhases = LinkedPhases()\n        self._excluded_regions: ExcludedRegions = ExcludedRegions()\n\n        self._peak_profile_type: PeakProfileTypeEnum = PeakProfileTypeEnum.default(\n            self.type.scattering_type.value,\n            self.type.beam_mode.value,\n        )\n        self._peak = PeakFactory.create(\n            scattering_type=self.type.scattering_type.value,\n            beam_mode=self.type.beam_mode.value,\n            profile_type=self._peak_profile_type,\n        )\n\n        self._data = DataFactory.create(\n            sample_form=self.type.sample_form.value,\n            beam_mode=self.type.beam_mode.value,\n            scattering_type=self.type.scattering_type.value,\n        )\n\n    def _get_valid_linked_phases(\n        self,\n        sample_models: SampleModels,\n    ) -&gt; List[Any]:\n        \"\"\"Get valid linked phases for this experiment.\n\n        Args:\n            sample_models: Collection of sample models.\n\n        Returns:\n            A list of valid linked phases.\n        \"\"\"\n        if not self.linked_phases:\n            print('Warning: No linked phases defined. Returning empty pattern.')\n            return []\n\n        valid_linked_phases = []\n        for linked_phase in self.linked_phases:\n            if linked_phase._identity.category_entry_name not in sample_models.names:\n                print(\n                    f\"Warning: Linked phase '{linked_phase.id.value}' not \"\n                    f'found in Sample Models {sample_models.names}. Skipping it.'\n                )\n                continue\n            valid_linked_phases.append(linked_phase)\n\n        if not valid_linked_phases:\n            print(\n                'Warning: None of the linked phases found in Sample '\n                'Models. Returning empty pattern.'\n            )\n\n        return valid_linked_phases\n\n    @abstractmethod\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load powder diffraction data from an ASCII file.\n\n        Args:\n            data_path: Path to data file with columns compatible with\n                the beam mode (e.g. 2\u03b8/I/\u03c3 for CWL, TOF/I/\u03c3 for TOF).\n        \"\"\"\n        pass\n\n    @property\n    def linked_phases(self):\n        \"\"\"Collection of phases linked to this experiment.\"\"\"\n        return self._linked_phases\n\n    @property\n    def excluded_regions(self):\n        \"\"\"Collection of excluded regions for the x-grid.\"\"\"\n        return self._excluded_regions\n\n    @property\n    def peak(self) -&gt; str:\n        \"\"\"Peak category object with profile parameters and mixins.\"\"\"\n        return self._peak\n\n    @peak.setter\n    def peak(self, value):\n        \"\"\"Replace the peak model used for this powder experiment.\n\n        Args:\n            value: New peak object created by the `PeakFactory`.\n        \"\"\"\n        self._peak = value\n\n    @property\n    def data(self):\n        return self._data\n\n    @property\n    def peak_profile_type(self):\n        \"\"\"Currently selected peak profile type enum.\"\"\"\n        return self._peak_profile_type\n\n    @peak_profile_type.setter\n    def peak_profile_type(self, new_type: str | PeakProfileTypeEnum):\n        \"\"\"Change the active peak profile type, if supported.\n\n        Args:\n            new_type: New profile type as enum or its string value.\n        \"\"\"\n        if isinstance(new_type, str):\n            try:\n                new_type = PeakProfileTypeEnum(new_type)\n            except ValueError:\n                log.warning(f\"Unknown peak profile type '{new_type}'\")\n                return\n\n        supported_types = list(\n            PeakFactory._supported[self.type.scattering_type.value][\n                self.type.beam_mode.value\n            ].keys()\n        )\n\n        if new_type not in supported_types:\n            log.warning(\n                f\"Unsupported peak profile '{new_type.value}', \"\n                f'Supported peak profiles: {supported_types}',\n                \"For more information, use 'show_supported_peak_profile_types()'\",\n            )\n            return\n\n        self._peak = PeakFactory.create(\n            scattering_type=self.type.scattering_type.value,\n            beam_mode=self.type.beam_mode.value,\n            profile_type=new_type,\n        )\n        self._peak_profile_type = new_type\n        console.paragraph(f\"Peak profile type for experiment '{self.name}' changed to\")\n        console.print(new_type.value)\n\n    def show_supported_peak_profile_types(self):\n        \"\"\"Print available peak profile types for this experiment.\"\"\"\n        columns_headers = ['Peak profile type', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data = []\n\n        scattering_type = self.type.scattering_type.value\n        beam_mode = self.type.beam_mode.value\n\n        for profile_type in PeakFactory._supported[scattering_type][beam_mode]:\n            columns_data.append([profile_type.value, profile_type.description()])\n\n        console.paragraph('Supported peak profile types')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_peak_profile_type(self):\n        \"\"\"Print the currently selected peak profile type.\"\"\"\n        console.paragraph('Current peak profile type')\n        console.print(self.peak_profile_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.excluded_regions","title":"<code>excluded_regions</code>  <code>property</code>","text":"<p>Collection of excluded regions for the x-grid.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.linked_phases","title":"<code>linked_phases</code>  <code>property</code>","text":"<p>Collection of phases linked to this experiment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.peak","title":"<code>peak</code>  <code>property</code> <code>writable</code>","text":"<p>Peak category object with profile parameters and mixins.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.peak_profile_type","title":"<code>peak_profile_type</code>  <code>property</code> <code>writable</code>","text":"<p>Currently selected peak profile type enum.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.show_current_peak_profile_type","title":"<code>show_current_peak_profile_type()</code>","text":"<p>Print the currently selected peak profile type.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_current_peak_profile_type(self):\n    \"\"\"Print the currently selected peak profile type.\"\"\"\n    console.paragraph('Current peak profile type')\n    console.print(self.peak_profile_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.PdExperimentBase.show_supported_peak_profile_types","title":"<code>show_supported_peak_profile_types()</code>","text":"<p>Print available peak profile types for this experiment.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_supported_peak_profile_types(self):\n    \"\"\"Print available peak profile types for this experiment.\"\"\"\n    columns_headers = ['Peak profile type', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data = []\n\n    scattering_type = self.type.scattering_type.value\n    beam_mode = self.type.beam_mode.value\n\n    for profile_type in PeakFactory._supported[scattering_type][beam_mode]:\n        columns_data.append([profile_type.value, profile_type.description()])\n\n    console.paragraph('Supported peak profile types')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.TotalPdExperiment","title":"<code>TotalPdExperiment</code>","text":"<p>               Bases: <code>PdExperimentBase</code></p> <p>PDF experiment class with specific attributes.</p> Source code in <code>src/easydiffraction/experiments/experiment/total_pd.py</code> <pre><code>class TotalPdExperiment(PdExperimentBase):\n    \"\"\"PDF experiment class with specific attributes.\"\"\"\n\n    def __init__(\n        self,\n        name: str,\n        type: ExperimentType,\n    ):\n        super().__init__(name=name, type=type)\n\n    def _load_ascii_data_to_experiment(self, data_path):\n        \"\"\"Loads x, y, sy values from an ASCII data file into the\n        experiment.\n\n        The file must be structured as:\n            x  y  sy\n        \"\"\"\n        try:\n            from diffpy.utils.parsers.loaddata import loadData\n        except ImportError:\n            raise ImportError('diffpy module not found.') from None\n        try:\n            data = loadData(data_path)\n        except Exception as e:\n            raise IOError(f'Failed to read data from {data_path}: {e}') from e\n\n        if data.shape[1] &lt; 2:\n            raise ValueError('Data file must have at least two columns: x and y.')\n\n        default_sy = 0.03\n        if data.shape[1] &lt; 3:\n            print(f'Warning: No uncertainty (sy) column provided. Defaulting to {default_sy}.')\n\n        x = data[:, 0]\n        y = data[:, 1]\n        sy = data[:, 2] if data.shape[1] &gt; 2 else np.full_like(y, fill_value=default_sy)\n\n        self.data._set_x(x)\n        self.data._set_meas(y)\n        self.data._set_meas_su(sy)\n\n        console.paragraph('Data loaded successfully')\n        console.print(f\"Experiment \ud83d\udd2c '{self.name}'. Number of data points: {len(x)}\")\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base","title":"<code>base</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase","title":"<code>ExperimentBase</code>","text":"<p>               Bases: <code>DatablockItem</code></p> <p>Base class for all experiments with only core attributes.</p> <p>Wraps experiment type and instrument.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>class ExperimentBase(DatablockItem):\n    \"\"\"Base class for all experiments with only core attributes.\n\n    Wraps experiment type and instrument.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ):\n        super().__init__()\n        self._name = name\n        self._type = type\n        # TODO: Should return default calculator based on experiment\n        #  type\n        from easydiffraction.analysis.calculators.factory import CalculatorFactory\n\n        self._calculator = CalculatorFactory.create_calculator('cryspy')\n        self._identity.datablock_entry_name = lambda: self.name\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Human-readable name of the experiment.\"\"\"\n        return self._name\n\n    @name.setter\n    def name(self, new: str) -&gt; None:\n        \"\"\"Rename the experiment.\n\n        Args:\n            new: New name for this experiment.\n        \"\"\"\n        self._name = new\n\n    @property\n    def type(self):  # TODO: Consider another name\n        \"\"\"Experiment type descriptor (sample form, probe, beam\n        mode).\n        \"\"\"\n        return self._type\n\n    @property\n    def calculator(self):\n        \"\"\"Calculator engine used for pattern calculations.\"\"\"\n        return self._calculator\n\n    @property\n    def as_cif(self) -&gt; str:\n        \"\"\"Serialize this experiment to a CIF fragment.\"\"\"\n        return experiment_to_cif(self)\n\n    def show_as_cif(self) -&gt; None:\n        \"\"\"Pretty-print the experiment as CIF text.\"\"\"\n        experiment_cif = super().as_cif\n        paragraph_title: str = f\"Experiment \ud83d\udd2c '{self.name}' as cif\"\n        console.paragraph(paragraph_title)\n        render_cif(experiment_cif)\n\n    @abstractmethod\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load ASCII data from file into the experiment data category.\n\n        Args:\n            data_path: Path to the ASCII file to load.\n        \"\"\"\n        raise NotImplementedError()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Serialize this experiment to a CIF fragment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase.calculator","title":"<code>calculator</code>  <code>property</code>","text":"<p>Calculator engine used for pattern calculations.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase.name","title":"<code>name</code>  <code>property</code> <code>writable</code>","text":"<p>Human-readable name of the experiment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase.show_as_cif","title":"<code>show_as_cif()</code>","text":"<p>Pretty-print the experiment as CIF text.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_as_cif(self) -&gt; None:\n    \"\"\"Pretty-print the experiment as CIF text.\"\"\"\n    experiment_cif = super().as_cif\n    paragraph_title: str = f\"Experiment \ud83d\udd2c '{self.name}' as cif\"\n    console.paragraph(paragraph_title)\n    render_cif(experiment_cif)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.ExperimentBase.type","title":"<code>type</code>  <code>property</code>","text":"<p>Experiment type descriptor (sample form, probe, beam mode).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase","title":"<code>PdExperimentBase</code>","text":"<p>               Bases: <code>ExperimentBase</code></p> <p>Base class for all powder experiments.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>class PdExperimentBase(ExperimentBase):\n    \"\"\"Base class for all powder experiments.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n\n        self._linked_phases: LinkedPhases = LinkedPhases()\n        self._excluded_regions: ExcludedRegions = ExcludedRegions()\n\n        self._peak_profile_type: PeakProfileTypeEnum = PeakProfileTypeEnum.default(\n            self.type.scattering_type.value,\n            self.type.beam_mode.value,\n        )\n        self._peak = PeakFactory.create(\n            scattering_type=self.type.scattering_type.value,\n            beam_mode=self.type.beam_mode.value,\n            profile_type=self._peak_profile_type,\n        )\n\n        self._data = DataFactory.create(\n            sample_form=self.type.sample_form.value,\n            beam_mode=self.type.beam_mode.value,\n            scattering_type=self.type.scattering_type.value,\n        )\n\n    def _get_valid_linked_phases(\n        self,\n        sample_models: SampleModels,\n    ) -&gt; List[Any]:\n        \"\"\"Get valid linked phases for this experiment.\n\n        Args:\n            sample_models: Collection of sample models.\n\n        Returns:\n            A list of valid linked phases.\n        \"\"\"\n        if not self.linked_phases:\n            print('Warning: No linked phases defined. Returning empty pattern.')\n            return []\n\n        valid_linked_phases = []\n        for linked_phase in self.linked_phases:\n            if linked_phase._identity.category_entry_name not in sample_models.names:\n                print(\n                    f\"Warning: Linked phase '{linked_phase.id.value}' not \"\n                    f'found in Sample Models {sample_models.names}. Skipping it.'\n                )\n                continue\n            valid_linked_phases.append(linked_phase)\n\n        if not valid_linked_phases:\n            print(\n                'Warning: None of the linked phases found in Sample '\n                'Models. Returning empty pattern.'\n            )\n\n        return valid_linked_phases\n\n    @abstractmethod\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load powder diffraction data from an ASCII file.\n\n        Args:\n            data_path: Path to data file with columns compatible with\n                the beam mode (e.g. 2\u03b8/I/\u03c3 for CWL, TOF/I/\u03c3 for TOF).\n        \"\"\"\n        pass\n\n    @property\n    def linked_phases(self):\n        \"\"\"Collection of phases linked to this experiment.\"\"\"\n        return self._linked_phases\n\n    @property\n    def excluded_regions(self):\n        \"\"\"Collection of excluded regions for the x-grid.\"\"\"\n        return self._excluded_regions\n\n    @property\n    def peak(self) -&gt; str:\n        \"\"\"Peak category object with profile parameters and mixins.\"\"\"\n        return self._peak\n\n    @peak.setter\n    def peak(self, value):\n        \"\"\"Replace the peak model used for this powder experiment.\n\n        Args:\n            value: New peak object created by the `PeakFactory`.\n        \"\"\"\n        self._peak = value\n\n    @property\n    def data(self):\n        return self._data\n\n    @property\n    def peak_profile_type(self):\n        \"\"\"Currently selected peak profile type enum.\"\"\"\n        return self._peak_profile_type\n\n    @peak_profile_type.setter\n    def peak_profile_type(self, new_type: str | PeakProfileTypeEnum):\n        \"\"\"Change the active peak profile type, if supported.\n\n        Args:\n            new_type: New profile type as enum or its string value.\n        \"\"\"\n        if isinstance(new_type, str):\n            try:\n                new_type = PeakProfileTypeEnum(new_type)\n            except ValueError:\n                log.warning(f\"Unknown peak profile type '{new_type}'\")\n                return\n\n        supported_types = list(\n            PeakFactory._supported[self.type.scattering_type.value][\n                self.type.beam_mode.value\n            ].keys()\n        )\n\n        if new_type not in supported_types:\n            log.warning(\n                f\"Unsupported peak profile '{new_type.value}', \"\n                f'Supported peak profiles: {supported_types}',\n                \"For more information, use 'show_supported_peak_profile_types()'\",\n            )\n            return\n\n        self._peak = PeakFactory.create(\n            scattering_type=self.type.scattering_type.value,\n            beam_mode=self.type.beam_mode.value,\n            profile_type=new_type,\n        )\n        self._peak_profile_type = new_type\n        console.paragraph(f\"Peak profile type for experiment '{self.name}' changed to\")\n        console.print(new_type.value)\n\n    def show_supported_peak_profile_types(self):\n        \"\"\"Print available peak profile types for this experiment.\"\"\"\n        columns_headers = ['Peak profile type', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data = []\n\n        scattering_type = self.type.scattering_type.value\n        beam_mode = self.type.beam_mode.value\n\n        for profile_type in PeakFactory._supported[scattering_type][beam_mode]:\n            columns_data.append([profile_type.value, profile_type.description()])\n\n        console.paragraph('Supported peak profile types')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_peak_profile_type(self):\n        \"\"\"Print the currently selected peak profile type.\"\"\"\n        console.paragraph('Current peak profile type')\n        console.print(self.peak_profile_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.excluded_regions","title":"<code>excluded_regions</code>  <code>property</code>","text":"<p>Collection of excluded regions for the x-grid.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.linked_phases","title":"<code>linked_phases</code>  <code>property</code>","text":"<p>Collection of phases linked to this experiment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.peak","title":"<code>peak</code>  <code>property</code> <code>writable</code>","text":"<p>Peak category object with profile parameters and mixins.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.peak_profile_type","title":"<code>peak_profile_type</code>  <code>property</code> <code>writable</code>","text":"<p>Currently selected peak profile type enum.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.show_current_peak_profile_type","title":"<code>show_current_peak_profile_type()</code>","text":"<p>Print the currently selected peak profile type.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_current_peak_profile_type(self):\n    \"\"\"Print the currently selected peak profile type.\"\"\"\n    console.paragraph('Current peak profile type')\n    console.print(self.peak_profile_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.base.PdExperimentBase.show_supported_peak_profile_types","title":"<code>show_supported_peak_profile_types()</code>","text":"<p>Print available peak profile types for this experiment.</p> Source code in <code>src/easydiffraction/experiments/experiment/base.py</code> <pre><code>def show_supported_peak_profile_types(self):\n    \"\"\"Print available peak profile types for this experiment.\"\"\"\n    columns_headers = ['Peak profile type', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data = []\n\n    scattering_type = self.type.scattering_type.value\n    beam_mode = self.type.beam_mode.value\n\n    for profile_type in PeakFactory._supported[scattering_type][beam_mode]:\n        columns_data.append([profile_type.value, profile_type.description()])\n\n    console.paragraph('Supported peak profile types')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_pd","title":"<code>bragg_pd</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_pd.BraggPdExperiment","title":"<code>BraggPdExperiment</code>","text":"<p>               Bases: <code>InstrumentMixin</code>, <code>PdExperimentBase</code></p> <p>Powder diffraction experiment.</p> <p>Wraps background model, peak profile and linked phases for Bragg PD.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>class BraggPdExperiment(InstrumentMixin, PdExperimentBase):\n    \"\"\"Powder diffraction experiment.\n\n    Wraps background model, peak profile and linked phases for Bragg PD.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n\n        self._background_type: BackgroundTypeEnum = BackgroundTypeEnum.default()\n        self._background = BackgroundFactory.create(background_type=self.background_type)\n\n    @property\n    def background(self):\n        return self._background\n\n    @background.setter\n    def background(self, value):\n        self._background = value\n\n    # -------------\n    # Measured data\n    # -------------\n\n    def _load_ascii_data_to_experiment(self, data_path: str) -&gt; None:\n        \"\"\"Load (x, y, sy) data from an ASCII file into the data\n        category.\n\n        The file format is space/column separated with 2 or 3 columns:\n        ``x y [sy]``. If ``sy`` is missing, it is approximated as\n        ``sqrt(y)`` with small values clamped to ``1.0``.\n        \"\"\"\n        try:\n            data = np.loadtxt(data_path)\n        except Exception as e:\n            raise IOError(f'Failed to read data from {data_path}: {e}') from e\n\n        if data.shape[1] &lt; 2:\n            raise ValueError('Data file must have at least two columns: x and y.')\n\n        if data.shape[1] &lt; 3:\n            print('Warning: No uncertainty (sy) column provided. Defaulting to sqrt(y).')\n\n        # Extract x, y data\n        x: np.ndarray = data[:, 0]\n        y: np.ndarray = data[:, 1]\n\n        # Round x to 4 decimal places\n        x = np.round(x, 4)\n\n        # Determine sy from column 3 if available, otherwise use sqrt(y)\n        sy: np.ndarray = data[:, 2] if data.shape[1] &gt; 2 else np.sqrt(y)\n\n        # Replace values smaller than 0.0001 with 1.0\n        sy = np.where(sy &lt; 0.0001, 1.0, sy)\n\n        # Set the experiment data\n        self.data._set_x(x)\n        self.data._set_meas(y)\n        self.data._set_meas_su(sy)\n\n        console.paragraph('Data loaded successfully')\n        console.print(f\"Experiment \ud83d\udd2c '{self.name}'. Number of data points: {len(x)}\")\n\n    @property\n    def background_type(self):\n        \"\"\"Current background type enum value.\"\"\"\n        return self._background_type\n\n    @background_type.setter\n    def background_type(self, new_type):\n        \"\"\"Set and apply a new background type.\n\n        Falls back to printing supported types if the new value is not\n        supported.\n        \"\"\"\n        if new_type not in BackgroundFactory._supported_map():\n            supported_types = list(BackgroundFactory._supported_map().keys())\n            log.warning(\n                f\"Unknown background type '{new_type}'. \"\n                f'Supported background types: {[bt.value for bt in supported_types]}. '\n                f\"For more information, use 'show_supported_background_types()'\"\n            )\n            return\n        self.background = BackgroundFactory.create(new_type)\n        self._background_type = new_type\n        console.paragraph(f\"Background type for experiment '{self.name}' changed to\")\n        console.print(new_type)\n\n    def show_supported_background_types(self):\n        \"\"\"Print a table of supported background types.\"\"\"\n        columns_headers = ['Background type', 'Description']\n        columns_alignment = ['left', 'left']\n        columns_data = []\n        for bt in BackgroundFactory._supported_map():\n            columns_data.append([bt.value, bt.description()])\n\n        console.paragraph('Supported background types')\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=columns_data,\n        )\n\n    def show_current_background_type(self):\n        \"\"\"Print the currently used background type.\"\"\"\n        console.paragraph('Current background type')\n        console.print(self.background_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_pd.BraggPdExperiment.background_type","title":"<code>background_type</code>  <code>property</code> <code>writable</code>","text":"<p>Current background type enum value.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_pd.BraggPdExperiment.show_current_background_type","title":"<code>show_current_background_type()</code>","text":"<p>Print the currently used background type.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>def show_current_background_type(self):\n    \"\"\"Print the currently used background type.\"\"\"\n    console.paragraph('Current background type')\n    console.print(self.background_type)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_pd.BraggPdExperiment.show_supported_background_types","title":"<code>show_supported_background_types()</code>","text":"<p>Print a table of supported background types.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_pd.py</code> <pre><code>def show_supported_background_types(self):\n    \"\"\"Print a table of supported background types.\"\"\"\n    columns_headers = ['Background type', 'Description']\n    columns_alignment = ['left', 'left']\n    columns_data = []\n    for bt in BackgroundFactory._supported_map():\n        columns_data.append([bt.value, bt.description()])\n\n    console.paragraph('Supported background types')\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=columns_data,\n    )\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_sc","title":"<code>bragg_sc</code>","text":"<p>Single crystal experiment types and helpers.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.bragg_sc.BraggScExperiment","title":"<code>BraggScExperiment</code>","text":"<p>               Bases: <code>ExperimentBase</code></p> <p>Single crystal experiment class with specific attributes.</p> Source code in <code>src/easydiffraction/experiments/experiment/bragg_sc.py</code> <pre><code>class BraggScExperiment(ExperimentBase):\n    \"\"\"Single crystal experiment class with specific attributes.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        name: str,\n        type: ExperimentType,\n    ) -&gt; None:\n        super().__init__(name=name, type=type)\n        self.linked_crystal = None\n\n    def show_meas_chart(self) -&gt; None:\n        print('Showing measured data chart is not implemented yet.')\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums","title":"<code>enums</code>","text":"<p>Enumerations for experiment configuration (forms, modes, types).</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums.BeamModeEnum","title":"<code>BeamModeEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Beam delivery mode for the instrument.</p> Source code in <code>src/easydiffraction/experiments/experiment/enums.py</code> <pre><code>class BeamModeEnum(str, Enum):\n    \"\"\"Beam delivery mode for the instrument.\"\"\"\n\n    # TODO: Rename to CWL and TOF\n    CONSTANT_WAVELENGTH = 'constant wavelength'\n    TIME_OF_FLIGHT = 'time-of-flight'\n\n    @classmethod\n    def default(cls) -&gt; 'BeamModeEnum':\n        return cls.CONSTANT_WAVELENGTH\n\n    def description(self) -&gt; str:\n        if self is BeamModeEnum.CONSTANT_WAVELENGTH:\n            return 'Constant wavelength (CW) diffraction.'\n        elif self is BeamModeEnum.TIME_OF_FLIGHT:\n            return 'Time-of-flight (TOF) diffraction.'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums.PeakProfileTypeEnum","title":"<code>PeakProfileTypeEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Available peak profile types per scattering and beam mode.</p> Source code in <code>src/easydiffraction/experiments/experiment/enums.py</code> <pre><code>class PeakProfileTypeEnum(str, Enum):\n    \"\"\"Available peak profile types per scattering and beam mode.\"\"\"\n\n    PSEUDO_VOIGT = 'pseudo-voigt'\n    SPLIT_PSEUDO_VOIGT = 'split pseudo-voigt'\n    THOMPSON_COX_HASTINGS = 'thompson-cox-hastings'\n    PSEUDO_VOIGT_IKEDA_CARPENTER = 'pseudo-voigt * ikeda-carpenter'\n    PSEUDO_VOIGT_BACK_TO_BACK = 'pseudo-voigt * back-to-back'\n    GAUSSIAN_DAMPED_SINC = 'gaussian-damped-sinc'\n\n    @classmethod\n    def default(\n        cls,\n        scattering_type: ScatteringTypeEnum | None = None,\n        beam_mode: BeamModeEnum | None = None,\n    ) -&gt; 'PeakProfileTypeEnum':\n        if scattering_type is None:\n            scattering_type = ScatteringTypeEnum.default()\n        if beam_mode is None:\n            beam_mode = BeamModeEnum.default()\n        return {\n            (ScatteringTypeEnum.BRAGG, BeamModeEnum.CONSTANT_WAVELENGTH): cls.PSEUDO_VOIGT,\n            (\n                ScatteringTypeEnum.BRAGG,\n                BeamModeEnum.TIME_OF_FLIGHT,\n            ): cls.PSEUDO_VOIGT_IKEDA_CARPENTER,\n            (ScatteringTypeEnum.TOTAL, BeamModeEnum.CONSTANT_WAVELENGTH): cls.GAUSSIAN_DAMPED_SINC,\n            (ScatteringTypeEnum.TOTAL, BeamModeEnum.TIME_OF_FLIGHT): cls.GAUSSIAN_DAMPED_SINC,\n        }[(scattering_type, beam_mode)]\n\n    def description(self) -&gt; str:\n        if self is PeakProfileTypeEnum.PSEUDO_VOIGT:\n            return 'Pseudo-Voigt profile'\n        elif self is PeakProfileTypeEnum.SPLIT_PSEUDO_VOIGT:\n            return 'Split pseudo-Voigt profile with empirical asymmetry correction.'\n        elif self is PeakProfileTypeEnum.THOMPSON_COX_HASTINGS:\n            return 'Thompson-Cox-Hastings profile with FCJ asymmetry correction.'\n        elif self is PeakProfileTypeEnum.PSEUDO_VOIGT_IKEDA_CARPENTER:\n            return 'Pseudo-Voigt profile with Ikeda-Carpenter asymmetry correction.'\n        elif self is PeakProfileTypeEnum.PSEUDO_VOIGT_BACK_TO_BACK:\n            return 'Pseudo-Voigt profile with Back-to-Back Exponential asymmetry correction.'\n        elif self is PeakProfileTypeEnum.GAUSSIAN_DAMPED_SINC:\n            return 'Gaussian-damped sinc profile for pair distribution function (PDF) analysis.'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums.RadiationProbeEnum","title":"<code>RadiationProbeEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Incident radiation probe used in the experiment.</p> Source code in <code>src/easydiffraction/experiments/experiment/enums.py</code> <pre><code>class RadiationProbeEnum(str, Enum):\n    \"\"\"Incident radiation probe used in the experiment.\"\"\"\n\n    NEUTRON = 'neutron'\n    XRAY = 'xray'\n\n    @classmethod\n    def default(cls) -&gt; 'RadiationProbeEnum':\n        return cls.NEUTRON\n\n    def description(self) -&gt; str:\n        if self is RadiationProbeEnum.NEUTRON:\n            return 'Neutron diffraction.'\n        elif self is RadiationProbeEnum.XRAY:\n            return 'X-ray diffraction.'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums.SampleFormEnum","title":"<code>SampleFormEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Physical sample form supported by experiments.</p> Source code in <code>src/easydiffraction/experiments/experiment/enums.py</code> <pre><code>class SampleFormEnum(str, Enum):\n    \"\"\"Physical sample form supported by experiments.\"\"\"\n\n    POWDER = 'powder'\n    SINGLE_CRYSTAL = 'single crystal'\n\n    @classmethod\n    def default(cls) -&gt; 'SampleFormEnum':\n        return cls.POWDER\n\n    def description(self) -&gt; str:\n        if self is SampleFormEnum.POWDER:\n            return 'Powdered or polycrystalline sample.'\n        elif self is SampleFormEnum.SINGLE_CRYSTAL:\n            return 'Single crystal sample.'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.enums.ScatteringTypeEnum","title":"<code>ScatteringTypeEnum</code>","text":"<p>               Bases: <code>str</code>, <code>Enum</code></p> <p>Type of scattering modeled in an experiment.</p> Source code in <code>src/easydiffraction/experiments/experiment/enums.py</code> <pre><code>class ScatteringTypeEnum(str, Enum):\n    \"\"\"Type of scattering modeled in an experiment.\"\"\"\n\n    BRAGG = 'bragg'\n    TOTAL = 'total'\n\n    @classmethod\n    def default(cls) -&gt; 'ScatteringTypeEnum':\n        return cls.BRAGG\n\n    def description(self) -&gt; str:\n        if self is ScatteringTypeEnum.BRAGG:\n            return 'Bragg diffraction for conventional structure refinement.'\n        elif self is ScatteringTypeEnum.TOTAL:\n            return 'Total scattering for pair distribution function analysis (PDF).'\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.factory","title":"<code>factory</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.factory.ExperimentFactory","title":"<code>ExperimentFactory</code>","text":"<p>               Bases: <code>FactoryBase</code></p> <p>Creates Experiment instances with only relevant attributes.</p> Source code in <code>src/easydiffraction/experiments/experiment/factory.py</code> <pre><code>class ExperimentFactory(FactoryBase):\n    \"\"\"Creates Experiment instances with only relevant attributes.\"\"\"\n\n    _ALLOWED_ARG_SPECS = [\n        {'required': ['cif_path'], 'optional': []},\n        {'required': ['cif_str'], 'optional': []},\n        {\n            'required': ['name', 'data_path'],\n            'optional': ['sample_form', 'beam_mode', 'radiation_probe', 'scattering_type'],\n        },\n        {\n            'required': ['name'],\n            'optional': ['sample_form', 'beam_mode', 'radiation_probe', 'scattering_type'],\n        },\n    ]\n\n    _SUPPORTED = {\n        ScatteringTypeEnum.BRAGG: {\n            SampleFormEnum.POWDER: BraggPdExperiment,\n            SampleFormEnum.SINGLE_CRYSTAL: BraggScExperiment,\n        },\n        ScatteringTypeEnum.TOTAL: {\n            SampleFormEnum.POWDER: TotalPdExperiment,\n        },\n    }\n\n    @classmethod\n    def _make_experiment_type(cls, kwargs):\n        \"\"\"Helper to construct an ExperimentType from keyword arguments,\n        using defaults as needed.\n        \"\"\"\n        # TODO: Defaults are already in the experiment type...\n        # TODO: Merging with experiment_type_from_block from\n        #  io.cif.parse\n        return ExperimentType(\n            sample_form=kwargs.get('sample_form', SampleFormEnum.default().value),\n            beam_mode=kwargs.get('beam_mode', BeamModeEnum.default().value),\n            radiation_probe=kwargs.get('radiation_probe', RadiationProbeEnum.default().value),\n            scattering_type=kwargs.get('scattering_type', ScatteringTypeEnum.default().value),\n        )\n\n    # TODO: Move to a common CIF utility module? io.cif.parse?\n    @classmethod\n    def _create_from_gemmi_block(\n        cls,\n        block: gemmi.cif.Block,\n    ) -&gt; ExperimentBase:\n        \"\"\"Build a model instance from a single CIF block.\"\"\"\n        name = name_from_block(block)\n\n        # TODO: move to io.cif.parse?\n        expt_type = ExperimentType()\n        for param in expt_type.parameters:\n            param.from_cif(block)\n\n        # Create experiment instance of appropriate class\n        # TODO: make helper method to create experiment from type\n        scattering_type = expt_type.scattering_type.value\n        sample_form = expt_type.sample_form.value\n        expt_class = cls._SUPPORTED[scattering_type][sample_form]\n        expt_obj = expt_class(name=name, type=expt_type)\n\n        # Read all categories from CIF block\n        # TODO: move to io.cif.parse?\n        for category in expt_obj.categories:\n            category.from_cif(block)\n\n        return expt_obj\n\n    @classmethod\n    def _create_from_cif_path(\n        cls,\n        cif_path: str,\n    ) -&gt; ExperimentBase:\n        \"\"\"Create an experiment from a CIF file path.\"\"\"\n        doc = document_from_path(cif_path)\n        block = pick_sole_block(doc)\n        return cls._create_from_gemmi_block(block)\n\n    @classmethod\n    def _create_from_cif_str(\n        cls,\n        cif_str: str,\n    ) -&gt; ExperimentBase:\n        \"\"\"Create an experiment from a CIF string.\"\"\"\n        doc = document_from_string(cif_str)\n        block = pick_sole_block(doc)\n        return cls._create_from_gemmi_block(block)\n\n    @classmethod\n    def _create_from_data_path(cls, kwargs):\n        \"\"\"Create an experiment from a raw data ASCII file.\n\n        Loads the experiment and attaches measured data from the\n        specified file.\n        \"\"\"\n        expt_type = cls._make_experiment_type(kwargs)\n        scattering_type = expt_type.scattering_type.value\n        sample_form = expt_type.sample_form.value\n        expt_class = cls._SUPPORTED[scattering_type][sample_form]\n        expt_name = kwargs['name']\n        expt_obj = expt_class(name=expt_name, type=expt_type)\n        data_path = kwargs['data_path']\n        expt_obj._load_ascii_data_to_experiment(data_path)\n        return expt_obj\n\n    @classmethod\n    def _create_without_data(cls, kwargs):\n        \"\"\"Create an experiment without measured data.\n\n        Returns an experiment instance with only metadata and\n        configuration.\n        \"\"\"\n        expt_type = cls._make_experiment_type(kwargs)\n        scattering_type = expt_type.scattering_type.value\n        sample_form = expt_type.sample_form.value\n        expt_class = cls._SUPPORTED[scattering_type][sample_form]\n        expt_name = kwargs['name']\n        expt_obj = expt_class(name=expt_name, type=expt_type)\n        return expt_obj\n\n    @classmethod\n    def create(cls, **kwargs):\n        \"\"\"Create an `ExperimentBase` using a validated argument\n        combination.\n        \"\"\"\n        # TODO: move to FactoryBase\n        # Check for valid argument combinations\n        user_args = {k for k, v in kwargs.items() if v is not None}\n        cls._validate_args(\n            present=user_args,\n            allowed_specs=cls._ALLOWED_ARG_SPECS,\n            factory_name=cls.__name__,  # TODO: move to FactoryBase\n        )\n\n        # Validate enum arguments if provided\n        if 'sample_form' in kwargs:\n            SampleFormEnum(kwargs['sample_form'])\n        if 'beam_mode' in kwargs:\n            BeamModeEnum(kwargs['beam_mode'])\n        if 'radiation_probe' in kwargs:\n            RadiationProbeEnum(kwargs['radiation_probe'])\n        if 'scattering_type' in kwargs:\n            ScatteringTypeEnum(kwargs['scattering_type'])\n\n        # Dispatch to the appropriate creation method\n        if 'cif_path' in kwargs:\n            return cls._create_from_cif_path(kwargs['cif_path'])\n        elif 'cif_str' in kwargs:\n            return cls._create_from_cif_str(kwargs['cif_str'])\n        elif 'data_path' in kwargs:\n            return cls._create_from_data_path(kwargs)\n        elif 'name' in kwargs:\n            return cls._create_without_data(kwargs)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.factory.ExperimentFactory.create","title":"<code>create(**kwargs)</code>  <code>classmethod</code>","text":"<p>Create an <code>ExperimentBase</code> using a validated argument combination.</p> Source code in <code>src/easydiffraction/experiments/experiment/factory.py</code> <pre><code>@classmethod\ndef create(cls, **kwargs):\n    \"\"\"Create an `ExperimentBase` using a validated argument\n    combination.\n    \"\"\"\n    # TODO: move to FactoryBase\n    # Check for valid argument combinations\n    user_args = {k for k, v in kwargs.items() if v is not None}\n    cls._validate_args(\n        present=user_args,\n        allowed_specs=cls._ALLOWED_ARG_SPECS,\n        factory_name=cls.__name__,  # TODO: move to FactoryBase\n    )\n\n    # Validate enum arguments if provided\n    if 'sample_form' in kwargs:\n        SampleFormEnum(kwargs['sample_form'])\n    if 'beam_mode' in kwargs:\n        BeamModeEnum(kwargs['beam_mode'])\n    if 'radiation_probe' in kwargs:\n        RadiationProbeEnum(kwargs['radiation_probe'])\n    if 'scattering_type' in kwargs:\n        ScatteringTypeEnum(kwargs['scattering_type'])\n\n    # Dispatch to the appropriate creation method\n    if 'cif_path' in kwargs:\n        return cls._create_from_cif_path(kwargs['cif_path'])\n    elif 'cif_str' in kwargs:\n        return cls._create_from_cif_str(kwargs['cif_str'])\n    elif 'data_path' in kwargs:\n        return cls._create_from_data_path(kwargs)\n    elif 'name' in kwargs:\n        return cls._create_without_data(kwargs)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.instrument_mixin","title":"<code>instrument_mixin</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.instrument_mixin.InstrumentMixin","title":"<code>InstrumentMixin</code>","text":"<p>Mixin that wires an experiment to an instrument category.</p> <p>Creates a default instrument via <code>InstrumentFactory</code> using the experiment type (scattering type and beam mode) at initialization.</p> Source code in <code>src/easydiffraction/experiments/experiment/instrument_mixin.py</code> <pre><code>class InstrumentMixin:\n    \"\"\"Mixin that wires an experiment to an instrument category.\n\n    Creates a default instrument via `InstrumentFactory` using the\n    experiment type (scattering type and beam mode) at initialization.\n    \"\"\"\n\n    def __init__(self, *args, **kwargs):\n        expt_type = kwargs.get('type')\n        super().__init__(*args, **kwargs)\n        self._instrument = InstrumentFactory.create(\n            scattering_type=expt_type.scattering_type.value,\n            beam_mode=expt_type.beam_mode.value,\n        )\n\n    @property\n    def instrument(self):\n        \"\"\"Instrument category object associated with the experiment.\"\"\"\n        return self._instrument\n\n    @instrument.setter\n    @typechecked\n    def instrument(self, new_instrument: InstrumentBase):\n        \"\"\"Replace the instrument and re-parent it to this experiment.\n\n        Args:\n            new_instrument: Instrument instance compatible with the\n                experiment type.\n        \"\"\"\n        self._instrument = new_instrument\n        self._instrument._parent = self\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.instrument_mixin.InstrumentMixin.instrument","title":"<code>instrument</code>  <code>property</code> <code>writable</code>","text":"<p>Instrument category object associated with the experiment.</p>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.total_pd","title":"<code>total_pd</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiment.total_pd.TotalPdExperiment","title":"<code>TotalPdExperiment</code>","text":"<p>               Bases: <code>PdExperimentBase</code></p> <p>PDF experiment class with specific attributes.</p> Source code in <code>src/easydiffraction/experiments/experiment/total_pd.py</code> <pre><code>class TotalPdExperiment(PdExperimentBase):\n    \"\"\"PDF experiment class with specific attributes.\"\"\"\n\n    def __init__(\n        self,\n        name: str,\n        type: ExperimentType,\n    ):\n        super().__init__(name=name, type=type)\n\n    def _load_ascii_data_to_experiment(self, data_path):\n        \"\"\"Loads x, y, sy values from an ASCII data file into the\n        experiment.\n\n        The file must be structured as:\n            x  y  sy\n        \"\"\"\n        try:\n            from diffpy.utils.parsers.loaddata import loadData\n        except ImportError:\n            raise ImportError('diffpy module not found.') from None\n        try:\n            data = loadData(data_path)\n        except Exception as e:\n            raise IOError(f'Failed to read data from {data_path}: {e}') from e\n\n        if data.shape[1] &lt; 2:\n            raise ValueError('Data file must have at least two columns: x and y.')\n\n        default_sy = 0.03\n        if data.shape[1] &lt; 3:\n            print(f'Warning: No uncertainty (sy) column provided. Defaulting to {default_sy}.')\n\n        x = data[:, 0]\n        y = data[:, 1]\n        sy = data[:, 2] if data.shape[1] &gt; 2 else np.full_like(y, fill_value=default_sy)\n\n        self.data._set_x(x)\n        self.data._set_meas(y)\n        self.data._set_meas_su(sy)\n\n        console.paragraph('Data loaded successfully')\n        console.print(f\"Experiment \ud83d\udd2c '{self.name}'. Number of data points: {len(x)}\")\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiments","title":"<code>experiments</code>","text":""},{"location":"api-reference/experiments/#easydiffraction.experiments.experiments.Experiments","title":"<code>Experiments</code>","text":"<p>               Bases: <code>DatablockCollection</code></p> <p>Collection of Experiment data blocks.</p> <p>Provides convenience constructors for common creation patterns and helper methods for simple presentation of collection contents.</p> Source code in <code>src/easydiffraction/experiments/experiments.py</code> <pre><code>class Experiments(DatablockCollection):\n    \"\"\"Collection of Experiment data blocks.\n\n    Provides convenience constructors for common creation patterns and\n    helper methods for simple presentation of collection contents.\n    \"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__(item_type=ExperimentBase)\n\n    # --------------------\n    # Add / Remove methods\n    # --------------------\n\n    # TODO: Move to DatablockCollection?\n    # TODO: Disallow args and only allow kwargs?\n    def add(self, **kwargs):\n        experiment = kwargs.pop('experiment', None)\n\n        if experiment is None:\n            experiment = ExperimentFactory.create(**kwargs)\n\n        self._add(experiment)\n\n    # @typechecked\n    # def add_from_cif_path(self, cif_path: str):\n    #    \"\"\"Add an experiment from a CIF file path.\n    #\n    #    Args:\n    #        cif_path: Path to a CIF document.\n    #    \"\"\"\n    #    experiment = ExperimentFactory.create(cif_path=cif_path)\n    #    self.add(experiment)\n\n    # @typechecked\n    # def add_from_cif_str(self, cif_str: str):\n    #    \"\"\"Add an experiment from a CIF string.\n    #\n    #    Args:\n    #        cif_str: Full CIF document as a string.\n    #    \"\"\"\n    #    experiment = ExperimentFactory.create(cif_str=cif_str)\n    #    self.add(experiment)\n\n    # @typechecked\n    # def add_from_data_path(\n    #    self,\n    #    name: str,\n    #    data_path: str,\n    #    sample_form: str = SampleFormEnum.default().value,\n    #    beam_mode: str = BeamModeEnum.default().value,\n    #    radiation_probe: str = RadiationProbeEnum.default().value,\n    #    scattering_type: str = ScatteringTypeEnum.default().value,\n    # ):\n    #    \"\"\"Add an experiment from a data file path.\n    #\n    #    Args:\n    #        name: Experiment identifier.\n    #        data_path: Path to the measured data file.\n    #        sample_form: Sample form (powder or single crystal).\n    #        beam_mode: Beam mode (constant wavelength or TOF).\n    #        radiation_probe: Radiation probe (neutron or xray).\n    #        scattering_type: Scattering type (bragg or total).\n    #    \"\"\"\n    #    experiment = ExperimentFactory.create(\n    #        name=name,\n    #        data_path=data_path,\n    #        sample_form=sample_form,\n    #        beam_mode=beam_mode,\n    #        radiation_probe=radiation_probe,\n    #        scattering_type=scattering_type,\n    #    )\n    #    self.add(experiment)\n\n    # @typechecked\n    # def add_without_data(\n    #    self,\n    #    name: str,\n    #    sample_form: str = SampleFormEnum.default().value,\n    #    beam_mode: str = BeamModeEnum.default().value,\n    #    radiation_probe: str = RadiationProbeEnum.default().value,\n    #    scattering_type: str = ScatteringTypeEnum.default().value,\n    # ):\n    #    \"\"\"Add an experiment without associating a data file.\n    #\n    #    Args:\n    #        name: Experiment identifier.\n    #        sample_form: Sample form (powder or single crystal).\n    #        beam_mode: Beam mode (constant wavelength or TOF).\n    #        radiation_probe: Radiation probe (neutron or xray).\n    #        scattering_type: Scattering type (bragg or total).\n    #    \"\"\"\n    #    experiment = ExperimentFactory.create(\n    #        name=name,\n    #        sample_form=sample_form,\n    #        beam_mode=beam_mode,\n    #        radiation_probe=radiation_probe,\n    #        scattering_type=scattering_type,\n    #    )\n    #    self.add(experiment)\n\n    # TODO: Move to DatablockCollection?\n    @typechecked\n    def remove(self, name: str) -&gt; None:\n        \"\"\"Remove an experiment by name if it exists.\"\"\"\n        if name in self:\n            del self[name]\n\n    # ------------\n    # Show methods\n    # ------------\n\n    # TODO: Move to DatablockCollection?\n    def show_names(self) -&gt; None:\n        \"\"\"Print the list of experiment names.\"\"\"\n        console.paragraph('Defined experiments' + ' \ud83d\udd2c')\n        console.print(self.names)\n\n    # TODO: Move to DatablockCollection?\n    def show_params(self) -&gt; None:\n        \"\"\"Print parameters for each experiment in the collection.\"\"\"\n        for exp in self.values():\n            exp.show_params()\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiments.Experiments.remove","title":"<code>remove(name)</code>","text":"<p>Remove an experiment by name if it exists.</p> Source code in <code>src/easydiffraction/experiments/experiments.py</code> <pre><code>@typechecked\ndef remove(self, name: str) -&gt; None:\n    \"\"\"Remove an experiment by name if it exists.\"\"\"\n    if name in self:\n        del self[name]\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiments.Experiments.show_names","title":"<code>show_names()</code>","text":"<p>Print the list of experiment names.</p> Source code in <code>src/easydiffraction/experiments/experiments.py</code> <pre><code>def show_names(self) -&gt; None:\n    \"\"\"Print the list of experiment names.\"\"\"\n    console.paragraph('Defined experiments' + ' \ud83d\udd2c')\n    console.print(self.names)\n</code></pre>"},{"location":"api-reference/experiments/#easydiffraction.experiments.experiments.Experiments.show_params","title":"<code>show_params()</code>","text":"<p>Print parameters for each experiment in the collection.</p> Source code in <code>src/easydiffraction/experiments/experiments.py</code> <pre><code>def show_params(self) -&gt; None:\n    \"\"\"Print parameters for each experiment in the collection.\"\"\"\n    for exp in self.values():\n        exp.show_params()\n</code></pre>"},{"location":"api-reference/io/","title":"io","text":""},{"location":"api-reference/io/#easydiffraction.io","title":"<code>io</code>","text":""},{"location":"api-reference/io/#easydiffraction.io.cif","title":"<code>cif</code>","text":""},{"location":"api-reference/io/#easydiffraction.io.cif.handler","title":"<code>handler</code>","text":"<p>Minimal CIF tag handler used by descriptors/parameters.</p>"},{"location":"api-reference/io/#easydiffraction.io.cif.handler.CifHandler","title":"<code>CifHandler</code>","text":"<p>Canonical CIF handler used by descriptors/parameters.</p> <p>Holds CIF tags (names) and attaches to an owning descriptor so it can derive a stable uid if needed.</p> Source code in <code>src/easydiffraction/io/cif/handler.py</code> <pre><code>class CifHandler:\n    \"\"\"Canonical CIF handler used by descriptors/parameters.\n\n    Holds CIF tags (names) and attaches to an owning descriptor so it\n    can derive a stable uid if needed.\n    \"\"\"\n\n    def __init__(self, *, names: list[str]) -&gt; None:\n        self._names = names\n        self._owner = None  # set by attach\n\n    def attach(self, owner):\n        \"\"\"Attach to a descriptor or parameter instance.\"\"\"\n        self._owner = owner\n\n    @property\n    def names(self) -&gt; list[str]:\n        \"\"\"List of CIF tag names associated with the owner.\"\"\"\n        return self._names\n\n    @property\n    def uid(self) -&gt; str | None:\n        \"\"\"Unique identifier taken from the owner, if attached.\"\"\"\n        if self._owner is None:\n            return None\n        return self._owner.unique_name\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.handler.CifHandler.attach","title":"<code>attach(owner)</code>","text":"<p>Attach to a descriptor or parameter instance.</p> Source code in <code>src/easydiffraction/io/cif/handler.py</code> <pre><code>def attach(self, owner):\n    \"\"\"Attach to a descriptor or parameter instance.\"\"\"\n    self._owner = owner\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.handler.CifHandler.names","title":"<code>names</code>  <code>property</code>","text":"<p>List of CIF tag names associated with the owner.</p>"},{"location":"api-reference/io/#easydiffraction.io.cif.handler.CifHandler.uid","title":"<code>uid</code>  <code>property</code>","text":"<p>Unique identifier taken from the owner, if attached.</p>"},{"location":"api-reference/io/#easydiffraction.io.cif.parse","title":"<code>parse</code>","text":""},{"location":"api-reference/io/#easydiffraction.io.cif.parse.document_from_path","title":"<code>document_from_path(path)</code>","text":"<p>Read a CIF document from a file path.</p> Source code in <code>src/easydiffraction/io/cif/parse.py</code> <pre><code>def document_from_path(path: str) -&gt; gemmi.cif.Document:\n    \"\"\"Read a CIF document from a file path.\"\"\"\n    return gemmi.cif.read_file(path)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.parse.document_from_string","title":"<code>document_from_string(text)</code>","text":"<p>Read a CIF document from a raw text string.</p> Source code in <code>src/easydiffraction/io/cif/parse.py</code> <pre><code>def document_from_string(text: str) -&gt; gemmi.cif.Document:\n    \"\"\"Read a CIF document from a raw text string.\"\"\"\n    return gemmi.cif.read_string(text)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.parse.name_from_block","title":"<code>name_from_block(block)</code>","text":"<p>Extract a model name from the CIF block name.</p> Source code in <code>src/easydiffraction/io/cif/parse.py</code> <pre><code>def name_from_block(block: gemmi.cif.Block) -&gt; str:\n    \"\"\"Extract a model name from the CIF block name.\"\"\"\n    # TODO: Need validator or normalization?\n    return block.name\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.parse.pick_sole_block","title":"<code>pick_sole_block(doc)</code>","text":"<p>Pick the sole data block from a CIF document.</p> Source code in <code>src/easydiffraction/io/cif/parse.py</code> <pre><code>def pick_sole_block(doc: gemmi.cif.Document) -&gt; gemmi.cif.Block:\n    \"\"\"Pick the sole data block from a CIF document.\"\"\"\n    return doc.sole_block()\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize","title":"<code>serialize</code>","text":""},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.analysis_to_cif","title":"<code>analysis_to_cif(analysis)</code>","text":"<p>Render analysis metadata, aliases, and constraints to CIF.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def analysis_to_cif(analysis) -&gt; str:\n    \"\"\"Render analysis metadata, aliases, and constraints to CIF.\"\"\"\n    cur_min = format_value(analysis.current_minimizer)\n    lines: list[str] = []\n    lines.append(f'_analysis.calculator_engine  {format_value(analysis.current_calculator)}')\n    lines.append(f'_analysis.fitting_engine  {cur_min}')\n    lines.append(f'_analysis.fit_mode  {format_value(analysis.fit_mode)}')\n    lines.append('')\n    lines.append(analysis.aliases.as_cif)\n    lines.append('')\n    lines.append(analysis.constraints.as_cif)\n    return '\\n'.join(lines)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.category_collection_to_cif","title":"<code>category_collection_to_cif(collection, max_display=20)</code>","text":"<p>Render a CategoryCollection-like object to CIF text.</p> <p>Uses first item to build loop header, then emits rows for each item.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def category_collection_to_cif(\n    collection,\n    max_display: Optional[int] = 20,\n) -&gt; str:\n    \"\"\"Render a CategoryCollection-like object to CIF text.\n\n    Uses first item to build loop header, then emits rows for each item.\n    \"\"\"\n    if not len(collection):\n        return ''\n\n    lines: list[str] = []\n\n    # Header\n    first_item = list(collection.values())[0]\n    lines.append('loop_')\n    for p in first_item.parameters:\n        tags = p._cif_handler.names  # type: ignore[attr-defined]\n        lines.append(tags[0])\n\n    # Rows\n    # Limit number of displayed rows if requested\n    if len(collection) &gt; max_display:\n        half_display = max_display // 2\n        for i in range(half_display):\n            item = list(collection.values())[i]\n            row_vals = [format_value(p.value) for p in item.parameters]\n            lines.append(' '.join(row_vals))\n        lines.append('...')\n        for i in range(-half_display, 0):\n            item = list(collection.values())[i]\n            row_vals = [format_value(p.value) for p in item.parameters]\n            lines.append(' '.join(row_vals))\n    # No limit\n    else:\n        for item in collection.values():\n            row_vals = [format_value(p.value) for p in item.parameters]\n            lines.append(' '.join(row_vals))\n\n    return '\\n'.join(lines)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.category_item_from_cif","title":"<code>category_item_from_cif(self, block, idx=0)</code>","text":"<p>Populate each parameter from CIF block at given loop index.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def category_item_from_cif(\n    self: CategoryItem,\n    block: gemmi.cif.Block,\n    idx: int = 0,\n) -&gt; None:\n    \"\"\"Populate each parameter from CIF block at given loop index.\"\"\"\n    for param in self.parameters:\n        param.from_cif(block, idx=idx)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.category_item_to_cif","title":"<code>category_item_to_cif(item)</code>","text":"<p>Render a CategoryItem-like object to CIF text.</p> <p>Expects <code>item.parameters</code> iterable of params with <code>_cif_handler.names</code> and <code>value</code>.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def category_item_to_cif(item) -&gt; str:\n    \"\"\"Render a CategoryItem-like object to CIF text.\n\n    Expects ``item.parameters`` iterable of params with\n    ``_cif_handler.names`` and ``value``.\n    \"\"\"\n    lines: list[str] = []\n    for p in item.parameters:\n        lines.append(param_to_cif(p))\n    return '\\n'.join(lines)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.datablock_collection_to_cif","title":"<code>datablock_collection_to_cif(collection)</code>","text":"<p>Render a collection of datablocks by joining their CIF blocks.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def datablock_collection_to_cif(collection) -&gt; str:\n    \"\"\"Render a collection of datablocks by joining their CIF blocks.\"\"\"\n    return '\\n\\n'.join([block.as_cif for block in collection.values()])\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.datablock_item_to_cif","title":"<code>datablock_item_to_cif(datablock)</code>","text":"<p>Render a DatablockItem-like object to CIF text.</p> <p>Emits a data_ header and then concatenates category CIF sections.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def datablock_item_to_cif(datablock) -&gt; str:\n    \"\"\"Render a DatablockItem-like object to CIF text.\n\n    Emits a data_ header and then concatenates category CIF sections.\n    \"\"\"\n    # Local imports to avoid import-time cycles\n    from easydiffraction.core.category import CategoryCollection\n    from easydiffraction.core.category import CategoryItem\n\n    header = f'data_{datablock._identity.datablock_entry_name}'\n    parts: list[str] = [header]\n\n    # First categories\n    for v in vars(datablock).values():\n        if isinstance(v, CategoryItem):\n            parts.append(v.as_cif)\n\n    # Then collections\n    for v in vars(datablock).values():\n        if isinstance(v, CategoryCollection):\n            parts.append(v.as_cif)\n\n    return '\\n\\n'.join(parts)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.experiment_to_cif","title":"<code>experiment_to_cif(experiment)</code>","text":"<p>Render an experiment: datablock part plus measured data.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def experiment_to_cif(experiment) -&gt; str:\n    \"\"\"Render an experiment: datablock part plus measured data.\"\"\"\n    return datablock_item_to_cif(experiment)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.format_value","title":"<code>format_value(value)</code>","text":"<p>Format a single CIF value, quoting strings with whitespace, and format floats with global precision.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def format_value(value) -&gt; str:\n    \"\"\"Format a single CIF value, quoting strings with whitespace, and\n    format floats with global precision.\n    \"\"\"\n    width = 8\n    precision = 4\n\n    # Converting\n\n    # Convert ints to floats\n    if isinstance(value, int):\n        value = float(value)\n    # Strings with whitespace are quoted\n    elif isinstance(value, str) and (' ' in value or '\\t' in value):\n        value = f'\"{value}\"'\n\n    # Formatting\n\n    # Format floats with given precision\n    if isinstance(value, float):\n        return f'{value:&gt;{width}.{precision}f}'\n    # Format strings right-aligned\n    elif isinstance(value, str):\n        return f'{value:&gt;{width}s}'\n    # Everything else: fallback\n    else:\n        return str(value)\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.param_to_cif","title":"<code>param_to_cif(param)</code>","text":"<p>Render a single descriptor/parameter to a CIF line.</p> <p>Expects <code>param</code> to expose <code>_cif_handler.names</code> and <code>value</code>.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def param_to_cif(param) -&gt; str:\n    \"\"\"Render a single descriptor/parameter to a CIF line.\n\n    Expects ``param`` to expose ``_cif_handler.names`` and ``value``.\n    \"\"\"\n    tags: Sequence[str] = param._cif_handler.names  # type: ignore[attr-defined]\n    main_key: str = tags[0]\n    return f'{main_key} {format_value(param.value)}'\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.project_info_to_cif","title":"<code>project_info_to_cif(info)</code>","text":"<p>Render ProjectInfo to CIF text (id, title, description, dates).</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def project_info_to_cif(info) -&gt; str:\n    \"\"\"Render ProjectInfo to CIF text (id, title, description,\n    dates).\n    \"\"\"\n    name = f'{info.name}'\n\n    title = f'{info.title}'\n    if ' ' in title:\n        title = f\"'{title}'\"\n\n    if len(info.description) &gt; 60:\n        description = f'\\n;\\n{info.description}\\n;'\n    else:\n        description = f'{info.description}'\n        if ' ' in description:\n            description = f\"'{description}'\"\n\n    created = f\"'{info._created.strftime('%d %b %Y %H:%M:%S')}'\"\n    last_modified = f\"'{info._last_modified.strftime('%d %b %Y %H:%M:%S')}'\"\n\n    return (\n        f'_project.id               {name}\\n'\n        f'_project.title            {title}\\n'\n        f'_project.description      {description}\\n'\n        f'_project.created          {created}\\n'\n        f'_project.last_modified    {last_modified}'\n    )\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.project_to_cif","title":"<code>project_to_cif(project)</code>","text":"<p>Render a whole project by concatenating sections when present.</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def project_to_cif(project) -&gt; str:\n    \"\"\"Render a whole project by concatenating sections when present.\"\"\"\n    parts: list[str] = []\n    if hasattr(project, 'info'):\n        parts.append(project.info.as_cif)\n    if getattr(project, 'sample_models', None):\n        parts.append(project.sample_models.as_cif)\n    if getattr(project, 'experiments', None):\n        parts.append(project.experiments.as_cif)\n    if getattr(project, 'analysis', None):\n        parts.append(project.analysis.as_cif())\n    if getattr(project, 'summary', None):\n        parts.append(project.summary.as_cif())\n    return '\\n\\n'.join([p for p in parts if p])\n</code></pre>"},{"location":"api-reference/io/#easydiffraction.io.cif.serialize.summary_to_cif","title":"<code>summary_to_cif(_summary)</code>","text":"<p>Render a summary CIF block (placeholder for now).</p> Source code in <code>src/easydiffraction/io/cif/serialize.py</code> <pre><code>def summary_to_cif(_summary) -&gt; str:\n    \"\"\"Render a summary CIF block (placeholder for now).\"\"\"\n    return 'To be added...'\n</code></pre>"},{"location":"api-reference/project/","title":"project","text":""},{"location":"api-reference/project/#easydiffraction.project","title":"<code>project</code>","text":""},{"location":"api-reference/project/#easydiffraction.project.project","title":"<code>project</code>","text":"<p>Project facade to orchestrate models, experiments, and analysis.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project","title":"<code>Project</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>Central API for managing a diffraction data analysis project.</p> <p>Provides access to sample models, experiments, analysis, and summary.</p> Source code in <code>src/easydiffraction/project/project.py</code> <pre><code>class Project(GuardedBase):\n    \"\"\"Central API for managing a diffraction data analysis project.\n\n    Provides access to sample models, experiments, analysis, and\n    summary.\n    \"\"\"\n\n    # ------------------------------------------------------------------\n    # Initialization\n    # ------------------------------------------------------------------\n    def __init__(\n        self,\n        name: str = 'untitled_project',\n        title: str = 'Untitled Project',\n        description: str = '',\n    ) -&gt; None:\n        super().__init__()\n\n        self._info: ProjectInfo = ProjectInfo(name, title, description)\n        self._sample_models = SampleModels()\n        self._experiments = Experiments()\n        self._tabler = TableRenderer.get()\n        self._plotter = Plotter()\n        self._analysis = Analysis(self)\n        self._summary = Summary(self)\n        self._saved = False\n        self._varname = varname()\n\n    # ------------------------------------------------------------------\n    # Dunder methods\n    # ------------------------------------------------------------------\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation.\"\"\"\n        class_name = self.__class__.__name__\n        project_name = self.name\n        sample_models_count = len(self.sample_models)\n        experiments_count = len(self.experiments)\n        return (\n            f\"{class_name} '{project_name}' \"\n            f'({sample_models_count} sample models, '\n            f'{experiments_count} experiments)'\n        )\n\n    # ------------------------------------------------------------------\n    # Public read-only properties\n    # ------------------------------------------------------------------\n\n    @property\n    def info(self) -&gt; ProjectInfo:\n        \"\"\"Project metadata container.\"\"\"\n        return self._info\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Convenience property to access the project's name\n        directly.\n        \"\"\"\n        return self._info.name\n\n    @property\n    def full_name(self) -&gt; str:\n        return self.name\n\n    @property\n    def sample_models(self) -&gt; SampleModels:\n        \"\"\"Collection of sample models in the project.\"\"\"\n        return self._sample_models\n\n    @sample_models.setter\n    @typechecked\n    def sample_models(self, sample_models: SampleModels) -&gt; None:\n        self._sample_models = sample_models\n\n    @property\n    def experiments(self):\n        \"\"\"Collection of experiments in the project.\"\"\"\n        return self._experiments\n\n    @experiments.setter\n    @typechecked\n    def experiments(self, experiments: Experiments):\n        self._experiments = experiments\n\n    @property\n    def plotter(self):\n        \"\"\"Plotting facade bound to the project.\"\"\"\n        return self._plotter\n\n    @property\n    def tabler(self):\n        \"\"\"Tables rendering facade bound to the project.\"\"\"\n        return self._tabler\n\n    @property\n    def analysis(self):\n        \"\"\"Analysis entry-point bound to the project.\"\"\"\n        return self._analysis\n\n    @property\n    def summary(self):\n        \"\"\"Summary report builder bound to the project.\"\"\"\n        return self._summary\n\n    @property\n    def parameters(self):\n        \"\"\"Return parameters from all components (TBD).\"\"\"\n        # To be implemented: return all parameters in the project\n        return []\n\n    @property\n    def as_cif(self):\n        \"\"\"Export whole project as CIF text.\"\"\"\n        # Concatenate sections using centralized CIF serializers\n        return project_to_cif(self)\n\n    # ------------------------------------------\n    #  Project File I/O\n    # ------------------------------------------\n\n    def load(self, dir_path: str) -&gt; None:\n        \"\"\"Load a project from a given directory.\n\n        Loads project info, sample models, experiments, etc.\n        \"\"\"\n        console.paragraph('Loading project \ud83d\udce6 from')\n        console.print(dir_path)\n        self._info.path = dir_path\n        # TODO: load project components from files inside dir_path\n        console.print('Loading project is not implemented yet.')\n        self._saved = True\n\n    def save(self) -&gt; None:\n        \"\"\"Save the project into the existing project directory.\"\"\"\n        if not self._info.path:\n            log.error('Project path not specified. Use save_as() to define the path first.')\n            return\n\n        console.paragraph(f\"Saving project \ud83d\udce6 '{self.name}' to\")\n        console.print(self.info.path.resolve())\n\n        # Ensure project directory exists\n        self._info.path.mkdir(parents=True, exist_ok=True)\n\n        # Save project info\n        with (self._info.path / 'project.cif').open('w') as f:\n            f.write(self._info.as_cif())\n            console.print('\u251c\u2500\u2500 \ud83d\udcc4 project.cif')\n\n        # Save sample models\n        sm_dir = self._info.path / 'sample_models'\n        sm_dir.mkdir(parents=True, exist_ok=True)\n        # Iterate over sample model objects (MutableMapping iter gives\n        # keys)\n        for model in self.sample_models.values():\n            file_name: str = f'{model.name}.cif'\n            file_path = sm_dir / file_name\n            console.print('\u251c\u2500\u2500 \ud83d\udcc1 sample_models')\n            with file_path.open('w') as f:\n                f.write(model.as_cif)\n                console.print(f'\u2502   \u2514\u2500\u2500 \ud83d\udcc4 {file_name}')\n\n        # Save experiments\n        expt_dir = self._info.path / 'experiments'\n        expt_dir.mkdir(parents=True, exist_ok=True)\n        for experiment in self.experiments.values():\n            file_name: str = f'{experiment.name}.cif'\n            file_path = expt_dir / file_name\n            console.print('\u251c\u2500\u2500 \ud83d\udcc1 experiments')\n            with file_path.open('w') as f:\n                f.write(experiment.as_cif)\n                console.print(f'\u2502   \u2514\u2500\u2500 \ud83d\udcc4 {file_name}')\n\n        # Save analysis\n        with (self._info.path / 'analysis.cif').open('w') as f:\n            f.write(self.analysis.as_cif())\n            console.print('\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif')\n\n        # Save summary\n        with (self._info.path / 'summary.cif').open('w') as f:\n            f.write(self.summary.as_cif())\n            console.print('\u2514\u2500\u2500 \ud83d\udcc4 summary.cif')\n\n        self._info.update_last_modified()\n        self._saved = True\n\n    def save_as(\n        self,\n        dir_path: str,\n        temporary: bool = False,\n    ) -&gt; None:\n        \"\"\"Save the project into a new directory.\"\"\"\n        if temporary:\n            tmp: str = tempfile.gettempdir()\n            dir_path = pathlib.Path(tmp) / dir_path\n        self._info.path = dir_path\n        self.save()\n\n    # ------------------------------------------\n    # Plotting\n    # ------------------------------------------\n\n    def _update_categories(self, expt_name) -&gt; None:\n        for sample_model in self.sample_models:\n            sample_model._update_categories()\n        self.analysis._update_categories()\n        experiment = self.experiments[expt_name]\n        experiment._update_categories()\n\n    def plot_meas(\n        self,\n        expt_name,\n        x_min=None,\n        x_max=None,\n        d_spacing=False,\n    ):\n        self._update_categories(expt_name)\n        experiment = self.experiments[expt_name]\n\n        self.plotter.plot_meas(\n            experiment.data,\n            expt_name,\n            experiment.type,\n            x_min=x_min,\n            x_max=x_max,\n            d_spacing=d_spacing,\n        )\n\n    def plot_calc(\n        self,\n        expt_name,\n        x_min=None,\n        x_max=None,\n        d_spacing=False,\n    ):\n        self._update_categories(expt_name)\n        experiment = self.experiments[expt_name]\n\n        self.plotter.plot_calc(\n            experiment.data,\n            expt_name,\n            experiment.type,\n            x_min=x_min,\n            x_max=x_max,\n            d_spacing=d_spacing,\n        )\n\n    def plot_meas_vs_calc(\n        self,\n        expt_name,\n        x_min=None,\n        x_max=None,\n        show_residual=False,\n        d_spacing=False,\n    ):\n        self._update_categories(expt_name)\n        experiment = self.experiments[expt_name]\n\n        self.plotter.plot_meas_vs_calc(\n            experiment.data,\n            expt_name,\n            experiment.type,\n            x_min=x_min,\n            x_max=x_max,\n            show_residual=show_residual,\n            d_spacing=d_spacing,\n        )\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation.</p> Source code in <code>src/easydiffraction/project/project.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation.\"\"\"\n    class_name = self.__class__.__name__\n    project_name = self.name\n    sample_models_count = len(self.sample_models)\n    experiments_count = len(self.experiments)\n    return (\n        f\"{class_name} '{project_name}' \"\n        f'({sample_models_count} sample models, '\n        f'{experiments_count} experiments)'\n    )\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.analysis","title":"<code>analysis</code>  <code>property</code>","text":"<p>Analysis entry-point bound to the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.as_cif","title":"<code>as_cif</code>  <code>property</code>","text":"<p>Export whole project as CIF text.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.experiments","title":"<code>experiments</code>  <code>property</code> <code>writable</code>","text":"<p>Collection of experiments in the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.info","title":"<code>info</code>  <code>property</code>","text":"<p>Project metadata container.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.load","title":"<code>load(dir_path)</code>","text":"<p>Load a project from a given directory.</p> <p>Loads project info, sample models, experiments, etc.</p> Source code in <code>src/easydiffraction/project/project.py</code> <pre><code>def load(self, dir_path: str) -&gt; None:\n    \"\"\"Load a project from a given directory.\n\n    Loads project info, sample models, experiments, etc.\n    \"\"\"\n    console.paragraph('Loading project \ud83d\udce6 from')\n    console.print(dir_path)\n    self._info.path = dir_path\n    # TODO: load project components from files inside dir_path\n    console.print('Loading project is not implemented yet.')\n    self._saved = True\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.name","title":"<code>name</code>  <code>property</code>","text":"<p>Convenience property to access the project's name directly.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.parameters","title":"<code>parameters</code>  <code>property</code>","text":"<p>Return parameters from all components (TBD).</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.plotter","title":"<code>plotter</code>  <code>property</code>","text":"<p>Plotting facade bound to the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.sample_models","title":"<code>sample_models</code>  <code>property</code> <code>writable</code>","text":"<p>Collection of sample models in the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.save","title":"<code>save()</code>","text":"<p>Save the project into the existing project directory.</p> Source code in <code>src/easydiffraction/project/project.py</code> <pre><code>def save(self) -&gt; None:\n    \"\"\"Save the project into the existing project directory.\"\"\"\n    if not self._info.path:\n        log.error('Project path not specified. Use save_as() to define the path first.')\n        return\n\n    console.paragraph(f\"Saving project \ud83d\udce6 '{self.name}' to\")\n    console.print(self.info.path.resolve())\n\n    # Ensure project directory exists\n    self._info.path.mkdir(parents=True, exist_ok=True)\n\n    # Save project info\n    with (self._info.path / 'project.cif').open('w') as f:\n        f.write(self._info.as_cif())\n        console.print('\u251c\u2500\u2500 \ud83d\udcc4 project.cif')\n\n    # Save sample models\n    sm_dir = self._info.path / 'sample_models'\n    sm_dir.mkdir(parents=True, exist_ok=True)\n    # Iterate over sample model objects (MutableMapping iter gives\n    # keys)\n    for model in self.sample_models.values():\n        file_name: str = f'{model.name}.cif'\n        file_path = sm_dir / file_name\n        console.print('\u251c\u2500\u2500 \ud83d\udcc1 sample_models')\n        with file_path.open('w') as f:\n            f.write(model.as_cif)\n            console.print(f'\u2502   \u2514\u2500\u2500 \ud83d\udcc4 {file_name}')\n\n    # Save experiments\n    expt_dir = self._info.path / 'experiments'\n    expt_dir.mkdir(parents=True, exist_ok=True)\n    for experiment in self.experiments.values():\n        file_name: str = f'{experiment.name}.cif'\n        file_path = expt_dir / file_name\n        console.print('\u251c\u2500\u2500 \ud83d\udcc1 experiments')\n        with file_path.open('w') as f:\n            f.write(experiment.as_cif)\n            console.print(f'\u2502   \u2514\u2500\u2500 \ud83d\udcc4 {file_name}')\n\n    # Save analysis\n    with (self._info.path / 'analysis.cif').open('w') as f:\n        f.write(self.analysis.as_cif())\n        console.print('\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif')\n\n    # Save summary\n    with (self._info.path / 'summary.cif').open('w') as f:\n        f.write(self.summary.as_cif())\n        console.print('\u2514\u2500\u2500 \ud83d\udcc4 summary.cif')\n\n    self._info.update_last_modified()\n    self._saved = True\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.save_as","title":"<code>save_as(dir_path, temporary=False)</code>","text":"<p>Save the project into a new directory.</p> Source code in <code>src/easydiffraction/project/project.py</code> <pre><code>def save_as(\n    self,\n    dir_path: str,\n    temporary: bool = False,\n) -&gt; None:\n    \"\"\"Save the project into a new directory.\"\"\"\n    if temporary:\n        tmp: str = tempfile.gettempdir()\n        dir_path = pathlib.Path(tmp) / dir_path\n    self._info.path = dir_path\n    self.save()\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.summary","title":"<code>summary</code>  <code>property</code>","text":"<p>Summary report builder bound to the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project.Project.tabler","title":"<code>tabler</code>  <code>property</code>","text":"<p>Tables rendering facade bound to the project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info","title":"<code>project_info</code>","text":"<p>Project metadata container used by Project.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo","title":"<code>ProjectInfo</code>","text":"<p>               Bases: <code>GuardedBase</code></p> <p>Stores metadata about the project, such as name, title, description, and file paths.</p> Source code in <code>src/easydiffraction/project/project_info.py</code> <pre><code>class ProjectInfo(GuardedBase):\n    \"\"\"Stores metadata about the project, such as name, title,\n    description, and file paths.\n    \"\"\"\n\n    def __init__(\n        self,\n        name: str = 'untitled_project',\n        title: str = 'Untitled Project',\n        description: str = '',\n    ) -&gt; None:\n        super().__init__()\n\n        self._name = name\n        self._title = title\n        self._description = description\n        self._path: pathlib.Path = pathlib.Path.cwd()\n        self._created: datetime.datetime = datetime.datetime.now()\n        self._last_modified: datetime.datetime = datetime.datetime.now()\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Return the project name.\"\"\"\n        return self._name\n\n    @name.setter\n    def name(self, value: str) -&gt; None:\n        self._name = value\n\n    @property\n    def unique_name(self) -&gt; str:\n        \"\"\"Unique name for GuardedBase diagnostics.\"\"\"\n        return self.name\n\n    @property\n    def title(self) -&gt; str:\n        \"\"\"Return the project title.\"\"\"\n        return self._title\n\n    @title.setter\n    def title(self, value: str) -&gt; None:\n        self._title = value\n\n    @property\n    def description(self) -&gt; str:\n        \"\"\"Return sanitized description with single spaces.\"\"\"\n        return ' '.join(self._description.split())\n\n    @description.setter\n    def description(self, value: str) -&gt; None:\n        self._description = ' '.join(value.split())\n\n    @property\n    def path(self) -&gt; pathlib.Path:\n        \"\"\"Return the project path as a Path object.\"\"\"\n        return self._path\n\n    @path.setter\n    def path(self, value) -&gt; None:\n        # Accept str or Path; normalize to Path\n        self._path = pathlib.Path(value)\n\n    @property\n    def created(self) -&gt; datetime.datetime:\n        \"\"\"Return the creation timestamp.\"\"\"\n        return self._created\n\n    @property\n    def last_modified(self) -&gt; datetime.datetime:\n        \"\"\"Return the last modified timestamp.\"\"\"\n        return self._last_modified\n\n    def update_last_modified(self) -&gt; None:\n        \"\"\"Update the last modified timestamp.\"\"\"\n        self._last_modified = datetime.datetime.now()\n\n    def parameters(self):\n        \"\"\"Placeholder for parameter listing.\"\"\"\n        pass\n\n    # TODO: Consider moving to io.cif.serialize\n    def as_cif(self) -&gt; str:\n        \"\"\"Export project metadata to CIF.\"\"\"\n        return project_info_to_cif(self)\n\n    # TODO: Consider moving to io.cif.serialize\n    def show_as_cif(self) -&gt; None:\n        \"\"\"Pretty-print CIF via shared utilities.\"\"\"\n        paragraph_title: str = f\"Project \ud83d\udce6 '{self.name}' info as CIF\"\n        cif_text: str = self.as_cif()\n        console.paragraph(paragraph_title)\n        render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.as_cif","title":"<code>as_cif()</code>","text":"<p>Export project metadata to CIF.</p> Source code in <code>src/easydiffraction/project/project_info.py</code> <pre><code>def as_cif(self) -&gt; str:\n    \"\"\"Export project metadata to CIF.\"\"\"\n    return project_info_to_cif(self)\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.created","title":"<code>created</code>  <code>property</code>","text":"<p>Return the creation timestamp.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.description","title":"<code>description</code>  <code>property</code> <code>writable</code>","text":"<p>Return sanitized description with single spaces.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.last_modified","title":"<code>last_modified</code>  <code>property</code>","text":"<p>Return the last modified timestamp.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.name","title":"<code>name</code>  <code>property</code> <code>writable</code>","text":"<p>Return the project name.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.parameters","title":"<code>parameters()</code>","text":"<p>Placeholder for parameter listing.</p> Source code in <code>src/easydiffraction/project/project_info.py</code> <pre><code>def parameters(self):\n    \"\"\"Placeholder for parameter listing.\"\"\"\n    pass\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.path","title":"<code>path</code>  <code>property</code> <code>writable</code>","text":"<p>Return the project path as a Path object.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.show_as_cif","title":"<code>show_as_cif()</code>","text":"<p>Pretty-print CIF via shared utilities.</p> Source code in <code>src/easydiffraction/project/project_info.py</code> <pre><code>def show_as_cif(self) -&gt; None:\n    \"\"\"Pretty-print CIF via shared utilities.\"\"\"\n    paragraph_title: str = f\"Project \ud83d\udce6 '{self.name}' info as CIF\"\n    cif_text: str = self.as_cif()\n    console.paragraph(paragraph_title)\n    render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.title","title":"<code>title</code>  <code>property</code> <code>writable</code>","text":"<p>Return the project title.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.unique_name","title":"<code>unique_name</code>  <code>property</code>","text":"<p>Unique name for GuardedBase diagnostics.</p>"},{"location":"api-reference/project/#easydiffraction.project.project_info.ProjectInfo.update_last_modified","title":"<code>update_last_modified()</code>","text":"<p>Update the last modified timestamp.</p> Source code in <code>src/easydiffraction/project/project_info.py</code> <pre><code>def update_last_modified(self) -&gt; None:\n    \"\"\"Update the last modified timestamp.\"\"\"\n    self._last_modified = datetime.datetime.now()\n</code></pre>"},{"location":"api-reference/sample_models/","title":"sample_models","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models","title":"<code>sample_models</code>","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories","title":"<code>categories</code>","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites","title":"<code>atom_sites</code>","text":"<p>Atom site category.</p> <p>Defines AtomSite items and AtomSites collection used in sample models. Only documentation was added; behavior remains unchanged.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite","title":"<code>AtomSite</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Single atom site with fractional coordinates and ADP.</p> <p>Attributes are represented by descriptors to support validation and CIF serialization.</p> Source code in <code>src/easydiffraction/sample_models/categories/atom_sites.py</code> <pre><code>class AtomSite(CategoryItem):\n    \"\"\"Single atom site with fractional coordinates and ADP.\n\n    Attributes are represented by descriptors to support validation and\n    CIF serialization.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        label=None,\n        type_symbol=None,\n        fract_x=None,\n        fract_y=None,\n        fract_z=None,\n        wyckoff_letter=None,\n        occupancy=None,\n        b_iso=None,\n        adp_type=None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._label: StringDescriptor = StringDescriptor(\n            name='label',\n            description='Unique identifier for the atom site.',\n            value_spec=AttributeSpec(\n                value=label,\n                type_=DataTypes.STRING,\n                default='Si',\n                # TODO: the following pattern is valid for dict key\n                #  (keywords are not checked). CIF label is less strict.\n                #  Do we need conversion between CIF and internal label?\n                content_validator=RegexValidator(pattern=r'^[A-Za-z_][A-Za-z0-9_]*$'),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.label',\n                ]\n            ),\n        )\n        self._type_symbol: StringDescriptor = StringDescriptor(\n            name='type_symbol',\n            description='Chemical symbol of the atom at this site.',\n            value_spec=AttributeSpec(\n                value=type_symbol,\n                type_=DataTypes.STRING,\n                default='Tb',\n                content_validator=MembershipValidator(allowed=self._type_symbol_allowed_values),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.type_symbol',\n                ]\n            ),\n        )\n        self._fract_x: Parameter = Parameter(\n            name='fract_x',\n            description='Fractional x-coordinate of the atom site within the unit cell.',\n            value_spec=AttributeSpec(\n                value=fract_x,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.fract_x',\n                ]\n            ),\n        )\n        self._fract_y: Parameter = Parameter(\n            name='fract_y',\n            description='Fractional y-coordinate of the atom site within the unit cell.',\n            value_spec=AttributeSpec(\n                value=fract_y,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.fract_y',\n                ]\n            ),\n        )\n        self._fract_z: Parameter = Parameter(\n            name='fract_z',\n            description='Fractional z-coordinate of the atom site within the unit cell.',\n            value_spec=AttributeSpec(\n                value=fract_z,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.fract_z',\n                ]\n            ),\n        )\n        self._wyckoff_letter: StringDescriptor = StringDescriptor(\n            name='wyckoff_letter',\n            description='Wyckoff letter indicating the symmetry of the '\n            'atom site within the space group.',\n            value_spec=AttributeSpec(\n                value=wyckoff_letter,\n                type_=DataTypes.STRING,\n                default=self._wyckoff_letter_default_value,\n                content_validator=MembershipValidator(allowed=self._wyckoff_letter_allowed_values),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.Wyckoff_letter',\n                    '_atom_site.Wyckoff_symbol',\n                ]\n            ),\n        )\n        self._occupancy: Parameter = Parameter(\n            name='occupancy',\n            description='Occupancy of the atom site, representing the '\n            'fraction of the site occupied by the atom type.',\n            value_spec=AttributeSpec(\n                value=occupancy,\n                type_=DataTypes.NUMERIC,\n                default=1.0,\n                content_validator=RangeValidator(),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.occupancy',\n                ]\n            ),\n        )\n        self._b_iso: Parameter = Parameter(\n            name='b_iso',\n            description='Isotropic atomic displacement parameter (ADP) for the atom site.',\n            value_spec=AttributeSpec(\n                value=b_iso,\n                type_=DataTypes.NUMERIC,\n                default=0.0,\n                content_validator=RangeValidator(ge=0.0),\n            ),\n            units='\u00c5\u00b2',\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.B_iso_or_equiv',\n                ]\n            ),\n        )\n        self._adp_type: StringDescriptor = StringDescriptor(\n            name='adp_type',\n            description='Type of atomic displacement parameter (ADP) '\n            'used (e.g., Biso, Uiso, Uani, Bani).',\n            value_spec=AttributeSpec(\n                value=adp_type,\n                type_=DataTypes.STRING,\n                default='Biso',\n                content_validator=MembershipValidator(allowed=['Biso']),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_atom_site.adp_type',\n                ]\n            ),\n        )\n\n        self._identity.category_code = 'atom_site'\n        self._identity.category_entry_name = lambda: str(self.label.value)\n\n    @property\n    def _type_symbol_allowed_values(self):\n        return list({key[1] for key in DATABASE['Isotopes']})\n\n    @property\n    def _wyckoff_letter_allowed_values(self):\n        # TODO: Need to now current space group. How to access it? Via\n        #  parent Cell? Then letters =\n        #  list(SPACE_GROUPS[62, 'cab']['Wyckoff_positions'].keys())\n        #  Temporarily return hardcoded list:\n        return ['a', 'b', 'c', 'd', 'e', 'f', 'g', 'h', 'i']\n\n    @property\n    def _wyckoff_letter_default_value(self):\n        # TODO: What to pass as default?\n        return self._wyckoff_letter_allowed_values[0]\n\n    @property\n    def label(self):\n        \"\"\"Label descriptor for the site (unique key).\"\"\"\n        return self._label\n\n    @label.setter\n    def label(self, value):\n        self._label.value = value\n\n    @property\n    def type_symbol(self):\n        \"\"\"Chemical symbol descriptor (e.g. 'Si').\"\"\"\n        return self._type_symbol\n\n    @type_symbol.setter\n    def type_symbol(self, value):\n        self._type_symbol.value = value\n\n    @property\n    def adp_type(self):\n        \"\"\"ADP type descriptor (e.g. 'Biso').\"\"\"\n        return self._adp_type\n\n    @adp_type.setter\n    def adp_type(self, value):\n        self._adp_type.value = value\n\n    @property\n    def wyckoff_letter(self):\n        \"\"\"Wyckoff letter descriptor (space-group position).\"\"\"\n        return self._wyckoff_letter\n\n    @wyckoff_letter.setter\n    def wyckoff_letter(self, value):\n        self._wyckoff_letter.value = value\n\n    @property\n    def fract_x(self):\n        \"\"\"Fractional x coordinate descriptor.\"\"\"\n        return self._fract_x\n\n    @fract_x.setter\n    def fract_x(self, value):\n        self._fract_x.value = value\n\n    @property\n    def fract_y(self):\n        \"\"\"Fractional y coordinate descriptor.\"\"\"\n        return self._fract_y\n\n    @fract_y.setter\n    def fract_y(self, value):\n        self._fract_y.value = value\n\n    @property\n    def fract_z(self):\n        \"\"\"Fractional z coordinate descriptor.\"\"\"\n        return self._fract_z\n\n    @fract_z.setter\n    def fract_z(self, value):\n        self._fract_z.value = value\n\n    @property\n    def occupancy(self):\n        \"\"\"Occupancy descriptor (0..1).\"\"\"\n        return self._occupancy\n\n    @occupancy.setter\n    def occupancy(self, value):\n        self._occupancy.value = value\n\n    @property\n    def b_iso(self):\n        \"\"\"Isotropic ADP descriptor in \u00c5\u00b2.\"\"\"\n        return self._b_iso\n\n    @b_iso.setter\n    def b_iso(self, value):\n        self._b_iso.value = value\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.adp_type","title":"<code>adp_type</code>  <code>property</code> <code>writable</code>","text":"<p>ADP type descriptor (e.g. 'Biso').</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.b_iso","title":"<code>b_iso</code>  <code>property</code> <code>writable</code>","text":"<p>Isotropic ADP descriptor in \u00c5\u00b2.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.fract_x","title":"<code>fract_x</code>  <code>property</code> <code>writable</code>","text":"<p>Fractional x coordinate descriptor.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.fract_y","title":"<code>fract_y</code>  <code>property</code> <code>writable</code>","text":"<p>Fractional y coordinate descriptor.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.fract_z","title":"<code>fract_z</code>  <code>property</code> <code>writable</code>","text":"<p>Fractional z coordinate descriptor.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.label","title":"<code>label</code>  <code>property</code> <code>writable</code>","text":"<p>Label descriptor for the site (unique key).</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.occupancy","title":"<code>occupancy</code>  <code>property</code> <code>writable</code>","text":"<p>Occupancy descriptor (0..1).</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.type_symbol","title":"<code>type_symbol</code>  <code>property</code> <code>writable</code>","text":"<p>Chemical symbol descriptor (e.g. 'Si').</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSite.wyckoff_letter","title":"<code>wyckoff_letter</code>  <code>property</code> <code>writable</code>","text":"<p>Wyckoff letter descriptor (space-group position).</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.atom_sites.AtomSites","title":"<code>AtomSites</code>","text":"<p>               Bases: <code>CategoryCollection</code></p> <p>Collection of AtomSite instances.</p> Source code in <code>src/easydiffraction/sample_models/categories/atom_sites.py</code> <pre><code>class AtomSites(CategoryCollection):\n    \"\"\"Collection of AtomSite instances.\"\"\"\n\n    def __init__(self):\n        super().__init__(item_type=AtomSite)\n\n    def _apply_atomic_coordinates_symmetry_constraints(self):\n        \"\"\"Apply symmetry rules to fractional coordinates of atom\n        sites.\n        \"\"\"\n        sample_model = self._parent\n        space_group_name = sample_model.space_group.name_h_m.value\n        space_group_coord_code = sample_model.space_group.it_coordinate_system_code.value\n        for atom in self._items:\n            dummy_atom = {\n                'fract_x': atom.fract_x.value,\n                'fract_y': atom.fract_y.value,\n                'fract_z': atom.fract_z.value,\n            }\n            wl = atom.wyckoff_letter.value\n            if not wl:\n                # TODO: Decide how to handle this case\n                #  For now, we just skip applying constraints if wyckoff\n                #  letter is not set. Alternatively, could raise an\n                #  error or warning\n                #  print(f\"Warning: Wyckoff letter is not ...\")\n                #  raise ValueError(\"Wyckoff letter is not ...\")\n                continue\n            ecr.apply_atom_site_symmetry_constraints(\n                atom_site=dummy_atom,\n                name_hm=space_group_name,\n                coord_code=space_group_coord_code,\n                wyckoff_letter=wl,\n            )\n            atom.fract_x.value = dummy_atom['fract_x']\n            atom.fract_y.value = dummy_atom['fract_y']\n            atom.fract_z.value = dummy_atom['fract_z']\n\n    def _update(self, called_by_minimizer=False):\n        \"\"\"Update atom sites by applying symmetry constraints.\"\"\"\n        del called_by_minimizer\n\n        self._apply_atomic_coordinates_symmetry_constraints()\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell","title":"<code>cell</code>","text":"<p>Unit cell parameters category for sample models.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell","title":"<code>Cell</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Unit cell with lengths a, b, c and angles alpha, beta, gamma.</p> Source code in <code>src/easydiffraction/sample_models/categories/cell.py</code> <pre><code>class Cell(CategoryItem):\n    \"\"\"Unit cell with lengths a, b, c and angles alpha, beta, gamma.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        length_a: Optional[int | float] = None,\n        length_b: Optional[int | float] = None,\n        length_c: Optional[int | float] = None,\n        angle_alpha: Optional[int | float] = None,\n        angle_beta: Optional[int | float] = None,\n        angle_gamma: Optional[int | float] = None,\n    ) -&gt; None:\n        super().__init__()\n\n        self._length_a: Parameter = Parameter(\n            name='length_a',\n            description='Length of the a axis of the unit cell.',\n            value_spec=AttributeSpec(\n                value=length_a,\n                type_=DataTypes.NUMERIC,\n                default=10.0,\n                content_validator=RangeValidator(ge=0, le=1000),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(names=['_cell.length_a']),\n        )\n        self._length_b: Parameter = Parameter(\n            name='length_b',\n            description='Length of the b axis of the unit cell.',\n            value_spec=AttributeSpec(\n                value=length_b,\n                type_=DataTypes.NUMERIC,\n                default=10.0,\n                content_validator=RangeValidator(ge=0, le=1000),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(names=['_cell.length_b']),\n        )\n        self._length_c: Parameter = Parameter(\n            name='length_c',\n            description='Length of the c axis of the unit cell.',\n            value_spec=AttributeSpec(\n                value=length_c,\n                type_=DataTypes.NUMERIC,\n                default=10.0,\n                content_validator=RangeValidator(ge=0, le=1000),\n            ),\n            units='\u00c5',\n            cif_handler=CifHandler(names=['_cell.length_c']),\n        )\n        self._angle_alpha: Parameter = Parameter(\n            name='angle_alpha',\n            description='Angle between edges b and c.',\n            value_spec=AttributeSpec(\n                value=angle_alpha,\n                type_=DataTypes.NUMERIC,\n                default=90.0,\n                content_validator=RangeValidator(ge=0, le=180),\n            ),\n            units='deg',\n            cif_handler=CifHandler(names=['_cell.angle_alpha']),\n        )\n        self._angle_beta: Parameter = Parameter(\n            name='angle_beta',\n            description='Angle between edges a and c.',\n            value_spec=AttributeSpec(\n                value=angle_beta,\n                type_=DataTypes.NUMERIC,\n                default=90.0,\n                content_validator=RangeValidator(ge=0, le=180),\n            ),\n            units='deg',\n            cif_handler=CifHandler(names=['_cell.angle_beta']),\n        )\n        self._angle_gamma: Parameter = Parameter(\n            name='angle_gamma',\n            description='Angle between edges a and b.',\n            value_spec=AttributeSpec(\n                value=angle_gamma,\n                type_=DataTypes.NUMERIC,\n                default=90.0,\n                content_validator=RangeValidator(ge=0, le=180),\n            ),\n            units='deg',\n            cif_handler=CifHandler(names=['_cell.angle_gamma']),\n        )\n\n        self._identity.category_code = 'cell'\n\n    @property\n    def length_a(self):\n        \"\"\"Descriptor for a-axis length in \u00c5.\"\"\"\n        return self._length_a\n\n    @length_a.setter\n    def length_a(self, value):\n        self._length_a.value = value\n\n    @property\n    def length_b(self):\n        \"\"\"Descriptor for b-axis length in \u00c5.\"\"\"\n        return self._length_b\n\n    @length_b.setter\n    def length_b(self, value):\n        self._length_b.value = value\n\n    @property\n    def length_c(self):\n        \"\"\"Descriptor for c-axis length in \u00c5.\"\"\"\n        return self._length_c\n\n    @length_c.setter\n    def length_c(self, value):\n        self._length_c.value = value\n\n    @property\n    def angle_alpha(self):\n        \"\"\"Descriptor for angle alpha in degrees.\"\"\"\n        return self._angle_alpha\n\n    @angle_alpha.setter\n    def angle_alpha(self, value):\n        self._angle_alpha.value = value\n\n    @property\n    def angle_beta(self):\n        \"\"\"Descriptor for angle beta in degrees.\"\"\"\n        return self._angle_beta\n\n    @angle_beta.setter\n    def angle_beta(self, value):\n        self._angle_beta.value = value\n\n    @property\n    def angle_gamma(self):\n        \"\"\"Descriptor for angle gamma in degrees.\"\"\"\n        return self._angle_gamma\n\n    @angle_gamma.setter\n    def angle_gamma(self, value):\n        self._angle_gamma.value = value\n\n    def _apply_cell_symmetry_constraints(self):\n        \"\"\"Apply symmetry constraints to cell parameters.\"\"\"\n        dummy_cell = {\n            'lattice_a': self.length_a.value,\n            'lattice_b': self.length_b.value,\n            'lattice_c': self.length_c.value,\n            'angle_alpha': self.angle_alpha.value,\n            'angle_beta': self.angle_beta.value,\n            'angle_gamma': self.angle_gamma.value,\n        }\n        space_group_name = self._parent.space_group.name_h_m.value\n\n        ecr.apply_cell_symmetry_constraints(\n            cell=dummy_cell,\n            name_hm=space_group_name,\n        )\n\n        self.length_a.value = dummy_cell['lattice_a']\n        self.length_b.value = dummy_cell['lattice_b']\n        self.length_c.value = dummy_cell['lattice_c']\n        self.angle_alpha.value = dummy_cell['angle_alpha']\n        self.angle_beta.value = dummy_cell['angle_beta']\n        self.angle_gamma.value = dummy_cell['angle_gamma']\n\n    def _update(self, called_by_minimizer=False):\n        \"\"\"Update cell parameters by applying symmetry constraints.\"\"\"\n        del called_by_minimizer\n\n        self._apply_cell_symmetry_constraints()\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.angle_alpha","title":"<code>angle_alpha</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for angle alpha in degrees.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.angle_beta","title":"<code>angle_beta</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for angle beta in degrees.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.angle_gamma","title":"<code>angle_gamma</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for angle gamma in degrees.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.length_a","title":"<code>length_a</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for a-axis length in \u00c5.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.length_b","title":"<code>length_b</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for b-axis length in \u00c5.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.cell.Cell.length_c","title":"<code>length_c</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for c-axis length in \u00c5.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.space_group","title":"<code>space_group</code>","text":"<p>Space group category for crystallographic sample models.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.space_group.SpaceGroup","title":"<code>SpaceGroup</code>","text":"<p>               Bases: <code>CategoryItem</code></p> <p>Space group with Hermann\u2013Mauguin symbol and IT code.</p> Source code in <code>src/easydiffraction/sample_models/categories/space_group.py</code> <pre><code>class SpaceGroup(CategoryItem):\n    \"\"\"Space group with Hermann\u2013Mauguin symbol and IT code.\"\"\"\n\n    def __init__(\n        self,\n        *,\n        name_h_m: str = None,\n        it_coordinate_system_code: str = None,\n    ) -&gt; None:\n        super().__init__()\n        self._name_h_m: StringDescriptor = StringDescriptor(\n            name='name_h_m',\n            description='Hermann-Mauguin symbol of the space group.',\n            value_spec=AttributeSpec(\n                value=name_h_m,\n                type_=DataTypes.STRING,\n                default='P 1',\n                content_validator=MembershipValidator(\n                    allowed=lambda: self._name_h_m_allowed_values\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_space_group.name_H-M_alt',\n                    '_space_group_name_H-M_alt',\n                    '_symmetry.space_group_name_H-M',\n                    '_symmetry_space_group_name_H-M',\n                ]\n            ),\n        )\n        self._it_coordinate_system_code: StringDescriptor = StringDescriptor(\n            name='it_coordinate_system_code',\n            description='A qualifier identifying which setting in IT is used.',\n            value_spec=AttributeSpec(\n                value=it_coordinate_system_code,\n                type_=DataTypes.STRING,\n                default=lambda: self._it_coordinate_system_code_default_value,\n                content_validator=MembershipValidator(\n                    allowed=lambda: self._it_coordinate_system_code_allowed_values\n                ),\n            ),\n            cif_handler=CifHandler(\n                names=[\n                    '_space_group.IT_coordinate_system_code',\n                    '_space_group_IT_coordinate_system_code',\n                    '_symmetry.IT_coordinate_system_code',\n                    '_symmetry_IT_coordinate_system_code',\n                ]\n            ),\n        )\n        self._identity.category_code = 'space_group'\n\n    def _reset_it_coordinate_system_code(self):\n        self._it_coordinate_system_code.value = self._it_coordinate_system_code_default_value\n\n    @property\n    def _name_h_m_allowed_values(self):\n        return ACCESIBLE_NAME_HM_SHORT\n\n    @property\n    def _it_coordinate_system_code_allowed_values(self):\n        name = self.name_h_m.value\n        it_number = get_it_number_by_name_hm_short(name)\n        codes = get_it_coordinate_system_codes_by_it_number(it_number)\n        codes = [str(code) for code in codes]\n        return codes if codes else ['']\n\n    @property\n    def _it_coordinate_system_code_default_value(self):\n        return self._it_coordinate_system_code_allowed_values[0]\n\n    @property\n    def name_h_m(self):\n        \"\"\"Descriptor for Hermann\u2013Mauguin symbol.\"\"\"\n        return self._name_h_m\n\n    @name_h_m.setter\n    def name_h_m(self, value):\n        self._name_h_m.value = value\n        self._reset_it_coordinate_system_code()\n\n    @property\n    def it_coordinate_system_code(self):\n        \"\"\"Descriptor for IT coordinate system code.\"\"\"\n        return self._it_coordinate_system_code\n\n    @it_coordinate_system_code.setter\n    def it_coordinate_system_code(self, value):\n        self._it_coordinate_system_code.value = value\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.space_group.SpaceGroup.it_coordinate_system_code","title":"<code>it_coordinate_system_code</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for IT coordinate system code.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.categories.space_group.SpaceGroup.name_h_m","title":"<code>name_h_m</code>  <code>property</code> <code>writable</code>","text":"<p>Descriptor for Hermann\u2013Mauguin symbol.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model","title":"<code>sample_model</code>","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base","title":"<code>base</code>","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase","title":"<code>SampleModelBase</code>","text":"<p>               Bases: <code>DatablockItem</code></p> <p>Base sample model and container for structural information.</p> <p>Holds space group, unit cell and atom-site categories. The factory is responsible for creating rich instances from CIF; this base accepts just the <code>name</code> and exposes helpers for applying symmetry.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/base.py</code> <pre><code>class SampleModelBase(DatablockItem):\n    \"\"\"Base sample model and container for structural information.\n\n    Holds space group, unit cell and atom-site categories. The\n    factory is responsible for creating rich instances from CIF;\n    this base accepts just the ``name`` and exposes helpers for\n    applying symmetry.\n    \"\"\"\n\n    def __init__(\n        self,\n        *,\n        name,\n    ) -&gt; None:\n        super().__init__()\n        self._name = name\n        self._cell: Cell = Cell()\n        self._space_group: SpaceGroup = SpaceGroup()\n        self._atom_sites: AtomSites = AtomSites()\n        self._identity.datablock_entry_name = lambda: self.name\n\n    def __str__(self) -&gt; str:\n        \"\"\"Human-readable representation of this component.\"\"\"\n        name = self._log_name\n        items = ', '.join(\n            f'{k}={v}'\n            for k, v in {\n                'cell': self.cell,\n                'space_group': self.space_group,\n                'atom_sites': self.atom_sites,\n            }.items()\n        )\n        return f'&lt;{name} ({items})&gt;'\n\n    @property\n    def name(self) -&gt; str:\n        \"\"\"Model name.\n\n        Returns:\n            The user-facing identifier for this model.\n        \"\"\"\n        return self._name\n\n    @name.setter\n    def name(self, new: str) -&gt; None:\n        \"\"\"Update model name.\"\"\"\n        self._name = new\n\n    @property\n    def cell(self) -&gt; Cell:\n        \"\"\"Unit-cell category object.\"\"\"\n        return self._cell\n\n    @cell.setter\n    def cell(self, new: Cell) -&gt; None:\n        \"\"\"Replace the unit-cell category object.\"\"\"\n        self._cell = new\n\n    @property\n    def space_group(self) -&gt; SpaceGroup:\n        \"\"\"Space-group category object.\"\"\"\n        return self._space_group\n\n    @space_group.setter\n    def space_group(self, new: SpaceGroup) -&gt; None:\n        \"\"\"Replace the space-group category object.\"\"\"\n        self._space_group = new\n\n    @property\n    def atom_sites(self) -&gt; AtomSites:\n        \"\"\"Atom-sites collection for this model.\"\"\"\n        return self._atom_sites\n\n    @atom_sites.setter\n    def atom_sites(self, new: AtomSites) -&gt; None:\n        \"\"\"Replace the atom-sites collection.\"\"\"\n        self._atom_sites = new\n\n    # --------------------\n    # Symmetry constraints\n    # --------------------\n\n    def _apply_cell_symmetry_constraints(self):\n        \"\"\"Apply symmetry rules to unit-cell parameters in place.\"\"\"\n        dummy_cell = {\n            'lattice_a': self.cell.length_a.value,\n            'lattice_b': self.cell.length_b.value,\n            'lattice_c': self.cell.length_c.value,\n            'angle_alpha': self.cell.angle_alpha.value,\n            'angle_beta': self.cell.angle_beta.value,\n            'angle_gamma': self.cell.angle_gamma.value,\n        }\n        space_group_name = self.space_group.name_h_m.value\n        ecr.apply_cell_symmetry_constraints(cell=dummy_cell, name_hm=space_group_name)\n        self.cell.length_a.value = dummy_cell['lattice_a']\n        self.cell.length_b.value = dummy_cell['lattice_b']\n        self.cell.length_c.value = dummy_cell['lattice_c']\n        self.cell.angle_alpha.value = dummy_cell['angle_alpha']\n        self.cell.angle_beta.value = dummy_cell['angle_beta']\n        self.cell.angle_gamma.value = dummy_cell['angle_gamma']\n\n    def _apply_atomic_coordinates_symmetry_constraints(self):\n        \"\"\"Apply symmetry rules to fractional coordinates of atom\n        sites.\n        \"\"\"\n        space_group_name = self.space_group.name_h_m.value\n        space_group_coord_code = self.space_group.it_coordinate_system_code.value\n        for atom in self.atom_sites:\n            dummy_atom = {\n                'fract_x': atom.fract_x.value,\n                'fract_y': atom.fract_y.value,\n                'fract_z': atom.fract_z.value,\n            }\n            wl = atom.wyckoff_letter.value\n            if not wl:\n                # TODO: Decide how to handle this case\n                #  For now, we just skip applying constraints if wyckoff\n                #  letter is not set. Alternatively, could raise an\n                #  error or warning\n                #  print(f\"Warning: Wyckoff letter is not ...\")\n                #  raise ValueError(\"Wyckoff letter is not ...\")\n                continue\n            ecr.apply_atom_site_symmetry_constraints(\n                atom_site=dummy_atom,\n                name_hm=space_group_name,\n                coord_code=space_group_coord_code,\n                wyckoff_letter=wl,\n            )\n            atom.fract_x.value = dummy_atom['fract_x']\n            atom.fract_y.value = dummy_atom['fract_y']\n            atom.fract_z.value = dummy_atom['fract_z']\n\n    def _apply_atomic_displacement_symmetry_constraints(self):\n        \"\"\"Placeholder for ADP symmetry constraints (not\n        implemented).\n        \"\"\"\n        pass\n\n    def _apply_symmetry_constraints(self):\n        \"\"\"Apply all available symmetry constraints to this model.\"\"\"\n        self._apply_cell_symmetry_constraints()\n        self._apply_atomic_coordinates_symmetry_constraints()\n        self._apply_atomic_displacement_symmetry_constraints()\n\n    # ------------\n    # Show methods\n    # ------------\n\n    def show_structure(self):\n        \"\"\"Show an ASCII projection of the structure on a 2D plane.\"\"\"\n        console.paragraph(f\"Sample model \ud83e\udde9 '{self.name}' structure view\")\n        console.print('Not implemented yet.')\n\n    def show_params(self):\n        \"\"\"Display structural parameters (space group, cell, atom\n        sites).\n        \"\"\"\n        console.print(f'\\nSampleModel ID: {self.name}')\n        console.print(f'Space group: {self.space_group.name_h_m}')\n        console.print(f'Cell parameters: {self.cell.as_dict}')\n        console.print('Atom sites:')\n        self.atom_sites.show()\n\n    def show_as_cif(self) -&gt; None:\n        \"\"\"Render the CIF text for this model in a terminal-friendly\n        view.\n        \"\"\"\n        cif_text: str = self.as_cif\n        paragraph_title: str = f\"Sample model \ud83e\udde9 '{self.name}' as cif\"\n        console.paragraph(paragraph_title)\n        render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.__str__","title":"<code>__str__()</code>","text":"<p>Human-readable representation of this component.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/base.py</code> <pre><code>def __str__(self) -&gt; str:\n    \"\"\"Human-readable representation of this component.\"\"\"\n    name = self._log_name\n    items = ', '.join(\n        f'{k}={v}'\n        for k, v in {\n            'cell': self.cell,\n            'space_group': self.space_group,\n            'atom_sites': self.atom_sites,\n        }.items()\n    )\n    return f'&lt;{name} ({items})&gt;'\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.atom_sites","title":"<code>atom_sites</code>  <code>property</code> <code>writable</code>","text":"<p>Atom-sites collection for this model.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.cell","title":"<code>cell</code>  <code>property</code> <code>writable</code>","text":"<p>Unit-cell category object.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.name","title":"<code>name</code>  <code>property</code> <code>writable</code>","text":"<p>Model name.</p> <p>Returns:</p> Type Description <code>str</code> <p>The user-facing identifier for this model.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.show_as_cif","title":"<code>show_as_cif()</code>","text":"<p>Render the CIF text for this model in a terminal-friendly view.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/base.py</code> <pre><code>def show_as_cif(self) -&gt; None:\n    \"\"\"Render the CIF text for this model in a terminal-friendly\n    view.\n    \"\"\"\n    cif_text: str = self.as_cif\n    paragraph_title: str = f\"Sample model \ud83e\udde9 '{self.name}' as cif\"\n    console.paragraph(paragraph_title)\n    render_cif(cif_text)\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.show_params","title":"<code>show_params()</code>","text":"<p>Display structural parameters (space group, cell, atom sites).</p> Source code in <code>src/easydiffraction/sample_models/sample_model/base.py</code> <pre><code>def show_params(self):\n    \"\"\"Display structural parameters (space group, cell, atom\n    sites).\n    \"\"\"\n    console.print(f'\\nSampleModel ID: {self.name}')\n    console.print(f'Space group: {self.space_group.name_h_m}')\n    console.print(f'Cell parameters: {self.cell.as_dict}')\n    console.print('Atom sites:')\n    self.atom_sites.show()\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.show_structure","title":"<code>show_structure()</code>","text":"<p>Show an ASCII projection of the structure on a 2D plane.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/base.py</code> <pre><code>def show_structure(self):\n    \"\"\"Show an ASCII projection of the structure on a 2D plane.\"\"\"\n    console.paragraph(f\"Sample model \ud83e\udde9 '{self.name}' structure view\")\n    console.print('Not implemented yet.')\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.base.SampleModelBase.space_group","title":"<code>space_group</code>  <code>property</code> <code>writable</code>","text":"<p>Space-group category object.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.factory","title":"<code>factory</code>","text":"<p>Factory for creating sample models from simple inputs or CIF.</p> <p>Supports three argument combinations: <code>name</code>, <code>cif_path</code>, or <code>cif_str</code>. Returns a minimal <code>SampleModelBase</code> populated from CIF when provided, or an empty model with the given name.</p>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.factory.SampleModelFactory","title":"<code>SampleModelFactory</code>","text":"<p>               Bases: <code>FactoryBase</code></p> <p>Create <code>SampleModelBase</code> instances from supported inputs.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/factory.py</code> <pre><code>class SampleModelFactory(FactoryBase):\n    \"\"\"Create ``SampleModelBase`` instances from supported inputs.\"\"\"\n\n    _ALLOWED_ARG_SPECS = [\n        {'required': ['name'], 'optional': []},\n        {'required': ['cif_path'], 'optional': []},\n        {'required': ['cif_str'], 'optional': []},\n    ]\n\n    @classmethod\n    def _create_from_gemmi_block(\n        cls,\n        block: gemmi.cif.Block,\n    ) -&gt; SampleModelBase:\n        \"\"\"Build a model instance from a single CIF block.\"\"\"\n        name = name_from_block(block)\n        sample_model = SampleModelBase(name=name)\n        for category in sample_model.categories:\n            category.from_cif(block)\n        return sample_model\n\n    @classmethod\n    def _create_from_cif_path(\n        cls,\n        cif_path: str,\n    ) -&gt; SampleModelBase:\n        \"\"\"Create a model by reading and parsing a CIF file.\"\"\"\n        doc = document_from_path(cif_path)\n        block = pick_sole_block(doc)\n        return cls._create_from_gemmi_block(block)\n\n    @classmethod\n    def _create_from_cif_str(\n        cls,\n        cif_str: str,\n    ) -&gt; SampleModelBase:\n        \"\"\"Create a model by parsing a CIF string.\"\"\"\n        doc = document_from_string(cif_str)\n        block = pick_sole_block(doc)\n        return cls._create_from_gemmi_block(block)\n\n    @classmethod\n    def _create_minimal(\n        cls,\n        name: str,\n    ) -&gt; SampleModelBase:\n        \"\"\"Create a minimal default model with just a name.\"\"\"\n        return SampleModelBase(name=name)\n\n    @classmethod\n    def create(cls, **kwargs):\n        \"\"\"Create a model based on a validated argument combination.\n\n        Keyword Args:\n            name: Name of the sample model to create.\n            cif_path: Path to a CIF file to parse.\n            cif_str: Raw CIF string to parse.\n            **kwargs: Extra args are ignored if None; only the above\n                three keys are supported.\n\n        Returns:\n            SampleModelBase: A populated or empty model instance.\n        \"\"\"\n        # TODO: move to FactoryBase\n        # Check for valid argument combinations\n        user_args = {k for k, v in kwargs.items() if v is not None}\n        cls._validate_args(\n            present=user_args,\n            allowed_specs=cls._ALLOWED_ARG_SPECS,\n            factory_name=cls.__name__,  # TODO: move to FactoryBase\n        )\n\n        # Dispatch to the appropriate creation method\n        if 'cif_path' in kwargs:\n            return cls._create_from_cif_path(kwargs['cif_path'])\n        elif 'cif_str' in kwargs:\n            return cls._create_from_cif_str(kwargs['cif_str'])\n        elif 'name' in kwargs:\n            return cls._create_minimal(kwargs['name'])\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_model.factory.SampleModelFactory.create","title":"<code>create(**kwargs)</code>  <code>classmethod</code>","text":"<p>Create a model based on a validated argument combination.</p> <p>Other Parameters:</p> Name Type Description <code>name</code> <p>Name of the sample model to create.</p> <code>cif_path</code> <p>Path to a CIF file to parse.</p> <code>cif_str</code> <p>Raw CIF string to parse.</p> <code>**kwargs</code> <p>Extra args are ignored if None; only the above three keys are supported.</p> <p>Returns:</p> Name Type Description <code>SampleModelBase</code> <p>A populated or empty model instance.</p> Source code in <code>src/easydiffraction/sample_models/sample_model/factory.py</code> <pre><code>@classmethod\ndef create(cls, **kwargs):\n    \"\"\"Create a model based on a validated argument combination.\n\n    Keyword Args:\n        name: Name of the sample model to create.\n        cif_path: Path to a CIF file to parse.\n        cif_str: Raw CIF string to parse.\n        **kwargs: Extra args are ignored if None; only the above\n            three keys are supported.\n\n    Returns:\n        SampleModelBase: A populated or empty model instance.\n    \"\"\"\n    # TODO: move to FactoryBase\n    # Check for valid argument combinations\n    user_args = {k for k, v in kwargs.items() if v is not None}\n    cls._validate_args(\n        present=user_args,\n        allowed_specs=cls._ALLOWED_ARG_SPECS,\n        factory_name=cls.__name__,  # TODO: move to FactoryBase\n    )\n\n    # Dispatch to the appropriate creation method\n    if 'cif_path' in kwargs:\n        return cls._create_from_cif_path(kwargs['cif_path'])\n    elif 'cif_str' in kwargs:\n        return cls._create_from_cif_str(kwargs['cif_str'])\n    elif 'name' in kwargs:\n        return cls._create_minimal(kwargs['name'])\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_models","title":"<code>sample_models</code>","text":""},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_models.SampleModels","title":"<code>SampleModels</code>","text":"<p>               Bases: <code>DatablockCollection</code></p> <p>Collection manager for multiple SampleModel instances.</p> Source code in <code>src/easydiffraction/sample_models/sample_models.py</code> <pre><code>class SampleModels(DatablockCollection):\n    \"\"\"Collection manager for multiple SampleModel instances.\"\"\"\n\n    def __init__(self) -&gt; None:\n        super().__init__(item_type=SampleModelBase)\n\n    # --------------------\n    # Add / Remove methods\n    # --------------------\n\n    # TODO: Move to DatablockCollection?\n    # TODO: Disallow args and only allow kwargs?\n    def add(self, **kwargs):\n        sample_model = kwargs.pop('sample_model', None)\n\n        if sample_model is None:\n            sample_model = SampleModelFactory.create(**kwargs)\n\n        self._add(sample_model)\n\n    # @typechecked\n    # def add_from_cif_path(self, cif_path: str) -&gt; None:\n    #    \"\"\"Create and add a model from a CIF file path.#\n    #\n    #    Args:\n    #        cif_path: Path to a CIF file.\n    #    \"\"\"\n    #    sample_model = SampleModelFactory.create(cif_path=cif_path)\n    #    self.add(sample_model)\n\n    # @typechecked\n    # def add_from_cif_str(self, cif_str: str) -&gt; None:\n    #    \"\"\"Create and add a model from CIF content (string).\n    #\n    #    Args:\n    #        cif_str: CIF file content.\n    #    \"\"\"\n    #    sample_model = SampleModelFactory.create(cif_str=cif_str)\n    #    self.add(sample_model)\n\n    # @typechecked\n    # def add_minimal(self, name: str) -&gt; None:\n    #    \"\"\"Create and add a minimal model (defaults, no atoms).\n    #\n    #    Args:\n    #        name: Identifier to assign to the new model.\n    #    \"\"\"\n    #    sample_model = SampleModelFactory.create(name=name)\n    #    self.add(sample_model)\n\n    # TODO: Move to DatablockCollection?\n    @typechecked\n    def remove(self, name: str) -&gt; None:\n        \"\"\"Remove a sample model by its ID.\n\n        Args:\n            name: ID of the model to remove.\n        \"\"\"\n        if name in self:\n            del self[name]\n\n    # ------------\n    # Show methods\n    # ------------\n\n    # TODO: Move to DatablockCollection?\n    def show_names(self) -&gt; None:\n        \"\"\"List all model names in the collection.\"\"\"\n        console.paragraph('Defined sample models' + ' \ud83e\udde9')\n        console.print(self.names)\n\n    # TODO: Move to DatablockCollection?\n    def show_params(self) -&gt; None:\n        \"\"\"Show parameters of all sample models in the collection.\"\"\"\n        for model in self.values():\n            model.show_params()\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_models.SampleModels.remove","title":"<code>remove(name)</code>","text":"<p>Remove a sample model by its ID.</p> <p>Parameters:</p> Name Type Description Default <code>name</code> <code>str</code> <p>ID of the model to remove.</p> required Source code in <code>src/easydiffraction/sample_models/sample_models.py</code> <pre><code>@typechecked\ndef remove(self, name: str) -&gt; None:\n    \"\"\"Remove a sample model by its ID.\n\n    Args:\n        name: ID of the model to remove.\n    \"\"\"\n    if name in self:\n        del self[name]\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_models.SampleModels.show_names","title":"<code>show_names()</code>","text":"<p>List all model names in the collection.</p> Source code in <code>src/easydiffraction/sample_models/sample_models.py</code> <pre><code>def show_names(self) -&gt; None:\n    \"\"\"List all model names in the collection.\"\"\"\n    console.paragraph('Defined sample models' + ' \ud83e\udde9')\n    console.print(self.names)\n</code></pre>"},{"location":"api-reference/sample_models/#easydiffraction.sample_models.sample_models.SampleModels.show_params","title":"<code>show_params()</code>","text":"<p>Show parameters of all sample models in the collection.</p> Source code in <code>src/easydiffraction/sample_models/sample_models.py</code> <pre><code>def show_params(self) -&gt; None:\n    \"\"\"Show parameters of all sample models in the collection.\"\"\"\n    for model in self.values():\n        model.show_params()\n</code></pre>"},{"location":"api-reference/summary/","title":"summary","text":""},{"location":"api-reference/summary/#easydiffraction.summary","title":"<code>summary</code>","text":""},{"location":"api-reference/summary/#easydiffraction.summary.summary","title":"<code>summary</code>","text":""},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary","title":"<code>Summary</code>","text":"<p>Generates reports and exports results from the project.</p> <p>This class collects and presents all relevant information about the fitted model, experiments, and analysis results.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>class Summary:\n    \"\"\"Generates reports and exports results from the project.\n\n    This class collects and presents all relevant information about the\n    fitted model, experiments, and analysis results.\n    \"\"\"\n\n    def __init__(self, project) -&gt; None:\n        \"\"\"Initialize the summary with a reference to the project.\n\n        Args:\n            project: The Project instance this summary belongs to.\n        \"\"\"\n        self.project = project\n\n    # ------------------------------------------\n    #  Report Generation\n    # ------------------------------------------\n\n    def show_report(self) -&gt; None:\n        self.show_project_info()\n        self.show_crystallographic_data()\n        self.show_experimental_data()\n        self.show_fitting_details()\n\n    def show_project_info(self) -&gt; None:\n        \"\"\"Print the project title and description.\"\"\"\n        console.section('Project info')\n\n        console.paragraph('Title')\n        console.print(self.project.info.title)\n\n        if self.project.info.description:\n            console.paragraph('Description')\n            # log.print('\\n'.join(wrap(self.project.info.description,\n            # width=80)))\n            # TODO: Fix the following lines\n            # Ensure description wraps with explicit newlines for tests\n            desc_lines = wrap(self.project.info.description, width=60)\n            # Use plain print to avoid Left padding that would break\n            # newline adjacency checks\n            print('\\n'.join(desc_lines))\n\n    def show_crystallographic_data(self) -&gt; None:\n        \"\"\"Print crystallographic data including phase datablocks, space\n        groups, cell parameters, and atom sites.\n        \"\"\"\n        console.section('Crystallographic data')\n\n        for model in self.project.sample_models.values():\n            console.paragraph('Phase datablock')\n            console.print(f'\ud83e\udde9 {model.name}')\n\n            console.paragraph('Space group')\n            console.print(model.space_group.name_h_m.value)\n\n            console.paragraph('Cell parameters')\n            columns_headers = ['Parameter', 'Value']\n            columns_alignment: List[str] = ['left', 'right']\n            cell_data = [\n                [p.name.replace('length_', '').replace('angle_', ''), f'{p.value:.5f}']\n                for p in model.cell.parameters\n            ]\n            render_table(\n                columns_headers=columns_headers,\n                columns_alignment=columns_alignment,\n                columns_data=cell_data,\n            )\n\n            console.paragraph('Atom sites')\n            columns_headers = [\n                'label',\n                'type',\n                'x',\n                'y',\n                'z',\n                'occ',\n                'Biso',\n            ]\n            columns_alignment = [\n                'left',\n                'left',\n                'right',\n                'right',\n                'right',\n                'right',\n                'right',\n            ]\n            atom_table = []\n            for site in model.atom_sites:\n                atom_table.append([\n                    site.label.value,\n                    site.type_symbol.value,\n                    f'{site.fract_x.value:.5f}',\n                    f'{site.fract_y.value:.5f}',\n                    f'{site.fract_z.value:.5f}',\n                    f'{site.occupancy.value:.5f}',\n                    f'{site.b_iso.value:.5f}',\n                ])\n            render_table(\n                columns_headers=columns_headers,\n                columns_alignment=columns_alignment,\n                columns_data=atom_table,\n            )\n\n    def show_experimental_data(self) -&gt; None:\n        \"\"\"Print experimental data including experiment datablocks,\n        types, instrument settings, and peak profile information.\n        \"\"\"\n        console.section('Experiments')\n\n        for expt in self.project.experiments.values():\n            console.paragraph('Experiment datablock')\n            console.print(f'\ud83d\udd2c {expt.name}')\n\n            console.paragraph('Experiment type')\n            console.print(\n                f'{expt.type.sample_form.value}, '\n                f'{expt.type.radiation_probe.value}, '\n                f'{expt.type.beam_mode.value}'\n            )\n\n            if 'instrument' in expt._public_attrs():\n                if 'setup_wavelength' in expt.instrument._public_attrs():\n                    console.paragraph('Wavelength')\n                    console.print(f'{expt.instrument.setup_wavelength.value:.5f}')\n                if 'calib_twotheta_offset' in expt.instrument._public_attrs():\n                    console.paragraph('2\u03b8 offset')\n                    console.print(f'{expt.instrument.calib_twotheta_offset.value:.5f}')\n\n            if 'peak_profile_type' in expt._public_attrs():\n                console.paragraph('Profile type')\n                console.print(expt.peak_profile_type)\n\n            if 'peak' in expt._public_attrs():\n                if 'broad_gauss_u' in expt.peak._public_attrs():\n                    console.paragraph('Peak broadening (Gaussian)')\n                    columns_headers = ['Parameter', 'Value']\n                    columns_alignment = ['left', 'right']\n                    columns_data = [\n                        ['U', f'{expt.peak.broad_gauss_u.value:.5f}'],\n                        ['V', f'{expt.peak.broad_gauss_v.value:.5f}'],\n                        ['W', f'{expt.peak.broad_gauss_w.value:.5f}'],\n                    ]\n                    render_table(\n                        columns_headers=columns_headers,\n                        columns_alignment=columns_alignment,\n                        columns_data=columns_data,\n                    )\n                if 'broad_lorentz_x' in expt.peak._public_attrs():\n                    console.paragraph('Peak broadening (Lorentzian)')\n                    # TODO: Some headers capitalize, some don't -\n                    #  be consistent\n                    columns_headers = ['Parameter', 'Value']\n                    columns_alignment = ['left', 'right']\n                    columns_data = [\n                        ['X', f'{expt.peak.broad_lorentz_x.value:.5f}'],\n                        ['Y', f'{expt.peak.broad_lorentz_y.value:.5f}'],\n                    ]\n                    render_table(\n                        columns_headers=columns_headers,\n                        columns_alignment=columns_alignment,\n                        columns_data=columns_data,\n                    )\n\n    def show_fitting_details(self) -&gt; None:\n        \"\"\"Print fitting details including calculation and minimization\n        engines, and fit quality metrics.\n        \"\"\"\n        console.section('Fitting')\n\n        console.paragraph('Calculation engine')\n        console.print(self.project.analysis.current_calculator)\n\n        console.paragraph('Minimization engine')\n        console.print(self.project.analysis.current_minimizer)\n\n        console.paragraph('Fit quality')\n        columns_headers = ['metric', 'value']\n        columns_alignment = ['left', 'right']\n        fit_metrics = [\n            [\n                'Goodness-of-fit (reduced \u03c7\u00b2)',\n                f'{self.project.analysis.fit_results.reduced_chi_square:.2f}',\n            ]\n        ]\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=fit_metrics,\n        )\n\n    # ------------------------------------------\n    #  Exporting\n    # ------------------------------------------\n\n    def as_cif(self) -&gt; str:\n        \"\"\"Export the final fitted data and analysis results as CIF\n        format.\n        \"\"\"\n        from easydiffraction.io.cif.serialize import summary_to_cif\n\n        return summary_to_cif(self)\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.__init__","title":"<code>__init__(project)</code>","text":"<p>Initialize the summary with a reference to the project.</p> <p>Parameters:</p> Name Type Description Default <code>project</code> <p>The Project instance this summary belongs to.</p> required Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def __init__(self, project) -&gt; None:\n    \"\"\"Initialize the summary with a reference to the project.\n\n    Args:\n        project: The Project instance this summary belongs to.\n    \"\"\"\n    self.project = project\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.as_cif","title":"<code>as_cif()</code>","text":"<p>Export the final fitted data and analysis results as CIF format.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def as_cif(self) -&gt; str:\n    \"\"\"Export the final fitted data and analysis results as CIF\n    format.\n    \"\"\"\n    from easydiffraction.io.cif.serialize import summary_to_cif\n\n    return summary_to_cif(self)\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.show_crystallographic_data","title":"<code>show_crystallographic_data()</code>","text":"<p>Print crystallographic data including phase datablocks, space groups, cell parameters, and atom sites.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def show_crystallographic_data(self) -&gt; None:\n    \"\"\"Print crystallographic data including phase datablocks, space\n    groups, cell parameters, and atom sites.\n    \"\"\"\n    console.section('Crystallographic data')\n\n    for model in self.project.sample_models.values():\n        console.paragraph('Phase datablock')\n        console.print(f'\ud83e\udde9 {model.name}')\n\n        console.paragraph('Space group')\n        console.print(model.space_group.name_h_m.value)\n\n        console.paragraph('Cell parameters')\n        columns_headers = ['Parameter', 'Value']\n        columns_alignment: List[str] = ['left', 'right']\n        cell_data = [\n            [p.name.replace('length_', '').replace('angle_', ''), f'{p.value:.5f}']\n            for p in model.cell.parameters\n        ]\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=cell_data,\n        )\n\n        console.paragraph('Atom sites')\n        columns_headers = [\n            'label',\n            'type',\n            'x',\n            'y',\n            'z',\n            'occ',\n            'Biso',\n        ]\n        columns_alignment = [\n            'left',\n            'left',\n            'right',\n            'right',\n            'right',\n            'right',\n            'right',\n        ]\n        atom_table = []\n        for site in model.atom_sites:\n            atom_table.append([\n                site.label.value,\n                site.type_symbol.value,\n                f'{site.fract_x.value:.5f}',\n                f'{site.fract_y.value:.5f}',\n                f'{site.fract_z.value:.5f}',\n                f'{site.occupancy.value:.5f}',\n                f'{site.b_iso.value:.5f}',\n            ])\n        render_table(\n            columns_headers=columns_headers,\n            columns_alignment=columns_alignment,\n            columns_data=atom_table,\n        )\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.show_experimental_data","title":"<code>show_experimental_data()</code>","text":"<p>Print experimental data including experiment datablocks, types, instrument settings, and peak profile information.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def show_experimental_data(self) -&gt; None:\n    \"\"\"Print experimental data including experiment datablocks,\n    types, instrument settings, and peak profile information.\n    \"\"\"\n    console.section('Experiments')\n\n    for expt in self.project.experiments.values():\n        console.paragraph('Experiment datablock')\n        console.print(f'\ud83d\udd2c {expt.name}')\n\n        console.paragraph('Experiment type')\n        console.print(\n            f'{expt.type.sample_form.value}, '\n            f'{expt.type.radiation_probe.value}, '\n            f'{expt.type.beam_mode.value}'\n        )\n\n        if 'instrument' in expt._public_attrs():\n            if 'setup_wavelength' in expt.instrument._public_attrs():\n                console.paragraph('Wavelength')\n                console.print(f'{expt.instrument.setup_wavelength.value:.5f}')\n            if 'calib_twotheta_offset' in expt.instrument._public_attrs():\n                console.paragraph('2\u03b8 offset')\n                console.print(f'{expt.instrument.calib_twotheta_offset.value:.5f}')\n\n        if 'peak_profile_type' in expt._public_attrs():\n            console.paragraph('Profile type')\n            console.print(expt.peak_profile_type)\n\n        if 'peak' in expt._public_attrs():\n            if 'broad_gauss_u' in expt.peak._public_attrs():\n                console.paragraph('Peak broadening (Gaussian)')\n                columns_headers = ['Parameter', 'Value']\n                columns_alignment = ['left', 'right']\n                columns_data = [\n                    ['U', f'{expt.peak.broad_gauss_u.value:.5f}'],\n                    ['V', f'{expt.peak.broad_gauss_v.value:.5f}'],\n                    ['W', f'{expt.peak.broad_gauss_w.value:.5f}'],\n                ]\n                render_table(\n                    columns_headers=columns_headers,\n                    columns_alignment=columns_alignment,\n                    columns_data=columns_data,\n                )\n            if 'broad_lorentz_x' in expt.peak._public_attrs():\n                console.paragraph('Peak broadening (Lorentzian)')\n                # TODO: Some headers capitalize, some don't -\n                #  be consistent\n                columns_headers = ['Parameter', 'Value']\n                columns_alignment = ['left', 'right']\n                columns_data = [\n                    ['X', f'{expt.peak.broad_lorentz_x.value:.5f}'],\n                    ['Y', f'{expt.peak.broad_lorentz_y.value:.5f}'],\n                ]\n                render_table(\n                    columns_headers=columns_headers,\n                    columns_alignment=columns_alignment,\n                    columns_data=columns_data,\n                )\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.show_fitting_details","title":"<code>show_fitting_details()</code>","text":"<p>Print fitting details including calculation and minimization engines, and fit quality metrics.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def show_fitting_details(self) -&gt; None:\n    \"\"\"Print fitting details including calculation and minimization\n    engines, and fit quality metrics.\n    \"\"\"\n    console.section('Fitting')\n\n    console.paragraph('Calculation engine')\n    console.print(self.project.analysis.current_calculator)\n\n    console.paragraph('Minimization engine')\n    console.print(self.project.analysis.current_minimizer)\n\n    console.paragraph('Fit quality')\n    columns_headers = ['metric', 'value']\n    columns_alignment = ['left', 'right']\n    fit_metrics = [\n        [\n            'Goodness-of-fit (reduced \u03c7\u00b2)',\n            f'{self.project.analysis.fit_results.reduced_chi_square:.2f}',\n        ]\n    ]\n    render_table(\n        columns_headers=columns_headers,\n        columns_alignment=columns_alignment,\n        columns_data=fit_metrics,\n    )\n</code></pre>"},{"location":"api-reference/summary/#easydiffraction.summary.summary.Summary.show_project_info","title":"<code>show_project_info()</code>","text":"<p>Print the project title and description.</p> Source code in <code>src/easydiffraction/summary/summary.py</code> <pre><code>def show_project_info(self) -&gt; None:\n    \"\"\"Print the project title and description.\"\"\"\n    console.section('Project info')\n\n    console.paragraph('Title')\n    console.print(self.project.info.title)\n\n    if self.project.info.description:\n        console.paragraph('Description')\n        # log.print('\\n'.join(wrap(self.project.info.description,\n        # width=80)))\n        # TODO: Fix the following lines\n        # Ensure description wraps with explicit newlines for tests\n        desc_lines = wrap(self.project.info.description, width=60)\n        # Use plain print to avoid Left padding that would break\n        # newline adjacency checks\n        print('\\n'.join(desc_lines))\n</code></pre>"},{"location":"api-reference/utils/","title":"utils","text":""},{"location":"api-reference/utils/#easydiffraction.utils","title":"<code>utils</code>","text":""},{"location":"api-reference/utils/#easydiffraction.utils.environment","title":"<code>environment</code>","text":""},{"location":"api-reference/utils/#easydiffraction.utils.environment.can_update_ipython_display","title":"<code>can_update_ipython_display()</code>","text":"<p>Return True if IPython HTML display utilities are available.</p> <p>This indicates we can safely construct <code>IPython.display.HTML</code> and update a display handle.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def can_update_ipython_display() -&gt; bool:\n    \"\"\"Return True if IPython HTML display utilities are available.\n\n    This indicates we can safely construct ``IPython.display.HTML`` and\n    update a display handle.\n    \"\"\"\n    try:\n        from IPython.display import HTML  # type: ignore[import-not-found]  # noqa: F401\n\n        return True\n    except Exception:\n        return False\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.can_use_ipython_display","title":"<code>can_use_ipython_display(handle)</code>","text":"<p>Return True if we can update the given IPython DisplayHandle.</p> <p>Combines type checking of the handle with availability of IPython HTML utilities.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def can_use_ipython_display(handle: object) -&gt; bool:\n    \"\"\"Return True if we can update the given IPython DisplayHandle.\n\n    Combines type checking of the handle with availability of IPython\n    HTML utilities.\n    \"\"\"\n    try:\n        return is_ipython_display_handle(handle) and can_update_ipython_display()\n    except Exception:\n        return False\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.in_colab","title":"<code>in_colab()</code>","text":"<p>Determines if the current environment is Google Colab.</p> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True if running in Google Colab, False otherwise.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def in_colab() -&gt; bool:\n    \"\"\"Determines if the current environment is Google Colab.\n\n    Returns:\n        bool: True if running in Google Colab, False otherwise.\n    \"\"\"\n    try:\n        return find_spec('google.colab') is not None\n    except ModuleNotFoundError:  # pragma: no cover - importlib edge case\n        return False\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.in_github_ci","title":"<code>in_github_ci()</code>","text":"<p>Return True when running under GitHub Actions CI.</p> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True if env var <code>GITHUB_ACTIONS</code> is set, False</p> <code>bool</code> <p>otherwise.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def in_github_ci() -&gt; bool:\n    \"\"\"Return True when running under GitHub Actions CI.\n\n    Returns:\n        bool: True if env var ``GITHUB_ACTIONS`` is set, False\n        otherwise.\n    \"\"\"\n    return os.environ.get('GITHUB_ACTIONS') is not None\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.in_jupyter","title":"<code>in_jupyter()</code>","text":"<p>Return True when running inside a Jupyter Notebook.</p> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True if inside a Jupyter Notebook, False otherwise.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def in_jupyter() -&gt; bool:\n    \"\"\"Return True when running inside a Jupyter Notebook.\n\n    Returns:\n        bool: True if inside a Jupyter Notebook, False otherwise.\n    \"\"\"\n    try:\n        import IPython  # type: ignore[import-not-found]\n    except ImportError:  # pragma: no cover - optional dependency\n        ipython_mod = None\n    else:\n        ipython_mod = IPython\n    if ipython_mod is None:\n        return False\n    if in_pycharm():\n        return False\n    if in_colab():\n        return True\n\n    try:\n        ip = ipython_mod.get_ipython()  # type: ignore[attr-defined]\n        if ip is None:\n            return False\n        # Prefer config-based detection when available (works with\n        # tests).\n        has_cfg = hasattr(ip, 'config') and isinstance(ip.config, dict)\n        if has_cfg and 'IPKernelApp' in ip.config:  # type: ignore[index]\n            return True\n        shell = ip.__class__.__name__\n        if shell == 'ZMQInteractiveShell':  # Jupyter or qtconsole\n            return True\n        if shell == 'TerminalInteractiveShell':\n            return False\n        return False\n    except Exception:\n        return False\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.in_pycharm","title":"<code>in_pycharm()</code>","text":"<p>Determines if the current environment is PyCharm.</p> <p>Returns:</p> Name Type Description <code>bool</code> <code>bool</code> <p>True if running inside PyCharm, False otherwise.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def in_pycharm() -&gt; bool:\n    \"\"\"Determines if the current environment is PyCharm.\n\n    Returns:\n        bool: True if running inside PyCharm, False otherwise.\n    \"\"\"\n    return os.environ.get('PYCHARM_HOSTED') == '1'\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.environment.is_ipython_display_handle","title":"<code>is_ipython_display_handle(obj)</code>","text":"<p>Return True if <code>obj</code> is an IPython DisplayHandle instance.</p> <p>Tries to import <code>IPython.display.DisplayHandle</code> and uses <code>isinstance</code> when available. Falls back to a conservative module name heuristic if IPython is missing. Any errors result in <code>False</code>.</p> Source code in <code>src/easydiffraction/utils/environment.py</code> <pre><code>def is_ipython_display_handle(obj: object) -&gt; bool:\n    \"\"\"Return True if ``obj`` is an IPython DisplayHandle instance.\n\n    Tries to import ``IPython.display.DisplayHandle`` and uses\n    ``isinstance`` when available. Falls back to a conservative\n    module name heuristic if IPython is missing. Any errors result\n    in ``False``.\n    \"\"\"\n    try:  # Fast path when IPython is available\n        from IPython.display import DisplayHandle  # type: ignore[import-not-found]\n\n        try:\n            return isinstance(obj, DisplayHandle)\n        except Exception:\n            return False\n    except Exception:\n        # Fallback heuristic when IPython is unavailable\n        try:\n            mod = getattr(getattr(obj, '__class__', None), '__module__', '')\n            return isinstance(mod, str) and mod.startswith('IPython')\n        except Exception:\n            return False\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging","title":"<code>logging</code>","text":"<p>Project-wide logging utilities built on top of Rich.</p> <p>Provides a shared Rich console, a compact/verbose logger with consistent formatting, Jupyter traceback handling, and a small printing fa\u00e7ade tailored to the configured console.</p>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsoleManager","title":"<code>ConsoleManager</code>","text":"<p>Central provider for shared Rich Console instance.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class ConsoleManager:\n    \"\"\"Central provider for shared Rich Console instance.\"\"\"\n\n    _MIN_CONSOLE_WIDTH = 130\n    _instance: Console | None = None\n\n    @staticmethod\n    def _detect_width() -&gt; int:\n        \"\"\"Detect a suitable console width for the shared Console.\n\n        Returns:\n            The detected terminal width, clamped at\n            ``_MIN_CONSOLE_WIDTH`` to avoid cramped layouts.\n        \"\"\"\n        min_width = ConsoleManager._MIN_CONSOLE_WIDTH\n        try:\n            width = shutil.get_terminal_size().columns\n        except Exception:\n            width = min_width\n        return max(width, min_width)\n\n    @classmethod\n    def get(cls) -&gt; Console:\n        \"\"\"Return a shared Rich Console instance.\"\"\"\n        if cls._instance is None:\n            cls._instance = Console(\n                width=cls._detect_width(),\n                force_jupyter=False,\n            )\n        return cls._instance\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsoleManager.get","title":"<code>get()</code>  <code>classmethod</code>","text":"<p>Return a shared Rich Console instance.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef get(cls) -&gt; Console:\n    \"\"\"Return a shared Rich Console instance.\"\"\"\n    if cls._instance is None:\n        cls._instance = Console(\n            width=cls._detect_width(),\n            force_jupyter=False,\n        )\n    return cls._instance\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsolePrinter","title":"<code>ConsolePrinter</code>","text":"<p>Printer utility that prints objects to the shared console with left padding.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class ConsolePrinter:\n    \"\"\"Printer utility that prints objects to the shared console with\n    left padding.\n    \"\"\"\n\n    _console = ConsoleManager.get()\n\n    @classmethod\n    def print(cls, *objects, **kwargs):\n        \"\"\"Print objects to the console with left padding.\n\n        - Renderables (Rich types like Text, Table, Panel, etc.) are\n          kept as-is.\n        - Non-renderables (ints, floats, Path, etc.) are converted to\n          str().\n        \"\"\"\n        safe_objects = []\n        for obj in objects:\n            if isinstance(obj, RenderableType):\n                safe_objects.append(obj)\n            elif isinstance(obj, Path):\n                safe_objects.append(str(obj))\n            else:\n                safe_objects.append(str(obj))\n\n        # If multiple objects, join with spaces\n        renderable = (\n            ' '.join(str(o) for o in safe_objects)\n            if all(isinstance(o, str) for o in safe_objects)\n            else Group(*safe_objects)\n        )\n\n        cls._console.print(renderable, **kwargs)\n\n    @classmethod\n    def paragraph(cls, title: str) -&gt; None:\n        parts = re.split(r\"('.*?')\", title)\n        text = Text()\n        for part in parts:\n            if part.startswith(\"'\") and part.endswith(\"'\"):\n                text.append(part)\n            else:\n                text.append(part, style='bold blue')\n        formatted = f'{text.markup}'\n        if not in_jupyter():\n            formatted = f'\\n{formatted}'\n        cls._console.print(formatted)\n\n    @classmethod\n    def section(cls, title: str) -&gt; None:\n        \"\"\"Formats a section header with bold green text.\"\"\"\n        full_title = f'{title.upper()}'\n        line = '\u2014' * len(full_title)\n        formatted = f'[bold green]{line}\\n{full_title}\\n{line}[/bold green]'\n        if not in_jupyter():\n            formatted = f'\\n{formatted}'\n        cls._console.print(formatted)\n\n    @classmethod\n    def chapter(cls, title: str) -&gt; None:\n        \"\"\"Formats a chapter header with bold magenta text, uppercase,\n        and padding.\n        \"\"\"\n        width = ConsoleManager._detect_width()\n        symbol = '\u2014'\n        full_title = f' {title.upper()} '\n        pad_len = (width - len(full_title)) // 2\n        padding = symbol * pad_len\n        line = f'[bold magenta]{padding}{full_title}{padding}[/bold magenta]'\n        if len(line) &lt; width:\n            line += symbol\n        formatted = f'{line}'\n        if not in_jupyter():\n            formatted = f'\\n{formatted}'\n        cls._console.print(formatted)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsolePrinter.chapter","title":"<code>chapter(title)</code>  <code>classmethod</code>","text":"<p>Formats a chapter header with bold magenta text, uppercase, and padding.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef chapter(cls, title: str) -&gt; None:\n    \"\"\"Formats a chapter header with bold magenta text, uppercase,\n    and padding.\n    \"\"\"\n    width = ConsoleManager._detect_width()\n    symbol = '\u2014'\n    full_title = f' {title.upper()} '\n    pad_len = (width - len(full_title)) // 2\n    padding = symbol * pad_len\n    line = f'[bold magenta]{padding}{full_title}{padding}[/bold magenta]'\n    if len(line) &lt; width:\n        line += symbol\n    formatted = f'{line}'\n    if not in_jupyter():\n        formatted = f'\\n{formatted}'\n    cls._console.print(formatted)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsolePrinter.print","title":"<code>print(*objects, **kwargs)</code>  <code>classmethod</code>","text":"<p>Print objects to the console with left padding.</p> <ul> <li>Renderables (Rich types like Text, Table, Panel, etc.) are   kept as-is.</li> <li>Non-renderables (ints, floats, Path, etc.) are converted to   str().</li> </ul> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef print(cls, *objects, **kwargs):\n    \"\"\"Print objects to the console with left padding.\n\n    - Renderables (Rich types like Text, Table, Panel, etc.) are\n      kept as-is.\n    - Non-renderables (ints, floats, Path, etc.) are converted to\n      str().\n    \"\"\"\n    safe_objects = []\n    for obj in objects:\n        if isinstance(obj, RenderableType):\n            safe_objects.append(obj)\n        elif isinstance(obj, Path):\n            safe_objects.append(str(obj))\n        else:\n            safe_objects.append(str(obj))\n\n    # If multiple objects, join with spaces\n    renderable = (\n        ' '.join(str(o) for o in safe_objects)\n        if all(isinstance(o, str) for o in safe_objects)\n        else Group(*safe_objects)\n    )\n\n    cls._console.print(renderable, **kwargs)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ConsolePrinter.section","title":"<code>section(title)</code>  <code>classmethod</code>","text":"<p>Formats a section header with bold green text.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef section(cls, title: str) -&gt; None:\n    \"\"\"Formats a section header with bold green text.\"\"\"\n    full_title = f'{title.upper()}'\n    line = '\u2014' * len(full_title)\n    formatted = f'[bold green]{line}\\n{full_title}\\n{line}[/bold green]'\n    if not in_jupyter():\n        formatted = f'\\n{formatted}'\n    cls._console.print(formatted)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ExceptionHookManager","title":"<code>ExceptionHookManager</code>","text":"<p>Handles installation and restoration of exception hooks.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class ExceptionHookManager:\n    \"\"\"Handles installation and restoration of exception hooks.\"\"\"\n\n    @staticmethod\n    def install_verbose_hook(logger: logging.Logger) -&gt; None:\n        \"\"\"Install a verbose exception hook that prints rich tracebacks.\n\n        Args:\n            logger: Logger used to emit the exception information.\n        \"\"\"\n        if not hasattr(Logger, '_orig_excepthook'):\n            Logger._orig_excepthook = sys.excepthook  # type: ignore[attr-defined]\n\n        def aligned_excepthook(\n            exc_type: type[BaseException],\n            exc: BaseException,\n            tb: 'TracebackType | None',\n        ) -&gt; None:\n            original_args = getattr(exc, 'args', tuple())\n            message = str(exc)\n            with suppress(Exception):\n                exc.args = tuple()\n            try:\n                logger.error(message, exc_info=(exc_type, exc, tb))\n            except Exception:\n                logger.error('Unhandled exception (logging failure)')\n            finally:\n                with suppress(Exception):\n                    exc.args = original_args\n\n        sys.excepthook = aligned_excepthook  # type: ignore[assignment]\n\n    @staticmethod\n    def install_compact_hook(logger: logging.Logger) -&gt; None:\n        \"\"\"Install a compact exception hook that logs message-only.\n\n        Args:\n            logger: Logger used to emit the error message.\n        \"\"\"\n        if not hasattr(Logger, '_orig_excepthook'):\n            Logger._orig_excepthook = sys.excepthook  # type: ignore[attr-defined]\n\n        def compact_excepthook(\n            _exc_type: type[BaseException],\n            exc: BaseException,\n            _tb: 'TracebackType | None',\n        ) -&gt; None:\n            logger.error(str(exc))\n            raise SystemExit(1)\n\n        sys.excepthook = compact_excepthook  # type: ignore[assignment]\n\n    @staticmethod\n    def restore_original_hook():\n        \"\"\"Restore the original sys.excepthook if it was overridden.\"\"\"\n        if hasattr(Logger, '_orig_excepthook'):\n            sys.excepthook = Logger._orig_excepthook  # type: ignore[attr-defined]\n\n    # Jupyter-specific traceback suppression (inlined here)\n    @staticmethod\n    def _suppress_traceback(logger):\n        \"\"\"Build a Jupyter custom exception callback that logs only the\n        message.\n\n        Args:\n            logger: Logger used to emit error messages.\n\n        Returns:\n            A callable suitable for IPython's set_custom_exc that\n            suppresses full tracebacks and logs only the exception\n            message.\n        \"\"\"\n\n        def suppress_jupyter_traceback(*args, **kwargs):\n            try:\n                _evalue = (\n                    args[2] if len(args) &gt; 2 else kwargs.get('_evalue') or kwargs.get('evalue')\n                )\n                logger.error(str(_evalue))\n            except Exception as err:\n                logger.debug('Jupyter traceback suppressor failed: %r', err)\n            return None\n\n        return suppress_jupyter_traceback\n\n    @staticmethod\n    def install_jupyter_traceback_suppressor(logger: logging.Logger) -&gt; None:\n        \"\"\"Install a Jupyter/IPython custom exception handler that\n        suppresses tracebacks.\n\n        Args:\n            logger: Logger used to emit error messages.\n        \"\"\"\n        try:\n            from IPython import get_ipython\n\n            ip = get_ipython()\n            if ip is not None:\n                ip.set_custom_exc(\n                    (BaseException,), ExceptionHookManager._suppress_traceback(logger)\n                )\n        except Exception as err:\n            msg = f'Failed to install Jupyter traceback suppressor: {err!r}'\n            logger.debug(msg)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ExceptionHookManager.install_compact_hook","title":"<code>install_compact_hook(logger)</code>  <code>staticmethod</code>","text":"<p>Install a compact exception hook that logs message-only.</p> <p>Parameters:</p> Name Type Description Default <code>logger</code> <code>Logger</code> <p>Logger used to emit the error message.</p> required Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef install_compact_hook(logger: logging.Logger) -&gt; None:\n    \"\"\"Install a compact exception hook that logs message-only.\n\n    Args:\n        logger: Logger used to emit the error message.\n    \"\"\"\n    if not hasattr(Logger, '_orig_excepthook'):\n        Logger._orig_excepthook = sys.excepthook  # type: ignore[attr-defined]\n\n    def compact_excepthook(\n        _exc_type: type[BaseException],\n        exc: BaseException,\n        _tb: 'TracebackType | None',\n    ) -&gt; None:\n        logger.error(str(exc))\n        raise SystemExit(1)\n\n    sys.excepthook = compact_excepthook  # type: ignore[assignment]\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ExceptionHookManager.install_jupyter_traceback_suppressor","title":"<code>install_jupyter_traceback_suppressor(logger)</code>  <code>staticmethod</code>","text":"<p>Install a Jupyter/IPython custom exception handler that suppresses tracebacks.</p> <p>Parameters:</p> Name Type Description Default <code>logger</code> <code>Logger</code> <p>Logger used to emit error messages.</p> required Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef install_jupyter_traceback_suppressor(logger: logging.Logger) -&gt; None:\n    \"\"\"Install a Jupyter/IPython custom exception handler that\n    suppresses tracebacks.\n\n    Args:\n        logger: Logger used to emit error messages.\n    \"\"\"\n    try:\n        from IPython import get_ipython\n\n        ip = get_ipython()\n        if ip is not None:\n            ip.set_custom_exc(\n                (BaseException,), ExceptionHookManager._suppress_traceback(logger)\n            )\n    except Exception as err:\n        msg = f'Failed to install Jupyter traceback suppressor: {err!r}'\n        logger.debug(msg)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ExceptionHookManager.install_verbose_hook","title":"<code>install_verbose_hook(logger)</code>  <code>staticmethod</code>","text":"<p>Install a verbose exception hook that prints rich tracebacks.</p> <p>Parameters:</p> Name Type Description Default <code>logger</code> <code>Logger</code> <p>Logger used to emit the exception information.</p> required Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef install_verbose_hook(logger: logging.Logger) -&gt; None:\n    \"\"\"Install a verbose exception hook that prints rich tracebacks.\n\n    Args:\n        logger: Logger used to emit the exception information.\n    \"\"\"\n    if not hasattr(Logger, '_orig_excepthook'):\n        Logger._orig_excepthook = sys.excepthook  # type: ignore[attr-defined]\n\n    def aligned_excepthook(\n        exc_type: type[BaseException],\n        exc: BaseException,\n        tb: 'TracebackType | None',\n    ) -&gt; None:\n        original_args = getattr(exc, 'args', tuple())\n        message = str(exc)\n        with suppress(Exception):\n            exc.args = tuple()\n        try:\n            logger.error(message, exc_info=(exc_type, exc, tb))\n        except Exception:\n            logger.error('Unhandled exception (logging failure)')\n        finally:\n            with suppress(Exception):\n                exc.args = original_args\n\n    sys.excepthook = aligned_excepthook  # type: ignore[assignment]\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.ExceptionHookManager.restore_original_hook","title":"<code>restore_original_hook()</code>  <code>staticmethod</code>","text":"<p>Restore the original sys.excepthook if it was overridden.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef restore_original_hook():\n    \"\"\"Restore the original sys.excepthook if it was overridden.\"\"\"\n    if hasattr(Logger, '_orig_excepthook'):\n        sys.excepthook = Logger._orig_excepthook  # type: ignore[attr-defined]\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.IconifiedRichHandler","title":"<code>IconifiedRichHandler</code>","text":"<p>               Bases: <code>RichHandler</code></p> <p>RichHandler that uses icons for log levels in compact mode, Rich default in verbose mode.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class IconifiedRichHandler(RichHandler):\n    \"\"\"RichHandler that uses icons for log levels in compact mode, Rich\n    default in verbose mode.\n    \"\"\"\n\n    _icons = {\n        logging.CRITICAL: '\ud83d\udc80',\n        logging.ERROR: '\u274c',\n        logging.WARNING: '\u26a0\ufe0f',\n        logging.DEBUG: '\u2699\ufe0f',\n        logging.INFO: '\u2139\ufe0f',\n    }\n\n    def __init__(self, *args, mode: str = 'compact', **kwargs):\n        super().__init__(*args, **kwargs)\n        self.mode = mode\n\n    def get_level_text(self, record: logging.LogRecord) -&gt; Text:\n        if self.mode == 'compact':\n            icon = self._icons.get(record.levelno, record.levelname)\n            if in_warp() and not in_jupyter() and icon in ['\u26a0\ufe0f', '\u2699\ufe0f', '\u2139\ufe0f']:\n                icon = icon + ' '  # add space to align with two-char icons\n            return Text(icon)\n        else:\n            # Use RichHandler's default level text for verbose mode\n            return super().get_level_text(record)\n\n    def render_message(self, record: logging.LogRecord, message: str) -&gt; Text:\n        # In compact mode, let the icon come from get_level_text and\n        # keep the message body unadorned. In verbose mode, defer to\n        # RichHandler.\n        if self.mode == 'compact':\n            try:\n                return Text.from_markup(message)\n            except Exception:\n                return Text(str(message))\n        return super().render_message(record, message)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger","title":"<code>Logger</code>","text":"<p>Centralized logging with Rich formatting and two modes.</p> <p>Environment variables: ED_LOG_MODE: set default mode ('verbose' or 'compact') ED_LOG_LEVEL: set default level ('DEBUG', 'INFO', etc.)</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class Logger:\n    \"\"\"Centralized logging with Rich formatting and two modes.\n\n    Environment variables:\n    ED_LOG_MODE: set default mode ('verbose' or 'compact')\n    ED_LOG_LEVEL: set default level ('DEBUG', 'INFO', etc.)\n    \"\"\"\n\n    # --- Enums ---\n    class Mode(Enum):\n        \"\"\"Output modes (see :class:`Logger`).\"\"\"\n\n        VERBOSE = 'verbose'  # rich traceback panel\n        COMPACT = 'compact'  # single line; no traceback\n\n        @classmethod\n        def default(cls):\n            return cls.COMPACT\n\n    class Level(IntEnum):\n        \"\"\"Mirror stdlib logging levels.\"\"\"\n\n        DEBUG = logging.DEBUG\n        INFO = logging.INFO\n        WARNING = logging.WARNING\n        ERROR = logging.ERROR\n        CRITICAL = logging.CRITICAL\n\n        @classmethod\n        def default(cls):\n            return cls.WARNING\n\n    class Reaction(Enum):\n        \"\"\"Reaction to errors (see :class:`Logger`).\"\"\"\n\n        RAISE = auto()\n        WARN = auto()\n\n        @classmethod\n        def default(cls):\n            return cls.RAISE\n\n    # --- Internal state ---\n    _logger = logging.getLogger('easydiffraction')\n    _configured = False\n    _mode: Mode = Mode.VERBOSE\n    _reaction: Reaction = Reaction.RAISE  # TODO: not default?\n    _console = ConsoleManager.get()\n\n    # ===== CONFIGURATION =====\n    @classmethod\n    def configure(\n        cls,\n        *,\n        mode: Mode | None = None,\n        level: Level | None = None,\n        reaction: Reaction | None = None,\n        rich_tracebacks: bool | None = None,\n    ) -&gt; None:\n        \"\"\"Configure logger.\n\n        mode: default COMPACT in Jupyter else VERBOSE\n        level: minimum log level\n        rich_tracebacks: override automatic choice\n\n        Environment variables:\n        ED_LOG_MODE: set default mode ('verbose' or 'compact')\n        ED_LOG_LEVEL: set default level ('DEBUG', 'INFO', etc.)\n        \"\"\"\n        env_mode = os.getenv('ED_LOG_MODE')\n        env_level = os.getenv('ED_LOG_LEVEL')\n        env_reaction = os.getenv('ED_LOG_REACTION')\n\n        # Read from environment if not provided\n        if mode is None and env_mode is not None:\n            with suppress(ValueError):\n                mode = Logger.Mode(env_mode.lower())\n        if level is None and env_level is not None:\n            with suppress(KeyError):\n                level = Logger.Level[env_level.upper()]\n        if reaction is None and env_reaction is not None:\n            with suppress(KeyError):\n                reaction = Logger.Reaction[env_reaction.upper()]\n\n        # Set defaults if still None\n        if mode is None:\n            mode = Logger.Mode.default()\n        if level is None:\n            level = Logger.Level.default()\n        if reaction is None:\n            reaction = Logger.Reaction.default()\n\n        cls._mode = mode\n        cls._reaction = reaction\n\n        if rich_tracebacks is None:\n            rich_tracebacks = mode == Logger.Mode.VERBOSE\n\n        LoggerConfig.configure(\n            logger=cls._logger,\n            mode=mode,\n            level=level,\n            rich_tracebacks=rich_tracebacks,\n        )\n        cls._configured = True\n\n    @classmethod\n    def _install_jupyter_traceback_suppressor(cls) -&gt; None:\n        \"\"\"Install traceback suppressor in Jupyter, safely and lint-\n        clean.\n        \"\"\"\n        ExceptionHookManager.install_jupyter_traceback_suppressor(cls._logger)\n\n    # ===== Helpers =====\n    @classmethod\n    def set_mode(cls, mode: Mode) -&gt; None:\n        cls.configure(mode=mode, level=cls.Level(cls._logger.level))\n\n    @classmethod\n    def set_level(cls, level: Level) -&gt; None:\n        cls.configure(mode=cls._mode, level=level)\n\n    @classmethod\n    def mode(cls) -&gt; Mode:\n        return cls._mode\n\n    @classmethod\n    def _lazy_config(cls) -&gt; None:\n        if not cls._configured:  # pragma: no cover - trivial\n            cls.configure()\n\n    # ===== Core Routing =====\n    @classmethod\n    def handle(\n        cls,\n        *messages: str,\n        level: Level = Level.ERROR,\n        exc_type: type[BaseException] | None = AttributeError,\n    ) -&gt; None:\n        \"\"\"Route a log message (see class docs for policy).\"\"\"\n        cls._lazy_config()\n        message = ' '.join(messages)\n        # Prioritize explicit UserWarning path so pytest captures\n        # warnings\n        if exc_type is UserWarning:\n            if in_pytest():\n                warnings.warn(message, UserWarning, stacklevel=2)\n            else:\n                cls._logger.warning(message)\n            return\n        # Special handling for Reaction.WARN (non-warning cases)\n        if cls._reaction is cls.Reaction.WARN:\n            # Log as error/critical (keep icon) but continue execution\n            cls._logger.log(int(level), message)\n            return\n        if exc_type is not None:\n            if cls._mode is cls.Mode.VERBOSE:\n                raise exc_type(message)\n            if cls._mode is cls.Mode.COMPACT:\n                raise exc_type(message) from None\n        cls._logger.log(int(level), message)\n\n    # ==================================================================\n    # CONVENIENCE API\n    # ==================================================================\n\n    @classmethod\n    def debug(cls, *messages: str) -&gt; None:\n        cls.handle(*messages, level=cls.Level.DEBUG, exc_type=None)\n\n    @classmethod\n    def info(cls, *messages: str) -&gt; None:\n        cls.handle(*messages, level=cls.Level.INFO, exc_type=None)\n\n    @classmethod\n    def warning(cls, *messages: str, exc_type: type[BaseException] | None = None) -&gt; None:\n        cls.handle(*messages, level=cls.Level.WARNING, exc_type=exc_type)\n\n    @classmethod\n    def error(cls, *messages: str, exc_type: type[BaseException] = AttributeError) -&gt; None:\n        cls.handle(*messages, level=cls.Level.ERROR, exc_type=exc_type)\n\n    @classmethod\n    def critical(cls, *messages: str, exc_type: type[BaseException] = RuntimeError) -&gt; None:\n        cls.handle(*messages, level=cls.Level.CRITICAL, exc_type=exc_type)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger.Level","title":"<code>Level</code>","text":"<p>               Bases: <code>IntEnum</code></p> <p>Mirror stdlib logging levels.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class Level(IntEnum):\n    \"\"\"Mirror stdlib logging levels.\"\"\"\n\n    DEBUG = logging.DEBUG\n    INFO = logging.INFO\n    WARNING = logging.WARNING\n    ERROR = logging.ERROR\n    CRITICAL = logging.CRITICAL\n\n    @classmethod\n    def default(cls):\n        return cls.WARNING\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger.Mode","title":"<code>Mode</code>","text":"<p>               Bases: <code>Enum</code></p> <p>Output modes (see :class:<code>Logger</code>).</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class Mode(Enum):\n    \"\"\"Output modes (see :class:`Logger`).\"\"\"\n\n    VERBOSE = 'verbose'  # rich traceback panel\n    COMPACT = 'compact'  # single line; no traceback\n\n    @classmethod\n    def default(cls):\n        return cls.COMPACT\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger.Reaction","title":"<code>Reaction</code>","text":"<p>               Bases: <code>Enum</code></p> <p>Reaction to errors (see :class:<code>Logger</code>).</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class Reaction(Enum):\n    \"\"\"Reaction to errors (see :class:`Logger`).\"\"\"\n\n    RAISE = auto()\n    WARN = auto()\n\n    @classmethod\n    def default(cls):\n        return cls.RAISE\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger.configure","title":"<code>configure(*, mode=None, level=None, reaction=None, rich_tracebacks=None)</code>  <code>classmethod</code>","text":"<p>Configure logger.</p> <p>mode: default COMPACT in Jupyter else VERBOSE level: minimum log level rich_tracebacks: override automatic choice</p> <p>Environment variables: ED_LOG_MODE: set default mode ('verbose' or 'compact') ED_LOG_LEVEL: set default level ('DEBUG', 'INFO', etc.)</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef configure(\n    cls,\n    *,\n    mode: Mode | None = None,\n    level: Level | None = None,\n    reaction: Reaction | None = None,\n    rich_tracebacks: bool | None = None,\n) -&gt; None:\n    \"\"\"Configure logger.\n\n    mode: default COMPACT in Jupyter else VERBOSE\n    level: minimum log level\n    rich_tracebacks: override automatic choice\n\n    Environment variables:\n    ED_LOG_MODE: set default mode ('verbose' or 'compact')\n    ED_LOG_LEVEL: set default level ('DEBUG', 'INFO', etc.)\n    \"\"\"\n    env_mode = os.getenv('ED_LOG_MODE')\n    env_level = os.getenv('ED_LOG_LEVEL')\n    env_reaction = os.getenv('ED_LOG_REACTION')\n\n    # Read from environment if not provided\n    if mode is None and env_mode is not None:\n        with suppress(ValueError):\n            mode = Logger.Mode(env_mode.lower())\n    if level is None and env_level is not None:\n        with suppress(KeyError):\n            level = Logger.Level[env_level.upper()]\n    if reaction is None and env_reaction is not None:\n        with suppress(KeyError):\n            reaction = Logger.Reaction[env_reaction.upper()]\n\n    # Set defaults if still None\n    if mode is None:\n        mode = Logger.Mode.default()\n    if level is None:\n        level = Logger.Level.default()\n    if reaction is None:\n        reaction = Logger.Reaction.default()\n\n    cls._mode = mode\n    cls._reaction = reaction\n\n    if rich_tracebacks is None:\n        rich_tracebacks = mode == Logger.Mode.VERBOSE\n\n    LoggerConfig.configure(\n        logger=cls._logger,\n        mode=mode,\n        level=level,\n        rich_tracebacks=rich_tracebacks,\n    )\n    cls._configured = True\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.Logger.handle","title":"<code>handle(*messages, level=Level.ERROR, exc_type=AttributeError)</code>  <code>classmethod</code>","text":"<p>Route a log message (see class docs for policy).</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@classmethod\ndef handle(\n    cls,\n    *messages: str,\n    level: Level = Level.ERROR,\n    exc_type: type[BaseException] | None = AttributeError,\n) -&gt; None:\n    \"\"\"Route a log message (see class docs for policy).\"\"\"\n    cls._lazy_config()\n    message = ' '.join(messages)\n    # Prioritize explicit UserWarning path so pytest captures\n    # warnings\n    if exc_type is UserWarning:\n        if in_pytest():\n            warnings.warn(message, UserWarning, stacklevel=2)\n        else:\n            cls._logger.warning(message)\n        return\n    # Special handling for Reaction.WARN (non-warning cases)\n    if cls._reaction is cls.Reaction.WARN:\n        # Log as error/critical (keep icon) but continue execution\n        cls._logger.log(int(level), message)\n        return\n    if exc_type is not None:\n        if cls._mode is cls.Mode.VERBOSE:\n            raise exc_type(message)\n        if cls._mode is cls.Mode.COMPACT:\n            raise exc_type(message) from None\n    cls._logger.log(int(level), message)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.LoggerConfig","title":"<code>LoggerConfig</code>","text":"<p>Facade for logger configuration, delegates to helpers.</p> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>class LoggerConfig:\n    \"\"\"Facade for logger configuration, delegates to helpers.\"\"\"\n\n    @staticmethod\n    def setup_handlers(\n        logger: logging.Logger,\n        *,\n        level: int,\n        rich_tracebacks: bool,\n        mode: str = 'compact',\n    ) -&gt; None:\n        \"\"\"Install Rich handler and optional Jupyter traceback support.\n\n        Args:\n            logger: Logger instance to attach handlers to.\n            level: Minimum log level to emit.\n            rich_tracebacks: Whether to enable Rich tracebacks.\n            mode: Output mode name (\"compact\" or \"verbose\").\n        \"\"\"\n        logger.handlers.clear()\n        logger.propagate = False\n        logger.setLevel(level)\n\n        if in_jupyter():\n            traceback.install(\n                show_locals=False,\n                suppress=['easydiffraction'],\n            )\n\n        console = ConsoleManager.get()\n        handler = IconifiedRichHandler(\n            rich_tracebacks=rich_tracebacks,\n            markup=True,\n            show_time=False,\n            show_path=False,\n            tracebacks_show_locals=False,\n            tracebacks_suppress=['easydiffraction'],\n            tracebacks_max_frames=10,\n            console=console,\n            mode=mode,\n        )\n        handler.setFormatter(logging.Formatter('%(message)s'))\n        logger.addHandler(handler)\n\n    @staticmethod\n    def configure(\n        logger: logging.Logger,\n        *,\n        mode: 'Logger.Mode',\n        level: 'Logger.Level',\n        rich_tracebacks: bool,\n    ) -&gt; None:\n        \"\"\"Configure the logger with RichHandler and exception hooks.\n\n        Args:\n            logger: Logger instance to configure.\n            mode: Output mode (compact or verbose).\n            level: Minimum log level to emit.\n            rich_tracebacks: Whether to enable Rich tracebacks.\n        \"\"\"\n        LoggerConfig.setup_handlers(\n            logger,\n            level=int(level),\n            rich_tracebacks=rich_tracebacks,\n            mode=mode.value,\n        )\n\n        if rich_tracebacks and mode == Logger.Mode.VERBOSE:\n            ExceptionHookManager.install_verbose_hook(logger)\n        elif mode == Logger.Mode.COMPACT:\n            ExceptionHookManager.install_compact_hook(logger)\n            ExceptionHookManager.install_jupyter_traceback_suppressor(logger)\n        else:\n            ExceptionHookManager.restore_original_hook()\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.LoggerConfig.configure","title":"<code>configure(logger, *, mode, level, rich_tracebacks)</code>  <code>staticmethod</code>","text":"<p>Configure the logger with RichHandler and exception hooks.</p> <p>Parameters:</p> Name Type Description Default <code>logger</code> <code>Logger</code> <p>Logger instance to configure.</p> required <code>mode</code> <code>'Logger.Mode'</code> <p>Output mode (compact or verbose).</p> required <code>level</code> <code>'Logger.Level'</code> <p>Minimum log level to emit.</p> required <code>rich_tracebacks</code> <code>bool</code> <p>Whether to enable Rich tracebacks.</p> required Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef configure(\n    logger: logging.Logger,\n    *,\n    mode: 'Logger.Mode',\n    level: 'Logger.Level',\n    rich_tracebacks: bool,\n) -&gt; None:\n    \"\"\"Configure the logger with RichHandler and exception hooks.\n\n    Args:\n        logger: Logger instance to configure.\n        mode: Output mode (compact or verbose).\n        level: Minimum log level to emit.\n        rich_tracebacks: Whether to enable Rich tracebacks.\n    \"\"\"\n    LoggerConfig.setup_handlers(\n        logger,\n        level=int(level),\n        rich_tracebacks=rich_tracebacks,\n        mode=mode.value,\n    )\n\n    if rich_tracebacks and mode == Logger.Mode.VERBOSE:\n        ExceptionHookManager.install_verbose_hook(logger)\n    elif mode == Logger.Mode.COMPACT:\n        ExceptionHookManager.install_compact_hook(logger)\n        ExceptionHookManager.install_jupyter_traceback_suppressor(logger)\n    else:\n        ExceptionHookManager.restore_original_hook()\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.logging.LoggerConfig.setup_handlers","title":"<code>setup_handlers(logger, *, level, rich_tracebacks, mode='compact')</code>  <code>staticmethod</code>","text":"<p>Install Rich handler and optional Jupyter traceback support.</p> <p>Parameters:</p> Name Type Description Default <code>logger</code> <code>Logger</code> <p>Logger instance to attach handlers to.</p> required <code>level</code> <code>int</code> <p>Minimum log level to emit.</p> required <code>rich_tracebacks</code> <code>bool</code> <p>Whether to enable Rich tracebacks.</p> required <code>mode</code> <code>str</code> <p>Output mode name (\"compact\" or \"verbose\").</p> <code>'compact'</code> Source code in <code>src/easydiffraction/utils/logging.py</code> <pre><code>@staticmethod\ndef setup_handlers(\n    logger: logging.Logger,\n    *,\n    level: int,\n    rich_tracebacks: bool,\n    mode: str = 'compact',\n) -&gt; None:\n    \"\"\"Install Rich handler and optional Jupyter traceback support.\n\n    Args:\n        logger: Logger instance to attach handlers to.\n        level: Minimum log level to emit.\n        rich_tracebacks: Whether to enable Rich tracebacks.\n        mode: Output mode name (\"compact\" or \"verbose\").\n    \"\"\"\n    logger.handlers.clear()\n    logger.propagate = False\n    logger.setLevel(level)\n\n    if in_jupyter():\n        traceback.install(\n            show_locals=False,\n            suppress=['easydiffraction'],\n        )\n\n    console = ConsoleManager.get()\n    handler = IconifiedRichHandler(\n        rich_tracebacks=rich_tracebacks,\n        markup=True,\n        show_time=False,\n        show_path=False,\n        tracebacks_show_locals=False,\n        tracebacks_suppress=['easydiffraction'],\n        tracebacks_max_frames=10,\n        console=console,\n        mode=mode,\n    )\n    handler.setFormatter(logging.Formatter('%(message)s'))\n    logger.addHandler(handler)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.stripped_package_version","title":"<code>stripped_package_version(package_name)</code>","text":"<p>Get the installed version of the specified package, stripped of any local version part.</p> <p>Returns only the public version segment (e.g., '1.2.3' or '1.2.3.post4'), omitting any local segment (e.g., '+d136').</p> <p>Parameters:</p> Name Type Description Default <code>package_name</code> <code>str</code> <p>The name of the package to query.</p> required <p>Returns:</p> Type Description <code>str | None</code> <p>str | None: The public version string, or None if the package</p> <code>str | None</code> <p>is not installed.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def stripped_package_version(package_name: str) -&gt; str | None:\n    \"\"\"Get the installed version of the specified package, stripped of\n    any local version part.\n\n    Returns only the public version segment (e.g., '1.2.3' or\n    '1.2.3.post4'), omitting any local segment (e.g., '+d136').\n\n    Args:\n        package_name (str): The name of the package to query.\n\n    Returns:\n        str | None: The public version string, or None if the package\n        is not installed.\n    \"\"\"\n    v_str = package_version(package_name)\n    if v_str is None:\n        return None\n    try:\n        v = Version(v_str)\n        return str(v.public)\n    except Exception:\n        return v_str\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils","title":"<code>utils</code>","text":""},{"location":"api-reference/utils/#easydiffraction.utils.utils.download_all_tutorials","title":"<code>download_all_tutorials(destination='tutorials', overwrite=False)</code>","text":"<p>Download all available tutorial notebooks.</p> Example <p>paths = download_all_tutorials(destination=\"tutorials\")</p> <p>Parameters:</p> Name Type Description Default <code>destination</code> <code>str</code> <p>Directory to save the files into (created if missing).</p> <code>'tutorials'</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite files if they already exist.</p> <code>False</code> <p>Returns:</p> Type Description <code>list[str]</code> <p>list[str]: List of full paths to the downloaded files.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def download_all_tutorials(\n    destination: str = 'tutorials',\n    overwrite: bool = False,\n) -&gt; list[str]:\n    \"\"\"Download all available tutorial notebooks.\n\n    Example:\n        paths = download_all_tutorials(destination=\"tutorials\")\n\n    Args:\n        destination: Directory to save the files into (created if\n            missing).\n        overwrite: Whether to overwrite files if they already exist.\n\n    Returns:\n        list[str]: List of full paths to the downloaded files.\n    \"\"\"\n    index = _fetch_tutorials_index()\n    if not index:\n        console.print('\u274c No tutorials available to download.')\n        return []\n\n    version = _get_version_for_url()\n    console.print(f'\ud83d\udce5 Downloading all tutorials for easydiffraction v{version}...')\n\n    downloaded_paths = []\n    for tutorial_id in sorted(index.keys(), key=lambda x: int(x) if x.isdigit() else x):\n        try:\n            path = download_tutorial(\n                id=tutorial_id,\n                destination=destination,\n                overwrite=overwrite,\n            )\n            downloaded_paths.append(path)\n        except Exception as e:\n            log.warning(f'Failed to download tutorial #{tutorial_id}: {e}')\n\n    console.print(f'\u2705 Downloaded {len(downloaded_paths)} tutorials to \"{destination}/\"')\n    return downloaded_paths\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.download_data","title":"<code>download_data(id, destination='data', overwrite=False)</code>","text":"<p>Download a dataset by numeric ID using the remote diffraction index.</p> Example <p>path = download_data(id=12, destination=\"data\")</p> <p>Parameters:</p> Name Type Description Default <code>id</code> <code>int | str</code> <p>Numeric dataset id (e.g. 12).</p> required <code>destination</code> <code>str</code> <p>Directory to save the file into (created if missing).</p> <code>'data'</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite the file if it already exists.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>str</code> <code>str</code> <p>Full path to the downloaded file as string.</p> <p>Raises:</p> Type Description <code>KeyError</code> <p>If the id is not found in the index.</p> <code>ValueError</code> <p>If the resolved URL is not HTTP/HTTPS.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def download_data(\n    id: int | str,\n    destination: str = 'data',\n    overwrite: bool = False,\n) -&gt; str:\n    \"\"\"Download a dataset by numeric ID using the remote diffraction\n    index.\n\n    Example:\n        path = download_data(id=12, destination=\"data\")\n\n    Args:\n        id: Numeric dataset id (e.g. 12).\n        destination: Directory to save the file into (created if\n            missing).\n        overwrite: Whether to overwrite the file if it already exists.\n\n    Returns:\n        str: Full path to the downloaded file as string.\n\n    Raises:\n        KeyError: If the id is not found in the index.\n        ValueError: If the resolved URL is not HTTP/HTTPS.\n    \"\"\"\n    index = _fetch_data_index()\n    key = str(id)\n\n    if key not in index:\n        # Provide a helpful message (and keep KeyError semantics)\n        available = ', '.join(\n            sorted(index.keys(), key=lambda s: int(s) if s.isdigit() else s)[:20]\n        )\n        raise KeyError(f'Unknown dataset id={id}. Example available ids: {available} ...')\n\n    record = index[key]\n    url = record['url']\n    _validate_url(url)\n\n    known_hash = _normalize_known_hash(record.get('hash'))\n    fname = _filename_for_id_from_url(id, url)\n\n    dest_path = pathlib.Path(destination)\n    dest_path.mkdir(parents=True, exist_ok=True)\n    file_path = dest_path / fname\n\n    description = record.get('description', '')\n    message = f'Data #{id}'\n    if description:\n        message += f': {description}'\n\n    console.paragraph('Getting data...')\n    console.print(f'{message}')\n\n    if file_path.exists():\n        if not overwrite:\n            console.print(\n                f\"\u2705 Data #{id} already present at '{file_path}'. Keeping existing file.\"\n            )\n            return str(file_path)\n        log.debug(f\"Data #{id} already present at '{file_path}', but will be overwritten.\")\n        file_path.unlink()\n\n    # Pooch downloads to destination with our controlled filename.\n    pooch.retrieve(\n        url=url,\n        known_hash=known_hash,\n        fname=fname,\n        path=str(dest_path),\n    )\n\n    console.print(f\"\u2705 Data #{id} downloaded to '{file_path}'\")\n    return str(file_path)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.download_tutorial","title":"<code>download_tutorial(id, destination='tutorials', overwrite=False)</code>","text":"<p>Download a tutorial notebook by numeric ID.</p> Example <p>path = download_tutorial(id=1, destination=\"tutorials\")</p> <p>Parameters:</p> Name Type Description Default <code>id</code> <code>int | str</code> <p>Numeric tutorial id (e.g. 1).</p> required <code>destination</code> <code>str</code> <p>Directory to save the file into (created if missing).</p> <code>'tutorials'</code> <code>overwrite</code> <code>bool</code> <p>Whether to overwrite the file if it already exists.</p> <code>False</code> <p>Returns:</p> Name Type Description <code>str</code> <code>str</code> <p>Full path to the downloaded file as string.</p> <p>Raises:</p> Type Description <code>KeyError</code> <p>If the id is not found in the index.</p> <code>ValueError</code> <p>If the resolved URL is not HTTP/HTTPS.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def download_tutorial(\n    id: int | str,\n    destination: str = 'tutorials',\n    overwrite: bool = False,\n) -&gt; str:\n    \"\"\"Download a tutorial notebook by numeric ID.\n\n    Example:\n        path = download_tutorial(id=1, destination=\"tutorials\")\n\n    Args:\n        id: Numeric tutorial id (e.g. 1).\n        destination: Directory to save the file into (created if\n            missing).\n        overwrite: Whether to overwrite the file if it already exists.\n\n    Returns:\n        str: Full path to the downloaded file as string.\n\n    Raises:\n        KeyError: If the id is not found in the index.\n        ValueError: If the resolved URL is not HTTP/HTTPS.\n    \"\"\"\n    index = _fetch_tutorials_index()\n    key = str(id)\n\n    if key not in index:\n        available = ', '.join(\n            sorted(index.keys(), key=lambda s: int(s) if s.isdigit() else s)[:20]\n        )\n        raise KeyError(f'Unknown tutorial id={id}. Available ids: {available}')\n\n    record = index[key]\n    url_template = record['url']\n    url = _resolve_tutorial_url(url_template)\n    _validate_url(url)\n\n    fname = f'ed-{id}.ipynb'\n\n    dest_path = pathlib.Path(destination)\n    dest_path.mkdir(parents=True, exist_ok=True)\n    file_path = dest_path / fname\n\n    title = record.get('title', '')\n    message = f'Tutorial #{id}'\n    if title:\n        message += f': {title}'\n\n    console.paragraph('Getting tutorial...')\n    console.print(f'{message}')\n\n    if file_path.exists():\n        if not overwrite:\n            console.print(\n                f\"\u2705 Tutorial #{id} already present at '{file_path}'. Keeping existing file.\"\n            )\n            return str(file_path)\n        log.debug(f\"Tutorial #{id} already present at '{file_path}', but will be overwritten.\")\n        file_path.unlink()\n\n    # Download the notebook\n    with _safe_urlopen(url) as resp:\n        file_path.write_bytes(resp.read())\n\n    console.print(f\"\u2705 Tutorial #{id} downloaded to '{file_path}'\")\n    return str(file_path)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.get_value_from_xye_header","title":"<code>get_value_from_xye_header(file_path, key)</code>","text":"<p>Extracts a floating point value from the first line of the file, corresponding to the given key.</p> <p>Parameters:</p> Name Type Description Default <code>file_path</code> <code>str</code> <p>Path to the input file.</p> required <code>key</code> <code>str</code> <p>The key to extract ('DIFC' or 'two_theta').</p> required <p>Returns:</p> Name Type Description <code>float</code> <p>The extracted value.</p> <p>Raises:</p> Type Description <code>ValueError</code> <p>If the key is not found.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def get_value_from_xye_header(file_path, key):\n    \"\"\"Extracts a floating point value from the first line of the file,\n    corresponding to the given key.\n\n    Parameters:\n        file_path (str): Path to the input file.\n        key (str): The key to extract ('DIFC' or 'two_theta').\n\n    Returns:\n        float: The extracted value.\n\n    Raises:\n        ValueError: If the key is not found.\n    \"\"\"\n    pattern = rf'{key}\\s*=\\s*([-+]?[0-9]*\\.?[0-9]+([eE][-+]?[0-9]+)?)'\n\n    with pathlib.Path(file_path).open('r') as f:\n        first_line = f.readline()\n\n    match = re.search(pattern, first_line)\n    if match:\n        return float(match.group(1))\n    else:\n        raise ValueError(f'{key} not found in the header.')\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.list_tutorials","title":"<code>list_tutorials()</code>","text":"<p>Display a table of available tutorial notebooks.</p> <p>Shows tutorial ID, filename, title, and description for all tutorials available for the current version of easydiffraction.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def list_tutorials() -&gt; None:\n    \"\"\"Display a table of available tutorial notebooks.\n\n    Shows tutorial ID, filename, title, and description for all\n    tutorials available for the current version of easydiffraction.\n    \"\"\"\n    index = _fetch_tutorials_index()\n    if not index:\n        console.print('\u274c No tutorials available.')\n        return\n\n    version = _get_version_for_url()\n    console.print(f'Tutorials available for easydiffraction v{version}:')\n    console.print('')\n\n    columns_headers = ['id', 'file', 'title', 'description']\n    columns_alignment = ['right', 'left', 'left', 'left']\n    columns_data = []\n\n    for tutorial_id in sorted(index.keys(), key=lambda x: int(x) if x.isdigit() else x):\n        record = index[tutorial_id]\n        filename = f'ed-{tutorial_id}.ipynb'\n        title = record.get('title', '')\n        description = record.get('description', '')\n        columns_data.append([tutorial_id, filename, title, description])\n\n    render_table(\n        columns_headers=columns_headers,\n        columns_data=columns_data,\n        columns_alignment=columns_alignment,\n    )\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.package_version","title":"<code>package_version(package_name)</code>","text":"<p>Get the installed version string of the specified package.</p> <p>Parameters:</p> Name Type Description Default <code>package_name</code> <code>str</code> <p>The name of the package to query.</p> required <p>Returns:</p> Type Description <code>str | None</code> <p>str | None: The raw version string (may include local part,</p> <code>str | None</code> <p>e.g., '1.2.3+abc123'), or None if the package is not installed.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def package_version(package_name: str) -&gt; str | None:\n    \"\"\"Get the installed version string of the specified package.\n\n    Args:\n        package_name (str): The name of the package to query.\n\n    Returns:\n        str | None: The raw version string (may include local part,\n        e.g., '1.2.3+abc123'), or None if the package is not installed.\n    \"\"\"\n    try:\n        return version(package_name)\n    except PackageNotFoundError:\n        return None\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.render_cif","title":"<code>render_cif(cif_text)</code>","text":"<p>Display the CIF text as a formatted table in Jupyter Notebook or terminal.</p> <p>Parameters:</p> Name Type Description Default <code>cif_text</code> <p>The CIF text to display.</p> required Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def render_cif(cif_text) -&gt; None:\n    \"\"\"Display the CIF text as a formatted table in Jupyter Notebook or\n    terminal.\n\n    Args:\n        cif_text: The CIF text to display.\n    \"\"\"\n    # Split into lines\n    lines: List[str] = [line for line in cif_text.splitlines()]\n\n    # Convert each line into a single-column format for table rendering\n    columns: List[List[str]] = [[line] for line in lines]\n\n    # Render the table using left alignment and no headers\n    render_table(\n        columns_headers=['CIF'],\n        columns_alignment=['left'],\n        columns_data=columns,\n    )\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.show_version","title":"<code>show_version()</code>","text":"<p>Print the installed version of the easydiffraction package.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def show_version() -&gt; None:\n    \"\"\"Print the installed version of the easydiffraction package.\n\n    Args:\n        None\n    \"\"\"\n    current_ed_version = package_version('easydiffraction')\n    console.print(f'Current easydiffraction v{current_ed_version}')\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.str_to_ufloat","title":"<code>str_to_ufloat(s, default=None)</code>","text":"<p>Parse a CIF-style numeric string into a <code>ufloat</code> with an optional uncertainty.</p> <p>Examples of supported input: - \"3.566\"       \u2192 ufloat(3.566, nan) - \"3.566(2)\"    \u2192 ufloat(3.566, 0.002) - None          \u2192 ufloat(default, nan)</p> <p>Behavior: - If the input string contains a value with parentheses (e.g.   \"3.566(2)\"), the number in parentheses is interpreted as an   estimated standard deviation (esd) in the last digit(s). - If the input string has no parentheses, an uncertainty of NaN is   assigned to indicate \"no esd provided\". - If parsing fails, the function falls back to the given <code>default</code>   value with uncertainty NaN.</p>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.str_to_ufloat--parameters","title":"Parameters","text":"<p>s : str or None     Numeric string in CIF format (e.g. \"3.566\", \"3.566(2)\") or None. default : float or None, optional     Default value to use if <code>s</code> is None or parsing fails.     Defaults to None.</p>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.str_to_ufloat--returns","title":"Returns:","text":"<p>UFloat     An <code>uncertainties.UFloat</code> object with the parsed value and     uncertainty. The uncertainty will be NaN if not specified or     parsing failed.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def str_to_ufloat(s: Optional[str], default: Optional[float] = None) -&gt; UFloat:\n    \"\"\"Parse a CIF-style numeric string into a `ufloat` with an optional\n    uncertainty.\n\n    Examples of supported input:\n    - \"3.566\"       \u2192 ufloat(3.566, nan)\n    - \"3.566(2)\"    \u2192 ufloat(3.566, 0.002)\n    - None          \u2192 ufloat(default, nan)\n\n    Behavior:\n    - If the input string contains a value with parentheses (e.g.\n      \"3.566(2)\"), the number in parentheses is interpreted as an\n      estimated standard deviation (esd) in the last digit(s).\n    - If the input string has no parentheses, an uncertainty of NaN is\n      assigned to indicate \"no esd provided\".\n    - If parsing fails, the function falls back to the given `default`\n      value with uncertainty NaN.\n\n    Parameters\n    ----------\n    s : str or None\n        Numeric string in CIF format (e.g. \"3.566\", \"3.566(2)\") or None.\n    default : float or None, optional\n        Default value to use if `s` is None or parsing fails.\n        Defaults to None.\n\n    Returns:\n    -------\n    UFloat\n        An `uncertainties.UFloat` object with the parsed value and\n        uncertainty. The uncertainty will be NaN if not specified or\n        parsing failed.\n    \"\"\"\n    if s is None:\n        return ufloat(default, np.nan)\n\n    if '(' not in s and ')' not in s:\n        s = f'{s}(nan)'\n    try:\n        return ufloat_fromstr(s)\n    except Exception:\n        return ufloat(default, np.nan)\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.stripped_package_version","title":"<code>stripped_package_version(package_name)</code>","text":"<p>Get the installed version of the specified package, stripped of any local version part.</p> <p>Returns only the public version segment (e.g., '1.2.3' or '1.2.3.post4'), omitting any local segment (e.g., '+d136').</p> <p>Parameters:</p> Name Type Description Default <code>package_name</code> <code>str</code> <p>The name of the package to query.</p> required <p>Returns:</p> Type Description <code>str | None</code> <p>str | None: The public version string, or None if the package</p> <code>str | None</code> <p>is not installed.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def stripped_package_version(package_name: str) -&gt; str | None:\n    \"\"\"Get the installed version of the specified package, stripped of\n    any local version part.\n\n    Returns only the public version segment (e.g., '1.2.3' or\n    '1.2.3.post4'), omitting any local segment (e.g., '+d136').\n\n    Args:\n        package_name (str): The name of the package to query.\n\n    Returns:\n        str | None: The public version string, or None if the package\n        is not installed.\n    \"\"\"\n    v_str = package_version(package_name)\n    if v_str is None:\n        return None\n    try:\n        v = Version(v_str)\n        return str(v.public)\n    except Exception:\n        return v_str\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.tof_to_d","title":"<code>tof_to_d(tof, offset, linear, quad, quad_eps=1e-20)</code>","text":"<p>Convert time-of-flight (TOF) to d-spacing using a quadratic calibration.</p> Model <p>TOF = offset + linear * d + quad * d\u00b2</p> The function <ul> <li>Uses a linear fallback when the quadratic term is effectively   zero.</li> <li>Solves the quadratic for d and selects the smallest positive,   finite root.</li> <li>Returns NaN where no valid solution exists.</li> <li>Expects <code>tof</code> as a NumPy array; output matches its shape.</li> </ul> <p>Parameters:</p> Name Type Description Default <code>tof</code> <code>ndarray</code> <p>Time-of-flight values (\u00b5s). Must be a NumPy array.</p> required <code>offset</code> <code>float</code> <p>Calibration offset (\u00b5s).</p> required <code>linear</code> <code>float</code> <p>Linear calibration coefficient (\u00b5s/\u00c5).</p> required <code>quad</code> <code>float</code> <p>Quadratic calibration coefficient (\u00b5s/\u00c5\u00b2).</p> required <code>quad_eps</code> <code>float</code> <p>Threshold to treat <code>quad</code> as zero. Defaults to 1e-20.</p> <code>1e-20</code> <p>Returns:</p> Type Description <code>ndarray</code> <p>np.ndarray: d-spacing values (\u00c5), NaN where invalid.</p> <p>Raises:</p> Type Description <code>TypeError</code> <p>If <code>tof</code> is not a NumPy array or coefficients are not real numbers.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def tof_to_d(\n    tof: np.ndarray,\n    offset: float,\n    linear: float,\n    quad: float,\n    quad_eps=1e-20,\n) -&gt; np.ndarray:\n    \"\"\"Convert time-of-flight (TOF) to d-spacing using a quadratic\n    calibration.\n\n    Model:\n        TOF = offset + linear * d + quad * d\u00b2\n\n    The function:\n      - Uses a linear fallback when the quadratic term is effectively\n        zero.\n      - Solves the quadratic for d and selects the smallest positive,\n        finite root.\n      - Returns NaN where no valid solution exists.\n      - Expects ``tof`` as a NumPy array; output matches its shape.\n\n    Args:\n        tof (np.ndarray): Time-of-flight values (\u00b5s). Must be a NumPy\n            array.\n        offset (float): Calibration offset (\u00b5s).\n        linear (float): Linear calibration coefficient (\u00b5s/\u00c5).\n        quad (float): Quadratic calibration coefficient (\u00b5s/\u00c5\u00b2).\n        quad_eps (float, optional): Threshold to treat ``quad`` as zero.\n            Defaults to 1e-20.\n\n    Returns:\n        np.ndarray: d-spacing values (\u00c5), NaN where invalid.\n\n    Raises:\n        TypeError: If ``tof`` is not a NumPy array or coefficients are\n            not real numbers.\n    \"\"\"\n    # Type checks\n    if not isinstance(tof, np.ndarray):\n        raise TypeError(f\"'tof' must be a NumPy array, got {type(tof).__name__}\")\n    for name, val in (\n        ('offset', offset),\n        ('linear', linear),\n        ('quad', quad),\n        ('quad_eps', quad_eps),\n    ):\n        if not isinstance(val, (int, float, np.integer, np.floating)):\n            raise TypeError(f\"'{name}' must be a real number, got {type(val).__name__}\")\n\n    # Output initialized to NaN\n    d_out = np.full_like(tof, np.nan, dtype=float)\n\n    # 1) If quadratic term is effectively zero, use linear formula:\n    #    TOF \u2248 offset + linear * d =&gt;\n    #    d \u2248 (tof - offset) / linear\n    if abs(quad) &lt; quad_eps:\n        if linear != 0.0:\n            d = (tof - offset) / linear\n            # Keep only positive, finite results\n            valid = np.isfinite(d) &amp; (d &gt; 0)\n            d_out[valid] = d[valid]\n        # If B == 0 too, there's no solution; leave NaN\n        return d_out\n\n    # 2) If quadratic term is significant, solve the quadratic equation:\n    #    TOF = offset + linear * d + quad * d\u00b2 =&gt;\n    #    quad * d\u00b2 + linear * d + (offset - tof) = 0\n    discr = linear**2 - 4 * quad * (offset - tof)\n    has_real_roots = discr &gt;= 0\n\n    if np.any(has_real_roots):\n        sqrt_discr = np.sqrt(discr[has_real_roots])\n\n        root_1 = (-linear + sqrt_discr) / (2 * quad)\n        root_2 = (-linear - sqrt_discr) / (2 * quad)\n\n        # Pick smallest positive, finite root per element\n        # Stack roots for comparison\n        roots = np.stack((root_1, root_2), axis=0)\n        # Replace non-finite or negative roots with NaN\n        roots = np.where(np.isfinite(roots) &amp; (roots &gt; 0), roots, np.nan)\n        # Choose the smallest positive root or NaN if none are valid\n        chosen = np.nanmin(roots, axis=0)\n\n        d_out[has_real_roots] = chosen\n\n    return d_out\n</code></pre>"},{"location":"api-reference/utils/#easydiffraction.utils.utils.twotheta_to_d","title":"<code>twotheta_to_d(twotheta, wavelength)</code>","text":"<p>Convert 2-theta to d-spacing using Bragg's law.</p> <p>Parameters:</p> Name Type Description Default <code>twotheta</code> <code>float or ndarray</code> <p>2-theta angle in degrees.</p> required <code>wavelength</code> <code>float</code> <p>Wavelength in \u00c5.</p> required <p>Returns:</p> Name Type Description <code>d</code> <code>float or ndarray</code> <p>d-spacing in \u00c5.</p> Source code in <code>src/easydiffraction/utils/utils.py</code> <pre><code>def twotheta_to_d(twotheta, wavelength):\n    \"\"\"Convert 2-theta to d-spacing using Bragg's law.\n\n    Parameters:\n        twotheta (float or np.ndarray): 2-theta angle in degrees.\n        wavelength (float): Wavelength in \u00c5.\n\n    Returns:\n        d (float or np.ndarray): d-spacing in \u00c5.\n    \"\"\"\n    # Convert twotheta from degrees to radians\n    theta_rad = np.radians(twotheta / 2)\n\n    # Calculate d-spacing using Bragg's law\n    d = wavelength / (2 * np.sin(theta_rad))\n\n    return d\n</code></pre>"},{"location":"architecture/package-structure-full/","title":"Package Structure (full)","text":"<pre><code>\ud83d\udce6 easydiffraction\n\u251c\u2500\u2500 \ud83d\udcc1 analysis\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 calculators\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CalculatorBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 crysfml.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CrysfmlCalculator\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cryspy.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CryspyCalculator\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CalculatorFactory\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 pdffit.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PdffitCalculator\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 aliases.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class Alias\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Aliases\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 constraints.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class Constraint\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Constraints\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 joint_fit_experiments.py\n\u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class JointFitExperiment\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class JointFitExperiments\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 fit_helpers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 metrics.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 reporting.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class FitResults\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 tracking.py\n\u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class _TerminalLiveHandle\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class FitProgressTracker\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 minimizers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class MinimizerBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 dfols.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class DfolsMinimizer\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class MinimizerFactory\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 lmfit.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class LmfitMinimizer\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 analysis.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Analysis\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 fitting.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Fitter\n\u251c\u2500\u2500 \ud83d\udcc1 core\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 category.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class CategoryItem\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CategoryCollection\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 collection.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CollectionBase\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 datablock.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class DatablockItem\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class DatablockCollection\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 diagnostic.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Diagnostics\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class FactoryBase\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 guard.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class GuardedBase\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 identity.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Identity\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 parameters.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class GenericDescriptorBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class GenericStringDescriptor\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class GenericNumericDescriptor\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class GenericParameter\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class StringDescriptor\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class NumericDescriptor\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Parameter\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 singletons.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class SingletonBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class UidMapHandler\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ConstraintsHandler\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 validation.py\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class DataTypes\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ValidationStage\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ValidatorBase\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TypeValidator\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class RangeValidator\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class MembershipValidator\n\u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class RegexValidator\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class AttributeSpec\n\u251c\u2500\u2500 \ud83d\udcc1 crystallography\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 crystallography.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 space_groups.py\n\u251c\u2500\u2500 \ud83d\udcc1 display\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 plotters\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 ascii.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class AsciiPlotter\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PlotterBase\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 plotly.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PlotlyPlotter\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 tablers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TableBackendBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 pandas.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PandasTableBackend\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 rich.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class RichTableBackend\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class RendererBase\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class RendererFactoryBase\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 plotting.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PlotterEngineEnum\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class Plotter\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PlotterFactory\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 tables.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TableEngineEnum\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TableRenderer\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TableRendererFactory\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 utils.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class JupyterScrollManager\n\u251c\u2500\u2500 \ud83d\udcc1 experiments\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 background\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class BackgroundBase\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 chebyshev.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PolynomialTerm\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ChebyshevPolynomialBackground\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 enums.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class BackgroundTypeEnum\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class BackgroundFactory\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 line_segment.py\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class LineSegment\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class LineSegmentBackground\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 data\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_pd.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdDataPointBaseMixin\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdCwlDataPointMixin\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdTofDataPointMixin\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdCwlDataPoint\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdTofDataPoint\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdDataBase\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class PdCwlData\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PdTofData\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_sc.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Refln\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class DataFactory\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total.py\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TotalDataPoint\n\u2502   \u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TotalDataBase\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TotalData\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 instrument\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class InstrumentBase\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CwlInstrument\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class InstrumentFactory\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 tof.py\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TofInstrument\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 peak\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PeakBase\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class CwlPseudoVoigt\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class CwlSplitPseudoVoigt\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CwlThompsonCoxHastings\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl_mixins.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class CwlBroadeningMixin\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class EmpiricalAsymmetryMixin\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class FcjAsymmetryMixin\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PeakFactory\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 tof.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TofPseudoVoigt\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TofPseudoVoigtIkedaCarpenter\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TofPseudoVoigtBackToBack\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 tof_mixins.py\n\u2502   \u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class TofBroadeningMixin\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class IkedaCarpenterAsymmetryMixin\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 total.py\n\u2502   \u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TotalGaussianDampedSinc\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total_mixins.py\n\u2502   \u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TotalBroadeningMixin\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 excluded_regions.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ExcludedRegion\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ExcludedRegions\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 experiment_type.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ExperimentType\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 linked_phases.py\n\u2502   \u2502       \u251c\u2500\u2500 \ud83c\udff7\ufe0f class LinkedPhase\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class LinkedPhases\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 experiment\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ExperimentBase\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PdExperimentBase\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_pd.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class BraggPdExperiment\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_sc.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class BraggScExperiment\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 enums.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class SampleFormEnum\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ScatteringTypeEnum\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class RadiationProbeEnum\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class BeamModeEnum\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class PeakProfileTypeEnum\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ExperimentFactory\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 instrument_mixin.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class InstrumentMixin\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total_pd.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class TotalPdExperiment\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 experiments.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Experiments\n\u251c\u2500\u2500 \ud83d\udcc1 io\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 cif\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 handler.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class CifHandler\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 parse.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 serialize.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 __init__.py\n\u251c\u2500\u2500 \ud83d\udcc1 project\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 project.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Project\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 project_info.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ProjectInfo\n\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 atom_sites.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class AtomSite\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class AtomSites\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cell.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Cell\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 space_group.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class SpaceGroup\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 sample_model\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class SampleModelBase\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class SampleModelFactory\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 sample_models.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class SampleModels\n\u251c\u2500\u2500 \ud83d\udcc1 summary\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 summary.py\n\u2502       \u2514\u2500\u2500 \ud83c\udff7\ufe0f class Summary\n\u251c\u2500\u2500 \ud83d\udcc1 utils\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 environment.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 logging.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class IconifiedRichHandler\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ConsoleManager\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class LoggerConfig\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class ExceptionHookManager\n\u2502   \u2502   \u251c\u2500\u2500 \ud83c\udff7\ufe0f class Logger\n\u2502   \u2502   \u2514\u2500\u2500 \ud83c\udff7\ufe0f class ConsolePrinter\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 utils.py\n\u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2514\u2500\u2500 \ud83d\udcc4 __main__.py\n</code></pre>"},{"location":"architecture/package-structure-short/","title":"Package Structure (short)","text":"<pre><code>\ud83d\udce6 easydiffraction\n\u251c\u2500\u2500 \ud83d\udcc1 analysis\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 calculators\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 crysfml.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cryspy.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 pdffit.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 aliases.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 constraints.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 joint_fit_experiments.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 fit_helpers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 metrics.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 reporting.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 tracking.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 minimizers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 dfols.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 lmfit.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 analysis.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 fitting.py\n\u251c\u2500\u2500 \ud83d\udcc1 core\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 category.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 collection.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 datablock.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 diagnostic.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 guard.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 identity.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 parameters.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 singletons.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 validation.py\n\u251c\u2500\u2500 \ud83d\udcc1 crystallography\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 crystallography.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 space_groups.py\n\u251c\u2500\u2500 \ud83d\udcc1 display\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 plotters\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 ascii.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 plotly.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 tablers\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 pandas.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 rich.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 plotting.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 tables.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 utils.py\n\u251c\u2500\u2500 \ud83d\udcc1 experiments\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 background\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 chebyshev.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 enums.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 line_segment.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 data\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_pd.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_sc.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 instrument\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 tof.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc1 peak\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cwl_mixins.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 tof.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 tof_mixins.py\n\u2502   \u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 total.py\n\u2502   \u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total_mixins.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 excluded_regions.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 experiment_type.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 linked_phases.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 experiment\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_pd.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 bragg_sc.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 enums.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 instrument_mixin.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 total_pd.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 experiments.py\n\u251c\u2500\u2500 \ud83d\udcc1 io\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 cif\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 handler.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 parse.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 serialize.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 __init__.py\n\u251c\u2500\u2500 \ud83d\udcc1 project\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 project.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 project_info.py\n\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 categories\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 atom_sites.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 cell.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 space_group.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc1 sample_model\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2502   \u251c\u2500\u2500 \ud83d\udcc4 base.py\n\u2502   \u2502   \u2514\u2500\u2500 \ud83d\udcc4 factory.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 sample_models.py\n\u251c\u2500\u2500 \ud83d\udcc1 summary\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 summary.py\n\u251c\u2500\u2500 \ud83d\udcc1 utils\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 environment.py\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 logging.py\n\u2502   \u2514\u2500\u2500 \ud83d\udcc4 utils.py\n\u251c\u2500\u2500 \ud83d\udcc4 __init__.py\n\u2514\u2500\u2500 \ud83d\udcc4 __main__.py\n</code></pre>"},{"location":"installation-and-setup/","title":"Installation &amp; Setup","text":""},{"location":"installation-and-setup/#requirements","title":"Requirements","text":"<p>EasyDiffraction is a cross-platform Python library compatible with Python 3.11 through 3.13. Make sure Python is installed on your system before proceeding with the installation.</p>"},{"location":"installation-and-setup/#environment-setup","title":"Environment Setup optional","text":"<p>We recommend using a virtual environment to isolate dependencies and avoid conflicts with system-wide packages. If any issues arise, you can simply delete and recreate the environment.</p>"},{"location":"installation-and-setup/#creating-and-activating-a-virtual-environment","title":"Creating and Activating a Virtual Environment:","text":"<ul> <li>Create a new virtual environment:   <pre><code>python3 -m venv venv\n</code></pre></li> <li> <p>Activate the environment:</p>  macOS Linux Windows <pre><code>. venv/bin/activate\n</code></pre> <pre><code>. venv/bin/activate\n</code></pre> <pre><code>. venv/Scripts/activate      # Windows with Unix-like shells\n.\\venv\\Scripts\\activate.bat  # Windows with CMD\n.\\venv\\Scripts\\activate.ps1  # Windows with PowerShell\n</code></pre> </li> <li> <p>The terminal should now show <code>(venv)</code>, indicating that the virtual environment   is active.</p> </li> </ul>"},{"location":"installation-and-setup/#deactivating-and-removing-the-virtual-environment","title":"Deactivating and Removing the Virtual Environment:","text":"<ul> <li>Exit the environment:   <pre><code>deactivate\n</code></pre></li> <li> <p>If this environment is no longer needed, delete it:</p>  macOS Linux Windows <pre><code>rm -rf venv\n</code></pre> <pre><code>rm -rf venv\n</code></pre> <pre><code>rmdir /s /q venv\n</code></pre> </li> </ul>"},{"location":"installation-and-setup/#installation-guide","title":"Installation Guide","text":""},{"location":"installation-and-setup/#from-pypi","title":"Installing from PyPI recommended","text":"<p>EasyDiffraction is available on PyPI (Python Package Index) and can be installed using <code>pip</code>. We strongly recommend installing it within a virtual environment, as described in the Environment Setup section.</p> <p>We recommend installing the latest release of EasyDiffraction with the <code>visualization</code> extras, which include optional dependencies used for simplified visualization of charts and tables. This can be especially useful for running the Jupyter Notebook examples. To do so, use the following command:</p> <pre><code>pip install 'easydiffraction[visualization]'\n</code></pre> <p>If only the core functionality is needed, the library can be installed simply with:</p> <pre><code>pip install easydiffraction\n</code></pre> <p>To install a specific version of EasyDiffraction, e.g., 1.0.3:</p> <pre><code>pip install 'easydiffraction==1.0.3'\n</code></pre> <p>To upgrade to the latest version:</p> <pre><code>pip install --upgrade --force-reinstall easydiffraction\n</code></pre> <p>To check the installed version:</p> <pre><code>pip show easydiffraction\n</code></pre>"},{"location":"installation-and-setup/#installing-from-github","title":"Installing from GitHub","text":"<p>Installing unreleased versions is generally not recommended but may be useful for testing.</p> <p>To install EasyDiffraction from, e.g., the <code>develop</code> branch of GitHub:</p> <pre><code>pip install git+https://github.com/easyscience/diffraction-lib@develop\n</code></pre> <p>To include extra dependencies (e.g., visualization):</p> <pre><code>pip install 'easydiffraction[visualization] @ git+https://github.com/easyscience/diffraction-lib@develop'\n</code></pre>"},{"location":"installation-and-setup/#how-to-run-tutorials","title":"How to Run Tutorials","text":"<p>EasyDiffraction includes a collection of Jupyter Notebook examples that demonstrate key functionality. These tutorials serve as step-by-step guides to help users understand the diffraction data analysis workflow.</p> <p>They are available as static HTML pages in the  Tutorials section. You can also run them interactively in two ways:</p> <ul> <li>Run Locally \u2013 Download the notebook via the  Download button and run it on your computer.</li> <li>Run Online \u2013 Use the  Open in Google Colab button to run   the tutorial directly in your browser (no setup required).</li> </ul> <p>Note</p> <p>You can also download all Jupyter notebooks at once as a zip archive from the EasyDiffraction Releases.</p>"},{"location":"installation-and-setup/#run-tutorials-locally","title":"Run Tutorials Locally","text":"<p>To run tutorials locally, install Jupyter Notebook or JupyterLab. Here are the steps to follow in the case of Jupyter Notebook:</p> <ul> <li>Install Jupyter Notebook and IPython kernel:   <pre><code>pip install notebook ipykernel\n</code></pre></li> <li>Add the virtual environment as a Jupyter kernel   <pre><code>python -m ipykernel install --user --name=venv --display-name \"EasyDiffraction Python kernel\"\n</code></pre></li> <li>Download the EasyDiffraction tutorials from GitHub Releases:   <pre><code>python -m easydiffraction fetch-tutorials\n</code></pre></li> <li>Launch the Jupyter Notebook server in the <code>examples/</code> directory:   <pre><code>jupyter notebook tutorials/\n</code></pre></li> <li>In your web browser, go to:   <pre><code>http://localhost:8888/\n</code></pre></li> <li>Open one of the <code>*.ipynb</code> files and select the <code>EasyDiffraction Python kernel</code>   to get started.</li> </ul>"},{"location":"installation-and-setup/#run-tutorials-via-google-colab","title":"Run Tutorials via Google Colab","text":"<p>Google Colab lets you run Jupyter Notebooks in the cloud without any local installation.</p> <p>To use Google Colab:</p> <ul> <li>Ensure you have a Google account.</li> <li>Go to the  Tutorials section.</li> <li>Click the  Open in Google Colab button on any tutorial.</li> </ul> <p>This is the fastest way to start experimenting with EasyDiffraction, without setting up Python on your system.</p>"},{"location":"installation-and-setup/#installing-with-pixi","title":"Installing with Pixi alternative","text":"<p>Pixi is a modern package and environment manager for Python and Conda-compatible packages. It simplifies dependency management, environment isolation, and reproducibility.</p> <p>The following simple steps provide an alternative setup method for EasyDiffraction using Pixi, replacing the traditional virtual environment approach.</p> <ul> <li>Install Pixi by following the instructions on the   official Pixi Installation Guide.</li> <li>Create a dedicated directory for the EasyDiffraction and navigate into it:   <pre><code>mkdir easydiffraction\ncd easydiffraction\n</code></pre></li> <li> <p>Download the pixi configuration file for EasyDiffraction:</p> curlwget <pre><code>curl -LO https://raw.githubusercontent.com/easyscience/diffraction-lib/master/pixi.toml\n</code></pre> <pre><code>wget https://raw.githubusercontent.com/easyscience/diffraction-lib/master/pixi.toml\n</code></pre> </li> <li> <p>Create the environment defined in <code>pixi.toml</code> and install all necessary   dependencies:   <pre><code>pixi install\n</code></pre></p> </li> <li>Fetch the EasyDiffraction tutorials to the <code>tutorials/</code> directory:   <pre><code>pixi run easydiffraction fetch-tutorials\n</code></pre></li> <li>Start JupyterLab in the <code>tutorials/</code> directory to access the notebooks:   <pre><code>pixi run jupyter lab tutorials/\n</code></pre></li> <li>Your web browser should open automatically. Click on one of the <code>*.ipynb</code>   files and select the <code>Python (Pixi)</code> kernel to get started.</li> </ul>"},{"location":"introduction/","title":"Introduction","text":""},{"location":"introduction/#description","title":"Description","text":"<p>EasyDiffraction is scientific software for calculating diffraction patterns based on structural models and refining model parameters against experimental data.</p> <p>It is available as both a cross-platform desktop application and a Python library.</p> <p>This documentation covers the usage of the EasyDiffraction Python library. For the graphical user interface (GUI) version, refer to the GUI documentation.</p>"},{"location":"introduction/#easyscience","title":"EasyScience","text":"<p>EasyDiffraction is developed using the EasyScience framework, which provides tools for building modular and flexible scientific libraries and applications.</p>"},{"location":"introduction/#license","title":"License","text":"<p>EasyDiffraction is released under the BSD 3-Clause License.</p>"},{"location":"introduction/#releases","title":"Releases","text":"<p>The latest version of the EasyDiffraction Python library is develop.</p> <p>For a complete list of new features, bug fixes, and improvements, see the GitHub Releases page.</p>"},{"location":"introduction/#citation","title":"Citation","text":"<p>If you use EasyDiffraction in your work, please cite the specific version you used.</p> <p>All official releases of the EasyDiffraction library are archived on Zenodo, each with a version-specific Digital Object Identifier (DOI).</p> <p>Citation details in various styles (e.g., APA, MLA) and formats (e.g., BibTeX, JSON) are available on the Zenodo archive page.</p>"},{"location":"introduction/#contributing","title":"Contributing","text":"<p>We welcome contributions from the community! EasyDiffraction is intended to be a community-driven, open-source project supported by a diverse group of contributors.</p> <p>The project is maintained by the European Spallation Source (ESS).</p> <p>To contribute, see our  Contributing Guidelines on GitHub.</p>"},{"location":"introduction/#get-in-touch","title":"Get in Touch","text":"<p>For general questions or feedback, contact us at support@easydiffraction.org.</p> <p>To report bugs or request features, please use the GitHub Issue Tracker (free registration required).</p>"},{"location":"tutorials/","title":"Tutorials","text":"<p>This section presents a collection of Jupyter Notebook tutorials that demonstrate how to use EasyDiffraction for various tasks. These tutorials serve as self-contained, step-by-step guides to help users grasp the workflow of diffraction data analysis using EasyDiffraction.</p> <p>Instructions on how to run the tutorials are provided in the  Installation &amp; Setup section of the documentation.</p> <p>The tutorials are organized into the following categories.</p>"},{"location":"tutorials/#getting-started","title":"Getting Started","text":"<ul> <li>LBCO <code>quick</code> CIF \u2013 A minimal example intended as a quick   reference for users already familiar with the EasyDiffraction API or who want   to see how Rietveld refinement of the La0.5Ba0.5CoO3 crystal structure can be   performed when both the sample model and experiment are loaded from CIF files.   Data collected from constant wavelength neutron powder diffraction at HRPT at   PSI.</li> <li>LBCO <code>quick</code> <code>code</code> \u2013 A minimal example intended as a quick   reference for users already familiar with the EasyDiffraction API or who want   to see an example refinement when both the sample model and experiment are   defined directly in code. This tutorial covers a Rietveld refinement of the   La0.5Ba0.5CoO3 crystal structure using constant wavelength neutron powder   diffraction data from HRPT at PSI.</li> <li>LBCO <code>basic</code> \u2013 Demonstrates the use of the EasyDiffraction API   in a simplified, user-friendly manner that closely follows the GUI workflow   for a Rietveld refinement of the La0.5Ba0.5CoO3 crystal structure using   constant wavelength neutron powder diffraction data from HRPT at PSI. This   tutorial provides a full explanation of the workflow with detailed comments   and descriptions of every step, making it suitable for users who are new to   EasyDiffraction or those who prefer a more guided approach.</li> <li>PbSO4 <code>advanced</code> \u2013 Demonstrates a more flexible and advanced   approach to using the EasyDiffraction library, intended for users who are more   comfortable with Python programming. This tutorial covers a Rietveld   refinement of the PbSO4 crystal structure based on the joint fit of both X-ray   and neutron diffraction data.</li> </ul>"},{"location":"tutorials/#standard-diffraction","title":"Standard Diffraction","text":"<ul> <li>Co2SiO4 <code>pd-neut-cwl</code> \u2013 Demonstrates a Rietveld refinement of   the Co2SiO4 crystal structure using constant wavelength neutron powder   diffraction data from D20 at ILL.</li> <li>HS <code>pd-neut-cwl</code> \u2013 Demonstrates a Rietveld refinement of the HS   crystal structure using constant wavelength neutron powder diffraction data   from HRPT at PSI.</li> <li>Si <code>pd-neut-tof</code> \u2013 Demonstrates a Rietveld refinement of the Si   crystal structure using time-of-flight neutron powder diffraction data from   SEPD at Argonne.</li> <li>NCAF <code>pd-neut-tof</code> \u2013 Demonstrates a Rietveld refinement of the   Na2Ca3Al2F14 crystal structure using two time-of-flight neutron powder   diffraction datasets (from two detector banks) of the WISH instrument at ISIS.</li> <li>LBCO+Si McStas \u2013 Demonstrates a Rietveld refinement of the   La0.5Ba0.5CoO3 crystal structure with a small amount of Si impurity as a   secondary phase using time-of-flight neutron powder diffraction data simulated   with McStas.</li> </ul>"},{"location":"tutorials/#pair-distribution-function-pdf","title":"Pair Distribution Function (PDF)","text":"<ul> <li>Ni <code>pd-neut-cwl</code> \u2013 Demonstrates a PDF analysis of Ni using data   collected from a constant wavelength neutron powder diffraction experiment.</li> <li>Si <code>pd-neut-tof</code> \u2013 Demonstrates a PDF analysis of Si using data   collected from a time-of-flight neutron powder diffraction experiment at NOMAD   at SNS.</li> <li>NaCl <code>pd-xray</code> \u2013 Demonstrates a PDF analysis of NaCl using data   collected from an X-ray powder diffraction experiment.</li> </ul>"},{"location":"tutorials/#workshops-schools","title":"Workshops &amp; Schools","text":"<ul> <li>2025 DMSC \u2013 A workshop tutorial that demonstrates a Rietveld   refinement of the La0.5Ba0.5CoO3 crystal structure using time-of-flight   neutron powder diffraction data simulated with McStas. This tutorial is   designed for the ESS DMSC Summer School 2025.</li> </ul>"},{"location":"tutorials/ed-1/","title":"LBCO quick CIF","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre># Create minimal project without name and description\nproject = ed.Project()\n</pre> # Create minimal project without name and description project = ed.Project() In\u00a0[4]: Copied! <pre># Download CIF file from repository\nmodel_path = ed.download_data(id=1, destination='data')\n</pre> # Download CIF file from repository model_path = ed.download_data(id=1, destination='data') <pre>Getting data...\n</pre> <pre>Data #1: La0.5Ba0.5CoO3 (crystal structure)\n</pre> <pre>\u2705 Data #1 downloaded to 'data/ed-1.cif'\n</pre> In\u00a0[5]: Copied! <pre>project.sample_models.add(cif_path=model_path)\n</pre> project.sample_models.add(cif_path=model_path) In\u00a0[6]: Copied! <pre># Download CIF file from repository\nexpt_path = ed.download_data(id=2, destination='data')\n</pre> # Download CIF file from repository expt_path = ed.download_data(id=2, destination='data') <pre>Getting data...\n</pre> <pre>Data #2: La0.5Ba0.5CoO3, HRPT (PSI), 300 K\n</pre> <pre>\u2705 Data #2 downloaded to 'data/ed-2.cif'\n</pre> In\u00a0[7]: Copied! <pre>project.experiments.add(cif_path=expt_path)\n</pre> project.experiments.add(cif_path=expt_path) In\u00a0[8]: Copied! <pre># Start refinement. All parameters, which have standard uncertainties\n# in the input CIF files, are refined by default.\nproject.analysis.fit()\n</pre> # Start refinement. All parameters, which have standard uncertainties # in the input CIF files, are refined by default. project.analysis.fit() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 165.50 2 28 33.67 79.7% \u2193 3 45 10.85 67.8% \u2193 4 63 6.43 40.7% \u2193 5 81 3.33 48.2% \u2193 6 98 2.23 33.2% \u2193 7 116 1.91 14.5% \u2193 8 133 1.50 21.1% \u2193 9 150 1.45 3.6% \u2193 10 167 1.34 7.7% \u2193 11 185 1.29 3.4% \u2193 12 276 1.29 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.29 at iteration 261\n</pre> <pre>\u2705 Fitting complete.\n</pre> In\u00a0[9]: Copied! <pre># Show fit results summary\nproject.analysis.show_fit_results()\n</pre> # Show fit results summary project.analysis.show_fit_results() <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 14.11 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.29\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.64%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.29%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.45%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8800 3.8909 0.0000 \u00c5 0.28 % \u2191 2 lbco atom_site La b_iso 0.5000 0.5051 6011.6004 \u00c5\u00b2 1.02 % \u2191 3 lbco atom_site Ba b_iso 0.5000 0.5052 9770.5350 \u00c5\u00b2 1.04 % \u2191 4 lbco atom_site Co b_iso 0.5000 0.2371 0.0611 \u00c5\u00b2 52.59 % \u2193 5 lbco atom_site O b_iso 0.5000 1.3935 0.0168 \u00c5\u00b2 178.70 % \u2191 6 hrpt linked_phases lbco scale 10.0000 9.1349 0.0643 8.65 % \u2193 7 hrpt peak broad_gauss_u 0.1000 0.0816 0.0031 deg\u00b2 18.44 % \u2193 8 hrpt peak broad_gauss_v -0.1000 -0.1159 0.0067 deg\u00b2 15.90 % \u2191 9 hrpt peak broad_gauss_w 0.1000 0.1204 0.0033 deg\u00b2 20.45 % \u2191 10 hrpt peak broad_lorentz_y 0.1000 0.0844 0.0021 deg 15.57 % \u2193 11 hrpt instrument twotheta_offset 0.6000 0.6226 0.0010 deg 3.76 % \u2191 12 hrpt background 1 y 170.0000 168.4242 1.3977 0.93 % \u2193 13 hrpt background 2 y 170.0000 164.3715 1.0025 3.31 % \u2193 14 hrpt background 3 y 170.0000 166.8870 0.7391 1.83 % \u2193 15 hrpt background 4 y 170.0000 175.3977 0.6586 3.18 % \u2191 16 hrpt background 5 y 170.0000 174.3027 0.9113 2.53 % \u2191 In\u00a0[10]: Copied! <pre>project.experiments.show_names()\n</pre> project.experiments.show_names() <pre>Defined experiments \ud83d\udd2c\n</pre> <pre>['hrpt']\n</pre> In\u00a0[11]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[12]: Copied! <pre>project.summary.show_report()\n</pre> project.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>Untitled Project\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 lbco\n</pre> <pre>Space group\n</pre> <pre>P m -3 m\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 3.89087 2 b 3.89087 3 c 3.89087 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 La La 0.00000 0.00000 0.00000 0.50000 0.50512 2 Ba Ba 0.00000 0.00000 0.00000 0.50000 0.50518 3 Co Co 0.50000 0.50000 0.50000 1.00000 0.23706 4 O O 0.00000 0.50000 0.50000 1.00000 1.39351 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c hrpt\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, constant wavelength\n</pre> <pre>Wavelength\n</pre> <pre>1.49400\n</pre> <pre>2\u03b8 offset\n</pre> <pre>0.62258\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT\n</pre> <pre>Peak broadening (Gaussian)\n</pre> Parameter Value 1 U 0.08156 2 V -0.11590 3 W 0.12045 <pre>Peak broadening (Lorentzian)\n</pre> Parameter Value 1 X 0.00000 2 Y 0.08443 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 1.29"},{"location":"tutorials/ed-1/#structure-refinement-lbco-hrpt","title":"Structure Refinement: LBCO, HRPT\u00b6","text":"<p>This minimalistic example is designed to show how Rietveld refinement of a crystal structure can be performed when both the sample model and experiment are defined using CIF files.</p> <p>For this example, constant-wavelength neutron powder diffraction data for La0.5Ba0.5CoO3 from HRPT at PSI is used.</p> <p>It does not contain any advanced features or options, and includes no comments or explanations\u2014these can be found in the other tutorials. Default values are used for all parameters if not specified. Only essential and self-explanatory code is provided.</p> <p>The example is intended for users who are already familiar with the EasyDiffraction library and want to quickly get started with a simple refinement. It is also useful for those who want to see what a refinement might look like in code. For a more detailed explanation of the code, please refer to the other tutorials.</p>"},{"location":"tutorials/ed-1/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-1/#step-1-define-project","title":"Step 1: Define Project\u00b6","text":""},{"location":"tutorials/ed-1/#step-2-define-sample-model","title":"Step 2: Define Sample Model\u00b6","text":""},{"location":"tutorials/ed-1/#step-3-define-experiment","title":"Step 3: Define Experiment\u00b6","text":""},{"location":"tutorials/ed-1/#step-4-perform-analysis","title":"Step 4: Perform Analysis\u00b6","text":""},{"location":"tutorials/ed-1/#step-5-show-project-summary","title":"Step 5: Show Project Summary\u00b6","text":""},{"location":"tutorials/ed-10/","title":"Ni pd-neut-cwl","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre>project = ed.Project()\n</pre> project = ed.Project() In\u00a0[4]: Copied! <pre>project.sample_models.add(name='ni')\n</pre> project.sample_models.add(name='ni') In\u00a0[5]: Copied! <pre>project.sample_models['ni'].space_group.name_h_m = 'F m -3 m'\nproject.sample_models['ni'].space_group.it_coordinate_system_code = '1'\nproject.sample_models['ni'].cell.length_a = 3.52387\nproject.sample_models['ni'].atom_sites.add(\n    label='Ni',\n    type_symbol='Ni',\n    fract_x=0.0,\n    fract_y=0.0,\n    fract_z=0.0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n)\n</pre> project.sample_models['ni'].space_group.name_h_m = 'F m -3 m' project.sample_models['ni'].space_group.it_coordinate_system_code = '1' project.sample_models['ni'].cell.length_a = 3.52387 project.sample_models['ni'].atom_sites.add(     label='Ni',     type_symbol='Ni',     fract_x=0.0,     fract_y=0.0,     fract_z=0.0,     wyckoff_letter='a',     b_iso=0.5, ) In\u00a0[6]: Copied! <pre>data_path = ed.download_data(id=6, destination='data')\n</pre> data_path = ed.download_data(id=6, destination='data') <pre>Getting data...\n</pre> <pre>Data #6: ni-q27r100-neutron_from-2.gr\n</pre> <pre>\u2705 Data #6 downloaded to 'data/ed-6.gr'\n</pre> In\u00a0[7]: Copied! <pre>project.experiments.add(\n    name='pdf',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='constant wavelength',\n    radiation_probe='neutron',\n    scattering_type='total',\n)\n</pre> project.experiments.add(     name='pdf',     data_path=data_path,     sample_form='powder',     beam_mode='constant wavelength',     radiation_probe='neutron',     scattering_type='total', ) <pre>Warning: No uncertainty (sy) column provided. Defaulting to 0.03.\n</pre> <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'pdf'. Number of data points: 9801\n</pre> In\u00a0[8]: Copied! <pre>project.experiments['pdf'].linked_phases.add(id='ni', scale=1.0)\nproject.experiments['pdf'].peak.damp_q = 0\nproject.experiments['pdf'].peak.broad_q = 0.03\nproject.experiments['pdf'].peak.cutoff_q = 27.0\nproject.experiments['pdf'].peak.sharp_delta_1 = 0.0\nproject.experiments['pdf'].peak.sharp_delta_2 = 2.0\nproject.experiments['pdf'].peak.damp_particle_diameter = 0\n</pre> project.experiments['pdf'].linked_phases.add(id='ni', scale=1.0) project.experiments['pdf'].peak.damp_q = 0 project.experiments['pdf'].peak.broad_q = 0.03 project.experiments['pdf'].peak.cutoff_q = 27.0 project.experiments['pdf'].peak.sharp_delta_1 = 0.0 project.experiments['pdf'].peak.sharp_delta_2 = 2.0 project.experiments['pdf'].peak.damp_particle_diameter = 0 In\u00a0[9]: Copied! <pre>project.sample_models['ni'].cell.length_a.free = True\nproject.sample_models['ni'].atom_sites['Ni'].b_iso.free = True\n</pre> project.sample_models['ni'].cell.length_a.free = True project.sample_models['ni'].atom_sites['Ni'].b_iso.free = True In\u00a0[10]: Copied! <pre>project.experiments['pdf'].linked_phases['ni'].scale.free = True\nproject.experiments['pdf'].peak.broad_q.free = True\nproject.experiments['pdf'].peak.sharp_delta_2.free = True\n</pre> project.experiments['pdf'].linked_phases['ni'].scale.free = True project.experiments['pdf'].peak.broad_q.free = True project.experiments['pdf'].peak.sharp_delta_2.free = True In\u00a0[11]: Copied! <pre>project.analysis.current_calculator = 'pdffit'\nproject.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.current_calculator = 'pdffit' project.analysis.fit() project.analysis.show_fit_results() <pre>Current calculator changed to\n</pre> <pre>pdffit\n</pre> <pre>Using experiment \ud83d\udd2c 'pdf' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 2324.45 2 9 921.68 60.3% \u2193 3 15 887.03 3.8% \u2193 4 56 886.39 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 886.39 at iteration 55\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 54.78 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 886.39\n</pre> <pre>\ud83d\udccf R-factor (Rf): 20.00%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 19.61%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 19.61%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 ni cell length_a 3.5239 3.5239 N/A \u00c5 0.00 % \u2193 2 ni atom_site Ni b_iso 0.5000 0.5000 N/A \u00c5\u00b2 0.00 % \u2193 3 pdf linked_phases ni scale 1.0000 1.0088 N/A 0.88 % \u2191 4 pdf peak broad_q 0.0300 0.0204 N/A \u00c5\u207b\u00b2 31.99 % \u2193 5 pdf peak sharp_delta_2 2.0000 3.1153 N/A \u00c5\u00b2 55.76 % \u2191 In\u00a0[12]: Copied! <pre>project.plot_meas_vs_calc(expt_name='pdf', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='pdf', show_residual=True)"},{"location":"tutorials/ed-10/#pair-distribution-function-ni-npd","title":"Pair Distribution Function: Ni, NPD\u00b6","text":"<p>This example demonstrates a pair distribution function (PDF) analysis of Ni, based on data collected from a constant wavelength neutron powder diffraction experiment.</p> <p>The dataset is taken from: https://github.com/diffpy/cmi_exchange/tree/main/cmi_scripts/fitNiPDF</p>"},{"location":"tutorials/ed-10/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-10/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-10/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-10/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-10/#select-fitting-parameters","title":"Select Fitting Parameters\u00b6","text":""},{"location":"tutorials/ed-10/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-10/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-11/","title":"Si pd-neut-tof","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre>project = ed.Project()\n</pre> project = ed.Project() In\u00a0[4]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[5]: Copied! <pre># Set global plot range for plots\nproject.plotter.x_max = 40\n</pre> # Set global plot range for plots project.plotter.x_max = 40 In\u00a0[6]: Copied! <pre>project.sample_models.add(name='si')\n</pre> project.sample_models.add(name='si') In\u00a0[7]: Copied! <pre>sample_model = project.sample_models['si']\nsample_model.space_group.name_h_m.value = 'F d -3 m'\nsample_model.space_group.it_coordinate_system_code = '1'\nsample_model.cell.length_a = 5.43146\nsample_model.atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n)\n</pre> sample_model = project.sample_models['si'] sample_model.space_group.name_h_m.value = 'F d -3 m' sample_model.space_group.it_coordinate_system_code = '1' sample_model.cell.length_a = 5.43146 sample_model.atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5, ) In\u00a0[8]: Copied! <pre>data_path = ed.download_data(id=5, destination='data')\n</pre> data_path = ed.download_data(id=5, destination='data') <pre>Getting data...\n</pre> <pre>Data #5: NOM_9999_Si_640g_PAC_50_ff_ftfrgr_up-to-50.gr\n</pre> <pre>\u2705 Data #5 downloaded to 'data/ed-5.gr'\n</pre> In\u00a0[9]: Copied! <pre>project.experiments.add(\n    name='nomad',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='time-of-flight',\n    radiation_probe='neutron',\n    scattering_type='total',\n)\n</pre> project.experiments.add(     name='nomad',     data_path=data_path,     sample_form='powder',     beam_mode='time-of-flight',     radiation_probe='neutron',     scattering_type='total', ) <pre>Warning: No uncertainty (sy) column provided. Defaulting to 0.03.\n</pre> <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'nomad'. Number of data points: 5033\n</pre> In\u00a0[10]: Copied! <pre>experiment = project.experiments['nomad']\nexperiment.linked_phases.add(id='si', scale=1.0)\nexperiment.peak.damp_q = 0.02\nexperiment.peak.broad_q = 0.03\nexperiment.peak.cutoff_q = 35.0\nexperiment.peak.sharp_delta_1 = 0.0\nexperiment.peak.sharp_delta_2 = 4.0\nexperiment.peak.damp_particle_diameter = 0\n</pre> experiment = project.experiments['nomad'] experiment.linked_phases.add(id='si', scale=1.0) experiment.peak.damp_q = 0.02 experiment.peak.broad_q = 0.03 experiment.peak.cutoff_q = 35.0 experiment.peak.sharp_delta_1 = 0.0 experiment.peak.sharp_delta_2 = 4.0 experiment.peak.damp_particle_diameter = 0 In\u00a0[11]: Copied! <pre>project.sample_models['si'].cell.length_a.free = True\nproject.sample_models['si'].atom_sites['Si'].b_iso.free = True\nexperiment.linked_phases['si'].scale.free = True\n</pre> project.sample_models['si'].cell.length_a.free = True project.sample_models['si'].atom_sites['Si'].b_iso.free = True experiment.linked_phases['si'].scale.free = True In\u00a0[12]: Copied! <pre>experiment.peak.damp_q.free = True\nexperiment.peak.broad_q.free = True\nexperiment.peak.sharp_delta_1.free = True\nexperiment.peak.sharp_delta_2.free = True\n</pre> experiment.peak.damp_q.free = True experiment.peak.broad_q.free = True experiment.peak.sharp_delta_1.free = True experiment.peak.sharp_delta_2.free = True In\u00a0[13]: Copied! <pre>project.analysis.current_calculator = 'pdffit'\nproject.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.current_calculator = 'pdffit' project.analysis.fit() project.analysis.show_fit_results() <pre>Current calculator changed to\n</pre> <pre>pdffit\n</pre> <pre>Using experiment \ud83d\udd2c 'nomad' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 3103.72 2 11 270.15 91.3% \u2193 3 19 239.11 11.5% \u2193 4 52 239.01 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 239.01 at iteration 51\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 8.03 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 239.01\n</pre> <pre>\ud83d\udccf R-factor (Rf): 9.88%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 9.82%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 9.82%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 si cell length_a 5.4315 5.4315 N/A \u00c5 0.00 % \u2193 2 si atom_site Si b_iso 0.5000 0.5000 N/A \u00c5\u00b2 0.00 % \u2193 3 nomad linked_phases si scale 1.0000 1.2501 N/A 25.01 % \u2191 4 nomad peak damp_q 0.0200 0.0233 N/A \u00c5\u207b\u00b9 16.62 % \u2191 5 nomad peak broad_q 0.0300 0.0290 N/A \u00c5\u207b\u00b2 3.46 % \u2193 6 nomad peak sharp_delta_1 0.0000 0.0078 N/A \u00c5 N/A 7 nomad peak sharp_delta_2 4.0000 3.8877 N/A \u00c5\u00b2 2.81 % \u2193 In\u00a0[14]: Copied! <pre>project.plot_meas_vs_calc(expt_name='nomad', show_residual=False)\n</pre> project.plot_meas_vs_calc(expt_name='nomad', show_residual=False)"},{"location":"tutorials/ed-11/#pair-distribution-function-si-npd","title":"Pair Distribution Function: Si, NPD\u00b6","text":"<p>This example demonstrates a pair distribution function (PDF) analysis of Si, based on data collected from a time-of-flight neutron powder diffraction experiment at NOMAD at SNS.</p>"},{"location":"tutorials/ed-11/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-11/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-11/#set-plotting-engine","title":"Set Plotting Engine\u00b6","text":""},{"location":"tutorials/ed-11/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-11/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-11/#select-fitting-parameters","title":"Select Fitting Parameters\u00b6","text":""},{"location":"tutorials/ed-11/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-11/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-12/","title":"NaCl pd-xray","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre>project = ed.Project()\n</pre> project = ed.Project() In\u00a0[4]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[5]: Copied! <pre># Set global plot range for plots\nproject.plotter.x_min = 2.0\nproject.plotter.x_max = 30.0\n</pre> # Set global plot range for plots project.plotter.x_min = 2.0 project.plotter.x_max = 30.0 In\u00a0[6]: Copied! <pre>project.sample_models.add(name='nacl')\n</pre> project.sample_models.add(name='nacl') In\u00a0[7]: Copied! <pre>project.sample_models['nacl'].space_group.name_h_m = 'F m -3 m'\nproject.sample_models['nacl'].space_group.it_coordinate_system_code = '1'\nproject.sample_models['nacl'].cell.length_a = 5.62\nproject.sample_models['nacl'].atom_sites.add(\n    label='Na',\n    type_symbol='Na',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=1.0,\n)\nproject.sample_models['nacl'].atom_sites.add(\n    label='Cl',\n    type_symbol='Cl',\n    fract_x=0.5,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=1.0,\n)\n</pre> project.sample_models['nacl'].space_group.name_h_m = 'F m -3 m' project.sample_models['nacl'].space_group.it_coordinate_system_code = '1' project.sample_models['nacl'].cell.length_a = 5.62 project.sample_models['nacl'].atom_sites.add(     label='Na',     type_symbol='Na',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=1.0, ) project.sample_models['nacl'].atom_sites.add(     label='Cl',     type_symbol='Cl',     fract_x=0.5,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='b',     b_iso=1.0, ) In\u00a0[8]: Copied! <pre>data_path = ed.download_data(id=4, destination='data')\n</pre> data_path = ed.download_data(id=4, destination='data') <pre>Getting data...\n</pre> <pre>Data #4: NaCl.gr\n</pre> <pre>\u2705 Data #4 downloaded to 'data/ed-4.gr'\n</pre> In\u00a0[9]: Copied! <pre>project.experiments.add(\n    name='xray_pdf',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='constant wavelength',\n    radiation_probe='xray',\n    scattering_type='total',\n)\n</pre> project.experiments.add(     name='xray_pdf',     data_path=data_path,     sample_form='powder',     beam_mode='constant wavelength',     radiation_probe='xray',     scattering_type='total', ) <pre>Warning: No uncertainty (sy) column provided. Defaulting to 0.03.\n</pre> <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'xray_pdf'. Number of data points: 5000\n</pre> In\u00a0[10]: Copied! <pre>project.experiments['xray_pdf'].show_supported_peak_profile_types()\n</pre> project.experiments['xray_pdf'].show_supported_peak_profile_types() <pre>Supported peak profile types\n</pre> Peak profile type Description 1 gaussian-damped-sinc Gaussian-damped sinc profile for pair distribution function (PDF) analysis. In\u00a0[11]: Copied! <pre>project.experiments['xray_pdf'].show_current_peak_profile_type()\n</pre> project.experiments['xray_pdf'].show_current_peak_profile_type() <pre>Current peak profile type\n</pre> <pre>PeakProfileTypeEnum.GAUSSIAN_DAMPED_SINC\n</pre> In\u00a0[12]: Copied! <pre>project.experiments['xray_pdf'].peak_profile_type = 'gaussian-damped-sinc'\n</pre> project.experiments['xray_pdf'].peak_profile_type = 'gaussian-damped-sinc' <pre>Peak profile type for experiment 'xray_pdf' changed to\n</pre> <pre>gaussian-damped-sinc\n</pre> In\u00a0[13]: Copied! <pre>project.experiments['xray_pdf'].peak.damp_q = 0.03\nproject.experiments['xray_pdf'].peak.broad_q = 0\nproject.experiments['xray_pdf'].peak.cutoff_q = 21\nproject.experiments['xray_pdf'].peak.sharp_delta_1 = 0\nproject.experiments['xray_pdf'].peak.sharp_delta_2 = 5\nproject.experiments['xray_pdf'].peak.damp_particle_diameter = 0\n</pre> project.experiments['xray_pdf'].peak.damp_q = 0.03 project.experiments['xray_pdf'].peak.broad_q = 0 project.experiments['xray_pdf'].peak.cutoff_q = 21 project.experiments['xray_pdf'].peak.sharp_delta_1 = 0 project.experiments['xray_pdf'].peak.sharp_delta_2 = 5 project.experiments['xray_pdf'].peak.damp_particle_diameter = 0 In\u00a0[14]: Copied! <pre>project.experiments['xray_pdf'].linked_phases.add(id='nacl', scale=0.5)\n</pre> project.experiments['xray_pdf'].linked_phases.add(id='nacl', scale=0.5) In\u00a0[15]: Copied! <pre>project.sample_models['nacl'].cell.length_a.free = True\nproject.sample_models['nacl'].atom_sites['Na'].b_iso.free = True\nproject.sample_models['nacl'].atom_sites['Cl'].b_iso.free = True\n</pre> project.sample_models['nacl'].cell.length_a.free = True project.sample_models['nacl'].atom_sites['Na'].b_iso.free = True project.sample_models['nacl'].atom_sites['Cl'].b_iso.free = True In\u00a0[16]: Copied! <pre>project.experiments['xray_pdf'].linked_phases['nacl'].scale.free = True\nproject.experiments['xray_pdf'].peak.damp_q.free = True\nproject.experiments['xray_pdf'].peak.sharp_delta_2.free = True\n</pre> project.experiments['xray_pdf'].linked_phases['nacl'].scale.free = True project.experiments['xray_pdf'].peak.damp_q.free = True project.experiments['xray_pdf'].peak.sharp_delta_2.free = True In\u00a0[17]: Copied! <pre>project.analysis.current_calculator = 'pdffit'\nproject.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.current_calculator = 'pdffit' project.analysis.fit() project.analysis.show_fit_results() <pre>Current calculator changed to\n</pre> <pre>pdffit\n</pre> <pre>Using experiment \ud83d\udd2c 'xray_pdf' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 163.09 2 10 19.59 88.0% \u2193 3 17 10.95 44.1% \u2193 4 24 10.69 2.3% \u2193 5 46 10.69 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 10.69 at iteration 45\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 6.99 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 10.69\n</pre> <pre>\ud83d\udccf R-factor (Rf): 34.82%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 30.63%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 30.63%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 nacl cell length_a 5.6200 5.6175 N/A \u00c5 0.04 % \u2193 2 nacl atom_site Na b_iso 1.0000 1.0000 N/A \u00c5\u00b2 0.00 % \u2193 3 nacl atom_site Cl b_iso 1.0000 1.0000 N/A \u00c5\u00b2 0.00 % \u2193 4 xray_pdf linked_phases nacl scale 0.5000 0.4469 N/A 10.61 % \u2193 5 xray_pdf peak damp_q 0.0300 0.0625 N/A \u00c5\u207b\u00b9 108.42 % \u2191 6 xray_pdf peak sharp_delta_2 5.0000 4.3628 N/A \u00c5\u00b2 12.74 % \u2193 In\u00a0[18]: Copied! <pre>project.plot_meas_vs_calc(expt_name='xray_pdf')\n</pre> project.plot_meas_vs_calc(expt_name='xray_pdf')"},{"location":"tutorials/ed-12/#pair-distribution-function-nacl-xrd","title":"Pair Distribution Function: NaCl, XRD\u00b6","text":"<p>This example demonstrates a pair distribution function (PDF) analysis of NaCl, based on data collected from an X-ray powder diffraction experiment.</p> <p>The dataset is taken from: https://github.com/diffpy/add2019-diffpy-cmi/tree/master</p>"},{"location":"tutorials/ed-12/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-12/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-12/#set-plotting-engine","title":"Set Plotting Engine\u00b6","text":""},{"location":"tutorials/ed-12/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-12/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-12/#select-fitting-parameters","title":"Select Fitting Parameters\u00b6","text":""},{"location":"tutorials/ed-12/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-12/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-13/","title":"2025 DMSC","text":"<p>\ud83d\udcd6 See documentation for more details about importing the EasyDiffraction library and its components.</p> In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed <p>\ud83d\udcd6 See documentation for more details about creating a project and its purpose in the analysis workflow.</p> In\u00a0[3]: Copied! <pre>project_1 = ed.Project(name='reference')\n</pre> project_1 = ed.Project(name='reference') <p>You can set the title and description of the project to provide context and information about the analysis being performed. This is useful for documentation purposes and helps others (or yourself in the future) understand the purpose of the project at a glance.</p> In\u00a0[4]: Copied! <pre>project_1.info.title = 'Reference Silicon Fit'\nproject_1.info.description = 'Fitting simulated powder diffraction pattern of Si.'\n</pre> project_1.info.title = 'Reference Silicon Fit' project_1.info.description = 'Fitting simulated powder diffraction pattern of Si.' <p>\ud83d\udcd6 See documentation for more details about experiments and their purpose in the analysis workflow.</p> In\u00a0[5]: Copied! <pre>data_dir = 'data'\nfile_name = 'reduced_Si.xye'\nsi_xye_path = f'{data_dir}/{file_name}'\n</pre> data_dir = 'data' file_name = 'reduced_Si.xye' si_xye_path = f'{data_dir}/{file_name}' <p>Uncomment the following cell if your data reduction failed and the reduced data file is missing. In this case, you can download our pre-generated reduced data file from the EasyDiffraction repository. The <code>download_data</code> function will not overwrite an existing file unless you set <code>overwrite=True</code>, so it's safe to run even if the file is already present.</p> In\u00a0[6]: Copied! <pre>si_xye_path = ed.download_data(id=17, destination=data_dir)\n</pre> si_xye_path = ed.download_data(id=17, destination=data_dir) <pre>Getting data...\n</pre> <pre>Data #17: Si, McStas simulation, DMSC Summer School 2025\n</pre> <pre>\u2705 Data #17 downloaded to 'data/ed-17.xye'\n</pre> <p>Now we can create the experiment and load the measured data. In this case, the experiment is defined as a powder diffraction measurement using time-of-flight neutrons. The measured data is loaded from a file containing the reduced diffraction pattern of Si from the data reduction notebook.</p> <p>\ud83d\udcd6 See documentation for more details about different types of experiments.</p> In\u00a0[7]: Copied! <pre>project_1.experiments.add(\n    name='sim_si',\n    data_path=si_xye_path,\n    sample_form='powder',\n    beam_mode='time-of-flight',\n    radiation_probe='neutron',\n)\n</pre> project_1.experiments.add(     name='sim_si',     data_path=si_xye_path,     sample_form='powder',     beam_mode='time-of-flight',     radiation_probe='neutron', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'sim_si'. Number of data points: 900\n</pre> <p>\ud83d\udcd6 See documentation for more details about the measured data and its format.</p> <p>To visualize the measured data, we can use the <code>plot_meas</code> method of the project. Before plotting, we need to set the plotting engine to 'plotly', which provides interactive visualizations.</p> <p>\ud83d\udcd6 See documentation for more details about setting the plotting engine.</p> In\u00a0[8]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[9]: Copied! <pre>project_1.plot_meas(expt_name='sim_si')\n</pre> project_1.plot_meas(expt_name='sim_si') <pre>Warning: No linked phases defined. Returning empty pattern.\n</pre> <p>If you zoom in on the highest TOF peak (around 120,000 \u03bcs), you will notice that it has a broad and unusual shape. This distortion, along with additional effects on the low TOF peaks, is most likely an artifact related to the simplifications made during the simulation and/or reduction process and is currently under investigation. However, this is outside the scope of this school. Therefore, we will simply exclude both the low and high TOF regions from the analysis by adding an excluded regions to the experiment.</p> <p>In real experiments, it is often necessary to exclude certain regions from the measured data. For example, the direct beam can significantly increase the background at very low angles, making those parts of the diffractogram unreliable. Additionally, sample environment components may introduce unwanted peaks. In such cases, excluding specific regions is often simpler and more effective than modeling them with an additional sample phase.</p> <p>\ud83d\udcd6 See documentation for more details about excluding regions from the measured data.</p> In\u00a0[10]: Copied! <pre>project_1.experiments['sim_si'].excluded_regions.add(id='1', start=0, end=55000)\nproject_1.experiments['sim_si'].excluded_regions.add(id='2', start=105500, end=200000)\n</pre> project_1.experiments['sim_si'].excluded_regions.add(id='1', start=0, end=55000) project_1.experiments['sim_si'].excluded_regions.add(id='2', start=105500, end=200000) <p>To visualize the effect of excluding the high TOF region, we can plot the measured data again. The excluded region will be omitted from the plot and is not used in the fitting process.</p> In\u00a0[11]: Copied! <pre>project_1.plot_meas(expt_name='sim_si')\n</pre> project_1.plot_meas(expt_name='sim_si') <pre>Warning: No linked phases defined. Returning empty pattern.\n</pre> <p>\ud83d\udcd6 See documentation for more details about the instrument parameters.</p> In\u00a0[12]: Copied! <pre>project_1.experiments['sim_si'].instrument.setup_twotheta_bank = ed.get_value_from_xye_header(\n    si_xye_path, 'two_theta'\n)\nproject_1.experiments['sim_si'].instrument.calib_d_to_tof_linear = ed.get_value_from_xye_header(\n    si_xye_path, 'DIFC'\n)\n</pre> project_1.experiments['sim_si'].instrument.setup_twotheta_bank = ed.get_value_from_xye_header(     si_xye_path, 'two_theta' ) project_1.experiments['sim_si'].instrument.calib_d_to_tof_linear = ed.get_value_from_xye_header(     si_xye_path, 'DIFC' ) <p>Before proceeding, let's take a quick look at the concept of parameters in EasyDiffraction, which is similar to the parameter concept in EasyScience. The current version of EasyDiffraction is transitioning to reuse the parameter system from EasyScience.</p> <p>That is, every parameter is an object, which has different attributes, such as <code>value</code>, <code>units</code>, etc. To display the parameter of interest, you can simply print the parameter object.</p> <p>For example, to display the linear conversion factor from d-spacing to TOF, which is the <code>calib_d_to_tof_linear</code> parameter, you can do the following:</p> In\u00a0[13]: Copied! <pre>print(project_1.experiments['sim_si'].instrument.calib_d_to_tof_linear)\n</pre> print(project_1.experiments['sim_si'].instrument.calib_d_to_tof_linear) <pre>&lt;sim_si.instrument.d_to_tof_linear = 61445.893309194034 \u00b5s/\u212b (free=False)&gt;\n</pre> <p>The <code>value</code> attribute represents the current value of the parameter as a float. You can access it directly by using the <code>value</code> attribute of the parameter. This is useful when you want to use the parameter value in calculations or when you want to assign it to another parameter. For example, to get only the value of the same parameter as floating point number, but not the whole object, you can do the following:</p> In\u00a0[14]: Copied! <pre>print(project_1.experiments['sim_si'].instrument.calib_d_to_tof_linear.value)\n</pre> print(project_1.experiments['sim_si'].instrument.calib_d_to_tof_linear.value) <pre>61445.893309194034\n</pre> <p>Note that to set the value of the parameter, you can simply assign a new value to the parameter object without using the <code>value</code> attribute, as we did above.</p> <p>\ud83d\udcd6 See documentation for more details about parameters in EasyDiffraction and their attributes.</p> <p>\ud83d\udcd6 See documentation for more details about the peak profile types.</p> In\u00a0[15]: Copied! <pre>project_1.experiments['sim_si'].peak_profile_type = 'pseudo-voigt * ikeda-carpenter'\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_0 = 69498\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_1 = -55578\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_2 = 14560\nproject_1.experiments['sim_si'].peak.broad_mix_beta_0 = 0.0019\nproject_1.experiments['sim_si'].peak.broad_mix_beta_1 = 0.0137\nproject_1.experiments['sim_si'].peak.asym_alpha_0 = -0.0055\nproject_1.experiments['sim_si'].peak.asym_alpha_1 = 0.0147\n</pre> project_1.experiments['sim_si'].peak_profile_type = 'pseudo-voigt * ikeda-carpenter' project_1.experiments['sim_si'].peak.broad_gauss_sigma_0 = 69498 project_1.experiments['sim_si'].peak.broad_gauss_sigma_1 = -55578 project_1.experiments['sim_si'].peak.broad_gauss_sigma_2 = 14560 project_1.experiments['sim_si'].peak.broad_mix_beta_0 = 0.0019 project_1.experiments['sim_si'].peak.broad_mix_beta_1 = 0.0137 project_1.experiments['sim_si'].peak.asym_alpha_0 = -0.0055 project_1.experiments['sim_si'].peak.asym_alpha_1 = 0.0147 <pre>Peak profile type for experiment 'sim_si' changed to\n</pre> <pre>pseudo-voigt * ikeda-carpenter\n</pre> <p>\ud83d\udcd6 See documentation for more details about the background and its types.</p> In\u00a0[16]: Copied! <pre>project_1.experiments['sim_si'].background_type = 'line-segment'\nproject_1.experiments['sim_si'].background.add(id='1', x=50000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='2', x=60000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='3', x=70000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='4', x=80000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='5', x=90000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='6', x=100000, y=0.01)\nproject_1.experiments['sim_si'].background.add(id='7', x=110000, y=0.01)\n</pre> project_1.experiments['sim_si'].background_type = 'line-segment' project_1.experiments['sim_si'].background.add(id='1', x=50000, y=0.01) project_1.experiments['sim_si'].background.add(id='2', x=60000, y=0.01) project_1.experiments['sim_si'].background.add(id='3', x=70000, y=0.01) project_1.experiments['sim_si'].background.add(id='4', x=80000, y=0.01) project_1.experiments['sim_si'].background.add(id='5', x=90000, y=0.01) project_1.experiments['sim_si'].background.add(id='6', x=100000, y=0.01) project_1.experiments['sim_si'].background.add(id='7', x=110000, y=0.01) <pre>Background type for experiment 'sim_si' changed to\n</pre> <pre>line-segment\n</pre> <p>\ud83d\udcd6 See documentation for more details about the CIF format and its use in EasyDiffraction.</p> <pre><code>data_si\n\n_space_group.name_H-M_alt  \"F d -3 m\"\n_space_group.IT_coordinate_system_code  2\n\n_cell.length_a      5.43\n_cell.length_b      5.43\n_cell.length_c      5.43\n_cell.angle_alpha  90.0\n_cell.angle_beta   90.0\n_cell.angle_gamma  90.0\n\nloop_\n_atom_site.label\n_atom_site.type_symbol\n_atom_site.fract_x\n_atom_site.fract_y\n_atom_site.fract_z\n_atom_site.wyckoff_letter\n_atom_site.occupancy\n_atom_site.ADP_type\n_atom_site.B_iso_or_equiv\nSi Si   0 0 0   a  1.0   Biso 0.89\n</code></pre> <p>As with adding the experiment in the previous step, we will create a default sample model and then modify its parameters to match the Si structure.</p> <p>\ud83d\udcd6 See documentation for more details about sample models and their purpose in the data analysis workflow.</p> In\u00a0[17]: Copied! <pre>project_1.sample_models.add(name='si')\n</pre> project_1.sample_models.add(name='si') <p>\ud83d\udcd6 See documentation for more details about the space group.</p> In\u00a0[18]: Copied! <pre>project_1.sample_models['si'].space_group.name_h_m = 'F d -3 m'\nproject_1.sample_models['si'].space_group.it_coordinate_system_code = '2'\n</pre> project_1.sample_models['si'].space_group.name_h_m = 'F d -3 m' project_1.sample_models['si'].space_group.it_coordinate_system_code = '2' <p>\ud83d\udcd6 See documentation for more details about the unit cell parameters.</p> In\u00a0[19]: Copied! <pre>project_1.sample_models['si'].cell.length_a = 5.43\n</pre> project_1.sample_models['si'].cell.length_a = 5.43 <p>\ud83d\udcd6 See documentation for more details about the atom sites category.</p> In\u00a0[20]: Copied! <pre>project_1.sample_models['si'].atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.89,\n)\n</pre> project_1.sample_models['si'].atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.89, ) <p>\ud83d\udcd6 See documentation for more details about linking a sample model to an experiment.</p> In\u00a0[21]: Copied! <pre>project_1.experiments['sim_si'].linked_phases.add(id='si', scale=1.0)\n</pre> project_1.experiments['sim_si'].linked_phases.add(id='si', scale=1.0) <p>The fitting process involves comparing the measured diffraction pattern with the calculated diffraction pattern based on the sample model and instrument parameters. The goal is to adjust the parameters of the sample model and the experiment to minimize the difference between the measured and calculated diffraction patterns. This is done by refining the parameters of the sample model and the instrument settings to achieve a better fit.</p> <p>\ud83d\udcd6 See documentation for more details about the fitting process in EasyDiffraction.</p> In\u00a0[22]: Copied! <pre>project_1.experiments['sim_si'].linked_phases['si'].scale.free = True\n\nfor line_segment in project_1.experiments['sim_si'].background:\n    line_segment.y.free = True\n\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_0.free = True\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_1.free = True\nproject_1.experiments['sim_si'].peak.broad_gauss_sigma_2.free = True\nproject_1.experiments['sim_si'].peak.broad_mix_beta_0.free = True\nproject_1.experiments['sim_si'].peak.broad_mix_beta_1.free = True\nproject_1.experiments['sim_si'].peak.asym_alpha_0.free = True\nproject_1.experiments['sim_si'].peak.asym_alpha_1.free = True\n</pre> project_1.experiments['sim_si'].linked_phases['si'].scale.free = True  for line_segment in project_1.experiments['sim_si'].background:     line_segment.y.free = True  project_1.experiments['sim_si'].peak.broad_gauss_sigma_0.free = True project_1.experiments['sim_si'].peak.broad_gauss_sigma_1.free = True project_1.experiments['sim_si'].peak.broad_gauss_sigma_2.free = True project_1.experiments['sim_si'].peak.broad_mix_beta_0.free = True project_1.experiments['sim_si'].peak.broad_mix_beta_1.free = True project_1.experiments['sim_si'].peak.asym_alpha_0.free = True project_1.experiments['sim_si'].peak.asym_alpha_1.free = True <p>\ud83d\udcd6 See documentation for more details on how to</p> <ul> <li>show all parameters of the project,</li> <li>show all fittable parameters, and</li> <li>show only free parameters of the project.</li> </ul> In\u00a0[23]: Copied! <pre>project_1.analysis.show_free_params()\n</pre> project_1.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 sim_si linked_phases si scale 1.00000 -inf inf 2 sim_si peak gauss_sigma_0 69498.00000 -inf inf \u00b5s\u00b2 3 sim_si peak gauss_sigma_1 -55578.00000 -inf inf \u00b5s/\u212b 4 sim_si peak gauss_sigma_2 14560.00000 -inf inf \u00b5s\u00b2/\u212b\u00b2 5 sim_si peak mix_beta_0 0.00190 -inf inf deg 6 sim_si peak mix_beta_1 0.01370 -inf inf deg 7 sim_si peak asym_alpha_0 -0.00550 -inf inf 8 sim_si peak asym_alpha_1 0.01470 -inf inf 9 sim_si background 1 y 0.01000 -inf inf 10 sim_si background 2 y 0.01000 -inf inf 11 sim_si background 3 y 0.01000 -inf inf 12 sim_si background 4 y 0.01000 -inf inf 13 sim_si background 5 y 0.01000 -inf inf 14 sim_si background 6 y 0.01000 -inf inf 15 sim_si background 7 y 0.01000 -inf inf In\u00a0[24]: Copied! <pre>project_1.plot_meas_vs_calc(expt_name='sim_si')\n</pre> project_1.plot_meas_vs_calc(expt_name='sim_si') <p>\ud83d\udcd6 See documentation for more details about the fitting process.</p> In\u00a0[25]: Copied! <pre>project_1.analysis.fit()\nproject_1.analysis.show_fit_results()\n</pre> project_1.analysis.fit() project_1.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sim_si' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 33.88 2 19 4.11 87.9% \u2193 3 35 2.33 43.4% \u2193 4 116 2.31 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 2.31 at iteration 115\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 2.96 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 2.31\n</pre> <pre>\ud83d\udccf R-factor (Rf): 6.87%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.52%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 5.60%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 sim_si linked_phases si scale 1.0000 1.4540 0.0071 45.40 % \u2191 2 sim_si peak gauss_sigma_0 69498.0000 87503.6603 7064.8898 \u00b5s\u00b2 25.91 % \u2191 3 sim_si peak gauss_sigma_1 -55578.0000 -66953.2238 8731.0313 \u00b5s/\u212b 20.47 % \u2191 4 sim_si peak gauss_sigma_2 14560.0000 16276.4795 2444.4594 \u00b5s\u00b2/\u212b\u00b2 11.79 % \u2191 5 sim_si peak mix_beta_0 0.0019 0.0008 0.0001 deg 58.68 % \u2193 6 sim_si peak mix_beta_1 0.0137 0.0190 0.0010 deg 38.42 % \u2191 7 sim_si peak asym_alpha_0 -0.0055 -0.0066 0.0005 20.30 % \u2191 8 sim_si peak asym_alpha_1 0.0147 0.0159 0.0007 7.87 % \u2191 9 sim_si background 1 y 0.0100 -0.0094 0.0068 193.92 % \u2193 10 sim_si background 2 y 0.0100 0.0051 0.0014 49.32 % \u2193 11 sim_si background 3 y 0.0100 0.0225 0.0016 125.05 % \u2191 12 sim_si background 4 y 0.0100 0.0242 0.0014 142.07 % \u2191 13 sim_si background 5 y 0.0100 0.0247 0.0010 147.08 % \u2191 14 sim_si background 6 y 0.0100 0.0226 0.0017 125.88 % \u2191 15 sim_si background 7 y 0.0100 0.0192 0.0040 91.73 % \u2191 In\u00a0[26]: Copied! <pre>project_1.plot_meas_vs_calc(expt_name='sim_si')\n</pre> project_1.plot_meas_vs_calc(expt_name='sim_si') In\u00a0[27]: Copied! <pre>project_1.plot_meas_vs_calc(expt_name='sim_si', d_spacing=True)\n</pre> project_1.plot_meas_vs_calc(expt_name='sim_si', d_spacing=True) <p>As you can see, the calculated diffraction pattern now matches the measured pattern much more closely. Typically, additional experimental parameters are included in the refinement process to further improve the fit. In this example, the structural parameters are not refined because the Si crystal structure is a well-known standard reference used to calibrate both the instrument and the experimental setup. The refined experimental parameters obtained here will then be applied when fitting the crystal structures of other materials.</p> <p>In the next part of the notebook, we will move to a more advanced case and fit a more complex crystal structure: La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO).</p> In\u00a0[28]: Copied! <pre>project_1.save_as(dir_path='powder_diffraction_Si')\n</pre> project_1.save_as(dir_path='powder_diffraction_Si') <pre>Saving project \ud83d\udce6 'reference' to\n</pre> <pre>/Users/runner/work/diffraction-lib/diffraction-lib/tutorials/powder_diffraction_Si\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 si.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 sim_si.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> <p>Hint:</p> <p>You can use the same approach as in the previous part of the notebook, but this time we will create a new project for the LBCO fit.</p> <p>Solution:</p> In\u00a0[29]: Copied! <pre>project_2 = ed.Project(name='main')\nproject_2.info.title = 'La0.5Ba0.5CoO3 Fit'\nproject_2.info.description = 'Fitting simulated powder diffraction pattern of La0.5Ba0.5CoO3.'\n</pre> project_2 = ed.Project(name='main') project_2.info.title = 'La0.5Ba0.5CoO3 Fit' project_2.info.description = 'Fitting simulated powder diffraction pattern of La0.5Ba0.5CoO3.' <p>Hint:</p> <p>You can use the same approach as in the previous part of the notebook, but this time you need to use the data file for LBCO.</p> <p>Solution:</p> In\u00a0[30]: Copied! <pre>data_dir = 'data'\nfile_name = 'reduced_LBCO.xye'\nlbco_xye_path = f'{data_dir}/{file_name}'\n\n# Uncomment the following line if your data reduction failed and the\n# reduced data file is missing.\nlbco_xye_path = ed.download_data(id=18, destination=data_dir)\n\nproject_2.experiments.add(\n    name='sim_lbco',\n    data_path=lbco_xye_path,\n    sample_form='powder',\n    beam_mode='time-of-flight',\n    radiation_probe='neutron',\n)\n</pre> data_dir = 'data' file_name = 'reduced_LBCO.xye' lbco_xye_path = f'{data_dir}/{file_name}'  # Uncomment the following line if your data reduction failed and the # reduced data file is missing. lbco_xye_path = ed.download_data(id=18, destination=data_dir)  project_2.experiments.add(     name='sim_lbco',     data_path=lbco_xye_path,     sample_form='powder',     beam_mode='time-of-flight',     radiation_probe='neutron', ) <pre>Getting data...\n</pre> <pre>Data #18: La0.5Ba0.5CoO3 + Si, McStas simulation, DMSC Summer School 2025\n</pre> <pre>\u2705 Data #18 downloaded to 'data/ed-18.xye'\n</pre> <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'sim_lbco'. Number of data points: 900\n</pre> <p>Hint:</p> <p>You can use the <code>plot_meas</code> method of the project to visualize the measured diffraction pattern. You can also use the <code>excluded_regions</code> attribute of the experiment to exclude specific regions from the analysis as we did in the previous part of the notebook.</p> <p>Solution:</p> In\u00a0[31]: Copied! <pre>project_2.plot_meas(expt_name='sim_lbco')\n\nproject_2.experiments['sim_lbco'].excluded_regions.add(id='1', start=0, end=55000)\nproject_2.experiments['sim_lbco'].excluded_regions.add(id='2', start=105500, end=200000)\n\nproject_2.plot_meas(expt_name='sim_lbco')\n</pre> project_2.plot_meas(expt_name='sim_lbco')  project_2.experiments['sim_lbco'].excluded_regions.add(id='1', start=0, end=55000) project_2.experiments['sim_lbco'].excluded_regions.add(id='2', start=105500, end=200000)  project_2.plot_meas(expt_name='sim_lbco') <pre>Warning: No linked phases defined. Returning empty pattern.\n</pre> <pre>Warning: No linked phases defined. Returning empty pattern.\n</pre> <p>Hint:</p> <p>Use the values from the data reduction process for the LBCO and follow the same approach as in the previous part of the notebook.</p> <p>Solution:</p> In\u00a0[32]: Copied! <pre>project_2.experiments['sim_lbco'].instrument.setup_twotheta_bank = ed.get_value_from_xye_header(\n    lbco_xye_path, 'two_theta'\n)\nproject_2.experiments['sim_lbco'].instrument.calib_d_to_tof_linear = ed.get_value_from_xye_header(\n    lbco_xye_path, 'DIFC'\n)\n</pre> project_2.experiments['sim_lbco'].instrument.setup_twotheta_bank = ed.get_value_from_xye_header(     lbco_xye_path, 'two_theta' ) project_2.experiments['sim_lbco'].instrument.calib_d_to_tof_linear = ed.get_value_from_xye_header(     lbco_xye_path, 'DIFC' ) <p>Hint:</p> <p>Use the values from the previous part of the notebook. You can either manually copy the values from the Si fit or use the <code>value</code> attribute of the parameters from the Si experiment to set the initial values for the LBCO experiment. This will help us to have a good starting point for the fit.</p> <p>Solution:</p> In\u00a0[33]: Copied! <pre># # Create a reference to the peak profile parameters from the Si\nsim_si_peak = project_1.experiments['sim_si'].peak\nproject_2.experiments['sim_lbco'].peak_profile_type = 'pseudo-voigt * ikeda-carpenter'\nproject_2.experiments['sim_lbco'].peak.broad_gauss_sigma_0 = sim_si_peak.broad_gauss_sigma_0.value\nproject_2.experiments['sim_lbco'].peak.broad_gauss_sigma_1 = sim_si_peak.broad_gauss_sigma_1.value\nproject_2.experiments['sim_lbco'].peak.broad_gauss_sigma_2 = sim_si_peak.broad_gauss_sigma_2.value\nproject_2.experiments['sim_lbco'].peak.broad_mix_beta_0 = sim_si_peak.broad_mix_beta_0.value\nproject_2.experiments['sim_lbco'].peak.broad_mix_beta_1 = sim_si_peak.broad_mix_beta_1.value\nproject_2.experiments['sim_lbco'].peak.asym_alpha_0 = sim_si_peak.asym_alpha_0.value\nproject_2.experiments['sim_lbco'].peak.asym_alpha_1 = sim_si_peak.asym_alpha_1.value\n</pre> # # Create a reference to the peak profile parameters from the Si sim_si_peak = project_1.experiments['sim_si'].peak project_2.experiments['sim_lbco'].peak_profile_type = 'pseudo-voigt * ikeda-carpenter' project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_0 = sim_si_peak.broad_gauss_sigma_0.value project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_1 = sim_si_peak.broad_gauss_sigma_1.value project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_2 = sim_si_peak.broad_gauss_sigma_2.value project_2.experiments['sim_lbco'].peak.broad_mix_beta_0 = sim_si_peak.broad_mix_beta_0.value project_2.experiments['sim_lbco'].peak.broad_mix_beta_1 = sim_si_peak.broad_mix_beta_1.value project_2.experiments['sim_lbco'].peak.asym_alpha_0 = sim_si_peak.asym_alpha_0.value project_2.experiments['sim_lbco'].peak.asym_alpha_1 = sim_si_peak.asym_alpha_1.value <pre>Peak profile type for experiment 'sim_lbco' changed to\n</pre> <pre>pseudo-voigt * ikeda-carpenter\n</pre> <p>Hint:</p> <p>Use the same approach as in the previous part of the notebook, but this time you need to set the background points for the LBCO experiment. You can zoom in on the measured diffraction pattern to determine the approximate background level.</p> <p>Solution:</p> In\u00a0[34]: Copied! <pre>project_2.experiments['sim_lbco'].background_type = 'line-segment'\nproject_2.experiments['sim_lbco'].background.add(id='1', x=50000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='2', x=60000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='3', x=70000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='4', x=80000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='5', x=90000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='6', x=100000, y=0.2)\nproject_2.experiments['sim_lbco'].background.add(id='7', x=110000, y=0.2)\n</pre> project_2.experiments['sim_lbco'].background_type = 'line-segment' project_2.experiments['sim_lbco'].background.add(id='1', x=50000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='2', x=60000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='3', x=70000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='4', x=80000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='5', x=90000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='6', x=100000, y=0.2) project_2.experiments['sim_lbco'].background.add(id='7', x=110000, y=0.2) <pre>Background type for experiment 'sim_lbco' changed to\n</pre> <pre>line-segment\n</pre> <pre><code>data_lbco\n\n_space_group.name_H-M_alt  \"P m -3 m\"\n_space_group.IT_coordinate_system_code  1\n\n_cell.length_a      3.89\n_cell.length_b      3.89\n_cell.length_c      3.89\n_cell.angle_alpha  90.0\n_cell.angle_beta   90.0\n_cell.angle_gamma  90.0\n\nloop_\n_atom_site.label\n_atom_site.type_symbol\n_atom_site.fract_x\n_atom_site.fract_y\n_atom_site.fract_z\n_atom_site.wyckoff_letter\n_atom_site.occupancy\n_atom_site.ADP_type\n_atom_site.B_iso_or_equiv\nLa La   0.0 0.0 0.0   a   0.5   Biso 0.95\nBa Ba   0.0 0.0 0.0   a   0.5   Biso 0.95\nCo Co   0.5 0.5 0.5   b   1.0   Biso 0.80\nO  O    0.0 0.5 0.5   c   1.0   Biso 1.66\n</code></pre> <p>Note that the <code>occupancy</code> of the La and Ba atoms is 0.5 and those atoms are located in the same position (0, 0, 0) in the unit cell. This means that an extra attribute <code>occupancy</code> needs to be set for those atoms later in the sample model.</p> <p>We model the La/Ba site using the virtual crystal approximation. In this approach, the scattering is taken as a weighted average of La and Ba. This reproduces the average diffraction pattern well but does not capture certain real-world effects.</p> <p>The edge cases are:</p> <ul> <li>Random distribution. La and Ba atoms are placed randomly. The Bragg peaks still match the average structure, but the pattern also shows extra background (diffuse scattering) between the peaks, but this is usually neglected in the analysis.</li> <li>Perfect ordering. La and Ba arrange themselves in a regular pattern, creating a larger repeating unit. This gives rise to extra peaks (\"superlattice reflections\") and changes the intensity of some existing peaks.</li> <li>Virtual crystal approximation (our model). We replace the site with a single \"virtual atom\" that averages La and Ba. This gives the correct average Bragg peaks but leaves out the extra background of the random case and the extra peaks of the ordered case.</li> </ul> <p>Hint:</p> <p>You can use the same approach as in the previous part of the notebook, but this time you need to use the model name corresponding to the LBCO structure, e.g. 'lbco'.</p> <p>Solution:</p> In\u00a0[35]: Copied! <pre>project_2.sample_models.add(name='lbco')\n</pre> project_2.sample_models.add(name='lbco') <p>Hint:</p> <p>Use the space group name and IT coordinate system code from the CIF data.</p> <p>Solution:</p> In\u00a0[36]: Copied! <pre>project_2.sample_models['lbco'].space_group.name_h_m = 'P m -3 m'\nproject_2.sample_models['lbco'].space_group.it_coordinate_system_code = '1'\n</pre> project_2.sample_models['lbco'].space_group.name_h_m = 'P m -3 m' project_2.sample_models['lbco'].space_group.it_coordinate_system_code = '1' <p>Hint:</p> <p>Use the lattice parameters from the CIF data.</p> <p>Solution:</p> In\u00a0[37]: Copied! <pre>project_2.sample_models['lbco'].cell.length_a = 3.88\n</pre> project_2.sample_models['lbco'].cell.length_a = 3.88 <p>Hint:</p> <p>Use the atom sites from the CIF data. You can use the <code>add</code> method of the <code>atom_sites</code> attribute of the sample model to add the atom sites.</p> <p>Solution:</p> In\u00a0[38]: Copied! <pre>project_2.sample_models['lbco'].atom_sites.add(\n    label='La',\n    type_symbol='La',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.95,\n    occupancy=0.5,\n)\nproject_2.sample_models['lbco'].atom_sites.add(\n    label='Ba',\n    type_symbol='Ba',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.95,\n    occupancy=0.5,\n)\nproject_2.sample_models['lbco'].atom_sites.add(\n    label='Co',\n    type_symbol='Co',\n    fract_x=0.5,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=0.80,\n)\nproject_2.sample_models['lbco'].atom_sites.add(\n    label='O',\n    type_symbol='O',\n    fract_x=0,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='c',\n    b_iso=1.66,\n)\n</pre> project_2.sample_models['lbco'].atom_sites.add(     label='La',     type_symbol='La',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.95,     occupancy=0.5, ) project_2.sample_models['lbco'].atom_sites.add(     label='Ba',     type_symbol='Ba',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.95,     occupancy=0.5, ) project_2.sample_models['lbco'].atom_sites.add(     label='Co',     type_symbol='Co',     fract_x=0.5,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='b',     b_iso=0.80, ) project_2.sample_models['lbco'].atom_sites.add(     label='O',     type_symbol='O',     fract_x=0,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='c',     b_iso=1.66, ) <p>Hint:</p> <p>Use the <code>linked_phases</code> attribute of the experiment to link the sample model.</p> <p>Solution:</p> In\u00a0[39]: Copied! <pre>project_2.experiments['sim_lbco'].linked_phases.add(id='lbco', scale=1.0)\n</pre> project_2.experiments['sim_lbco'].linked_phases.add(id='lbco', scale=1.0) <p>Hint:</p> <p>You can start with the scale factor and the background points, as in the Si fit.</p> <p>Solution:</p> In\u00a0[40]: Copied! <pre>project_2.experiments['sim_lbco'].linked_phases['lbco'].scale.free = True\n\nfor line_segment in project_2.experiments['sim_lbco'].background:\n    line_segment.y.free = True\n</pre> project_2.experiments['sim_lbco'].linked_phases['lbco'].scale.free = True  for line_segment in project_2.experiments['sim_lbco'].background:     line_segment.y.free = True <p>Hint:</p> <p>Use the <code>plot_meas_vs_calc</code> method of the project to visualize the measured and calculated diffraction patterns before fitting. Then, use the <code>fit</code> method of the <code>analysis</code> object of the project to perform the fitting process.</p> <p>Solution:</p> In\u00a0[41]: Copied! <pre>project_2.plot_meas_vs_calc(expt_name='sim_lbco')\n\nproject_2.analysis.fit()\nproject_2.analysis.show_fit_results()\n</pre> project_2.plot_meas_vs_calc(expt_name='sim_lbco')  project_2.analysis.fit() project_2.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sim_lbco' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 115.86 2 12 70.26 39.4% \u2193 3 22 70.26 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 70.26 at iteration 12\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 0.89 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 70.26\n</pre> <pre>\ud83d\udccf R-factor (Rf): 38.27%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 64.53%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 66.00%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 sim_lbco linked_phases lbco scale 1.0000 2.5864 0.1352 158.64 % \u2191 2 sim_lbco background 1 y 0.2000 0.2974 0.1893 48.69 % \u2191 3 sim_lbco background 2 y 0.2000 0.2745 0.0387 37.23 % \u2191 4 sim_lbco background 3 y 0.2000 0.2805 0.0251 40.25 % \u2191 5 sim_lbco background 4 y 0.2000 0.2359 0.0193 17.93 % \u2191 6 sim_lbco background 5 y 0.2000 0.2643 0.0138 32.15 % \u2191 7 sim_lbco background 6 y 0.2000 0.2511 0.0160 25.54 % \u2191 8 sim_lbco background 7 y 0.2000 0.2117 0.0576 5.86 % \u2191 <p>Hint:</p> <p>Consider the following options:</p> <ol> <li>The conversion parameters from TOF to d-spacing are not correct.</li> <li>The lattice parameters of the LBCO phase are not correct.</li> <li>The peak profile parameters are not correct.</li> <li>The background points are not correct.</li> </ol> <p>Solution:</p> <ol> <li>\u274c The conversion parameters from TOF to d-spacing were set based on the data reduction step. While they are specific to each dataset and thus differ from those used for the Si data, the full reduction workflow has already been validated with the Si fit. Therefore, they are not the cause of the misfit in this case.</li> <li>\u2705 The lattice parameters of the LBCO phase were set based on the CIF data, which is a good starting point, but they are not necessarily as accurate as needed for the fit. The lattice parameters may need to be refined.</li> <li>\u274c The peak profile parameters do not change the position of the peaks, but rather their shape.</li> <li>\u274c The background points affect the background level, but not the peak positions.</li> </ol> In\u00a0[42]: Copied! <pre>project_2.plot_meas_vs_calc(expt_name='sim_lbco')\n</pre> project_2.plot_meas_vs_calc(expt_name='sim_lbco') <p>Hint:</p> <p>To achieve this, we will set the <code>free</code> attribute of the <code>length_a</code> parameter of the LBCO cell to <code>True</code>.</p> <p>LBCO has a cubic crystal structure (space group <code>P m -3 m</code>), which means that <code>length_b</code> and <code>length_c</code> are constrained to be equal to <code>length_a</code>. Therefore, only <code>length_a</code> needs to be refined; the other two will be updated automatically. All cell angles are fixed at 90\u00b0, so they do not require refinement.</p> <p>Solution:</p> In\u00a0[43]: Copied! <pre>project_2.sample_models['lbco'].cell.length_a.free = True\n\nproject_2.analysis.fit()\nproject_2.analysis.show_fit_results()\n\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco')\n</pre> project_2.sample_models['lbco'].cell.length_a.free = True  project_2.analysis.fit() project_2.analysis.show_fit_results()  project_2.plot_meas_vs_calc(expt_name='sim_lbco') <pre>Using experiment \ud83d\udd2c 'sim_lbco' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 70.43 2 13 11.61 83.5% \u2193 3 23 5.07 56.3% \u2193 4 33 4.84 4.6% \u2193 5 65 4.84 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 4.84 at iteration 53\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 2.23 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 4.84\n</pre> <pre>\ud83d\udccf R-factor (Rf): 6.85%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 6.43%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 5.67%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8800 3.8922 0.0001 \u00c5 0.31 % \u2191 2 sim_lbco linked_phases lbco scale 2.5864 4.8705 0.0464 88.31 % \u2191 3 sim_lbco background 1 y 0.2974 0.2745 0.0497 7.70 % \u2193 4 sim_lbco background 2 y 0.2745 0.2586 0.0101 5.77 % \u2193 5 sim_lbco background 3 y 0.2805 0.2592 0.0066 7.58 % \u2193 6 sim_lbco background 4 y 0.2359 0.2412 0.0051 2.27 % \u2191 7 sim_lbco background 5 y 0.2643 0.2455 0.0036 7.10 % \u2193 8 sim_lbco background 6 y 0.2511 0.2379 0.0042 5.25 % \u2193 9 sim_lbco background 7 y 0.2117 0.2092 0.0151 1.20 % \u2193 <p>One of the main goals of this study was to refine the lattice parameter of the LBCO phase. As shown in the updated fit results, the overall fit has improved significantly, even though the change in cell length is less than 1% of the initial value. This demonstrates how even a small adjustment to the lattice parameter can have a substantial impact on the quality of the fit.</p> <p>Hint:</p> <p>Use the <code>plot_meas_vs_calc</code> method of the project and set the <code>d_spacing</code> parameter to <code>True</code>.</p> <p>Solution:</p> In\u00a0[44]: Copied! <pre>project_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True)\n</pre> project_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True) In\u00a0[45]: Copied! <pre>project_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True, x_min=1.35, x_max=1.40)\n</pre> project_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True, x_min=1.35, x_max=1.40) <p>The peak profile parameters are determined based on both the instrument and the sample characteristics, so they can vary when analyzing different samples on the same instrument. Therefore, it is better to refine them as well.</p> <p>Select the peak profile parameters to be refined during the fitting process.</p> <p>Hint:</p> <p>You can set the <code>free</code> attribute of the peak profile parameters to <code>True</code> to allow the fitting process to adjust them. You can use the same approach as in the previous part of the notebook, but this time you will refine the peak profile parameters of the LBCO phase.</p> <p>Solution:</p> In\u00a0[46]: Copied! <pre>project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_0.free = True\nproject_2.experiments['sim_lbco'].peak.broad_gauss_sigma_1.free = True\nproject_2.experiments['sim_lbco'].peak.broad_gauss_sigma_2.free = True\nproject_2.experiments['sim_lbco'].peak.broad_mix_beta_0.free = True\nproject_2.experiments['sim_lbco'].peak.broad_mix_beta_1.free = True\nproject_2.experiments['sim_lbco'].peak.asym_alpha_0.free = True\nproject_2.experiments['sim_lbco'].peak.asym_alpha_1.free = True\n\nproject_2.analysis.fit()\nproject_2.analysis.show_fit_results()\n\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True, x_min=1.35, x_max=1.40)\n</pre> project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_0.free = True project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_1.free = True project_2.experiments['sim_lbco'].peak.broad_gauss_sigma_2.free = True project_2.experiments['sim_lbco'].peak.broad_mix_beta_0.free = True project_2.experiments['sim_lbco'].peak.broad_mix_beta_1.free = True project_2.experiments['sim_lbco'].peak.asym_alpha_0.free = True project_2.experiments['sim_lbco'].peak.asym_alpha_1.free = True  project_2.analysis.fit() project_2.analysis.show_fit_results()  project_2.plot_meas_vs_calc(expt_name='sim_lbco', d_spacing=True, x_min=1.35, x_max=1.40) <pre>Using experiment \ud83d\udd2c 'sim_lbco' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 4.92 2 20 4.51 8.3% \u2193 3 327 4.49 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 4.49 at iteration 326\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 5.68 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 4.49\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.67%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 4.91%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.13%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8922 3.8915 0.0003 \u00c5 0.02 % \u2193 2 sim_lbco linked_phases lbco scale 4.8705 4.8295 0.0465 0.84 % \u2193 3 sim_lbco peak gauss_sigma_0 87503.6603 90223.6773 15782.1219 \u00b5s\u00b2 3.11 % \u2191 4 sim_lbco peak gauss_sigma_1 -66953.2238 -80933.7029 19529.4986 \u00b5s/\u212b 20.88 % \u2191 5 sim_lbco peak gauss_sigma_2 16276.4795 21634.7078 6015.0274 \u00b5s\u00b2/\u212b\u00b2 32.92 % \u2191 6 sim_lbco peak mix_beta_0 0.0008 0.0023 0.0005 deg 193.55 % \u2191 7 sim_lbco peak mix_beta_1 0.0190 0.0124 0.0021 deg 34.83 % \u2193 8 sim_lbco peak asym_alpha_0 -0.0066 -0.0048 0.0017 28.16 % \u2193 9 sim_lbco peak asym_alpha_1 0.0159 0.0137 0.0023 13.62 % \u2193 10 sim_lbco background 1 y 0.2745 0.2750 0.0479 0.18 % \u2191 11 sim_lbco background 2 y 0.2586 0.2606 0.0098 0.76 % \u2191 12 sim_lbco background 3 y 0.2592 0.2592 0.0064 0.03 % \u2193 13 sim_lbco background 4 y 0.2412 0.2439 0.0050 1.12 % \u2191 14 sim_lbco background 5 y 0.2455 0.2458 0.0035 0.09 % \u2191 15 sim_lbco background 6 y 0.2379 0.2387 0.0040 0.35 % \u2191 16 sim_lbco background 7 y 0.2092 0.2084 0.0146 0.35 % \u2193 <p>Hint:</p> <p>While the fit is now significantly better, there are still some unexplained peaks in the diffraction pattern. These peaks are not accounted for by the LBCO phase. For example, if you zoom in on the region around 1.6 \u00c5 (or 95,000 \u03bcs), you will notice that the rightmost peak is not explained by the LBCO phase at all.</p> <p>Solution:</p> In\u00a0[47]: Copied! <pre>project_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=1.53, x_max=1.7, d_spacing=True)\n</pre> project_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=1.53, x_max=1.7, d_spacing=True) <p>Hint:</p> <p>Consider the following options:</p> <ol> <li>The LBCO phase is not correctly modeled.</li> <li>The LBCO phase is not the only phase present in the sample.</li> <li>The data reduction process introduced artifacts.</li> <li>The studied sample is not LBCO, but rather a different phase.</li> </ol> <p>Solution:</p> <ol> <li>\u274c In principle, this could be the case, as sometimes the presence of extra peaks in the diffraction pattern can indicate lower symmetry than the one used in the model, or that the model is not complete. However, in this case, the LBCO phase is correctly modeled based on the CIF data.</li> <li>\u2705 The unexplained peaks are due to the presence of an impurity phase in the sample, which is not included in the current model.</li> <li>\u274c The data reduction process is not likely to introduce such specific peaks, as it is tested and verified in the previous part of the notebook.</li> <li>\u274c This could also be the case in real experiments, but in this case, we know that the sample is LBCO, as it was simulated based on the CIF data.</li> </ol> <p>Hint:</p> <p>Check the positions of the unexplained peaks in the diffraction pattern. Compare them with the known diffraction patterns in the previous part of the notebook.</p> <p>Solution:</p> <p>The unexplained peaks are likely due to the presence of a small amount of Si in the LBCO sample. In real experiments, it might happen, e.g., because the sample holder was not cleaned properly after the Si experiment.</p> <p>You can visalize both the patterns of the Si and LBCO phases to confirm this hypothesis.</p> In\u00a0[48]: Copied! <pre>project_1.plot_meas_vs_calc(expt_name='sim_si', x_min=1, x_max=1.7, d_spacing=True)\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=1, x_max=1.7, d_spacing=True)\n</pre> project_1.plot_meas_vs_calc(expt_name='sim_si', x_min=1, x_max=1.7, d_spacing=True) project_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=1, x_max=1.7, d_spacing=True) <p>Hint:</p> <p>You can use the same approach as in the previous part of the notebook, but this time you need to create a sample model for Si and link it to the LBCO experiment.</p> <p>Solution:</p> In\u00a0[49]: Copied! <pre># Set Space Group\nproject_2.sample_models.add(name='si')\nproject_2.sample_models['si'].space_group.name_h_m = 'F d -3 m'\nproject_2.sample_models['si'].space_group.it_coordinate_system_code = '2'\n\n# Set Lattice Parameters\nproject_2.sample_models['si'].cell.length_a = 5.43\n\n# Set Atom Sites\nproject_2.sample_models['si'].atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.89,\n)\n\n# Assign Sample Model to Experiment\nproject_2.experiments['sim_lbco'].linked_phases.add(id='si', scale=1.0)\n</pre> # Set Space Group project_2.sample_models.add(name='si') project_2.sample_models['si'].space_group.name_h_m = 'F d -3 m' project_2.sample_models['si'].space_group.it_coordinate_system_code = '2'  # Set Lattice Parameters project_2.sample_models['si'].cell.length_a = 5.43  # Set Atom Sites project_2.sample_models['si'].atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.89, )  # Assign Sample Model to Experiment project_2.experiments['sim_lbco'].linked_phases.add(id='si', scale=1.0) <p>Hint:</p> <p>You can use the <code>plot_meas_vs_calc</code> method of the project to visualize the patterns. Then, set the <code>free</code> attribute of the <code>scale</code> parameter of the Si phase to <code>True</code> to allow the fitting process to adjust the scale factor.</p> <p>Solution:</p> In\u00a0[50]: Copied! <pre># Before optimizing the parameters, we can visualize the measured\n# diffraction pattern and the calculated diffraction pattern based on\n# the two phases: LBCO and Si.\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco')\n\n# As you can see, the calculated pattern is now the sum of both phases,\n# and Si peaks are visible in the calculated pattern. However, their\n# intensities are much too high. Therefore, we need to refine the scale\n# factor of the Si phase.\nproject_2.experiments['sim_lbco'].linked_phases['si'].scale.free = True\n\n# Now we can perform the fit with both phases included.\nproject_2.analysis.fit()\nproject_2.analysis.show_fit_results()\n\n# Let's plot the measured diffraction pattern and the calculated\n# diffraction pattern both for the full range and for a zoomed-in region\n# around the previously unexplained peak near 95,000 \u03bcs. The calculated\n# pattern will be the sum of the two phases.\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco')\nproject_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=88000, x_max=101000)\n</pre> # Before optimizing the parameters, we can visualize the measured # diffraction pattern and the calculated diffraction pattern based on # the two phases: LBCO and Si. project_2.plot_meas_vs_calc(expt_name='sim_lbco')  # As you can see, the calculated pattern is now the sum of both phases, # and Si peaks are visible in the calculated pattern. However, their # intensities are much too high. Therefore, we need to refine the scale # factor of the Si phase. project_2.experiments['sim_lbco'].linked_phases['si'].scale.free = True  # Now we can perform the fit with both phases included. project_2.analysis.fit() project_2.analysis.show_fit_results()  # Let's plot the measured diffraction pattern and the calculated # diffraction pattern both for the full range and for a zoomed-in region # around the previously unexplained peak near 95,000 \u03bcs. The calculated # pattern will be the sum of the two phases. project_2.plot_meas_vs_calc(expt_name='sim_lbco') project_2.plot_meas_vs_calc(expt_name='sim_lbco', x_min=88000, x_max=101000) <pre>Using experiment \ud83d\udd2c 'sim_lbco' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 2254.38 2 21 1.56 99.9% \u2193 3 39 1.54 1.5% \u2193 4 688 1.54 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.54 at iteration 687\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 14.06 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.54\n</pre> <pre>\ud83d\udccf R-factor (Rf): 4.64%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 4.15%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 3.67%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8915 3.8913 0.0002 \u00c5 0.01 % \u2193 2 sim_lbco linked_phases lbco scale 4.8295 4.8548 0.0274 0.52 % \u2191 3 sim_lbco linked_phases si scale 1.0000 0.0373 0.0014 96.27 % \u2193 4 sim_lbco peak gauss_sigma_0 90223.6773 89477.6733 9441.8847 \u00b5s\u00b2 0.83 % \u2193 5 sim_lbco peak gauss_sigma_1 -80933.7029 -73469.3179 11867.0173 \u00b5s/\u212b 9.22 % \u2193 6 sim_lbco peak gauss_sigma_2 21634.7078 18331.8705 3625.2100 \u00b5s\u00b2/\u212b\u00b2 15.27 % \u2193 7 sim_lbco peak mix_beta_0 0.0023 0.0015 0.0003 deg 33.08 % \u2193 8 sim_lbco peak mix_beta_1 0.0124 0.0154 0.0012 deg 24.45 % \u2191 9 sim_lbco peak asym_alpha_0 -0.0048 -0.0071 0.0010 49.74 % \u2191 10 sim_lbco peak asym_alpha_1 0.0137 0.0173 0.0014 26.55 % \u2191 11 sim_lbco background 1 y 0.2750 0.2780 0.0281 1.10 % \u2191 12 sim_lbco background 2 y 0.2606 0.2515 0.0057 3.48 % \u2193 13 sim_lbco background 3 y 0.2592 0.2518 0.0038 2.85 % \u2193 14 sim_lbco background 4 y 0.2439 0.2417 0.0029 0.89 % \u2193 15 sim_lbco background 5 y 0.2458 0.2426 0.0021 1.29 % \u2193 16 sim_lbco background 6 y 0.2387 0.2220 0.0025 7.00 % \u2193 17 sim_lbco background 7 y 0.2084 0.2388 0.0086 14.56 % \u2191 <p>All previously unexplained peaks are now accounted for in the pattern, and the fit is improved. Some discrepancies in the peak intensities remain, but further improvements would require more advanced data reduction and analysis, which are beyond the scope of this school.</p> <p>To review the analysis results, you can generate and print a summary report using the <code>show_report()</code> method, as demonstrated in the cell below. The report includes parameters related to the sample model and the experiment, such as the refined unit cell parameter <code>a</code> of LBCO.</p> <p>Information about the crystal or magnetic structure, along with experimental details, fitting quality, and other relevant data, is often submitted to crystallographic journals as part of a scientific publication. It can also be deposited in crystallographic databases when relevant.</p> In\u00a0[51]: Copied! <pre>project_2.summary.show_report()\n</pre> project_2.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>La0.5Ba0.5CoO3 Fit\n</pre> <pre>Description\n</pre> <pre>Fitting simulated powder diffraction pattern of\nLa0.5Ba0.5CoO3.\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 lbco\n</pre> <pre>Space group\n</pre> <pre>P m -3 m\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 3.89125 2 b 3.89125 3 c 3.89125 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 La La 0.00000 0.00000 0.00000 0.50000 0.95000 2 Ba Ba 0.00000 0.00000 0.00000 0.50000 0.95000 3 Co Co 0.50000 0.50000 0.50000 1.00000 0.80000 4 O O 0.00000 0.50000 0.50000 1.00000 1.66000 <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 si\n</pre> <pre>Space group\n</pre> <pre>F d -3 m\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 5.43000 2 b 5.43000 3 c 5.43000 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 Si Si 0.12500 0.12500 0.12500 1.00000 0.89000 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c sim_lbco\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, time-of-flight\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT_IKEDA_CARPENTER\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 1.54 <p>Finally, we save the project to disk to preserve the current state of the analysis.</p> In\u00a0[52]: Copied! <pre>project_2.save_as(dir_path='powder_diffraction_LBCO_Si')\n</pre> project_2.save_as(dir_path='powder_diffraction_LBCO_Si') <pre>Saving project \ud83d\udce6 'main' to\n</pre> <pre>/Users/runner/work/diffraction-lib/diffraction-lib/tutorials/powder_diffraction_LBCO_Si\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 si.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 sim_lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre>"},{"location":"tutorials/ed-13/#fitting-powder-diffraction-data","title":"Fitting Powder Diffraction data\u00b6","text":"<p>This notebook guides you through the Rietveld refinement of crystal structures using simulated powder diffraction data. It consists of two parts:</p> <ul> <li>Introduction: A simple reference fit using silicon (Si) crystal structure.</li> <li>Exercise: A more complex fit using La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO) crystal structure.</li> </ul>"},{"location":"tutorials/ed-13/#import-library","title":"\ud83d\udee0\ufe0f Import Library\u00b6","text":"<p>We start by importing the necessary library for the analysis. In this notebook, we use the EasyDiffraction library. As mentioned in the introduction to EasyScience, EasyDiffraction is built on that framework and offers a high-level interface focused specifically for diffraction analysis.</p> <p>This notebook is self-contained and designed for hands-on learning. However, if you're interested in exploring more advanced features or learning about additional capabilities of the EasyDiffraction library, please refer to the official documentation: https://docs.easydiffraction.org/lib</p> <p>Depending on your requirements, you may choose to import only specific classes. However, for the sake of simplicity in this notebook, we will import the entire library.</p>"},{"location":"tutorials/ed-13/#introduction-simple-reference-fit-si","title":"\ud83d\udcd8 Introduction: Simple Reference Fit \u2013 Si\u00b6","text":"<p>Before diving into the more complex fitting exercise with the La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO) crystal structure, let's start with a simpler example using the silicon (Si) crystal structure. This will help us understand the basic concepts and steps involved in fitting a crystal structure using powder diffraction data.</p> <p>For this part of the notebook, we will use the powder diffraction data previously simulated using the Si crystal structure.</p>"},{"location":"tutorials/ed-13/#create-a-project-reference","title":"\ud83d\udce6 Create a Project \u2013 'reference'\u00b6","text":"<p>In EasyDiffraction, a project serves as a container for all information related to the analysis of a specific experiment or set of experiments. It enables you to organize your data, experiments, sample models, and fitting parameters in a structured manner. You can think of it as a folder containing all the essential details about your analysis. The project also allows us to visualize both the measured and calculated diffraction patterns, among other things.</p>"},{"location":"tutorials/ed-13/#create-an-experiment","title":"\ud83d\udd2c Create an Experiment\u00b6","text":"<p>An experiment represents a specific diffraction measurement performed on a specific sample using a particular instrument. It contains details about the measured data, instrument parameters, and other relevant information.</p>"},{"location":"tutorials/ed-13/#inspect-measured-data","title":"Inspect Measured Data\u00b6","text":"<p>After creating the experiment, we can examine the measured data. The measured data consists of a diffraction pattern having time-of-flight (TOF) values and corresponding intensities. The TOF values are given in microseconds (\u03bcs), and the intensities are in arbitrary units.</p> <p>The data is stored in XYE format, a simple text format containing three columns: TOF, intensity, and intensity error (if available).</p>"},{"location":"tutorials/ed-13/#set-instrument-parameters","title":"Set Instrument Parameters\u00b6","text":"<p>After the experiment is created and measured data is loaded, we need to set the instrument parameters.</p> <p>In this type of experiment, the instrument parameters define how the measured data is converted between d-spacing and time-of-flight (TOF) during the data reduction process as well as the angular position of the detector. So, we put values based on those from the reduction. These values can be found in the header of the corresponding .XYE file. Their names are <code>two_theta</code> and <code>DIFC</code>, which stand for the two-theta angle and the linear conversion factor from d-spacing to TOF, respectively.</p> <p>You can set them manually, but it is more convenient to use the <code>get_value_from_xye_header</code> function from the EasyDiffraction library.</p>"},{"location":"tutorials/ed-13/#set-peak-profile-parameters","title":"Set Peak Profile Parameters\u00b6","text":"<p>The next set of parameters is needed to define the peak profile used in the fitting process. The peak profile describes the shape of the diffraction peaks. They include parameters for the broadening and asymmetry of the peaks.</p> <p>There are several commonly used peak profile functions:</p> <ul> <li>Gaussian: Describes peaks with a symmetric bell-shaped curve, often used when instrumental broadening dominates. Click for more details.</li> <li>Lorentzian: Produces narrower central peaks with longer tails, frequently used to model size broadening effects. Click for more details.</li> <li>Pseudo-Voigt: A linear combination of Gaussian and Lorentzian components, providing flexibility to represent real diffraction peaks. Click for more details.</li> <li>Pseudo-Voigt convoluted with Ikeda-Carpenter: Incorporates the asymmetry introduced by the neutron pulse shape in time-of-flight instruments. This is a common choice for TOF neutron powder diffraction data. Click for more details.</li> </ul> <p>Here, we use a pseudo-Voigt peak profile function with Ikeda-Carpenter asymmetry.</p> <p>The parameter values are typically determined experimentally on the same instrument and under the same configuration as the data being analyzed, using measurements of a standard sample. In our case, the Si sample serves as this standard reference. We will refine the peak profile parameters here, and these refined values will be used as starting points for the more complex fit in the next part of the notebook. For this initial fit, we will provide reasonable physical guesses as starting values.</p>"},{"location":"tutorials/ed-13/#set-background","title":"Set Background\u00b6","text":"<p>The background of the diffraction pattern represents the portion of the pattern that is not related to the crystal structure of the sample. It's rather represents noise and other sources of scattering that can affect the measured intensities. This includes contributions from the instrument, the sample holder, the sample environment, and other sources of incoherent scattering.</p> <p>The background can be modeled in various ways. In this example, we will use a simple line segment background, which is a common approach for powder diffraction data. The background intensity at any point is defined by linear interpolation between neighboring points. The background points are selected to span the range of the diffraction pattern while avoiding the peaks.</p> <p>We will add several background points at specific TOF values (in \u03bcs) and corresponding intensity values. These points are chosen to represent the background level in the diffraction pattern free from any peaks.</p> <p>The background points are added using the <code>add</code> method of the <code>background</code> object. The <code>x</code> parameter represents the TOF value, and the <code>y</code> parameter represents the intensity value at that TOF.</p> <p>Let's set all the background points at a constant value of 0.01, which can be roughly estimated by the eye, and we will refine them later during the fitting process.</p>"},{"location":"tutorials/ed-13/#create-a-sample-model-si","title":"\ud83e\udde9 Create a Sample Model \u2013 Si\u00b6","text":"<p>After setting up the experiment, we need to create a sample model that describes the crystal structure of the sample being analyzed.</p> <p>In this case, we will create a sample model for silicon (Si) with a cubic crystal structure. The sample model contains information about the space group, lattice parameters, atomic positions of the atoms in the unit cell, atom types, occupancies and atomic displacement parameters. The sample model is essential for the fitting process, as it is used to calculate the expected diffraction pattern.</p> <p>EasyDiffraction refines the crystal structure of the sample, but does not solve it. Therefore, we need a good starting point with reasonable structural parameters.</p> <p>Here, we define the Si structure as a cubic structure. As this is a cubic structure, we only need to define the single lattice parameter, which is the length of the unit cell edge. The Si crystal structure has a single atom in the unit cell, which is located at the origin (0, 0, 0) of the unit cell. The symmetry of this site is defined by the Wyckoff letter 'a'. The atomic displacement parameter defines the thermal vibrations of the atoms in the unit cell and is presented as an isotropic parameter (B_iso).</p> <p>Sometimes, the initial crystal structure parameters can be obtained from one of the crystallographic databases, like for example the Crystallography Open Database (COD). In this case, we use the COD entry for silicon as a reference for the initial crystal structure model: https://www.crystallography.net/cod/4507226.html</p> <p>Usually, the crystal structure parameters are provided in a CIF file format, which is a standard format for crystallographic data. An example of a CIF file for silicon is shown below. The CIF file contains the space group information, unit cell parameters, and atomic positions.</p>"},{"location":"tutorials/ed-13/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-13/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-13/#set-lattice-parameters","title":"Set Lattice Parameters\u00b6","text":""},{"location":"tutorials/ed-13/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-13/#assign-sample-model-to-experiment","title":"\ud83d\udd17 Assign Sample Model to Experiment\u00b6","text":"<p>Now we need to assign, or link, this sample model to the experiment created above. This linked crystallographic phase will be used to calculate the expected diffraction pattern based on the crystal structure defined in the sample model.</p>"},{"location":"tutorials/ed-13/#analyze-and-fit-the-data","title":"\ud83d\ude80 Analyze and Fit the Data\u00b6","text":"<p>After setting up the experiment and sample model, we can now analyze the measured diffraction pattern and perform the fit. Building on the analogies from the EasyScience library and the previous notebooks, we can say that all the parameters we introduced earlier \u2014 those defining the sample model (crystal structure parameters) and the experiment (instrument, background, and peak profile parameters) \u2014 together form the complete set of parameters that can be refined during the fitting process.</p> <p>Unlike in the previous analysis notebooks, we will not create a math_model object here. The mathematical model used to calculate the expected diffraction pattern is already defined in the library and will be applied automatically during the fitting process.</p>"},{"location":"tutorials/ed-13/#set-fit-parameters","title":"Set Fit Parameters\u00b6","text":"<p>To perform the fit, we need to specify the refinement parameters. These are the parameters that will be adjusted during the fitting process to minimize the difference between the measured and calculated diffraction patterns. This is done by setting the <code>free</code> attribute of the corresponding parameters to <code>True</code>.</p> <p>Note: setting <code>param.free = True</code> is equivalent to using <code>param.fixed = False</code> in the EasyScience library.</p> <p>We will refine the scale factor of the Si phase, the intensities of the background points as well as the peak profile parameters. The structure parameters of the Si phase will not be refined, as this sample is considered a reference sample with known parameters.</p>"},{"location":"tutorials/ed-13/#show-free-parameters","title":"Show Free Parameters\u00b6","text":"<p>We can check which parameters are free to be refined by calling the <code>show_free_params</code> method of the <code>analysis</code> object of the project.</p>"},{"location":"tutorials/ed-13/#visualize-diffraction-patterns","title":"Visualize Diffraction Patterns\u00b6","text":"<p>Before performing the fit, we can visually compare the measured diffraction pattern with the calculated diffraction pattern based on the initial parameters of the sample model and the instrument. This provides an indication of how well the initial parameters match the measured data. The <code>plot_meas_vs_calc</code> method of the project allows this comparison.</p>"},{"location":"tutorials/ed-13/#run-fitting","title":"Run Fitting\u00b6","text":"<p>We can now perform the fit using the <code>fit</code> method of the <code>analysis</code> object of the project.</p>"},{"location":"tutorials/ed-13/#check-fit-results","title":"Check Fit Results\u00b6","text":"<p>You can see that the agreement between the measured and calculated diffraction patterns is now much improved and that the intensities of the calculated peaks align much better with the measured peaks. To check the quality of the fit numerically, we can look at the goodness-of-fit \u03c7\u00b2 value and the reliability R-factors. The \u03c7\u00b2 value is a measure of how well the calculated diffraction pattern matches the measured pattern, and it is calculated as the sum of the squared differences between the measured and calculated intensities, divided by the number of data points. Ideally, the \u03c7\u00b2 value should be close to 1, indicating a good fit.</p>"},{"location":"tutorials/ed-13/#visualize-fit-results","title":"Visualize Fit Results\u00b6","text":"<p>After the fit is completed, we can plot the comparison between the measured and calculated diffraction patterns again to see how well the fit improved the agreement between the two. The calculated diffraction pattern is now based on the refined parameters.</p>"},{"location":"tutorials/ed-13/#tof-vs-d-spacing","title":"TOF vs d-spacing\u00b6","text":"<p>The diffraction pattern is typically analyzed and plotted in the time-of-flight (TOF) axis, which represents the time it takes for neutrons to travel from the sample to the detector. However, it is sometimes more convenient to visualize the diffraction pattern in the d-spacing axis, which represents the distance between planes in the crystal lattice.</p> <p>The conversion from d-spacing to TOF was already introduced in the data reduction notebook. As a reminder, the two are related through the instrument calibration parameters according to the equation:</p> <p>$$ \\text{TOF} = \\text{offset} + \\text{linear} \\cdot d + \\text{quad} \\cdot d^{2}, $$</p> <p>where <code>offset</code>, <code>linear</code>, and <code>quad</code> are calibration parameters.</p> <p>In our case, only the <code>linear</code> term is used (the <code>calib_d_to_tof_linear</code> parameter we set earlier). The <code>offset</code> and <code>quad</code> terms were not part of the data reduction and are therefore set to 0 by default.</p> <p>The <code>plot_meas_vs_calc</code> method of the project allows us to plot the measured and calculated diffraction patterns in the d-spacing axis by setting the <code>d_spacing</code> parameter to <code>True</code>.</p>"},{"location":"tutorials/ed-13/#save-project","title":"Save Project\u00b6","text":"<p>Before moving on, we can save the project to disk for later use. This will preserve the entire project structure, including experiments, sample models, and fitting results. The project is saved into a directory specified by the <code>dir_path</code> attribute of the project object.</p>"},{"location":"tutorials/ed-13/#exercise-complex-fit-lbco","title":"\ud83d\udcaa Exercise: Complex Fit \u2013 LBCO\u00b6","text":"<p>Now that you have a basic understanding of the fitting process, we will undertake a more complex fit of the La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO) crystal structure using simulated powder diffraction data from the data reduction notebook.</p> <p>You can use the same approach as in the previous part of the notebook, but this time we will refine a more complex crystal structure LBCO with multiple atoms in the unit cell.</p>"},{"location":"tutorials/ed-13/#exercise-1-create-a-project","title":"\ud83d\udce6 Exercise 1: Create a Project\u00b6","text":"<p>Create a new project for the LBCO fit.</p>"},{"location":"tutorials/ed-13/#exercise-2-define-an-experiment","title":"\ud83d\udd2c Exercise 2: Define an Experiment\u00b6","text":""},{"location":"tutorials/ed-13/#exercise-21-create-an-experiment","title":"Exercise 2.1: Create an Experiment\u00b6","text":"<p>Create an experiment within the new project and load the reduced diffraction pattern for LBCO.</p>"},{"location":"tutorials/ed-13/#exercise-21-inspect-measured-data","title":"Exercise 2.1: Inspect Measured Data\u00b6","text":"<p>Check the measured data of the LBCO experiment. Are there any peaks with the shape similar to those excluded in the Si fit? If so, exclude them from this analysis as well.</p>"},{"location":"tutorials/ed-13/#exercise-22-set-instrument-parameters","title":"Exercise 2.2: Set Instrument Parameters\u00b6","text":"<p>Set the instrument parameters for the LBCO experiment.</p>"},{"location":"tutorials/ed-13/#exercise-23-set-peak-profile-parameters","title":"Exercise 2.3: Set Peak Profile Parameters\u00b6","text":"<p>Set the peak profile parameters for the LBCO experiment.</p>"},{"location":"tutorials/ed-13/#exercise-24-set-background","title":"Exercise 2.4: Set Background\u00b6","text":"<p>Set the background points for the LBCO experiment. What would you suggest as the initial intensity value for the background points?</p>"},{"location":"tutorials/ed-13/#exercise-3-define-a-sample-model-lbco","title":"\ud83e\udde9 Exercise 3: Define a Sample Model \u2013 LBCO\u00b6","text":"<p>The LBSO structure is not as simple as the Si model, as it contains multiple atoms in the unit cell. It is not in COD, so we give you the structural parameters in CIF format to create the sample model.</p> <p>Note that those parameters are not necessarily the most accurate ones, but they are a good starting point for the fit. The aim of the study is to refine the LBCO lattice parameters.</p>"},{"location":"tutorials/ed-13/#exercise-31-create-sample-model","title":"Exercise 3.1: Create Sample Model\u00b6","text":"<p>Add a sample model for LBCO to the project. The sample model parameters will be set in the next exercises.</p>"},{"location":"tutorials/ed-13/#exercise-32-set-space-group","title":"Exercise 3.2: Set Space Group\u00b6","text":"<p>Set the space group for the LBCO sample model.</p>"},{"location":"tutorials/ed-13/#exercise-33-set-lattice-parameters","title":"Exercise 3.3: Set Lattice Parameters\u00b6","text":"<p>Set the lattice parameters for the LBCO sample model.</p>"},{"location":"tutorials/ed-13/#exercise-34-set-atom-sites","title":"Exercise 3.4: Set Atom Sites\u00b6","text":"<p>Set the atom sites for the LBCO sample model.</p>"},{"location":"tutorials/ed-13/#exercise-4-assign-sample-model-to-experiment","title":"\ud83d\udd17 Exercise 4: Assign Sample Model to Experiment\u00b6","text":"<p>Now assign the LBCO sample model to the experiment created above.</p>"},{"location":"tutorials/ed-13/#exercise-5-analyze-and-fit-the-data","title":"\ud83d\ude80 Exercise 5: Analyze and Fit the Data\u00b6","text":""},{"location":"tutorials/ed-13/#exercise-51-set-fit-parameters","title":"Exercise 5.1: Set Fit Parameters\u00b6","text":"<p>Select the initial set of parameters to be refined during the fitting process.</p>"},{"location":"tutorials/ed-13/#exercise-52-run-fitting","title":"Exercise 5.2: Run Fitting\u00b6","text":"<p>Visualize the measured and calculated diffraction patterns before fitting and then run the fitting process.</p>"},{"location":"tutorials/ed-13/#exercise-53-find-the-misfit-in-the-fit","title":"Exercise 5.3: Find the Misfit in the Fit\u00b6","text":"<p>Visualize the measured and calculated diffraction patterns after the fit. As you can see, the fit shows noticeable discrepancies. If you zoom in on different regions of the pattern, you will observe that all the calculated peaks are shifted to the left.</p> <p>What could be the reason for the misfit?</p>"},{"location":"tutorials/ed-13/#exercise-54-refine-the-lbco-lattice-parameter","title":"Exercise 5.4: Refine the LBCO Lattice Parameter\u00b6","text":"<p>To improve the fit, refine the lattice parameters of the LBCO phase.</p>"},{"location":"tutorials/ed-13/#exercise-55-visualize-the-fit-results-in-d-spacing","title":"Exercise 5.5: Visualize the Fit Results in d-spacing\u00b6","text":"<p>Plot measured vs calculated diffraction patterns in d-spacing instead of TOF.</p>"},{"location":"tutorials/ed-13/#exercise-56-refine-the-peak-profile-parameters","title":"Exercise 5.6: Refine the Peak Profile Parameters\u00b6","text":"<p>As you can see, the fit is now relatively good and the peak positions are much closer to the measured data.</p> <p>The peak profile parameters were not refined, and their starting values were set based on the previous fit of the Si standard sample. Although these starting values are reasonable and provide a good starting point for the fit, they are not necessarily optimal for the LBCO phase. This can be seen while inspecting the individual peaks in the diffraction pattern. For example, the calculated curve does not perfectly describe the peak at about 1.38 \u00c5, as can be seen below:</p>"},{"location":"tutorials/ed-13/#exercise-57-find-undefined-features","title":"Exercise 5.7: Find Undefined Features\u00b6","text":"<p>After refining the lattice parameter and the peak profile parameters, the fit is significantly improved, but inspect the diffraction pattern again. Are you noticing anything undefined?</p>"},{"location":"tutorials/ed-13/#exercise-58-identify-the-cause-of-the-unexplained-peaks","title":"Exercise 5.8: Identify the Cause of the Unexplained Peaks\u00b6","text":"<p>Analyze the residual peaks that remain after refining the LBCO phase and the peak-profile parameters. Based on their positions and characteristics, decide which potential cause best explains the misfit.</p>"},{"location":"tutorials/ed-13/#exercise-59-identify-the-impurity-phase","title":"Exercise 5.9: Identify the impurity phase\u00b6","text":"<p>Use the positions of the unexplained peaks to identify the most likely secondary phase present in the sample.</p>"},{"location":"tutorials/ed-13/#exercise-510-create-a-second-sample-model-si-as-impurity","title":"Exercise 5.10: Create a Second Sample Model \u2013 Si as Impurity\u00b6","text":"<p>Create a second sample model for the Si phase, which is the impurity phase identified in the previous step. Link this sample model to the LBCO experiment.</p>"},{"location":"tutorials/ed-13/#exercise-511-refine-the-scale-of-the-si-phase","title":"Exercise 5.11: Refine the Scale of the Si Phase\u00b6","text":"<p>Visualize the measured diffraction pattern and the calculated diffraction pattern. Check if the Si phase is contributing to the calculated diffraction pattern. Refine the scale factor of the Si phase to improve the fit.</p>"},{"location":"tutorials/ed-13/#final-remarks","title":"Final Remarks\u00b6","text":"<p>In this part of the notebook, you learned how to use EasyDiffraction to refine lattice parameters of a more complex crystal structure, La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO).</p> <p>In real experiments, you might also refine additional parameters, such as atomic positions, occupancies, and atomic displacement factors, to achieve an even better fit. For our purposes, we'll stop here, as the goal was to give you a starting point for analyzing more complex crystal structures with EasyDiffraction.</p>"},{"location":"tutorials/ed-13/#bonus","title":"\ud83c\udf81 Bonus\u00b6","text":"<p>Congratulations \u2014 you've now completed the diffraction data analysis part of the DMSC Summer School!</p> <p>If you'd like to keep exploring, the EasyDiffraction library offers many additional tutorials and examples on the official documentation site: \ud83d\udc49 https://docs.easydiffraction.org/lib/tutorials/</p> <p>Besides the Python package, EasyDiffraction also comes with a graphical user interface (GUI) that lets you perform similar analyses without writing code. To be fair, it's not quite feature-complete compared to the Python library yet \u2014 but we're working on it! \ud83d\udea7</p> <p>If you prefer a point-and-click interface over coding, the GUI provides a user-friendly way to analyze diffraction data. You can download it as a standalone application here: \ud83d\udc49 https://easydiffraction.org</p> <p>We'd love to hear your feedback on EasyDiffraction \u2014 both the library and the GUI! \ud83d\udcac</p>"},{"location":"tutorials/ed-2/","title":"LBCO quick code","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre>project = ed.Project()\n</pre> project = ed.Project() In\u00a0[4]: Copied! <pre>project.sample_models.add(name='lbco')\n</pre> project.sample_models.add(name='lbco') In\u00a0[5]: Copied! <pre>sample_model = project.sample_models['lbco']\n</pre> sample_model = project.sample_models['lbco'] In\u00a0[6]: Copied! <pre>sample_model.space_group.name_h_m = 'P m -3 m'\nsample_model.space_group.it_coordinate_system_code = '1'\n</pre> sample_model.space_group.name_h_m = 'P m -3 m' sample_model.space_group.it_coordinate_system_code = '1' In\u00a0[7]: Copied! <pre>sample_model.cell.length_a = 3.88\n</pre> sample_model.cell.length_a = 3.88 In\u00a0[8]: Copied! <pre>sample_model.atom_sites.add(\n    label='La',\n    type_symbol='La',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n    occupancy=0.5,\n)\nsample_model.atom_sites.add(\n    label='Ba',\n    type_symbol='Ba',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n    occupancy=0.5,\n)\nsample_model.atom_sites.add(\n    label='Co',\n    type_symbol='Co',\n    fract_x=0.5,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=0.5,\n)\nsample_model.atom_sites.add(\n    label='O',\n    type_symbol='O',\n    fract_x=0,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\n</pre> sample_model.atom_sites.add(     label='La',     type_symbol='La',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5,     occupancy=0.5, ) sample_model.atom_sites.add(     label='Ba',     type_symbol='Ba',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5,     occupancy=0.5, ) sample_model.atom_sites.add(     label='Co',     type_symbol='Co',     fract_x=0.5,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='b',     b_iso=0.5, ) sample_model.atom_sites.add(     label='O',     type_symbol='O',     fract_x=0,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='c',     b_iso=0.5, ) In\u00a0[9]: Copied! <pre>data_path = ed.download_data(id=3, destination='data')\n</pre> data_path = ed.download_data(id=3, destination='data') <pre>Getting data...\n</pre> <pre>Data #3: La0.5Ba0.5CoO3, HRPT (PSI), 300 K\n</pre> <pre>\u2705 Data #3 already present at 'data/ed-3.xye'. Keeping existing file.\n</pre> In\u00a0[10]: Copied! <pre>project.experiments.add(\n    name='hrpt',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='constant wavelength',\n    radiation_probe='neutron',\n)\n</pre> project.experiments.add(     name='hrpt',     data_path=data_path,     sample_form='powder',     beam_mode='constant wavelength',     radiation_probe='neutron', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'hrpt'. Number of data points: 3098\n</pre> In\u00a0[11]: Copied! <pre>experiment = project.experiments['hrpt']\n</pre> experiment = project.experiments['hrpt'] In\u00a0[12]: Copied! <pre>experiment.instrument.setup_wavelength = 1.494\nexperiment.instrument.calib_twotheta_offset = 0.6\n</pre> experiment.instrument.setup_wavelength = 1.494 experiment.instrument.calib_twotheta_offset = 0.6 In\u00a0[13]: Copied! <pre>experiment.peak.broad_gauss_u = 0.1\nexperiment.peak.broad_gauss_v = -0.1\nexperiment.peak.broad_gauss_w = 0.1\nexperiment.peak.broad_lorentz_y = 0.1\n</pre> experiment.peak.broad_gauss_u = 0.1 experiment.peak.broad_gauss_v = -0.1 experiment.peak.broad_gauss_w = 0.1 experiment.peak.broad_lorentz_y = 0.1 In\u00a0[14]: Copied! <pre>experiment.background.add(id='1', x=10, y=170)\nexperiment.background.add(id='2', x=30, y=170)\nexperiment.background.add(id='3', x=50, y=170)\nexperiment.background.add(id='4', x=110, y=170)\nexperiment.background.add(id='5', x=165, y=170)\n</pre> experiment.background.add(id='1', x=10, y=170) experiment.background.add(id='2', x=30, y=170) experiment.background.add(id='3', x=50, y=170) experiment.background.add(id='4', x=110, y=170) experiment.background.add(id='5', x=165, y=170) In\u00a0[15]: Copied! <pre>experiment.excluded_regions.add(id='1', start=0, end=5)\nexperiment.excluded_regions.add(id='2', start=165, end=180)\n</pre> experiment.excluded_regions.add(id='1', start=0, end=5) experiment.excluded_regions.add(id='2', start=165, end=180) In\u00a0[16]: Copied! <pre>experiment.linked_phases.add(id='lbco', scale=10.0)\n</pre> experiment.linked_phases.add(id='lbco', scale=10.0) In\u00a0[17]: Copied! <pre>sample_model.cell.length_a.free = True\n\nsample_model.atom_sites['La'].b_iso.free = True\nsample_model.atom_sites['Ba'].b_iso.free = True\nsample_model.atom_sites['Co'].b_iso.free = True\nsample_model.atom_sites['O'].b_iso.free = True\n</pre> sample_model.cell.length_a.free = True  sample_model.atom_sites['La'].b_iso.free = True sample_model.atom_sites['Ba'].b_iso.free = True sample_model.atom_sites['Co'].b_iso.free = True sample_model.atom_sites['O'].b_iso.free = True In\u00a0[18]: Copied! <pre>experiment.instrument.calib_twotheta_offset.free = True\n\nexperiment.peak.broad_gauss_u.free = True\nexperiment.peak.broad_gauss_v.free = True\nexperiment.peak.broad_gauss_w.free = True\nexperiment.peak.broad_lorentz_y.free = True\n\nexperiment.background['1'].y.free = True\nexperiment.background['2'].y.free = True\nexperiment.background['3'].y.free = True\nexperiment.background['4'].y.free = True\nexperiment.background['5'].y.free = True\n\nexperiment.linked_phases['lbco'].scale.free = True\n</pre> experiment.instrument.calib_twotheta_offset.free = True  experiment.peak.broad_gauss_u.free = True experiment.peak.broad_gauss_v.free = True experiment.peak.broad_gauss_w.free = True experiment.peak.broad_lorentz_y.free = True  experiment.background['1'].y.free = True experiment.background['2'].y.free = True experiment.background['3'].y.free = True experiment.background['4'].y.free = True experiment.background['5'].y.free = True  experiment.linked_phases['lbco'].scale.free = True In\u00a0[19]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 165.02 2 28 33.58 79.7% \u2193 3 45 10.82 67.8% \u2193 4 63 6.49 40.0% \u2193 5 81 3.35 48.4% \u2193 6 98 2.24 33.1% \u2193 7 116 1.91 14.7% \u2193 8 133 1.50 21.3% \u2193 9 150 1.45 3.6% \u2193 10 167 1.34 7.8% \u2193 11 185 1.29 3.4% \u2193 12 276 1.29 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.29 at iteration 275\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 13.25 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.29\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.65%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.30%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.47%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8800 3.8909 0.0000 \u00c5 0.28 % \u2191 2 lbco atom_site La b_iso 0.5000 0.5052 3231.4177 \u00c5\u00b2 1.04 % \u2191 3 lbco atom_site Ba b_iso 0.5000 0.5049 5252.0523 \u00c5\u00b2 0.97 % \u2191 4 lbco atom_site Co b_iso 0.5000 0.2370 0.0611 \u00c5\u00b2 52.60 % \u2193 5 lbco atom_site O b_iso 0.5000 1.3935 0.0167 \u00c5\u00b2 178.71 % \u2191 6 hrpt linked_phases lbco scale 10.0000 9.1351 0.0642 8.65 % \u2193 7 hrpt peak broad_gauss_u 0.1000 0.0816 0.0031 deg\u00b2 18.43 % \u2193 8 hrpt peak broad_gauss_v -0.1000 -0.1159 0.0067 deg\u00b2 15.93 % \u2191 9 hrpt peak broad_gauss_w 0.1000 0.1204 0.0033 deg\u00b2 20.45 % \u2191 10 hrpt peak broad_lorentz_y 0.1000 0.0844 0.0021 deg 15.55 % \u2193 11 hrpt instrument twotheta_offset 0.6000 0.6226 0.0010 deg 3.76 % \u2191 12 hrpt background 1 y 170.0000 168.5585 1.3671 0.85 % \u2193 13 hrpt background 2 y 170.0000 164.3357 0.9992 3.33 % \u2193 14 hrpt background 3 y 170.0000 166.8881 0.7388 1.83 % \u2193 15 hrpt background 4 y 170.0000 175.4006 0.6578 3.18 % \u2191 16 hrpt background 5 y 170.0000 174.2813 0.9105 2.52 % \u2191 In\u00a0[20]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)"},{"location":"tutorials/ed-2/#structure-refinement-lbco-hrpt","title":"Structure Refinement: LBCO, HRPT\u00b6","text":"<p>This minimalistic example is designed to show how Rietveld refinement of a crystal structure can be performed when both the sample model and experiment are defined directly in code. Only the experimentally measured data is loaded from an external file.</p> <p>For this example, constant-wavelength neutron powder diffraction data for La0.5Ba0.5CoO3 from HRPT at PSI is used.</p> <p>It does not contain any advanced features or options, and includes no comments or explanations\u2014these can be found in the other tutorials. Default values are used for all parameters if not specified. Only essential and self-explanatory code is provided.</p> <p>The example is intended for users who are already familiar with the EasyDiffraction library and want to quickly get started with a simple refinement. It is also useful for those who want to see what a refinement might look like in code. For a more detailed explanation of the code, please refer to the other tutorials.</p>"},{"location":"tutorials/ed-2/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-2/#step-1-define-project","title":"Step 1: Define Project\u00b6","text":""},{"location":"tutorials/ed-2/#step-2-define-sample-model","title":"Step 2: Define Sample Model\u00b6","text":""},{"location":"tutorials/ed-2/#step-3-define-experiment","title":"Step 3: Define Experiment\u00b6","text":""},{"location":"tutorials/ed-2/#step-4-perform-analysis","title":"Step 4: Perform Analysis\u00b6","text":""},{"location":"tutorials/ed-3/","title":"LBCO basic","text":"In\u00a0[2]: Copied! <pre>import easydiffraction as ed\n</pre> import easydiffraction as ed In\u00a0[3]: Copied! <pre>project = ed.Project(name='lbco_hrpt')\n</pre> project = ed.Project(name='lbco_hrpt') In\u00a0[4]: Copied! <pre>project.info.title = 'La0.5Ba0.5CoO3 at HRPT@PSI'\nproject.info.description = \"\"\"This project demonstrates a standard\nrefinement of La0.5Ba0.5CoO3, which crystallizes in a perovskite-type\nstructure, using neutron powder diffraction data collected in constant\nwavelength mode at the HRPT diffractometer (PSI).\"\"\"\n</pre> project.info.title = 'La0.5Ba0.5CoO3 at HRPT@PSI' project.info.description = \"\"\"This project demonstrates a standard refinement of La0.5Ba0.5CoO3, which crystallizes in a perovskite-type structure, using neutron powder diffraction data collected in constant wavelength mode at the HRPT diffractometer (PSI).\"\"\" In\u00a0[5]: Copied! <pre>project.info.show_as_cif()\n</pre> project.info.show_as_cif() <pre>Project \ud83d\udce6 'lbco_hrpt' info as CIF\n</pre> CIF 1 _project.id               lbco_hrpt 2 _project.title            'La0.5Ba0.5CoO3 at HRPT@PSI' 3 _project.description       4 ; 5 This project demonstrates a standard refinement of La0.5Ba0.5CoO3, which crystallizes in a perovskite-type structure, using neutron powder diffraction data collected in constant wavelength mode at the HRPT diffractometer (PSI). 6 ; 7 _project.created          '30 Dec 2025 21:53:50' 8 _project.last_modified    '30 Dec 2025 21:53:50' In\u00a0[6]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> <p>Show supported plotting engines.</p> In\u00a0[7]: Copied! <pre>project.plotter.show_supported_engines()\n</pre> project.plotter.show_supported_engines() <pre>Supported engines\n</pre> Engine Description 1 asciichartpy Console ASCII line charts 2 plotly Interactive browser-based graphing library <p>Show current plotting configuration.</p> In\u00a0[8]: Copied! <pre>project.plotter.show_config()\n</pre> project.plotter.show_config() <pre>Current plotter configuration\n</pre> Parameter Value 1 Plotting engine plotly 2 x-axis limits [-inf, inf] 3 Chart height 9 <p>Set plotting engine.</p> In\u00a0[9]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[10]: Copied! <pre>project.sample_models.add(name='lbco')\n</pre> project.sample_models.add(name='lbco') In\u00a0[11]: Copied! <pre>project.sample_models.show_names()\n</pre> project.sample_models.show_names() <pre>Defined sample models \ud83e\udde9\n</pre> <pre>['lbco']\n</pre> In\u00a0[12]: Copied! <pre>project.sample_models['lbco'].space_group.name_h_m = 'P m -3 m'\nproject.sample_models['lbco'].space_group.it_coordinate_system_code = '1'\n</pre> project.sample_models['lbco'].space_group.name_h_m = 'P m -3 m' project.sample_models['lbco'].space_group.it_coordinate_system_code = '1' In\u00a0[13]: Copied! <pre>project.sample_models['lbco'].cell.length_a = 3.88\n</pre> project.sample_models['lbco'].cell.length_a = 3.88 In\u00a0[14]: Copied! <pre>project.sample_models['lbco'].atom_sites.add(\n    label='La',\n    type_symbol='La',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n    occupancy=0.5,\n)\nproject.sample_models['lbco'].atom_sites.add(\n    label='Ba',\n    type_symbol='Ba',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n    occupancy=0.5,\n)\nproject.sample_models['lbco'].atom_sites.add(\n    label='Co',\n    type_symbol='Co',\n    fract_x=0.5,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=0.5,\n)\nproject.sample_models['lbco'].atom_sites.add(\n    label='O',\n    type_symbol='O',\n    fract_x=0,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\n</pre> project.sample_models['lbco'].atom_sites.add(     label='La',     type_symbol='La',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5,     occupancy=0.5, ) project.sample_models['lbco'].atom_sites.add(     label='Ba',     type_symbol='Ba',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5,     occupancy=0.5, ) project.sample_models['lbco'].atom_sites.add(     label='Co',     type_symbol='Co',     fract_x=0.5,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='b',     b_iso=0.5, ) project.sample_models['lbco'].atom_sites.add(     label='O',     type_symbol='O',     fract_x=0,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='c',     b_iso=0.5, ) In\u00a0[15]: Copied! <pre>project.sample_models['lbco'].show_as_cif()\n</pre> project.sample_models['lbco'].show_as_cif() <pre>Sample model \ud83e\udde9 'lbco' as cif\n</pre> CIF 1 data_lbco 2 3 _cell.length_a   3.8800 4 _cell.length_b   3.8800 5 _cell.length_c   3.8800 6 _cell.angle_alpha  90.0000 7 _cell.angle_beta  90.0000 8 _cell.angle_gamma  90.0000 9 10 _space_group.name_H-M_alt \"P m -3 m\" 11 _space_group.IT_coordinate_system_code        1 12 13 loop_ 14 _atom_site.label 15 _atom_site.type_symbol 16 _atom_site.fract_x 17 _atom_site.fract_y 18 _atom_site.fract_z 19 _atom_site.Wyckoff_letter 20 _atom_site.occupancy 21 _atom_site.B_iso_or_equiv 22 _atom_site.adp_type 23       La       La   0.0000   0.0000   0.0000        a   0.5000   0.5000     Biso 24       Ba       Ba   0.0000   0.0000   0.0000        a   0.5000   0.5000     Biso 25       Co       Co   0.5000   0.5000   0.5000        b   1.0000   0.5000     Biso 26        O        O   0.0000   0.5000   0.5000        c   1.0000   0.5000     Biso In\u00a0[16]: Copied! <pre>project.sample_models['lbco'].show_structure()\n</pre> project.sample_models['lbco'].show_structure() <pre>Sample model \ud83e\udde9 'lbco' structure view\n</pre> <pre>Not implemented yet.\n</pre> In\u00a0[17]: Copied! <pre>project.save()\n</pre> project.save() <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[18]: Copied! <pre>data_path = ed.download_data(id=3, destination='data')\n</pre> data_path = ed.download_data(id=3, destination='data') <pre>Getting data...\n</pre> <pre>Data #3: La0.5Ba0.5CoO3, HRPT (PSI), 300 K\n</pre> <pre>\u2705 Data #3 downloaded to 'data/ed-3.xye'\n</pre> In\u00a0[19]: Copied! <pre>project.experiments.add(\n    name='hrpt',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='constant wavelength',\n    radiation_probe='neutron',\n)\n</pre> project.experiments.add(     name='hrpt',     data_path=data_path,     sample_form='powder',     beam_mode='constant wavelength',     radiation_probe='neutron', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'hrpt'. Number of data points: 3098\n</pre> In\u00a0[20]: Copied! <pre>project.experiments.show_names()\n</pre> project.experiments.show_names() <pre>Defined experiments \ud83d\udd2c\n</pre> <pre>['hrpt']\n</pre> In\u00a0[21]: Copied! <pre>project.plot_meas(expt_name='hrpt')\n</pre> project.plot_meas(expt_name='hrpt') <pre>Warning: No linked phases defined. Returning empty pattern.\n</pre> In\u00a0[22]: Copied! <pre>project.experiments['hrpt'].instrument.setup_wavelength = 1.494\nproject.experiments['hrpt'].instrument.calib_twotheta_offset = 0.6\n</pre> project.experiments['hrpt'].instrument.setup_wavelength = 1.494 project.experiments['hrpt'].instrument.calib_twotheta_offset = 0.6 In\u00a0[23]: Copied! <pre>project.experiments['hrpt'].show_supported_peak_profile_types()\n</pre> project.experiments['hrpt'].show_supported_peak_profile_types() <pre>Supported peak profile types\n</pre> Peak profile type Description 1 pseudo-voigt Pseudo-Voigt profile 2 split pseudo-voigt Split pseudo-Voigt profile with empirical asymmetry correction. 3 thompson-cox-hastings Thompson-Cox-Hastings profile with FCJ asymmetry correction. <p>Show the current peak profile type.</p> In\u00a0[24]: Copied! <pre>project.experiments['hrpt'].show_current_peak_profile_type()\n</pre> project.experiments['hrpt'].show_current_peak_profile_type() <pre>Current peak profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT\n</pre> <p>Select the desired peak profile type.</p> In\u00a0[25]: Copied! <pre>project.experiments['hrpt'].peak_profile_type = 'pseudo-voigt'\n</pre> project.experiments['hrpt'].peak_profile_type = 'pseudo-voigt' <pre>Peak profile type for experiment 'hrpt' changed to\n</pre> <pre>pseudo-voigt\n</pre> <p>Modify default peak profile parameters.</p> In\u00a0[26]: Copied! <pre>project.experiments['hrpt'].peak.broad_gauss_u = 0.1\nproject.experiments['hrpt'].peak.broad_gauss_v = -0.1\nproject.experiments['hrpt'].peak.broad_gauss_w = 0.1\nproject.experiments['hrpt'].peak.broad_lorentz_x = 0\nproject.experiments['hrpt'].peak.broad_lorentz_y = 0.1\n</pre> project.experiments['hrpt'].peak.broad_gauss_u = 0.1 project.experiments['hrpt'].peak.broad_gauss_v = -0.1 project.experiments['hrpt'].peak.broad_gauss_w = 0.1 project.experiments['hrpt'].peak.broad_lorentz_x = 0 project.experiments['hrpt'].peak.broad_lorentz_y = 0.1 <p>Show supported background types.</p> In\u00a0[27]: Copied! <pre>project.experiments['hrpt'].show_supported_background_types()\n</pre> project.experiments['hrpt'].show_supported_background_types() <pre>Supported background types\n</pre> Background type Description 1 line-segment Linear interpolation between points 2 chebyshev polynomial Chebyshev polynomial background <p>Show current background type.</p> In\u00a0[28]: Copied! <pre>project.experiments['hrpt'].show_current_background_type()\n</pre> project.experiments['hrpt'].show_current_background_type() <pre>Current background type\n</pre> <pre>BackgroundTypeEnum.LINE_SEGMENT\n</pre> <p>Select the desired background type.</p> In\u00a0[29]: Copied! <pre>project.experiments['hrpt'].background_type = 'line-segment'\n</pre> project.experiments['hrpt'].background_type = 'line-segment' <pre>Background type for experiment 'hrpt' changed to\n</pre> <pre>line-segment\n</pre> <p>Add background points.</p> In\u00a0[30]: Copied! <pre>project.experiments['hrpt'].background.add(id='10', x=10, y=170)\nproject.experiments['hrpt'].background.add(id='30', x=30, y=170)\nproject.experiments['hrpt'].background.add(id='50', x=50, y=170)\nproject.experiments['hrpt'].background.add(id='110', x=110, y=170)\nproject.experiments['hrpt'].background.add(id='165', x=165, y=170)\n</pre> project.experiments['hrpt'].background.add(id='10', x=10, y=170) project.experiments['hrpt'].background.add(id='30', x=30, y=170) project.experiments['hrpt'].background.add(id='50', x=50, y=170) project.experiments['hrpt'].background.add(id='110', x=110, y=170) project.experiments['hrpt'].background.add(id='165', x=165, y=170) <p>Show current background points.</p> In\u00a0[31]: Copied! <pre>project.experiments['hrpt'].background.show()\n</pre> project.experiments['hrpt'].background.show() <pre>Line-segment background points\n</pre> X Intensity 1 10 170 2 30 170 3 50 170 4 110 170 5 165 170 In\u00a0[32]: Copied! <pre>project.experiments['hrpt'].linked_phases.add(id='lbco', scale=10.0)\n</pre> project.experiments['hrpt'].linked_phases.add(id='lbco', scale=10.0) In\u00a0[33]: Copied! <pre>project.experiments['hrpt'].show_as_cif()\n</pre> project.experiments['hrpt'].show_as_cif() <pre>Experiment \ud83d\udd2c 'hrpt' as cif\n</pre> CIF 1 data_hrpt 2 3 _expt_type.sample_form   powder 4 _expt_type.beam_mode \"constant wavelength\" 5 _expt_type.radiation_probe  neutron 6 _expt_type.scattering_type    bragg 7 8 _peak.broad_gauss_u   0.1000 9 _peak.broad_gauss_v  -0.1000 10 _peak.broad_gauss_w   0.1000 11 _peak.broad_lorentz_x   0.0000 12 _peak.broad_lorentz_y   0.1000 13 14 _instr.wavelength   1.4940 15 _instr.2theta_offset   0.6000 16 17 loop_ 18 _pd_phase_block.id 19 _pd_phase_block.scale 20     lbco  10.0000 21 22 23 24 loop_ 25 _pd_proc.2theta_scan 26 _pd_data.point_id 27 _pd_proc.d_spacing 28 _pd_meas.intensity_total 29 _pd_meas.intensity_total_su 30 _pd_calc.intensity_total 31 _pd_calc.intensity_bkg 32 _pd_data.refinement_status 33  10.0000        1   8.5709 167.0000  12.6000 172.3278 170.0000     incl 34  10.0500        2   8.5283 157.0000  12.5000 172.3086 170.0000     incl 35  10.1000        3   8.4862 187.0000  13.3000 172.2897 170.0000     incl 36  10.1500        4   8.4445 197.0000  14.0000 172.2711 170.0000     incl 37  10.2000        5   8.4032 164.0000  12.5000 172.2528 170.0000     incl 38  10.2500        6   8.3624 171.0000  13.0000 172.2347 170.0000     incl 39  10.3000        7   8.3219 190.0000  13.4000 172.2169 170.0000     incl 40  10.3500        8   8.2818 182.0000  13.5000 172.1994 170.0000     incl 41  10.4000        9   8.2421 166.0000  12.6000 172.1822 170.0000     incl 42  10.4500       10   8.2027 203.0000  14.3000 172.1652 170.0000     incl 43 ... 44 164.4000     3089   0.7540 202.0000  18.5000 172.6004 170.0000     incl 45 164.4500     3090   0.7539 178.0000  20.4000 172.5970 170.0000     incl 46 164.5000     3091   0.7539 153.0000  18.0000 172.5938 170.0000     incl 47 164.5500     3092   0.7538 197.0000  25.3000 172.5909 170.0000     incl 48 164.6000     3093   0.7538 153.0000  20.7000 172.5883 170.0000     incl 49 164.6500     3094   0.7538 173.0000  30.1000 172.5859 170.0000     incl 50 164.7000     3095   0.7537 187.0000  27.9000 172.5838 170.0000     incl 51 164.7500     3096   0.7537 175.0000  38.2000 172.5819 170.0000     incl 52 164.8000     3097   0.7536 168.0000  30.9000 172.5803 170.0000     incl 53 164.8500     3098   0.7536 109.0000  41.2000 172.5789 170.0000     incl 54 55 loop_ 56 _pd_background.id 57 _pd_background.line_segment_X 58 _pd_background.line_segment_intensity 59       10  10.0000 170.0000 60       30  30.0000 170.0000 61       50  50.0000 170.0000 62      110 110.0000 170.0000 63      165 165.0000 170.0000 In\u00a0[34]: Copied! <pre>project.save()\n</pre> project.save() <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[35]: Copied! <pre>project.analysis.show_supported_calculators()\n</pre> project.analysis.show_supported_calculators() <pre>Supported calculators\n</pre> Calculator Description 1 cryspy CrysPy library for crystallographic calculations 2 pdffit PDFfit2 library for pair distribution function calculations <p>Show current calculation engine.</p> In\u00a0[36]: Copied! <pre>project.analysis.show_current_calculator()\n</pre> project.analysis.show_current_calculator() <pre>Current calculator\n</pre> <pre>cryspy\n</pre> <p>Select the desired calculation engine.</p> In\u00a0[37]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[38]: Copied! <pre>project.plot_calc(expt_name='hrpt')\n</pre> project.plot_calc(expt_name='hrpt') In\u00a0[39]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[40]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[41]: Copied! <pre># project.analysis.show_all_params()\n</pre> # project.analysis.show_all_params() <p>Show all fittable parameters.</p> In\u00a0[42]: Copied! <pre>project.analysis.show_fittable_params()\n</pre> project.analysis.show_fittable_params() <pre>Fittable parameters for all sample models (\ud83e\udde9 data blocks)\n</pre> datablock category entry parameter value uncertainty units free 1 lbco cell length_a 3.88000 \u00c5 False 2 lbco cell length_b 3.88000 \u00c5 False 3 lbco cell length_c 3.88000 \u00c5 False 4 lbco cell angle_alpha 90.00000 deg False 5 lbco cell angle_beta 90.00000 deg False 6 lbco cell angle_gamma 90.00000 deg False 7 lbco atom_site La fract_x 0.00000 False 8 lbco atom_site La fract_y 0.00000 False 9 lbco atom_site La fract_z 0.00000 False 10 lbco atom_site La occupancy 0.50000 False 11 lbco atom_site La b_iso 0.50000 \u00c5\u00b2 False 12 lbco atom_site Ba fract_x 0.00000 False 13 lbco atom_site Ba fract_y 0.00000 False 14 lbco atom_site Ba fract_z 0.00000 False 15 lbco atom_site Ba occupancy 0.50000 False 16 lbco atom_site Ba b_iso 0.50000 \u00c5\u00b2 False 17 lbco atom_site Co fract_x 0.50000 False 18 lbco atom_site Co fract_y 0.50000 False 19 lbco atom_site Co fract_z 0.50000 False 20 lbco atom_site Co occupancy 1.00000 False 21 lbco atom_site Co b_iso 0.50000 \u00c5\u00b2 False 22 lbco atom_site O fract_x 0.00000 False 23 lbco atom_site O fract_y 0.50000 False 24 lbco atom_site O fract_z 0.50000 False 25 lbco atom_site O occupancy 1.00000 False 26 lbco atom_site O b_iso 0.50000 \u00c5\u00b2 False <pre>Fittable parameters for all experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty units free 1 hrpt linked_phases lbco scale 10.00000 False 2 hrpt peak broad_gauss_u 0.10000 deg\u00b2 False 3 hrpt peak broad_gauss_v -0.10000 deg\u00b2 False 4 hrpt peak broad_gauss_w 0.10000 deg\u00b2 False 5 hrpt peak broad_lorentz_x 0.00000 deg False 6 hrpt peak broad_lorentz_y 0.10000 deg False 7 hrpt instrument wavelength 1.49400 \u00c5 False 8 hrpt instrument twotheta_offset 0.60000 deg False 9 hrpt background 10 y 170.00000 False 10 hrpt background 30 y 170.00000 False 11 hrpt background 50 y 170.00000 False 12 hrpt background 110 y 170.00000 False 13 hrpt background 165 y 170.00000 False <p>Show only free parameters.</p> In\u00a0[43]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>\u26a0\ufe0f No free parameters found.                                                                                                       \n</pre> <p>Show how to access parameters in the code.</p> In\u00a0[44]: Copied! <pre># project.analysis.how_to_access_parameters()\n</pre> # project.analysis.how_to_access_parameters() In\u00a0[45]: Copied! <pre>project.analysis.show_available_fit_modes()\n</pre> project.analysis.show_available_fit_modes() <pre>Available fit modes\n</pre> Strategy Description 1 single Independent fitting of each experiment; no shared parameters 2 joint Simultaneous fitting of all experiments; some parameters are shared <p>Show current fit mode.</p> In\u00a0[46]: Copied! <pre>project.analysis.show_current_fit_mode()\n</pre> project.analysis.show_current_fit_mode() <pre>Current fit mode\n</pre> <pre>single\n</pre> <p>Select desired fit mode.</p> In\u00a0[47]: Copied! <pre>project.analysis.fit_mode = 'single'\n</pre> project.analysis.fit_mode = 'single' <pre>Current fit mode changed to\n</pre> <pre>single\n</pre> In\u00a0[48]: Copied! <pre>project.analysis.show_available_minimizers()\n</pre> project.analysis.show_available_minimizers() <pre>Supported minimizers\n</pre> Minimizer Description 1 lmfit LMFIT library using the default Levenberg-Marquardt least squares method 2 lmfit (leastsq) LMFIT library with Levenberg-Marquardt least squares method 3 lmfit (least_squares) LMFIT library with SciPy\u2019s trust region reflective algorithm 4 dfols DFO-LS library for derivative-free least-squares optimization <p>Show current fitting engine.</p> In\u00a0[49]: Copied! <pre>project.analysis.show_current_minimizer()\n</pre> project.analysis.show_current_minimizer() <pre>Current minimizer\n</pre> <pre>lmfit (leastsq)\n</pre> <p>Select desired fitting engine.</p> In\u00a0[50]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[51]: Copied! <pre>project.sample_models['lbco'].cell.length_a.free = True\n</pre> project.sample_models['lbco'].cell.length_a.free = True <p>Set experiment parameters to be refined.</p> In\u00a0[52]: Copied! <pre>project.experiments['hrpt'].linked_phases['lbco'].scale.free = True\nproject.experiments['hrpt'].instrument.calib_twotheta_offset.free = True\nproject.experiments['hrpt'].background['10'].y.free = True\nproject.experiments['hrpt'].background['30'].y.free = True\nproject.experiments['hrpt'].background['50'].y.free = True\nproject.experiments['hrpt'].background['110'].y.free = True\nproject.experiments['hrpt'].background['165'].y.free = True\n</pre> project.experiments['hrpt'].linked_phases['lbco'].scale.free = True project.experiments['hrpt'].instrument.calib_twotheta_offset.free = True project.experiments['hrpt'].background['10'].y.free = True project.experiments['hrpt'].background['30'].y.free = True project.experiments['hrpt'].background['50'].y.free = True project.experiments['hrpt'].background['110'].y.free = True project.experiments['hrpt'].background['165'].y.free = True <p>Show free parameters after selection.</p> In\u00a0[53]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.88000 -inf inf \u00c5 2 hrpt linked_phases lbco scale 10.00000 -inf inf 3 hrpt instrument twotheta_offset 0.60000 -inf inf deg 4 hrpt background 10 y 170.00000 -inf inf 5 hrpt background 30 y 170.00000 -inf inf 6 hrpt background 50 y 170.00000 -inf inf 7 hrpt background 110 y 170.00000 -inf inf 8 hrpt background 165 y 170.00000 -inf inf In\u00a0[54]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 164.59 2 12 33.43 79.7% \u2193 3 21 13.22 60.4% \u2193 4 30 5.78 56.3% \u2193 5 39 3.15 45.6% \u2193 6 77 3.14 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.14 at iteration 69\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 4.40 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.14\n</pre> <pre>\ud83d\udccf R-factor (Rf): 8.42%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 11.79%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 11.63%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8800 3.8910 0.0001 \u00c5 0.28 % \u2191 2 hrpt linked_phases lbco scale 10.0000 7.3409 0.0350 26.59 % \u2193 3 hrpt instrument twotheta_offset 0.6000 0.6243 0.0018 deg 4.05 % \u2191 4 hrpt background 10 y 170.0000 167.7066 2.1300 1.35 % \u2193 5 hrpt background 30 y 170.0000 166.0338 1.5404 2.33 % \u2193 6 hrpt background 50 y 170.0000 169.9495 1.1025 0.03 % \u2193 7 hrpt background 110 y 170.0000 170.0802 0.9788 0.05 % \u2191 8 hrpt background 165 y 170.0000 179.6656 1.3289 5.69 % \u2191 In\u00a0[55]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[56]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[57]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[58]: Copied! <pre>project.experiments['hrpt'].peak.broad_gauss_u.free = True\nproject.experiments['hrpt'].peak.broad_gauss_v.free = True\nproject.experiments['hrpt'].peak.broad_gauss_w.free = True\nproject.experiments['hrpt'].peak.broad_lorentz_y.free = True\n</pre> project.experiments['hrpt'].peak.broad_gauss_u.free = True project.experiments['hrpt'].peak.broad_gauss_v.free = True project.experiments['hrpt'].peak.broad_gauss_w.free = True project.experiments['hrpt'].peak.broad_lorentz_y.free = True <p>Show free parameters after selection.</p> In\u00a0[59]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.89099 0.00006 -inf inf \u00c5 2 hrpt linked_phases lbco scale 7.34088 0.03496 -inf inf 3 hrpt peak broad_gauss_u 0.10000 -inf inf deg\u00b2 4 hrpt peak broad_gauss_v -0.10000 -inf inf deg\u00b2 5 hrpt peak broad_gauss_w 0.10000 -inf inf deg\u00b2 6 hrpt peak broad_lorentz_y 0.10000 -inf inf deg 7 hrpt instrument twotheta_offset 0.62432 0.00181 -inf inf deg 8 hrpt background 10 y 167.70662 2.13004 -inf inf 9 hrpt background 30 y 166.03383 1.54041 -inf inf 10 hrpt background 50 y 169.94949 1.10249 -inf inf 11 hrpt background 110 y 170.08023 0.97879 -inf inf 12 hrpt background 165 y 179.66557 1.32895 -inf inf In\u00a0[60]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 3.14 2 16 2.85 9.1% \u2193 3 69 2.85 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 2.85 at iteration 68\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 3.74 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 2.85\n</pre> <pre>\ud83d\udccf R-factor (Rf): 8.30%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 11.85%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 11.90%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8910 3.8909 0.0001 \u00c5 0.00 % \u2193 2 hrpt linked_phases lbco scale 7.3409 7.2120 0.0406 1.76 % \u2193 3 hrpt peak broad_gauss_u 0.1000 0.0803 0.0047 deg\u00b2 19.74 % \u2193 4 hrpt peak broad_gauss_v -0.1000 -0.1029 0.0104 deg\u00b2 2.93 % \u2191 5 hrpt peak broad_gauss_w 0.1000 0.1077 0.0051 deg\u00b2 7.66 % \u2191 6 hrpt peak broad_lorentz_y 0.1000 0.0893 0.0032 deg 10.67 % \u2193 7 hrpt instrument twotheta_offset 0.6243 0.6231 0.0017 deg 0.19 % \u2193 8 hrpt background 10 y 167.7066 167.5167 2.0311 0.11 % \u2193 9 hrpt background 30 y 166.0338 166.7627 1.4794 0.44 % \u2191 10 hrpt background 50 y 169.9495 170.8330 1.0808 0.52 % \u2191 11 hrpt background 110 y 170.0802 172.2546 0.9660 1.28 % \u2191 12 hrpt background 165 y 179.6656 180.6405 1.2737 0.54 % \u2191 In\u00a0[61]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[62]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[63]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[64]: Copied! <pre>project.sample_models['lbco'].atom_sites['La'].b_iso.free = True\nproject.sample_models['lbco'].atom_sites['Ba'].b_iso.free = True\nproject.sample_models['lbco'].atom_sites['Co'].b_iso.free = True\nproject.sample_models['lbco'].atom_sites['O'].b_iso.free = True\n</pre> project.sample_models['lbco'].atom_sites['La'].b_iso.free = True project.sample_models['lbco'].atom_sites['Ba'].b_iso.free = True project.sample_models['lbco'].atom_sites['Co'].b_iso.free = True project.sample_models['lbco'].atom_sites['O'].b_iso.free = True <p>Show free parameters after selection.</p> In\u00a0[65]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.89091 0.00005 -inf inf \u00c5 2 lbco atom_site La b_iso 0.50000 -inf inf \u00c5\u00b2 3 lbco atom_site Ba b_iso 0.50000 -inf inf \u00c5\u00b2 4 lbco atom_site Co b_iso 0.50000 -inf inf \u00c5\u00b2 5 lbco atom_site O b_iso 0.50000 -inf inf \u00c5\u00b2 6 hrpt linked_phases lbco scale 7.21199 0.04057 -inf inf 7 hrpt peak broad_gauss_u 0.08026 0.00472 -inf inf deg\u00b2 8 hrpt peak broad_gauss_v -0.10293 0.01036 -inf inf deg\u00b2 9 hrpt peak broad_gauss_w 0.10766 0.00515 -inf inf deg\u00b2 10 hrpt peak broad_lorentz_y 0.08933 0.00320 -inf inf deg 11 hrpt instrument twotheta_offset 0.62314 0.00167 -inf inf deg 12 hrpt background 10 y 167.51669 2.03112 -inf inf 13 hrpt background 30 y 166.76268 1.47937 -inf inf 14 hrpt background 50 y 170.83305 1.08080 -inf inf 15 hrpt background 110 y 172.25458 0.96599 -inf inf 16 hrpt background 165 y 180.64054 1.27368 -inf inf In\u00a0[66]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 2.85 2 28 2.28 19.9% \u2193 3 45 1.62 28.9% \u2193 4 62 1.47 9.6% \u2193 5 79 1.36 7.0% \u2193 6 97 1.29 5.4% \u2193 7 204 1.29 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.29 at iteration 187\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 8.48 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.29\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.65%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.30%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.47%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8909 3.8909 0.0000 \u00c5 0.00 % \u2193 2 lbco atom_site La b_iso 0.5000 0.5051 1216.0511 \u00c5\u00b2 1.02 % \u2191 3 lbco atom_site Ba b_iso 0.5000 0.5048 1976.1818 \u00c5\u00b2 0.96 % \u2191 4 lbco atom_site Co b_iso 0.5000 0.2371 0.0612 \u00c5\u00b2 52.59 % \u2193 5 lbco atom_site O b_iso 0.5000 1.3935 0.0167 \u00c5\u00b2 178.71 % \u2191 6 hrpt linked_phases lbco scale 7.2120 9.1350 0.0641 26.66 % \u2191 7 hrpt peak broad_gauss_u 0.0803 0.0816 0.0031 deg\u00b2 1.63 % \u2191 8 hrpt peak broad_gauss_v -0.1029 -0.1159 0.0067 deg\u00b2 12.62 % \u2191 9 hrpt peak broad_gauss_w 0.1077 0.1204 0.0033 deg\u00b2 11.88 % \u2191 10 hrpt peak broad_lorentz_y 0.0893 0.0844 0.0021 deg 5.47 % \u2193 11 hrpt instrument twotheta_offset 0.6231 0.6226 0.0010 deg 0.09 % \u2193 12 hrpt background 10 y 167.5167 168.5585 1.3671 0.62 % \u2191 13 hrpt background 30 y 166.7627 164.3357 0.9992 1.46 % \u2193 14 hrpt background 50 y 170.8330 166.8881 0.7388 2.31 % \u2193 15 hrpt background 110 y 172.2546 175.4004 0.6571 1.83 % \u2191 16 hrpt background 165 y 180.6405 174.2811 0.9113 3.52 % \u2193 In\u00a0[67]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[68]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[69]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[70]: Copied! <pre>project.analysis.aliases.add(\n    label='biso_La',\n    param_uid=project.sample_models['lbco'].atom_sites['La'].b_iso.uid,\n)\nproject.analysis.aliases.add(\n    label='biso_Ba',\n    param_uid=project.sample_models['lbco'].atom_sites['Ba'].b_iso.uid,\n)\n</pre> project.analysis.aliases.add(     label='biso_La',     param_uid=project.sample_models['lbco'].atom_sites['La'].b_iso.uid, ) project.analysis.aliases.add(     label='biso_Ba',     param_uid=project.sample_models['lbco'].atom_sites['Ba'].b_iso.uid, ) <p>Set constraints.</p> In\u00a0[71]: Copied! <pre>project.analysis.constraints.add(lhs_alias='biso_Ba', rhs_expr='biso_La')\n</pre> project.analysis.constraints.add(lhs_alias='biso_Ba', rhs_expr='biso_La') <p>Show defined constraints.</p> In\u00a0[72]: Copied! <pre>project.analysis.show_constraints()\n</pre> project.analysis.show_constraints() <pre>User defined constraints\n</pre> lhs_alias rhs_expr full expression 1 biso_Ba biso_La biso_Ba = biso_La <p>Show free parameters before applying constraints.</p> In\u00a0[73]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.89087 0.00004 -inf inf \u00c5 2 lbco atom_site La b_iso 0.50509 1216.05113 -inf inf \u00c5\u00b2 3 lbco atom_site Ba b_iso 0.50481 1976.18178 -inf inf \u00c5\u00b2 4 lbco atom_site Co b_iso 0.23707 0.06119 -inf inf \u00c5\u00b2 5 lbco atom_site O b_iso 1.39354 0.01668 -inf inf \u00c5\u00b2 6 hrpt linked_phases lbco scale 9.13503 0.06407 -inf inf 7 hrpt peak broad_gauss_u 0.08157 0.00314 -inf inf deg\u00b2 8 hrpt peak broad_gauss_v -0.11592 0.00672 -inf inf deg\u00b2 9 hrpt peak broad_gauss_w 0.12045 0.00328 -inf inf deg\u00b2 10 hrpt peak broad_lorentz_y 0.08445 0.00215 -inf inf deg 11 hrpt instrument twotheta_offset 0.62258 0.00104 -inf inf deg 12 hrpt background 10 y 168.55849 1.36709 -inf inf 13 hrpt background 30 y 164.33571 0.99917 -inf inf 14 hrpt background 50 y 166.88814 0.73884 -inf inf 15 hrpt background 110 y 175.40040 0.65706 -inf inf 16 hrpt background 165 y 174.28113 0.91128 -inf inf <p>Apply constraints.</p> In\u00a0[74]: Copied! <pre>project.analysis.apply_constraints()\n</pre> project.analysis.apply_constraints() <p>Show free parameters after applying constraints.</p> In\u00a0[75]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.89087 0.00004 -inf inf \u00c5 2 lbco atom_site La b_iso 0.50509 1216.05113 -inf inf \u00c5\u00b2 3 lbco atom_site Co b_iso 0.23707 0.06119 -inf inf \u00c5\u00b2 4 lbco atom_site O b_iso 1.39354 0.01668 -inf inf \u00c5\u00b2 5 hrpt linked_phases lbco scale 9.13503 0.06407 -inf inf 6 hrpt peak broad_gauss_u 0.08157 0.00314 -inf inf deg\u00b2 7 hrpt peak broad_gauss_v -0.11592 0.00672 -inf inf deg\u00b2 8 hrpt peak broad_gauss_w 0.12045 0.00328 -inf inf deg\u00b2 9 hrpt peak broad_lorentz_y 0.08445 0.00215 -inf inf deg 10 hrpt instrument twotheta_offset 0.62258 0.00104 -inf inf deg 11 hrpt background 10 y 168.55849 1.36709 -inf inf 12 hrpt background 30 y 164.33571 0.99917 -inf inf 13 hrpt background 50 y 166.88814 0.73884 -inf inf 14 hrpt background 110 y 175.40040 0.65706 -inf inf 15 hrpt background 165 y 174.28113 0.91128 -inf inf In\u00a0[76]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 1.29 2 20 1.29 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.29 at iteration 19\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 0.91 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.29\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.65%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.30%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.47%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8909 3.8909 0.0000 \u00c5 0.00 % \u2191 2 lbco atom_site La b_iso 0.5051 0.5051 0.0278 \u00c5\u00b2 0.00 % \u2193 3 lbco atom_site Co b_iso 0.2371 0.2370 0.0564 \u00c5\u00b2 0.03 % \u2193 4 lbco atom_site O b_iso 1.3935 1.3935 0.0160 \u00c5\u00b2 0.00 % \u2191 5 hrpt linked_phases lbco scale 9.1350 9.1351 0.0538 0.00 % \u2191 6 hrpt peak broad_gauss_u 0.0816 0.0816 0.0031 deg\u00b2 0.00 % \u2191 7 hrpt peak broad_gauss_v -0.1159 -0.1159 0.0066 deg\u00b2 0.00 % \u2191 8 hrpt peak broad_gauss_w 0.1204 0.1204 0.0032 deg\u00b2 0.00 % \u2191 9 hrpt peak broad_lorentz_y 0.0844 0.0844 0.0021 deg 0.00 % \u2193 10 hrpt instrument twotheta_offset 0.6226 0.6226 0.0010 deg 0.00 % \u2191 11 hrpt background 10 y 168.5585 168.5585 1.3669 0.00 % \u2193 12 hrpt background 30 y 164.3357 164.3357 0.9990 0.00 % \u2193 13 hrpt background 50 y 166.8881 166.8881 0.7386 0.00 % \u2193 14 hrpt background 110 y 175.4004 175.4006 0.6488 0.00 % \u2191 15 hrpt background 165 y 174.2811 174.2812 0.8944 0.00 % \u2191 In\u00a0[77]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[78]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[79]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[80]: Copied! <pre>project.analysis.aliases.add(\n    label='occ_La',\n    param_uid=project.sample_models['lbco'].atom_sites['La'].occupancy.uid,\n)\nproject.analysis.aliases.add(\n    label='occ_Ba',\n    param_uid=project.sample_models['lbco'].atom_sites['Ba'].occupancy.uid,\n)\n</pre> project.analysis.aliases.add(     label='occ_La',     param_uid=project.sample_models['lbco'].atom_sites['La'].occupancy.uid, ) project.analysis.aliases.add(     label='occ_Ba',     param_uid=project.sample_models['lbco'].atom_sites['Ba'].occupancy.uid, ) <p>Set more constraints.</p> In\u00a0[81]: Copied! <pre>project.analysis.constraints.add(\n    lhs_alias='occ_Ba',\n    rhs_expr='1 - occ_La',\n)\n</pre> project.analysis.constraints.add(     lhs_alias='occ_Ba',     rhs_expr='1 - occ_La', ) <p>Show defined constraints.</p> In\u00a0[82]: Copied! <pre>project.analysis.show_constraints()\n</pre> project.analysis.show_constraints() <pre>User defined constraints\n</pre> lhs_alias rhs_expr full expression 1 biso_Ba biso_La biso_Ba = biso_La 2 occ_Ba 1 - occ_La occ_Ba = 1 - occ_La <p>Apply constraints.</p> In\u00a0[83]: Copied! <pre>project.analysis.apply_constraints()\n</pre> project.analysis.apply_constraints() <p>Set sample model parameters to be refined.</p> In\u00a0[84]: Copied! <pre>project.sample_models['lbco'].atom_sites['La'].occupancy.free = True\n</pre> project.sample_models['lbco'].atom_sites['La'].occupancy.free = True <p>Show free parameters after selection.</p> In\u00a0[85]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 lbco cell length_a 3.89087 0.00004 -inf inf \u00c5 2 lbco atom_site La occupancy 0.50000 -inf inf 3 lbco atom_site La b_iso 0.50508 0.02777 -inf inf \u00c5\u00b2 4 lbco atom_site Co b_iso 0.23699 0.05643 -inf inf \u00c5\u00b2 5 lbco atom_site O b_iso 1.39355 0.01599 -inf inf \u00c5\u00b2 6 hrpt linked_phases lbco scale 9.13509 0.05380 -inf inf 7 hrpt peak broad_gauss_u 0.08157 0.00310 -inf inf deg\u00b2 8 hrpt peak broad_gauss_v -0.11593 0.00664 -inf inf deg\u00b2 9 hrpt peak broad_gauss_w 0.12045 0.00325 -inf inf deg\u00b2 10 hrpt peak broad_lorentz_y 0.08445 0.00214 -inf inf deg 11 hrpt instrument twotheta_offset 0.62258 0.00103 -inf inf deg 12 hrpt background 10 y 168.55849 1.36685 -inf inf 13 hrpt background 30 y 164.33569 0.99900 -inf inf 14 hrpt background 50 y 166.88808 0.73857 -inf inf 15 hrpt background 110 y 175.40056 0.64879 -inf inf 16 hrpt background 165 y 174.28124 0.89439 -inf inf In\u00a0[86]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 1.29 2 55 1.28 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 1.28 at iteration 54\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 2.20 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 1.28\n</pre> <pre>\ud83d\udccf R-factor (Rf): 5.63%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.28%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.44%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8909 3.8909 0.0000 \u00c5 0.00 % \u2191 2 lbco atom_site La occupancy 0.5000 0.5840 0.0203 16.81 % \u2191 3 lbco atom_site La b_iso 0.5051 0.5983 0.0355 \u00c5\u00b2 18.46 % \u2191 4 lbco atom_site Co b_iso 0.2370 0.1665 0.0580 \u00c5\u00b2 29.74 % \u2193 5 lbco atom_site O b_iso 1.3935 1.3491 0.0192 \u00c5\u00b2 3.19 % \u2193 6 hrpt linked_phases lbco scale 9.1351 8.9057 0.0761 2.51 % \u2193 7 hrpt peak broad_gauss_u 0.0816 0.0812 0.0031 deg\u00b2 0.43 % \u2193 8 hrpt peak broad_gauss_v -0.1159 -0.1154 0.0066 deg\u00b2 0.48 % \u2193 9 hrpt peak broad_gauss_w 0.1204 0.1203 0.0032 deg\u00b2 0.14 % \u2193 10 hrpt peak broad_lorentz_y 0.0844 0.0846 0.0021 deg 0.18 % \u2191 11 hrpt instrument twotheta_offset 0.6226 0.6226 0.0010 deg 0.00 % \u2191 12 hrpt background 10 y 168.5585 168.9780 1.3666 0.25 % \u2191 13 hrpt background 30 y 164.3357 164.0535 0.9992 0.17 % \u2193 14 hrpt background 50 y 166.8881 166.9125 0.7364 0.01 % \u2191 15 hrpt background 110 y 175.4006 175.2699 0.6479 0.07 % \u2193 16 hrpt background 165 y 174.2812 174.5580 0.8935 0.16 % \u2191 In\u00a0[87]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[88]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=38, x_max=41, show_residual=True) In\u00a0[89]: Copied! <pre>project.save_as(dir_path='lbco_hrpt', temporary=True)\n</pre> project.save_as(dir_path='lbco_hrpt', temporary=True) <pre>Saving project \ud83d\udce6 'lbco_hrpt' to\n</pre> <pre>/private/var/folders/sm/xrr7tmqj20s7hrsh1qhfl1d40000gn/T/lbco_hrpt\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 project.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 sample_models\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 lbco.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc1 experiments\n</pre> <pre>\u2502   \u2514\u2500\u2500 \ud83d\udcc4 hrpt.cif\n</pre> <pre>\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif\n</pre> <pre>\u2514\u2500\u2500 \ud83d\udcc4 summary.cif\n</pre> In\u00a0[90]: Copied! <pre>project.summary.show_report()\n</pre> project.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>La0.5Ba0.5CoO3 at HRPT@PSI\n</pre> <pre>Description\n</pre> <pre>This project demonstrates a standard refinement of\nLa0.5Ba0.5CoO3, which crystallizes in a perovskite-type\nstructure, using neutron powder diffraction data collected\nin constant wavelength mode at the HRPT diffractometer\n(PSI).\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 lbco\n</pre> <pre>Space group\n</pre> <pre>P m -3 m\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 3.89087 2 b 3.89087 3 c 3.89087 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 La La 0.00000 0.00000 0.00000 0.58403 0.59832 2 Ba Ba 0.00000 0.00000 0.00000 0.41597 0.59832 3 Co Co 0.50000 0.50000 0.50000 1.00000 0.16651 4 O O 0.00000 0.50000 0.50000 1.00000 1.34914 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c hrpt\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, constant wavelength\n</pre> <pre>Wavelength\n</pre> <pre>1.49400\n</pre> <pre>2\u03b8 offset\n</pre> <pre>0.62261\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT\n</pre> <pre>Peak broadening (Gaussian)\n</pre> Parameter Value 1 U 0.08122 2 V -0.11537 3 W 0.12028 <pre>Peak broadening (Lorentzian)\n</pre> Parameter Value 1 X 0.00000 2 Y 0.08460 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 1.28 In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tutorials/ed-3/#structure-refinement-lbco-hrpt","title":"Structure Refinement: LBCO, HRPT\u00b6","text":"<p>This example demonstrates how to use the EasyDiffraction API in a simplified, user-friendly manner that closely follows the GUI workflow for a Rietveld refinement of La0.5Ba0.5CoO3 crystal structure using constant wavelength neutron powder diffraction data from HRPT at PSI.</p> <p>It is intended for users with minimal programming experience who want to learn how to perform standard crystal structure fitting using diffraction data. This script covers creating a project, adding sample models and experiments, performing analysis, and refining parameters.</p> <p>Only a single import of <code>easydiffraction</code> is required, and all operations are performed through high-level components of the <code>project</code> object, such as <code>project.sample_models</code>, <code>project.experiments</code>, and <code>project.analysis</code>. The <code>project</code> object is the main container for all information.</p>"},{"location":"tutorials/ed-3/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-3/#step-1-create-a-project","title":"Step 1: Create a Project\u00b6","text":"<p>This section explains how to create a project and define its metadata.</p>"},{"location":"tutorials/ed-3/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-3/#set-project-metadata","title":"Set Project Metadata\u00b6","text":""},{"location":"tutorials/ed-3/#show-project-metadata-as-cif","title":"Show Project Metadata as CIF\u00b6","text":""},{"location":"tutorials/ed-3/#save-project","title":"Save Project\u00b6","text":"<p>When saving the project for the first time, you need to specify the directory path. In the example below, the project is saved to a temporary location defined by the system.</p>"},{"location":"tutorials/ed-3/#set-up-data-plotter","title":"Set Up Data Plotter\u00b6","text":""},{"location":"tutorials/ed-3/#step-2-define-sample-model","title":"Step 2: Define Sample Model\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-3/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-3/#show-defined-sample-models","title":"Show Defined Sample Models\u00b6","text":"<p>Show the names of the models added. These names are used to access the model using the syntax: <code>project.sample_models['model_name']</code>. All model parameters can be accessed via the <code>project</code> object.</p>"},{"location":"tutorials/ed-3/#set-space-group","title":"Set Space Group\u00b6","text":"<p>Modify the default space group parameters.</p>"},{"location":"tutorials/ed-3/#set-unit-cell","title":"Set Unit Cell\u00b6","text":"<p>Modify the default unit cell parameters.</p>"},{"location":"tutorials/ed-3/#set-atom-sites","title":"Set Atom Sites\u00b6","text":"<p>Add atom sites to the sample model.</p>"},{"location":"tutorials/ed-3/#show-sample-model-as-cif","title":"Show Sample Model as CIF\u00b6","text":""},{"location":"tutorials/ed-3/#show-sample-model-structure","title":"Show Sample Model Structure\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":"<p>Save the project state after adding the sample model. This ensures that all changes are stored and can be accessed later. The project state is saved in the directory specified during project creation.</p>"},{"location":"tutorials/ed-3/#step-3-define-experiment","title":"Step 3: Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-3/#download-measured-data","title":"Download Measured Data\u00b6","text":"<p>Download the data file from the EasyDiffraction repository on GitHub.</p>"},{"location":"tutorials/ed-3/#add-diffraction-experiment","title":"Add Diffraction Experiment\u00b6","text":""},{"location":"tutorials/ed-3/#show-defined-experiments","title":"Show Defined Experiments\u00b6","text":""},{"location":"tutorials/ed-3/#show-measured-data","title":"Show Measured Data\u00b6","text":""},{"location":"tutorials/ed-3/#set-instrument","title":"Set Instrument\u00b6","text":"<p>Modify the default instrument parameters.</p>"},{"location":"tutorials/ed-3/#set-peak-profile","title":"Set Peak Profile\u00b6","text":"<p>Show supported peak profile types.</p>"},{"location":"tutorials/ed-3/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-3/#set-linked-phases","title":"Set Linked Phases\u00b6","text":"<p>Link the sample model defined in the previous step to the experiment.</p>"},{"location":"tutorials/ed-3/#show-experiment-as-cif","title":"Show Experiment as CIF\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#step-4-perform-analysis","title":"Step 4: Perform Analysis\u00b6","text":"<p>This section explains the analysis process, including how to set up calculation and fitting engines.</p>"},{"location":"tutorials/ed-3/#set-calculator","title":"Set Calculator\u00b6","text":"<p>Show supported calculation engines.</p>"},{"location":"tutorials/ed-3/#show-calculated-data","title":"Show Calculated Data\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#show-parameters","title":"Show Parameters\u00b6","text":"<p>Show all parameters of the project.</p>"},{"location":"tutorials/ed-3/#set-fit-mode","title":"Set Fit Mode\u00b6","text":"<p>Show supported fit modes.</p>"},{"location":"tutorials/ed-3/#set-minimizer","title":"Set Minimizer\u00b6","text":"<p>Show supported fitting engines.</p>"},{"location":"tutorials/ed-3/#perform-fit-15","title":"Perform Fit 1/5\u00b6","text":"<p>Set sample model parameters to be refined.</p>"},{"location":"tutorials/ed-3/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#perform-fit-25","title":"Perform Fit 2/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-3/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#perform-fit-35","title":"Perform Fit 3/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-3/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#perform-fit-45","title":"Perform Fit 4/5\u00b6","text":""},{"location":"tutorials/ed-3/#set-constraints","title":"Set Constraints\u00b6","text":"<p>Set aliases for parameters.</p>"},{"location":"tutorials/ed-3/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#perform-fit-55","title":"Perform Fit 5/5\u00b6","text":""},{"location":"tutorials/ed-3/#set-constraints","title":"Set Constraints\u00b6","text":"<p>Set more aliases for parameters.</p>"},{"location":"tutorials/ed-3/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-3/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-3/#save-project-state","title":"Save Project State\u00b6","text":""},{"location":"tutorials/ed-3/#step-5-summary","title":"Step 5: Summary\u00b6","text":"<p>This final section shows how to review the results of the analysis.</p>"},{"location":"tutorials/ed-3/#show-project-summary","title":"Show Project Summary\u00b6","text":""},{"location":"tutorials/ed-4/","title":"PbSO4 advanced","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model = SampleModelFactory.create(name='pbso4')\n</pre> model = SampleModelFactory.create(name='pbso4') In\u00a0[4]: Copied! <pre>model.space_group.name_h_m = 'P n m a'\n</pre> model.space_group.name_h_m = 'P n m a' In\u00a0[5]: Copied! <pre>model.cell.length_a = 8.47\nmodel.cell.length_b = 5.39\nmodel.cell.length_c = 6.95\n</pre> model.cell.length_a = 8.47 model.cell.length_b = 5.39 model.cell.length_c = 6.95 In\u00a0[6]: Copied! <pre>model.atom_sites.add(\n    label='Pb',\n    type_symbol='Pb',\n    fract_x=0.1876,\n    fract_y=0.25,\n    fract_z=0.167,\n    wyckoff_letter='c',\n    b_iso=1.37,\n)\nmodel.atom_sites.add(\n    label='S',\n    type_symbol='S',\n    fract_x=0.0654,\n    fract_y=0.25,\n    fract_z=0.684,\n    wyckoff_letter='c',\n    b_iso=0.3777,\n)\nmodel.atom_sites.add(\n    label='O1',\n    type_symbol='O',\n    fract_x=0.9082,\n    fract_y=0.25,\n    fract_z=0.5954,\n    wyckoff_letter='c',\n    b_iso=1.9764,\n)\nmodel.atom_sites.add(\n    label='O2',\n    type_symbol='O',\n    fract_x=0.1935,\n    fract_y=0.25,\n    fract_z=0.5432,\n    wyckoff_letter='c',\n    b_iso=1.4456,\n)\nmodel.atom_sites.add(\n    label='O3',\n    type_symbol='O',\n    fract_x=0.0811,\n    fract_y=0.0272,\n    fract_z=0.8086,\n    wyckoff_letter='d',\n    b_iso=1.2822,\n)\n</pre> model.atom_sites.add(     label='Pb',     type_symbol='Pb',     fract_x=0.1876,     fract_y=0.25,     fract_z=0.167,     wyckoff_letter='c',     b_iso=1.37, ) model.atom_sites.add(     label='S',     type_symbol='S',     fract_x=0.0654,     fract_y=0.25,     fract_z=0.684,     wyckoff_letter='c',     b_iso=0.3777, ) model.atom_sites.add(     label='O1',     type_symbol='O',     fract_x=0.9082,     fract_y=0.25,     fract_z=0.5954,     wyckoff_letter='c',     b_iso=1.9764, ) model.atom_sites.add(     label='O2',     type_symbol='O',     fract_x=0.1935,     fract_y=0.25,     fract_z=0.5432,     wyckoff_letter='c',     b_iso=1.4456, ) model.atom_sites.add(     label='O3',     type_symbol='O',     fract_x=0.0811,     fract_y=0.0272,     fract_z=0.8086,     wyckoff_letter='d',     b_iso=1.2822, ) In\u00a0[7]: Copied! <pre>data_path1 = download_data(id=13, destination='data')\n</pre> data_path1 = download_data(id=13, destination='data') <pre>Getting data...\n</pre> <pre>Data #13: PbSO4, D1A (ILL)\n</pre> <pre>\u2705 Data #13 downloaded to 'data/ed-13.dat'\n</pre> In\u00a0[8]: Copied! <pre>expt1 = ExperimentFactory.create(\n    name='npd',\n    data_path=data_path1,\n    radiation_probe='neutron',\n)\n</pre> expt1 = ExperimentFactory.create(     name='npd',     data_path=data_path1,     radiation_probe='neutron', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'npd'. Number of data points: 1801\n</pre> In\u00a0[9]: Copied! <pre>expt1.instrument.setup_wavelength = 1.91\nexpt1.instrument.calib_twotheta_offset = -0.1406\n</pre> expt1.instrument.setup_wavelength = 1.91 expt1.instrument.calib_twotheta_offset = -0.1406 In\u00a0[10]: Copied! <pre>expt1.peak.broad_gauss_u = 0.139\nexpt1.peak.broad_gauss_v = -0.412\nexpt1.peak.broad_gauss_w = 0.386\nexpt1.peak.broad_lorentz_x = 0\nexpt1.peak.broad_lorentz_y = 0.088\n</pre> expt1.peak.broad_gauss_u = 0.139 expt1.peak.broad_gauss_v = -0.412 expt1.peak.broad_gauss_w = 0.386 expt1.peak.broad_lorentz_x = 0 expt1.peak.broad_lorentz_y = 0.088 <p>Select the background type.</p> In\u00a0[11]: Copied! <pre>expt1.background_type = 'line-segment'\n</pre> expt1.background_type = 'line-segment' <pre>Background type for experiment 'npd' changed to\n</pre> <pre>line-segment\n</pre> <p>Add background points.</p> In\u00a0[12]: Copied! <pre>for id, x, y in [\n    ('1', 11.0, 206.1624),\n    ('2', 15.0, 194.75),\n    ('3', 20.0, 194.505),\n    ('4', 30.0, 188.4375),\n    ('5', 50.0, 207.7633),\n    ('6', 70.0, 201.7002),\n    ('7', 120.0, 244.4525),\n    ('8', 153.0, 226.0595),\n]:\n    expt1.background.add(id=id, x=x, y=y)\n</pre> for id, x, y in [     ('1', 11.0, 206.1624),     ('2', 15.0, 194.75),     ('3', 20.0, 194.505),     ('4', 30.0, 188.4375),     ('5', 50.0, 207.7633),     ('6', 70.0, 201.7002),     ('7', 120.0, 244.4525),     ('8', 153.0, 226.0595), ]:     expt1.background.add(id=id, x=x, y=y) In\u00a0[13]: Copied! <pre>expt1.linked_phases.add(id='pbso4', scale=1.5)\n</pre> expt1.linked_phases.add(id='pbso4', scale=1.5) In\u00a0[14]: Copied! <pre>data_path2 = download_data(id=16, destination='data')\n</pre> data_path2 = download_data(id=16, destination='data') <pre>Getting data...\n</pre> <pre>Data #16: PbSO4, laboratory X-ray\n</pre> <pre>\u2705 Data #16 downloaded to 'data/ed-16.dat'\n</pre> In\u00a0[15]: Copied! <pre>expt2 = ExperimentFactory.create(\n    name='xrd',\n    data_path=data_path2,\n    radiation_probe='xray',\n)\n</pre> expt2 = ExperimentFactory.create(     name='xrd',     data_path=data_path2,     radiation_probe='xray', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'xrd'. Number of data points: 3601\n</pre> In\u00a0[16]: Copied! <pre>expt2.instrument.setup_wavelength = 1.540567\nexpt2.instrument.calib_twotheta_offset = -0.05181\n</pre> expt2.instrument.setup_wavelength = 1.540567 expt2.instrument.calib_twotheta_offset = -0.05181 In\u00a0[17]: Copied! <pre>expt2.peak.broad_gauss_u = 0.304138\nexpt2.peak.broad_gauss_v = -0.112622\nexpt2.peak.broad_gauss_w = 0.021272\nexpt2.peak.broad_lorentz_x = 0\nexpt2.peak.broad_lorentz_y = 0.057691\n</pre> expt2.peak.broad_gauss_u = 0.304138 expt2.peak.broad_gauss_v = -0.112622 expt2.peak.broad_gauss_w = 0.021272 expt2.peak.broad_lorentz_x = 0 expt2.peak.broad_lorentz_y = 0.057691 <p>Select background type.</p> In\u00a0[18]: Copied! <pre>expt2.background_type = 'chebyshev polynomial'\n</pre> expt2.background_type = 'chebyshev polynomial' <pre>Background type for experiment 'xrd' changed to\n</pre> <pre>chebyshev polynomial\n</pre> <p>Add background points.</p> In\u00a0[19]: Copied! <pre>for id, x, y in [\n    ('1', 0, 119.195),\n    ('2', 1, 6.221),\n    ('3', 2, -45.725),\n    ('4', 3, 8.119),\n    ('5', 4, 54.552),\n    ('6', 5, -20.661),\n]:\n    expt2.background.add(id=id, order=x, coef=y)\n</pre> for id, x, y in [     ('1', 0, 119.195),     ('2', 1, 6.221),     ('3', 2, -45.725),     ('4', 3, 8.119),     ('5', 4, 54.552),     ('6', 5, -20.661), ]:     expt2.background.add(id=id, order=x, coef=y) In\u00a0[20]: Copied! <pre>expt2.linked_phases.add(id='pbso4', scale=0.001)\n</pre> expt2.linked_phases.add(id='pbso4', scale=0.001) In\u00a0[21]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[22]: Copied! <pre>project.sample_models.add(sample_model=model)\n</pre> project.sample_models.add(sample_model=model) In\u00a0[23]: Copied! <pre>project.experiments.add(experiment=expt1)\nproject.experiments.add(experiment=expt2)\n</pre> project.experiments.add(experiment=expt1) project.experiments.add(experiment=expt2) In\u00a0[24]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[25]: Copied! <pre>project.analysis.fit_mode = 'joint'\n</pre> project.analysis.fit_mode = 'joint' <pre>Current fit mode changed to\n</pre> <pre>joint\n</pre> In\u00a0[26]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[27]: Copied! <pre>model.cell.length_a.free = True\nmodel.cell.length_b.free = True\nmodel.cell.length_c.free = True\n</pre> model.cell.length_a.free = True model.cell.length_b.free = True model.cell.length_c.free = True <p>Set experiment parameters to be optimized.</p> In\u00a0[28]: Copied! <pre>expt1.linked_phases['pbso4'].scale.free = True\n\nexpt1.instrument.calib_twotheta_offset.free = True\n\nexpt1.peak.broad_gauss_u.free = True\nexpt1.peak.broad_gauss_v.free = True\nexpt1.peak.broad_gauss_w.free = True\nexpt1.peak.broad_lorentz_y.free = True\n</pre> expt1.linked_phases['pbso4'].scale.free = True  expt1.instrument.calib_twotheta_offset.free = True  expt1.peak.broad_gauss_u.free = True expt1.peak.broad_gauss_v.free = True expt1.peak.broad_gauss_w.free = True expt1.peak.broad_lorentz_y.free = True In\u00a0[29]: Copied! <pre>expt2.linked_phases['pbso4'].scale.free = True\n\nexpt2.instrument.calib_twotheta_offset.free = True\n\nexpt2.peak.broad_gauss_u.free = True\nexpt2.peak.broad_gauss_v.free = True\nexpt2.peak.broad_gauss_w.free = True\nexpt2.peak.broad_lorentz_y.free = True\n\nfor term in expt2.background:\n    term.coef.free = True\n</pre> expt2.linked_phases['pbso4'].scale.free = True  expt2.instrument.calib_twotheta_offset.free = True  expt2.peak.broad_gauss_u.free = True expt2.peak.broad_gauss_v.free = True expt2.peak.broad_gauss_w.free = True expt2.peak.broad_lorentz_y.free = True  for term in expt2.background:     term.coef.free = True In\u00a0[30]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using all experiments \ud83d\udd2c ['npd', 'xrd'] for 'joint' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 37.01 2 25 16.30 56.0% \u2193 3 136 16.21 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 16.21 at iteration 135\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 17.58 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 16.21\n</pre> <pre>\ud83d\udccf R-factor (Rf): 13.18%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 17.19%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 17.09%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 pbso4 cell length_a 8.4700 8.4693 0.0002 \u00c5 0.01 % \u2193 2 pbso4 cell length_b 5.3900 5.3912 0.0001 \u00c5 0.02 % \u2191 3 pbso4 cell length_c 6.9500 6.9504 0.0002 \u00c5 0.01 % \u2191 4 npd linked_phases pbso4 scale 1.5000 1.4622 0.0049 2.52 % \u2193 5 npd peak broad_gauss_u 0.1390 0.2901 0.0350 deg\u00b2 108.67 % \u2191 6 npd peak broad_gauss_v -0.4120 -0.6390 0.0531 deg\u00b2 55.10 % \u2191 7 npd peak broad_gauss_w 0.3860 0.4552 0.0186 deg\u00b2 17.92 % \u2191 8 npd peak broad_lorentz_y 0.0880 0.0931 0.0034 deg 5.76 % \u2191 9 npd instrument twotheta_offset -0.1406 -0.1385 0.0019 deg 1.47 % \u2193 10 xrd linked_phases pbso4 scale 0.0010 0.0010 0.0000 1.52 % \u2193 11 xrd peak broad_gauss_u 0.3041 0.5724 0.0196 deg\u00b2 88.21 % \u2191 12 xrd peak broad_gauss_v -0.1126 -0.2799 0.0142 deg\u00b2 148.57 % \u2191 13 xrd peak broad_gauss_w 0.0213 0.0452 0.0024 deg\u00b2 112.27 % \u2191 14 xrd peak broad_lorentz_y 0.0577 0.0587 0.0014 deg 1.75 % \u2191 15 xrd instrument twotheta_offset -0.0518 -0.0637 0.0009 deg 22.93 % \u2191 16 xrd background 1 coef 119.1950 85.8587 1.3293 27.97 % \u2193 17 xrd background 2 coef 6.2210 -19.3112 1.8805 410.42 % \u2193 18 xrd background 3 coef -45.7250 5.3658 1.7778 111.74 % \u2193 19 xrd background 4 coef 8.1190 11.8842 1.7472 46.37 % \u2191 20 xrd background 5 coef 54.5520 18.5560 1.5670 65.98 % \u2193 21 xrd background 6 coef -20.6610 -6.4093 1.5359 68.98 % \u2193 In\u00a0[31]: Copied! <pre>project.plot_meas_vs_calc(expt_name='npd', x_min=35.5, x_max=38.3, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='npd', x_min=35.5, x_max=38.3, show_residual=True) In\u00a0[32]: Copied! <pre>project.plot_meas_vs_calc(expt_name='xrd', x_min=29.0, x_max=30.4, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='xrd', x_min=29.0, x_max=30.4, show_residual=True)"},{"location":"tutorials/ed-4/#structure-refinement-pbso4-npd-xrd","title":"Structure Refinement: PbSO4, NPD + XRD\u00b6","text":"<p>This example demonstrates a more advanced use of the EasyDiffraction library by explicitly creating and configuring sample models and experiments before adding them to a project. It could be more suitable for users who are interested in creating custom workflows. This tutorial provides minimal explanation and is intended for users already familiar with EasyDiffraction.</p> <p>The tutorial covers a Rietveld refinement of PbSO4 crystal structure based on the joint fit of both X-ray and neutron diffraction data.</p>"},{"location":"tutorials/ed-4/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-4/#define-sample-model","title":"Define Sample Model\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-4/#create-sample-model","title":"Create Sample Model\u00b6","text":""},{"location":"tutorials/ed-4/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-4/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-4/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-4/#define-experiments","title":"Define Experiments\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-4/#experiment-1-npd","title":"Experiment 1: npd\u00b6","text":""},{"location":"tutorials/ed-4/#download-data","title":"Download Data\u00b6","text":""},{"location":"tutorials/ed-4/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-4/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-4/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-4/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-4/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-4/#experiment-2-xrd","title":"Experiment 2: xrd\u00b6","text":""},{"location":"tutorials/ed-4/#download-data","title":"Download Data\u00b6","text":""},{"location":"tutorials/ed-4/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-4/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-4/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-4/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-4/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-4/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage sample models, experiments, and analysis.</p>"},{"location":"tutorials/ed-4/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-4/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-4/#add-experiments","title":"Add Experiments\u00b6","text":""},{"location":"tutorials/ed-4/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section outlines the analysis process, including how to configure calculation and fitting engines.</p>"},{"location":"tutorials/ed-4/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-4/#set-fit-mode","title":"Set Fit Mode\u00b6","text":""},{"location":"tutorials/ed-4/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-4/#set-fitting-parameters","title":"Set Fitting Parameters\u00b6","text":"<p>Set sample model parameters to be optimized.</p>"},{"location":"tutorials/ed-4/#perform-fit","title":"Perform Fit\u00b6","text":""},{"location":"tutorials/ed-4/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-5/","title":"Co2SiO4 pd-neut-cwl","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model = SampleModelFactory.create(name='cosio')\n</pre> model = SampleModelFactory.create(name='cosio') In\u00a0[4]: Copied! <pre>model.space_group.name_h_m = 'P n m a'\nmodel.space_group.it_coordinate_system_code = 'abc'\n</pre> model.space_group.name_h_m = 'P n m a' model.space_group.it_coordinate_system_code = 'abc' In\u00a0[5]: Copied! <pre>model.cell.length_a = 10.3\nmodel.cell.length_b = 6.0\nmodel.cell.length_c = 4.8\n</pre> model.cell.length_a = 10.3 model.cell.length_b = 6.0 model.cell.length_c = 4.8 In\u00a0[6]: Copied! <pre>model.atom_sites.add(\n    label='Co1',\n    type_symbol='Co',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='Co2',\n    type_symbol='Co',\n    fract_x=0.279,\n    fract_y=0.25,\n    fract_z=0.985,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0.094,\n    fract_y=0.25,\n    fract_z=0.429,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='O1',\n    type_symbol='O',\n    fract_x=0.091,\n    fract_y=0.25,\n    fract_z=0.771,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='O2',\n    type_symbol='O',\n    fract_x=0.448,\n    fract_y=0.25,\n    fract_z=0.217,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='O3',\n    type_symbol='O',\n    fract_x=0.164,\n    fract_y=0.032,\n    fract_z=0.28,\n    wyckoff_letter='d',\n    b_iso=0.5,\n)\n</pre> model.atom_sites.add(     label='Co1',     type_symbol='Co',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.5, ) model.atom_sites.add(     label='Co2',     type_symbol='Co',     fract_x=0.279,     fract_y=0.25,     fract_z=0.985,     wyckoff_letter='c',     b_iso=0.5, ) model.atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0.094,     fract_y=0.25,     fract_z=0.429,     wyckoff_letter='c',     b_iso=0.5, ) model.atom_sites.add(     label='O1',     type_symbol='O',     fract_x=0.091,     fract_y=0.25,     fract_z=0.771,     wyckoff_letter='c',     b_iso=0.5, ) model.atom_sites.add(     label='O2',     type_symbol='O',     fract_x=0.448,     fract_y=0.25,     fract_z=0.217,     wyckoff_letter='c',     b_iso=0.5, ) model.atom_sites.add(     label='O3',     type_symbol='O',     fract_x=0.164,     fract_y=0.032,     fract_z=0.28,     wyckoff_letter='d',     b_iso=0.5, ) In\u00a0[7]: Copied! <pre>data_path = download_data(id=12, destination='data')\n</pre> data_path = download_data(id=12, destination='data') <pre>Getting data...\n</pre> <pre>Data #12: Co2SiO4, D20 (ILL)\n</pre> <pre>\u2705 Data #12 downloaded to 'data/ed-12.xye'\n</pre> In\u00a0[8]: Copied! <pre>expt = ExperimentFactory.create(name='d20', data_path=data_path)\n</pre> expt = ExperimentFactory.create(name='d20', data_path=data_path) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'd20'. Number of data points: 1418\n</pre> In\u00a0[9]: Copied! <pre>expt.instrument.setup_wavelength = 1.87\nexpt.instrument.calib_twotheta_offset = 0.1\n</pre> expt.instrument.setup_wavelength = 1.87 expt.instrument.calib_twotheta_offset = 0.1 In\u00a0[10]: Copied! <pre>expt.peak.broad_gauss_u = 0.3\nexpt.peak.broad_gauss_v = -0.5\nexpt.peak.broad_gauss_w = 0.4\n</pre> expt.peak.broad_gauss_u = 0.3 expt.peak.broad_gauss_v = -0.5 expt.peak.broad_gauss_w = 0.4 In\u00a0[11]: Copied! <pre>expt.background.add(id='1', x=8, y=500)\nexpt.background.add(id='2', x=9, y=500)\nexpt.background.add(id='3', x=10, y=500)\nexpt.background.add(id='4', x=11, y=500)\nexpt.background.add(id='5', x=12, y=500)\nexpt.background.add(id='6', x=15, y=500)\nexpt.background.add(id='7', x=25, y=500)\nexpt.background.add(id='8', x=30, y=500)\nexpt.background.add(id='9', x=50, y=500)\nexpt.background.add(id='10', x=70, y=500)\nexpt.background.add(id='11', x=90, y=500)\nexpt.background.add(id='12', x=110, y=500)\nexpt.background.add(id='13', x=130, y=500)\nexpt.background.add(id='14', x=150, y=500)\n</pre> expt.background.add(id='1', x=8, y=500) expt.background.add(id='2', x=9, y=500) expt.background.add(id='3', x=10, y=500) expt.background.add(id='4', x=11, y=500) expt.background.add(id='5', x=12, y=500) expt.background.add(id='6', x=15, y=500) expt.background.add(id='7', x=25, y=500) expt.background.add(id='8', x=30, y=500) expt.background.add(id='9', x=50, y=500) expt.background.add(id='10', x=70, y=500) expt.background.add(id='11', x=90, y=500) expt.background.add(id='12', x=110, y=500) expt.background.add(id='13', x=130, y=500) expt.background.add(id='14', x=150, y=500) In\u00a0[12]: Copied! <pre>expt.linked_phases.add(id='cosio', scale=1.0)\n</pre> expt.linked_phases.add(id='cosio', scale=1.0) In\u00a0[13]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[14]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[15]: Copied! <pre>project.sample_models.add(sample_model=model)\n</pre> project.sample_models.add(sample_model=model) In\u00a0[16]: Copied! <pre>project.experiments.add(experiment=expt)\n</pre> project.experiments.add(experiment=expt) In\u00a0[17]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[18]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[19]: Copied! <pre>project.plot_meas_vs_calc(expt_name='d20', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='d20', show_residual=True) In\u00a0[20]: Copied! <pre>project.plot_meas_vs_calc(expt_name='d20', x_min=41, x_max=54, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='d20', x_min=41, x_max=54, show_residual=True) In\u00a0[21]: Copied! <pre>model.cell.length_a.free = True\nmodel.cell.length_b.free = True\nmodel.cell.length_c.free = True\n\nmodel.atom_sites['Co2'].fract_x.free = True\nmodel.atom_sites['Co2'].fract_z.free = True\nmodel.atom_sites['Si'].fract_x.free = True\nmodel.atom_sites['Si'].fract_z.free = True\nmodel.atom_sites['O1'].fract_x.free = True\nmodel.atom_sites['O1'].fract_z.free = True\nmodel.atom_sites['O2'].fract_x.free = True\nmodel.atom_sites['O2'].fract_z.free = True\nmodel.atom_sites['O3'].fract_x.free = True\nmodel.atom_sites['O3'].fract_y.free = True\nmodel.atom_sites['O3'].fract_z.free = True\n\nmodel.atom_sites['Co1'].b_iso.free = True\nmodel.atom_sites['Co2'].b_iso.free = True\nmodel.atom_sites['Si'].b_iso.free = True\nmodel.atom_sites['O1'].b_iso.free = True\nmodel.atom_sites['O2'].b_iso.free = True\nmodel.atom_sites['O3'].b_iso.free = True\n</pre> model.cell.length_a.free = True model.cell.length_b.free = True model.cell.length_c.free = True  model.atom_sites['Co2'].fract_x.free = True model.atom_sites['Co2'].fract_z.free = True model.atom_sites['Si'].fract_x.free = True model.atom_sites['Si'].fract_z.free = True model.atom_sites['O1'].fract_x.free = True model.atom_sites['O1'].fract_z.free = True model.atom_sites['O2'].fract_x.free = True model.atom_sites['O2'].fract_z.free = True model.atom_sites['O3'].fract_x.free = True model.atom_sites['O3'].fract_y.free = True model.atom_sites['O3'].fract_z.free = True  model.atom_sites['Co1'].b_iso.free = True model.atom_sites['Co2'].b_iso.free = True model.atom_sites['Si'].b_iso.free = True model.atom_sites['O1'].b_iso.free = True model.atom_sites['O2'].b_iso.free = True model.atom_sites['O3'].b_iso.free = True In\u00a0[22]: Copied! <pre>expt.linked_phases['cosio'].scale.free = True\n\nexpt.instrument.calib_twotheta_offset.free = True\n\nexpt.peak.broad_gauss_u.free = True\nexpt.peak.broad_gauss_v.free = True\nexpt.peak.broad_gauss_w.free = True\nexpt.peak.broad_lorentz_y.free = True\n\nfor point in expt.background:\n    point.y.free = True\n</pre> expt.linked_phases['cosio'].scale.free = True  expt.instrument.calib_twotheta_offset.free = True  expt.peak.broad_gauss_u.free = True expt.peak.broad_gauss_v.free = True expt.peak.broad_gauss_w.free = True expt.peak.broad_lorentz_y.free = True  for point in expt.background:     point.y.free = True In\u00a0[23]: Copied! <pre>project.analysis.aliases.add(\n    label='biso_Co1',\n    param_uid=project.sample_models['cosio'].atom_sites['Co1'].b_iso.uid,\n)\nproject.analysis.aliases.add(\n    label='biso_Co2',\n    param_uid=project.sample_models['cosio'].atom_sites['Co2'].b_iso.uid,\n)\n</pre> project.analysis.aliases.add(     label='biso_Co1',     param_uid=project.sample_models['cosio'].atom_sites['Co1'].b_iso.uid, ) project.analysis.aliases.add(     label='biso_Co2',     param_uid=project.sample_models['cosio'].atom_sites['Co2'].b_iso.uid, ) <p>Set constraints.</p> In\u00a0[24]: Copied! <pre>project.analysis.constraints.add(\n    lhs_alias='biso_Co2',\n    rhs_expr='biso_Co1',\n)\n</pre> project.analysis.constraints.add(     lhs_alias='biso_Co2',     rhs_expr='biso_Co1', ) <p>Apply constraints.</p> In\u00a0[25]: Copied! <pre>project.analysis.apply_constraints()\n</pre> project.analysis.apply_constraints() In\u00a0[26]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'd20' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 423.20 2 43 71.71 83.1% \u2193 3 83 40.43 43.6% \u2193 4 123 17.05 57.8% \u2193 5 163 10.78 36.8% \u2193 6 203 9.26 14.1% \u2193 7 243 8.08 12.7% \u2193 8 283 5.66 30.0% \u2193 9 323 4.67 17.4% \u2193 10 363 4.57 2.3% \u2193 11 564 4.56 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 4.56 at iteration 547\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 26.69 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 4.56\n</pre> <pre>\ud83d\udccf R-factor (Rf): 3.03%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 4.54%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.87%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 cosio cell length_a 10.3000 10.3090 0.0003 \u00c5 0.09 % \u2191 2 cosio cell length_b 6.0000 6.0039 0.0002 \u00c5 0.07 % \u2191 3 cosio cell length_c 4.8000 4.7868 0.0001 \u00c5 0.28 % \u2193 4 cosio atom_site Co1 b_iso 0.5000 0.2770 0.0802 \u00c5\u00b2 44.59 % \u2193 5 cosio atom_site Co2 fract_x 0.2790 0.2794 0.0007 0.14 % \u2191 6 cosio atom_site Co2 fract_z 0.9850 0.9847 0.0015 0.03 % \u2193 7 cosio atom_site Si fract_x 0.0940 0.0937 0.0004 0.31 % \u2193 8 cosio atom_site Si fract_z 0.4290 0.4290 0.0008 0.01 % \u2191 9 cosio atom_site Si b_iso 0.5000 0.3519 0.0625 \u00c5\u00b2 29.62 % \u2193 10 cosio atom_site O1 fract_x 0.0910 0.0911 0.0003 0.08 % \u2191 11 cosio atom_site O1 fract_z 0.7710 0.7714 0.0006 0.05 % \u2191 12 cosio atom_site O1 b_iso 0.5000 0.6457 0.0581 \u00c5\u00b2 29.14 % \u2191 13 cosio atom_site O2 fract_x 0.4480 0.4482 0.0003 0.06 % \u2191 14 cosio atom_site O2 fract_z 0.2170 0.2167 0.0007 0.14 % \u2193 15 cosio atom_site O2 b_iso 0.5000 0.5778 0.0582 \u00c5\u00b2 15.57 % \u2191 16 cosio atom_site O3 fract_x 0.1640 0.1636 0.0002 0.26 % \u2193 17 cosio atom_site O3 fract_y 0.0320 0.0317 0.0003 1.08 % \u2193 18 cosio atom_site O3 fract_z 0.2800 0.2800 0.0005 0.02 % \u2191 19 cosio atom_site O3 b_iso 0.5000 0.8389 0.0485 \u00c5\u00b2 67.79 % \u2191 20 d20 linked_phases cosio scale 1.0000 1.1957 0.0106 19.57 % \u2191 21 d20 peak broad_gauss_u 0.3000 0.2423 0.0068 deg\u00b2 19.22 % \u2193 22 d20 peak broad_gauss_v -0.5000 -0.5288 0.0145 deg\u00b2 5.76 % \u2191 23 d20 peak broad_gauss_w 0.4000 0.3840 0.0090 deg\u00b2 4.01 % \u2193 24 d20 peak broad_lorentz_y 0.0000 0.0159 0.0045 deg N/A 25 d20 instrument twotheta_offset 0.1000 0.2884 0.0020 deg 188.44 % \u2191 26 d20 background 1 y 500.0000 608.6305 14.5414 21.73 % \u2191 27 d20 background 2 y 500.0000 580.6214 9.7278 16.12 % \u2191 28 d20 background 3 y 500.0000 562.8991 9.2422 12.58 % \u2191 29 d20 background 4 y 500.0000 540.2882 8.7695 8.06 % \u2191 30 d20 background 5 y 500.0000 519.8428 6.0496 3.97 % \u2191 31 d20 background 6 y 500.0000 507.3838 3.4846 1.48 % \u2191 32 d20 background 7 y 500.0000 463.0794 3.1898 7.38 % \u2193 33 d20 background 8 y 500.0000 434.2455 2.3904 13.15 % \u2193 34 d20 background 9 y 500.0000 450.8166 2.2505 9.84 % \u2193 35 d20 background 10 y 500.0000 430.3828 2.0250 13.92 % \u2193 36 d20 background 11 y 500.0000 413.7132 2.2594 17.26 % \u2193 37 d20 background 12 y 500.0000 361.2599 2.0915 27.75 % \u2193 38 d20 background 13 y 500.0000 291.0612 1.9671 41.79 % \u2193 39 d20 background 14 y 500.0000 238.7749 2.9764 52.25 % \u2193 In\u00a0[27]: Copied! <pre>project.plot_meas_vs_calc(expt_name='d20', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='d20', show_residual=True) In\u00a0[28]: Copied! <pre>project.plot_meas_vs_calc(expt_name='d20', x_min=41, x_max=54, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='d20', x_min=41, x_max=54, show_residual=True) In\u00a0[29]: Copied! <pre>project.summary.show_report()\n</pre> project.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>Untitled Project\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 cosio\n</pre> <pre>Space group\n</pre> <pre>P n m a\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 10.30896 2 b 6.00391 3 c 4.78675 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 Co1 Co 0.00000 0.00000 0.00000 1.00000 0.27703 2 Co2 Co 0.27938 0.25000 0.98470 1.00000 0.27703 3 Si Si 0.09371 0.25000 0.42904 1.00000 0.35192 4 O1 O 0.09107 0.25000 0.77140 1.00000 0.64570 5 O2 O 0.44825 0.25000 0.21671 1.00000 0.57784 6 O3 O 0.16358 0.03165 0.28005 1.00000 0.83894 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c d20\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, constant wavelength\n</pre> <pre>Wavelength\n</pre> <pre>1.87000\n</pre> <pre>2\u03b8 offset\n</pre> <pre>0.28844\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT\n</pre> <pre>Peak broadening (Gaussian)\n</pre> Parameter Value 1 U 0.24233 2 V -0.52880 3 W 0.38395 <pre>Peak broadening (Lorentzian)\n</pre> Parameter Value 1 X 0.00000 2 Y 0.01591 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 4.56"},{"location":"tutorials/ed-5/#structure-refinement-co2sio4-d20","title":"Structure Refinement: Co2SiO4, D20\u00b6","text":"<p>This example demonstrates a Rietveld refinement of Co2SiO4 crystal structure using constant wavelength neutron powder diffraction data from D20 at ILL.</p>"},{"location":"tutorials/ed-5/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-5/#define-sample-model","title":"Define Sample Model\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-5/#create-sample-model","title":"Create Sample Model\u00b6","text":""},{"location":"tutorials/ed-5/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-5/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-5/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-5/#define-experiment","title":"Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-5/#download-measured-data","title":"Download Measured Data\u00b6","text":""},{"location":"tutorials/ed-5/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-5/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-5/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-5/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-5/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-5/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage the sample model, experiment, and analysis.</p>"},{"location":"tutorials/ed-5/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-5/#set-plotting-engine","title":"Set Plotting Engine\u00b6","text":""},{"location":"tutorials/ed-5/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-5/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-5/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section shows the analysis process, including how to set up calculation and fitting engines.</p>"},{"location":"tutorials/ed-5/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-5/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-5/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-5/#set-free-parameters","title":"Set Free Parameters\u00b6","text":""},{"location":"tutorials/ed-5/#set-constraints","title":"Set Constraints\u00b6","text":"<p>Set aliases for parameters.</p>"},{"location":"tutorials/ed-5/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-5/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-5/#summary","title":"Summary\u00b6","text":"<p>This final section shows how to review the results of the analysis.</p>"},{"location":"tutorials/ed-5/#show-project-summary","title":"Show Project Summary\u00b6","text":""},{"location":"tutorials/ed-6/","title":"HS pd-neut-cwl","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model = SampleModelFactory.create(name='hs')\n</pre> model = SampleModelFactory.create(name='hs') In\u00a0[4]: Copied! <pre>model.space_group.name_h_m = 'R -3 m'\nmodel.space_group.it_coordinate_system_code = 'h'\n</pre> model.space_group.name_h_m = 'R -3 m' model.space_group.it_coordinate_system_code = 'h' In\u00a0[5]: Copied! <pre>model.cell.length_a = 6.9\nmodel.cell.length_c = 14.1\n</pre> model.cell.length_a = 6.9 model.cell.length_c = 14.1 In\u00a0[6]: Copied! <pre>model.atom_sites.add(\n    label='Zn',\n    type_symbol='Zn',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='Cu',\n    type_symbol='Cu',\n    fract_x=0.5,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='e',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='O',\n    type_symbol='O',\n    fract_x=0.21,\n    fract_y=-0.21,\n    fract_z=0.06,\n    wyckoff_letter='h',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='Cl',\n    type_symbol='Cl',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0.197,\n    wyckoff_letter='c',\n    b_iso=0.5,\n)\nmodel.atom_sites.add(\n    label='H',\n    type_symbol='2H',\n    fract_x=0.13,\n    fract_y=-0.13,\n    fract_z=0.08,\n    wyckoff_letter='h',\n    b_iso=0.5,\n)\n</pre> model.atom_sites.add(     label='Zn',     type_symbol='Zn',     fract_x=0,     fract_y=0,     fract_z=0.5,     wyckoff_letter='b',     b_iso=0.5, ) model.atom_sites.add(     label='Cu',     type_symbol='Cu',     fract_x=0.5,     fract_y=0,     fract_z=0,     wyckoff_letter='e',     b_iso=0.5, ) model.atom_sites.add(     label='O',     type_symbol='O',     fract_x=0.21,     fract_y=-0.21,     fract_z=0.06,     wyckoff_letter='h',     b_iso=0.5, ) model.atom_sites.add(     label='Cl',     type_symbol='Cl',     fract_x=0,     fract_y=0,     fract_z=0.197,     wyckoff_letter='c',     b_iso=0.5, ) model.atom_sites.add(     label='H',     type_symbol='2H',     fract_x=0.13,     fract_y=-0.13,     fract_z=0.08,     wyckoff_letter='h',     b_iso=0.5, ) In\u00a0[7]: Copied! <pre>data_path = download_data(id=11, destination='data')\n</pre> data_path = download_data(id=11, destination='data') <pre>Getting data...\n</pre> <pre>Data #11: HS, HRPT (PSI)\n</pre> <pre>\u2705 Data #11 downloaded to 'data/ed-11.xye'\n</pre> In\u00a0[8]: Copied! <pre>expt = ExperimentFactory.create(name='hrpt', data_path=data_path)\n</pre> expt = ExperimentFactory.create(name='hrpt', data_path=data_path) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'hrpt'. Number of data points: 3220\n</pre> In\u00a0[9]: Copied! <pre>expt.instrument.setup_wavelength = 1.89\nexpt.instrument.calib_twotheta_offset = 0.0\n</pre> expt.instrument.setup_wavelength = 1.89 expt.instrument.calib_twotheta_offset = 0.0 In\u00a0[10]: Copied! <pre>expt.peak.broad_gauss_u = 0.1\nexpt.peak.broad_gauss_v = -0.2\nexpt.peak.broad_gauss_w = 0.2\nexpt.peak.broad_lorentz_x = 0.0\nexpt.peak.broad_lorentz_y = 0\n</pre> expt.peak.broad_gauss_u = 0.1 expt.peak.broad_gauss_v = -0.2 expt.peak.broad_gauss_w = 0.2 expt.peak.broad_lorentz_x = 0.0 expt.peak.broad_lorentz_y = 0 In\u00a0[11]: Copied! <pre>expt.background.add(id='1', x=4.4196, y=500)\nexpt.background.add(id='2', x=6.6207, y=500)\nexpt.background.add(id='3', x=10.4918, y=500)\nexpt.background.add(id='4', x=15.4634, y=500)\nexpt.background.add(id='5', x=45.6041, y=500)\nexpt.background.add(id='6', x=74.6844, y=500)\nexpt.background.add(id='7', x=103.4187, y=500)\nexpt.background.add(id='8', x=121.6311, y=500)\nexpt.background.add(id='9', x=159.4116, y=500)\n</pre> expt.background.add(id='1', x=4.4196, y=500) expt.background.add(id='2', x=6.6207, y=500) expt.background.add(id='3', x=10.4918, y=500) expt.background.add(id='4', x=15.4634, y=500) expt.background.add(id='5', x=45.6041, y=500) expt.background.add(id='6', x=74.6844, y=500) expt.background.add(id='7', x=103.4187, y=500) expt.background.add(id='8', x=121.6311, y=500) expt.background.add(id='9', x=159.4116, y=500) In\u00a0[12]: Copied! <pre>expt.linked_phases.add(id='hs', scale=0.5)\n</pre> expt.linked_phases.add(id='hs', scale=0.5) In\u00a0[13]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[14]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[15]: Copied! <pre>project.sample_models.add(sample_model=model)\n</pre> project.sample_models.add(sample_model=model) In\u00a0[16]: Copied! <pre>project.experiments.add(experiment=expt)\n</pre> project.experiments.add(experiment=expt) In\u00a0[17]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[18]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[19]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[20]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True) In\u00a0[21]: Copied! <pre>model.cell.length_a.free = True\nmodel.cell.length_c.free = True\n\nexpt.linked_phases['hs'].scale.free = True\nexpt.instrument.calib_twotheta_offset.free = True\n</pre> model.cell.length_a.free = True model.cell.length_c.free = True  expt.linked_phases['hs'].scale.free = True expt.instrument.calib_twotheta_offset.free = True <p>Show free parameters after selection.</p> In\u00a0[22]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 hs cell length_a 6.90000 -inf inf \u00c5 2 hs cell length_c 14.10000 -inf inf \u00c5 3 hrpt linked_phases hs scale 0.50000 -inf inf 4 hrpt instrument twotheta_offset 0.00000 -inf inf deg In\u00a0[23]: Copied! <pre>project.analysis.fit()\n</pre> project.analysis.fit() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 576.50 2 8 122.02 78.8% \u2193 3 13 115.19 5.6% \u2193 4 18 109.86 4.6% \u2193 5 23 106.68 2.9% \u2193 6 28 104.60 2.0% \u2193 7 33 102.87 1.7% \u2193 8 38 101.13 1.7% \u2193 9 43 99.20 1.9% \u2193 10 48 96.86 2.4% \u2193 11 53 93.93 3.0% \u2193 12 58 90.34 3.8% \u2193 13 63 86.20 4.6% \u2193 14 68 81.66 5.3% \u2193 15 73 76.78 6.0% \u2193 16 78 71.71 6.6% \u2193 17 83 66.82 6.8% \u2193 18 88 62.48 6.5% \u2193 19 93 58.99 5.6% \u2193 20 98 56.41 4.4% \u2193 21 103 54.64 3.1% \u2193 22 108 53.49 2.1% \u2193 23 113 52.76 1.4% \u2193 24 123 52.02 1.4% \u2193 25 304 51.57 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 51.57 at iteration 303\n</pre> <pre>\u2705 Fitting complete.\n</pre> In\u00a0[24]: Copied! <pre>project.analysis.show_fit_results()\n</pre> project.analysis.show_fit_results() <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 25.50 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 51.57\n</pre> <pre>\ud83d\udccf R-factor (Rf): 19.70%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 30.20%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 30.35%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 hs cell length_a 6.9000 6.8623 0.0003 \u00c5 0.55 % \u2193 2 hs cell length_c 14.1000 14.1365 0.0008 \u00c5 0.26 % \u2191 3 hrpt linked_phases hs scale 0.5000 0.2548 0.0030 49.04 % \u2193 4 hrpt instrument twotheta_offset 0.0000 0.1271 0.0051 deg N/A In\u00a0[25]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[26]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True) In\u00a0[27]: Copied! <pre>expt.peak.broad_gauss_u.free = True\nexpt.peak.broad_gauss_v.free = True\nexpt.peak.broad_gauss_w.free = True\nexpt.peak.broad_lorentz_x.free = True\n\nfor point in expt.background:\n    point.y.free = True\n</pre> expt.peak.broad_gauss_u.free = True expt.peak.broad_gauss_v.free = True expt.peak.broad_gauss_w.free = True expt.peak.broad_lorentz_x.free = True  for point in expt.background:     point.y.free = True <p>Show free parameters after selection.</p> In\u00a0[28]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 hs cell length_a 6.86229 0.00029 -inf inf \u00c5 2 hs cell length_c 14.13651 0.00084 -inf inf \u00c5 3 hrpt linked_phases hs scale 0.25480 0.00305 -inf inf 4 hrpt peak broad_gauss_u 0.10000 -inf inf deg\u00b2 5 hrpt peak broad_gauss_v -0.20000 -inf inf deg\u00b2 6 hrpt peak broad_gauss_w 0.20000 -inf inf deg\u00b2 7 hrpt peak broad_lorentz_x 0.00000 -inf inf deg 8 hrpt instrument twotheta_offset 0.12712 0.00515 -inf inf deg 9 hrpt background 1 y 500.00000 -inf inf 10 hrpt background 2 y 500.00000 -inf inf 11 hrpt background 3 y 500.00000 -inf inf 12 hrpt background 4 y 500.00000 -inf inf 13 hrpt background 5 y 500.00000 -inf inf 14 hrpt background 6 y 500.00000 -inf inf 15 hrpt background 7 y 500.00000 -inf inf 16 hrpt background 8 y 500.00000 -inf inf 17 hrpt background 9 y 500.00000 -inf inf In\u00a0[29]: Copied! <pre>project.analysis.fit()\n</pre> project.analysis.fit() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 51.78 2 21 13.07 74.8% \u2193 3 40 12.66 3.2% \u2193 4 58 12.49 1.3% \u2193 5 340 12.41 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 12.41 at iteration 339\n</pre> <pre>\u2705 Fitting complete.\n</pre> In\u00a0[30]: Copied! <pre>project.analysis.show_fit_results()\n</pre> project.analysis.show_fit_results() <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 22.96 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 12.41\n</pre> <pre>\ud83d\udccf R-factor (Rf): 9.62%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 12.83%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 12.21%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 hs cell length_a 6.8623 6.8628 0.0003 \u00c5 0.01 % \u2191 2 hs cell length_c 14.1365 14.1389 0.0009 \u00c5 0.02 % \u2191 3 hrpt linked_phases hs scale 0.2548 0.4570 0.0032 79.37 % \u2191 4 hrpt peak broad_gauss_u 0.1000 0.1042 0.0451 deg\u00b2 4.18 % \u2191 5 hrpt peak broad_gauss_v -0.2000 -0.4977 0.0619 deg\u00b2 148.83 % \u2191 6 hrpt peak broad_gauss_w 0.2000 0.3592 0.0227 deg\u00b2 79.60 % \u2191 7 hrpt peak broad_lorentz_x 0.0000 0.5042 0.0075 deg N/A 8 hrpt instrument twotheta_offset 0.1271 0.1289 0.0038 deg 1.39 % \u2191 9 hrpt background 1 y 500.0000 645.4830 23.7674 29.10 % \u2191 10 hrpt background 2 y 500.0000 520.8595 13.6088 4.17 % \u2191 11 hrpt background 3 y 500.0000 455.0036 10.4220 9.00 % \u2193 12 hrpt background 4 y 500.0000 428.8639 5.4019 14.23 % \u2193 13 hrpt background 5 y 500.0000 453.5008 5.2135 9.30 % \u2193 14 hrpt background 6 y 500.0000 446.7592 5.4686 10.65 % \u2193 15 hrpt background 7 y 500.0000 411.5620 5.4490 17.69 % \u2193 16 hrpt background 8 y 500.0000 364.3828 5.6634 27.12 % \u2193 17 hrpt background 9 y 500.0000 469.2837 5.4987 6.14 % \u2193 In\u00a0[31]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[32]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True) In\u00a0[33]: Copied! <pre>model.atom_sites['O'].fract_x.free = True\nmodel.atom_sites['O'].fract_z.free = True\nmodel.atom_sites['Cl'].fract_z.free = True\nmodel.atom_sites['H'].fract_x.free = True\nmodel.atom_sites['H'].fract_z.free = True\n</pre> model.atom_sites['O'].fract_x.free = True model.atom_sites['O'].fract_z.free = True model.atom_sites['Cl'].fract_z.free = True model.atom_sites['H'].fract_x.free = True model.atom_sites['H'].fract_z.free = True <p>Show free parameters after selection.</p> In\u00a0[34]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 hs cell length_a 6.86276 0.00033 -inf inf \u00c5 2 hs cell length_c 14.13889 0.00088 -inf inf \u00c5 3 hs atom_site O fract_x 0.21000 -inf inf 4 hs atom_site O fract_z 0.06000 -inf inf 5 hs atom_site Cl fract_z 0.19700 -inf inf 6 hs atom_site H fract_x 0.13000 -inf inf 7 hs atom_site H fract_z 0.08000 -inf inf 8 hrpt linked_phases hs scale 0.45704 0.00318 -inf inf 9 hrpt peak broad_gauss_u 0.10418 0.04510 -inf inf deg\u00b2 10 hrpt peak broad_gauss_v -0.49766 0.06188 -inf inf deg\u00b2 11 hrpt peak broad_gauss_w 0.35919 0.02266 -inf inf deg\u00b2 12 hrpt peak broad_lorentz_x 0.50419 0.00753 -inf inf deg 13 hrpt instrument twotheta_offset 0.12889 0.00379 -inf inf deg 14 hrpt background 1 y 645.48303 23.76745 -inf inf 15 hrpt background 2 y 520.85952 13.60879 -inf inf 16 hrpt background 3 y 455.00355 10.42197 -inf inf 17 hrpt background 4 y 428.86390 5.40186 -inf inf 18 hrpt background 5 y 453.50084 5.21353 -inf inf 19 hrpt background 6 y 446.75916 5.46856 -inf inf 20 hrpt background 7 y 411.56202 5.44902 -inf inf 21 hrpt background 8 y 364.38279 5.66340 -inf inf 22 hrpt background 9 y 469.28374 5.49874 -inf inf In\u00a0[35]: Copied! <pre>project.analysis.fit()\n</pre> project.analysis.fit() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 12.43 2 26 5.11 58.9% \u2193 3 49 4.40 13.9% \u2193 4 72 4.35 1.3% \u2193 5 188 4.34 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 4.34 at iteration 187\n</pre> <pre>\u2705 Fitting complete.\n</pre> In\u00a0[36]: Copied! <pre>project.analysis.show_fit_results()\n</pre> project.analysis.show_fit_results() <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 13.08 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 4.34\n</pre> <pre>\ud83d\udccf R-factor (Rf): 6.01%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 7.75%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 7.54%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 hs cell length_a 6.8628 6.8621 0.0002 \u00c5 0.01 % \u2193 2 hs cell length_c 14.1389 14.1356 0.0005 \u00c5 0.02 % \u2193 3 hs atom_site O fract_x 0.2100 0.2059 0.0002 1.96 % \u2193 4 hs atom_site O fract_z 0.0600 0.0625 0.0002 4.14 % \u2191 5 hs atom_site Cl fract_z 0.1970 0.1977 0.0002 0.36 % \u2191 6 hs atom_site H fract_x 0.1300 0.1330 0.0002 2.33 % \u2191 7 hs atom_site H fract_z 0.0800 0.0877 0.0001 9.59 % \u2191 8 hrpt linked_phases hs scale 0.4570 0.4176 0.0021 8.63 % \u2193 9 hrpt peak broad_gauss_u 0.1042 0.1789 0.0119 deg\u00b2 71.71 % \u2191 10 hrpt peak broad_gauss_v -0.4977 -0.3964 0.0222 deg\u00b2 20.35 % \u2193 11 hrpt peak broad_gauss_w 0.3592 0.3272 0.0100 deg\u00b2 8.92 % \u2193 12 hrpt peak broad_lorentz_x 0.5042 0.3601 0.0089 deg 28.57 % \u2193 13 hrpt instrument twotheta_offset 0.1289 0.1167 0.0021 deg 9.43 % \u2193 14 hrpt background 1 y 645.4830 647.4024 14.0610 0.30 % \u2191 15 hrpt background 2 y 520.8595 523.4725 8.0510 0.50 % \u2191 16 hrpt background 3 y 455.0036 453.7545 6.1678 0.27 % \u2193 17 hrpt background 4 y 428.8639 437.9479 3.2221 2.12 % \u2191 18 hrpt background 5 y 453.5008 477.4863 3.2261 5.29 % \u2191 19 hrpt background 6 y 446.7592 485.0177 3.4007 8.56 % \u2191 20 hrpt background 7 y 411.5620 452.4338 3.2894 9.93 % \u2191 21 hrpt background 8 y 364.3828 435.3732 3.5007 19.48 % \u2191 22 hrpt background 9 y 469.2837 427.3883 3.6274 8.93 % \u2193 In\u00a0[37]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[38]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True) In\u00a0[39]: Copied! <pre>model.atom_sites['Zn'].b_iso.free = True\nmodel.atom_sites['Cu'].b_iso.free = True\nmodel.atom_sites['O'].b_iso.free = True\nmodel.atom_sites['Cl'].b_iso.free = True\nmodel.atom_sites['H'].b_iso.free = True\n</pre> model.atom_sites['Zn'].b_iso.free = True model.atom_sites['Cu'].b_iso.free = True model.atom_sites['O'].b_iso.free = True model.atom_sites['Cl'].b_iso.free = True model.atom_sites['H'].b_iso.free = True <p>Show free parameters after selection.</p> In\u00a0[40]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 hs cell length_a 6.86205 0.00020 -inf inf \u00c5 2 hs cell length_c 14.13560 0.00049 -inf inf \u00c5 3 hs atom_site Zn b_iso 0.50000 -inf inf \u00c5\u00b2 4 hs atom_site Cu b_iso 0.50000 -inf inf \u00c5\u00b2 5 hs atom_site O fract_x 0.20589 0.00022 -inf inf 6 hs atom_site O fract_z 0.06248 0.00016 -inf inf 7 hs atom_site O b_iso 0.50000 -inf inf \u00c5\u00b2 8 hs atom_site Cl fract_z 0.19771 0.00016 -inf inf 9 hs atom_site Cl b_iso 0.50000 -inf inf \u00c5\u00b2 10 hs atom_site H fract_x 0.13303 0.00017 -inf inf 11 hs atom_site H fract_z 0.08767 0.00012 -inf inf 12 hs atom_site H b_iso 0.50000 -inf inf \u00c5\u00b2 13 hrpt linked_phases hs scale 0.41758 0.00208 -inf inf 14 hrpt peak broad_gauss_u 0.17888 0.01187 -inf inf deg\u00b2 15 hrpt peak broad_gauss_v -0.39638 0.02219 -inf inf deg\u00b2 16 hrpt peak broad_gauss_w 0.32715 0.00999 -inf inf deg\u00b2 17 hrpt peak broad_lorentz_x 0.36012 0.00888 -inf inf deg 18 hrpt instrument twotheta_offset 0.11674 0.00215 -inf inf deg 19 hrpt background 1 y 647.40242 14.06098 -inf inf 20 hrpt background 2 y 523.47254 8.05103 -inf inf 21 hrpt background 3 y 453.75449 6.16778 -inf inf 22 hrpt background 4 y 437.94787 3.22213 -inf inf 23 hrpt background 5 y 477.48627 3.22612 -inf inf 24 hrpt background 6 y 485.01766 3.40075 -inf inf 25 hrpt background 7 y 452.43379 3.28943 -inf inf 26 hrpt background 8 y 435.37321 3.50066 -inf inf 27 hrpt background 9 y 427.38825 3.62743 -inf inf In\u00a0[41]: Copied! <pre>project.analysis.fit()\n</pre> project.analysis.fit() <pre>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 4.35 2 31 2.30 47.1% \u2193 3 59 2.11 8.3% \u2193 4 144 2.11 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 2.11 at iteration 118\n</pre> <pre>\u2705 Fitting complete.\n</pre> In\u00a0[42]: Copied! <pre>project.analysis.show_fit_results()\n</pre> project.analysis.show_fit_results() <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 9.22 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 2.11\n</pre> <pre>\ud83d\udccf R-factor (Rf): 4.17%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.05%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.72%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 hs cell length_a 6.8621 6.8615 0.0001 \u00c5 0.01 % \u2193 2 hs cell length_c 14.1356 14.1360 0.0004 \u00c5 0.00 % \u2191 3 hs atom_site Zn b_iso 0.5000 0.0855 0.0630 \u00c5\u00b2 82.91 % \u2193 4 hs atom_site Cu b_iso 0.5000 1.1937 0.0399 \u00c5\u00b2 138.74 % \u2191 5 hs atom_site O fract_x 0.2059 0.2060 0.0002 0.06 % \u2191 6 hs atom_site O fract_z 0.0625 0.0609 0.0001 2.53 % \u2193 7 hs atom_site O b_iso 0.5000 0.7001 0.0360 \u00c5\u00b2 40.02 % \u2191 8 hs atom_site Cl fract_z 0.1977 0.1968 0.0001 0.49 % \u2193 9 hs atom_site Cl b_iso 0.5000 1.1129 0.0385 \u00c5\u00b2 122.58 % \u2191 10 hs atom_site H fract_x 0.1330 0.1322 0.0002 0.62 % \u2193 11 hs atom_site H fract_z 0.0877 0.0900 0.0001 2.63 % \u2191 12 hs atom_site H b_iso 0.5000 2.3404 0.0401 \u00c5\u00b2 368.08 % \u2191 13 hrpt linked_phases hs scale 0.4176 0.4918 0.0022 17.76 % \u2191 14 hrpt peak broad_gauss_u 0.1789 0.1579 0.0076 deg\u00b2 11.70 % \u2193 15 hrpt peak broad_gauss_v -0.3964 -0.3571 0.0147 deg\u00b2 9.91 % \u2193 16 hrpt peak broad_gauss_w 0.3272 0.3498 0.0067 deg\u00b2 6.92 % \u2191 17 hrpt peak broad_lorentz_x 0.3601 0.2927 0.0065 deg 18.73 % \u2193 18 hrpt instrument twotheta_offset 0.1167 0.1137 0.0015 deg 2.62 % \u2193 19 hrpt background 1 y 647.4024 648.4125 9.7968 0.16 % \u2191 20 hrpt background 2 y 523.4725 523.7880 5.6095 0.06 % \u2191 21 hrpt background 3 y 453.7545 454.9375 4.2976 0.26 % \u2191 22 hrpt background 4 y 437.9479 435.9131 2.2512 0.46 % \u2193 23 hrpt background 5 y 477.4863 472.9718 2.2759 0.95 % \u2193 24 hrpt background 6 y 485.0177 486.6064 2.4356 0.33 % \u2191 25 hrpt background 7 y 452.4338 472.4095 2.3483 4.42 % \u2191 26 hrpt background 8 y 435.3732 496.7338 2.6211 14.09 % \u2191 27 hrpt background 9 y 427.3883 473.1457 2.9361 10.71 % \u2191 In\u00a0[43]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True) In\u00a0[44]: Copied! <pre>project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='hrpt', x_min=48, x_max=51, show_residual=True) In\u00a0[45]: Copied! <pre>project.summary.show_report()\n</pre> project.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>Untitled Project\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 hs\n</pre> <pre>Space group\n</pre> <pre>R -3 m\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 6.86149 2 b 6.86149 3 c 14.13604 4 alpha 90.00000 5 beta 90.00000 6 gamma 120.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 Zn Zn 0.00000 0.00000 0.50000 1.00000 0.08546 2 Cu Cu 0.50000 0.00000 0.00000 1.00000 1.19372 3 O O 0.20601 -0.20601 0.06090 1.00000 0.70009 4 Cl Cl 0.00000 0.00000 0.19675 1.00000 1.11288 5 H 2H 0.13220 -0.13220 0.08998 1.00000 2.34039 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c hrpt\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, constant wavelength\n</pre> <pre>Wavelength\n</pre> <pre>1.89000\n</pre> <pre>2\u03b8 offset\n</pre> <pre>0.11368\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT\n</pre> <pre>Peak broadening (Gaussian)\n</pre> Parameter Value 1 U 0.15795 2 V -0.35708 3 W 0.34978 <pre>Peak broadening (Lorentzian)\n</pre> Parameter Value 1 X 0.29266 2 Y 0.00000 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 2.11"},{"location":"tutorials/ed-6/#structure-refinement-hs-hrpt","title":"Structure Refinement: HS, HRPT\u00b6","text":"<p>This example demonstrates a Rietveld refinement of HS crystal structure using constant wavelength neutron powder diffraction data from HRPT at PSI.</p>"},{"location":"tutorials/ed-6/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-6/#define-sample-model","title":"Define Sample Model\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-6/#create-sample-model","title":"Create Sample Model\u00b6","text":""},{"location":"tutorials/ed-6/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-6/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-6/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-6/#define-experiment","title":"Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-6/#download-measured-data","title":"Download Measured Data\u00b6","text":""},{"location":"tutorials/ed-6/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-6/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-6/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-6/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-6/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-6/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage the sample model, experiment, and analysis.</p>"},{"location":"tutorials/ed-6/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-6/#set-plotting-engine","title":"Set Plotting Engine\u00b6","text":""},{"location":"tutorials/ed-6/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-6/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-6/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section shows the analysis process, including how to set up calculation and fitting engines.</p>"},{"location":"tutorials/ed-6/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-6/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-6/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-6/#perform-fit-15","title":"Perform Fit 1/5\u00b6","text":"<p>Set parameters to be refined.</p>"},{"location":"tutorials/ed-6/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-6/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-6/#perform-fit-25","title":"Perform Fit 2/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-6/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-6/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-6/#perform-fit-35","title":"Perform Fit 3/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-6/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-6/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-6/#perform-fit-45","title":"Perform Fit 4/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-6/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-6/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-6/#summary","title":"Summary\u00b6","text":"<p>This final section shows how to review the results of the analysis.</p>"},{"location":"tutorials/ed-6/#show-project-summary","title":"Show Project Summary\u00b6","text":""},{"location":"tutorials/ed-7/","title":"Si pd-neut-tof","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model = SampleModelFactory.create(name='si')\n</pre> model = SampleModelFactory.create(name='si') In\u00a0[4]: Copied! <pre>model.space_group.name_h_m = 'F d -3 m'\nmodel.space_group.it_coordinate_system_code = '2'\n</pre> model.space_group.name_h_m = 'F d -3 m' model.space_group.it_coordinate_system_code = '2' In\u00a0[5]: Copied! <pre>model.cell.length_a = 5.431\n</pre> model.cell.length_a = 5.431 In\u00a0[6]: Copied! <pre>model.atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0.125,\n    fract_y=0.125,\n    fract_z=0.125,\n    b_iso=0.5,\n)\n</pre> model.atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0.125,     fract_y=0.125,     fract_z=0.125,     b_iso=0.5, ) In\u00a0[7]: Copied! <pre>data_path = download_data(id=7, destination='data')\n</pre> data_path = download_data(id=7, destination='data') <pre>Getting data...\n</pre> <pre>Data #7: Si, SEPD (Argonne)\n</pre> <pre>\u2705 Data #7 downloaded to 'data/ed-7.xye'\n</pre> In\u00a0[8]: Copied! <pre>expt = ExperimentFactory.create(name='sepd', data_path=data_path, beam_mode='time-of-flight')\n</pre> expt = ExperimentFactory.create(name='sepd', data_path=data_path, beam_mode='time-of-flight') <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'sepd'. Number of data points: 5600\n</pre> In\u00a0[9]: Copied! <pre>expt.instrument.setup_twotheta_bank = 144.845\nexpt.instrument.calib_d_to_tof_offset = 0.0\nexpt.instrument.calib_d_to_tof_linear = 7476.91\nexpt.instrument.calib_d_to_tof_quad = -1.54\n</pre> expt.instrument.setup_twotheta_bank = 144.845 expt.instrument.calib_d_to_tof_offset = 0.0 expt.instrument.calib_d_to_tof_linear = 7476.91 expt.instrument.calib_d_to_tof_quad = -1.54 In\u00a0[10]: Copied! <pre>expt.peak_profile_type = 'pseudo-voigt * ikeda-carpenter'\nexpt.peak.broad_gauss_sigma_0 = 3.0\nexpt.peak.broad_gauss_sigma_1 = 40.0\nexpt.peak.broad_gauss_sigma_2 = 2.0\nexpt.peak.broad_mix_beta_0 = 0.04221\nexpt.peak.broad_mix_beta_1 = 0.00946\n</pre> expt.peak_profile_type = 'pseudo-voigt * ikeda-carpenter' expt.peak.broad_gauss_sigma_0 = 3.0 expt.peak.broad_gauss_sigma_1 = 40.0 expt.peak.broad_gauss_sigma_2 = 2.0 expt.peak.broad_mix_beta_0 = 0.04221 expt.peak.broad_mix_beta_1 = 0.00946 <pre>Peak profile type for experiment 'sepd' changed to\n</pre> <pre>pseudo-voigt * ikeda-carpenter\n</pre> In\u00a0[11]: Copied! <pre>expt.peak.asym_alpha_0 = 0.0\nexpt.peak.asym_alpha_1 = 0.5971\n</pre> expt.peak.asym_alpha_0 = 0.0 expt.peak.asym_alpha_1 = 0.5971 In\u00a0[12]: Copied! <pre>expt.background_type = 'line-segment'\nfor x in range(0, 35000, 5000):\n    expt.background.add(id=str(x), x=x, y=200)\n</pre> expt.background_type = 'line-segment' for x in range(0, 35000, 5000):     expt.background.add(id=str(x), x=x, y=200) <pre>Background type for experiment 'sepd' changed to\n</pre> <pre>line-segment\n</pre> In\u00a0[13]: Copied! <pre>expt.linked_phases.add(id='si', scale=10.0)\n</pre> expt.linked_phases.add(id='si', scale=10.0) In\u00a0[14]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[15]: Copied! <pre>project.sample_models.add(sample_model=model)\n</pre> project.sample_models.add(sample_model=model) In\u00a0[16]: Copied! <pre>project.experiments.add(experiment=expt)\n</pre> project.experiments.add(experiment=expt) In\u00a0[17]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[18]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[19]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', show_residual=True)\nproject.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', show_residual=True) project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True) In\u00a0[20]: Copied! <pre>model.cell.length_a.free = True\n\nexpt.linked_phases['si'].scale.free = True\nexpt.instrument.calib_d_to_tof_offset.free = True\n</pre> model.cell.length_a.free = True  expt.linked_phases['si'].scale.free = True expt.instrument.calib_d_to_tof_offset.free = True <p>Show free parameters after selection.</p> In\u00a0[21]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 si cell length_a 5.43100 -inf inf \u00c5 2 sepd linked_phases si scale 10.00000 -inf inf 3 sepd instrument d_to_tof_offset 0.00000 -inf inf \u00b5s In\u00a0[22]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sepd' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 113.06 2 7 72.20 36.1% \u2193 3 11 66.76 7.5% \u2193 4 30 66.72 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 66.72 at iteration 26\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 10.59 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 66.72\n</pre> <pre>\ud83d\udccf R-factor (Rf): 23.05%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 12.56%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 12.54%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 si cell length_a 5.4310 5.4314 0.0002 \u00c5 0.01 % \u2191 2 sepd linked_phases si scale 10.0000 13.3619 0.1153 33.62 % \u2191 3 sepd instrument d_to_tof_offset 0.0000 -9.2543 0.2503 \u00b5s N/A In\u00a0[23]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', show_residual=True) In\u00a0[24]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True) In\u00a0[25]: Copied! <pre>for point in expt.background:\n    point.y.free = True\n</pre> for point in expt.background:     point.y.free = True <p>Show free parameters after selection.</p> In\u00a0[26]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 si cell length_a 5.43135 0.00018 -inf inf \u00c5 2 sepd linked_phases si scale 13.36187 0.11531 -inf inf 3 sepd instrument d_to_tof_offset -9.25432 0.25033 -inf inf \u00b5s 4 sepd background 0 y 200.00000 -inf inf 5 sepd background 5000 y 200.00000 -inf inf 6 sepd background 10000 y 200.00000 -inf inf 7 sepd background 15000 y 200.00000 -inf inf 8 sepd background 20000 y 200.00000 -inf inf 9 sepd background 25000 y 200.00000 -inf inf 10 sepd background 30000 y 200.00000 -inf inf In\u00a0[27]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sepd' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 66.80 2 14 3.38 94.9% \u2193 3 48 3.38 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.38 at iteration 47\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 15.31 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.38\n</pre> <pre>\ud83d\udccf R-factor (Rf): 9.29%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 6.35%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 5.99%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 si cell length_a 5.4314 5.4314 0.0000 \u00c5 0.00 % \u2191 2 sepd linked_phases si scale 13.3619 14.6317 0.0265 9.50 % \u2191 3 sepd instrument d_to_tof_offset -9.2543 -9.2534 0.0515 \u00b5s 0.01 % \u2193 4 sepd background 0 y 200.0000 268.6002 0.9745 34.30 % \u2191 5 sepd background 5000 y 200.0000 144.7589 0.4071 27.62 % \u2193 6 sepd background 10000 y 200.0000 120.0247 0.4282 39.99 % \u2193 7 sepd background 15000 y 200.0000 135.8494 0.8169 32.08 % \u2193 8 sepd background 20000 y 200.0000 132.6887 1.4317 33.66 % \u2193 9 sepd background 25000 y 200.0000 175.1775 2.8755 12.41 % \u2193 10 sepd background 30000 y 200.0000 180.4556 5.8525 9.77 % \u2193 In\u00a0[28]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', show_residual=True) In\u00a0[29]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True) In\u00a0[30]: Copied! <pre>for point in expt.background:\n    point.y.free = False\n</pre> for point in expt.background:     point.y.free = False <p>Set more parameters to be refined.</p> In\u00a0[31]: Copied! <pre>expt.peak.broad_gauss_sigma_0.free = True\nexpt.peak.broad_gauss_sigma_1.free = True\nexpt.peak.broad_gauss_sigma_2.free = True\n</pre> expt.peak.broad_gauss_sigma_0.free = True expt.peak.broad_gauss_sigma_1.free = True expt.peak.broad_gauss_sigma_2.free = True <p>Show free parameters after selection.</p> In\u00a0[32]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 si cell length_a 5.43137 0.00004 -inf inf \u00c5 2 sepd linked_phases si scale 14.63167 0.02651 -inf inf 3 sepd peak gauss_sigma_0 3.00000 -inf inf \u00b5s\u00b2 4 sepd peak gauss_sigma_1 40.00000 -inf inf \u00b5s/\u212b 5 sepd peak gauss_sigma_2 2.00000 -inf inf \u00b5s\u00b2/\u212b\u00b2 6 sepd instrument d_to_tof_offset -9.25336 0.05153 -inf inf \u00b5s In\u00a0[33]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sepd' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 3.38 2 10 3.21 5.0% \u2193 3 39 3.21 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.21 at iteration 38\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 12.61 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.21\n</pre> <pre>\ud83d\udccf R-factor (Rf): 9.00%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.49%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.81%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 si cell length_a 5.4314 5.4314 0.0000 \u00c5 0.00 % \u2191 2 sepd linked_phases si scale 14.6317 14.7057 0.0257 0.51 % \u2191 3 sepd peak gauss_sigma_0 3.0000 5.7727 0.4206 \u00b5s\u00b2 92.42 % \u2191 4 sepd peak gauss_sigma_1 40.0000 44.2827 0.7966 \u00b5s/\u212b 10.71 % \u2191 5 sepd peak gauss_sigma_2 2.0000 1.2962 0.1680 \u00b5s\u00b2/\u212b\u00b2 35.19 % \u2193 6 sepd instrument d_to_tof_offset -9.2534 -9.2506 0.0546 \u00b5s 0.03 % \u2193 In\u00a0[34]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', show_residual=True) In\u00a0[35]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True) In\u00a0[36]: Copied! <pre>model.atom_sites['Si'].b_iso.free = True\n</pre> model.atom_sites['Si'].b_iso.free = True <p>Show free parameters after selection.</p> In\u00a0[37]: Copied! <pre>project.analysis.show_free_params()\n</pre> project.analysis.show_free_params() <pre>Free parameters for both sample models (\ud83e\udde9 data blocks) and experiments (\ud83d\udd2c data blocks)\n</pre> datablock category entry parameter value uncertainty min max units 1 si cell length_a 5.43143 0.00004 -inf inf \u00c5 2 si atom_site Si b_iso 0.50000 -inf inf \u00c5\u00b2 3 sepd linked_phases si scale 14.70568 0.02567 -inf inf 4 sepd peak gauss_sigma_0 5.77274 0.42055 -inf inf \u00b5s\u00b2 5 sepd peak gauss_sigma_1 44.28265 0.79664 -inf inf \u00b5s/\u212b 6 sepd peak gauss_sigma_2 1.29621 0.16795 -inf inf \u00b5s\u00b2/\u212b\u00b2 7 sepd instrument d_to_tof_offset -9.25065 0.05458 -inf inf \u00b5s In\u00a0[38]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'sepd' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 3.21 2 44 3.19 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.19 at iteration 43\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 13.18 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.19\n</pre> <pre>\ud83d\udccf R-factor (Rf): 9.01%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.28%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 4.34%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 si cell length_a 5.4314 5.4314 0.0000 \u00c5 0.00 % \u2191 2 si atom_site Si b_iso 0.5000 0.5201 0.0034 \u00c5\u00b2 4.02 % \u2191 3 sepd linked_phases si scale 14.7057 14.8594 0.0366 1.05 % \u2191 4 sepd peak gauss_sigma_0 5.7727 4.8233 0.4394 \u00b5s\u00b2 16.45 % \u2193 5 sepd peak gauss_sigma_1 44.2827 45.2122 0.8016 \u00b5s/\u212b 2.10 % \u2191 6 sepd peak gauss_sigma_2 1.2962 1.1931 0.1667 \u00b5s\u00b2/\u212b\u00b2 7.95 % \u2193 7 sepd instrument d_to_tof_offset -9.2506 -9.2823 0.0548 \u00b5s 0.34 % \u2191 In\u00a0[39]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', show_residual=True) In\u00a0[40]: Copied! <pre>project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='sepd', x_min=23200, x_max=23700, show_residual=True)"},{"location":"tutorials/ed-7/#structure-refinement-si-sepd","title":"Structure Refinement: Si, SEPD\u00b6","text":"<p>This example demonstrates a Rietveld refinement of Si crystal structure using time-of-flight neutron powder diffraction data from SEPD at Argonne.</p>"},{"location":"tutorials/ed-7/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-7/#define-sample-model","title":"Define Sample Model\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-7/#create-sample-model","title":"Create Sample Model\u00b6","text":""},{"location":"tutorials/ed-7/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-7/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-7/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-7/#define-experiment","title":"Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-7/#download-measured-data","title":"Download Measured Data\u00b6","text":""},{"location":"tutorials/ed-7/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-7/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-7/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-7/#set-peak-asymmetry","title":"Set Peak Asymmetry\u00b6","text":""},{"location":"tutorials/ed-7/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-7/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-7/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage the sample model, experiment, and analysis.</p>"},{"location":"tutorials/ed-7/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-7/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-7/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-7/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section shows the analysis process, including how to set up calculation and fitting engines.</p>"},{"location":"tutorials/ed-7/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-7/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-7/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-7/#perform-fit-15","title":"Perform Fit 1/5\u00b6","text":"<p>Set parameters to be refined.</p>"},{"location":"tutorials/ed-7/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-7/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-7/#perform-fit-25","title":"Perform Fit 2/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-7/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-7/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-7/#perform-fit-35","title":"Perform Fit 3/5\u00b6","text":"<p>Fix background points.</p>"},{"location":"tutorials/ed-7/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-7/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-7/#perform-fit-45","title":"Perform Fit 4/5\u00b6","text":"<p>Set more parameters to be refined.</p>"},{"location":"tutorials/ed-7/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-7/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-8/","title":"NCAF pd-neut-tof","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model = SampleModelFactory.create(name='ncaf')\n</pre> model = SampleModelFactory.create(name='ncaf') In\u00a0[4]: Copied! <pre>model.space_group.name_h_m = 'I 21 3'\nmodel.space_group.it_coordinate_system_code = '1'\n</pre> model.space_group.name_h_m = 'I 21 3' model.space_group.it_coordinate_system_code = '1' In\u00a0[5]: Copied! <pre>model.cell.length_a = 10.250256\n</pre> model.cell.length_a = 10.250256 In\u00a0[6]: Copied! <pre>model.atom_sites.add(\n    label='Ca',\n    type_symbol='Ca',\n    fract_x=0.4663,\n    fract_y=0.0,\n    fract_z=0.25,\n    wyckoff_letter='b',\n    b_iso=0.92,\n)\nmodel.atom_sites.add(\n    label='Al',\n    type_symbol='Al',\n    fract_x=0.2521,\n    fract_y=0.2521,\n    fract_z=0.2521,\n    wyckoff_letter='a',\n    b_iso=0.73,\n)\nmodel.atom_sites.add(\n    label='Na',\n    type_symbol='Na',\n    fract_x=0.0851,\n    fract_y=0.0851,\n    fract_z=0.0851,\n    wyckoff_letter='a',\n    b_iso=2.08,\n)\nmodel.atom_sites.add(\n    label='F1',\n    type_symbol='F',\n    fract_x=0.1377,\n    fract_y=0.3054,\n    fract_z=0.1195,\n    wyckoff_letter='c',\n    b_iso=0.90,\n)\nmodel.atom_sites.add(\n    label='F2',\n    type_symbol='F',\n    fract_x=0.3625,\n    fract_y=0.3633,\n    fract_z=0.1867,\n    wyckoff_letter='c',\n    b_iso=1.37,\n)\nmodel.atom_sites.add(\n    label='F3',\n    type_symbol='F',\n    fract_x=0.4612,\n    fract_y=0.4612,\n    fract_z=0.4612,\n    wyckoff_letter='a',\n    b_iso=0.88,\n)\n</pre> model.atom_sites.add(     label='Ca',     type_symbol='Ca',     fract_x=0.4663,     fract_y=0.0,     fract_z=0.25,     wyckoff_letter='b',     b_iso=0.92, ) model.atom_sites.add(     label='Al',     type_symbol='Al',     fract_x=0.2521,     fract_y=0.2521,     fract_z=0.2521,     wyckoff_letter='a',     b_iso=0.73, ) model.atom_sites.add(     label='Na',     type_symbol='Na',     fract_x=0.0851,     fract_y=0.0851,     fract_z=0.0851,     wyckoff_letter='a',     b_iso=2.08, ) model.atom_sites.add(     label='F1',     type_symbol='F',     fract_x=0.1377,     fract_y=0.3054,     fract_z=0.1195,     wyckoff_letter='c',     b_iso=0.90, ) model.atom_sites.add(     label='F2',     type_symbol='F',     fract_x=0.3625,     fract_y=0.3633,     fract_z=0.1867,     wyckoff_letter='c',     b_iso=1.37, ) model.atom_sites.add(     label='F3',     type_symbol='F',     fract_x=0.4612,     fract_y=0.4612,     fract_z=0.4612,     wyckoff_letter='a',     b_iso=0.88, ) In\u00a0[7]: Copied! <pre>data_path56 = download_data(id=9, destination='data')\n</pre> data_path56 = download_data(id=9, destination='data') <pre>Getting data...\n</pre> <pre>Data #9: NCAF, WISH (ISIS), Detector banks 5 &amp; 6\n</pre> <pre>\u2705 Data #9 downloaded to 'data/ed-9.xys'\n</pre> In\u00a0[8]: Copied! <pre>data_path47 = download_data(id=10, destination='data')\n</pre> data_path47 = download_data(id=10, destination='data') <pre>Getting data...\n</pre> <pre>Data #10: NCAF, WISH (ISIS), Detector banks 4 &amp; 7\n</pre> <pre>\u2705 Data #10 downloaded to 'data/ed-10.xys'\n</pre> In\u00a0[9]: Copied! <pre>expt56 = ExperimentFactory.create(\n    name='wish_5_6',\n    data_path=data_path56,\n    beam_mode='time-of-flight',\n)\n</pre> expt56 = ExperimentFactory.create(     name='wish_5_6',     data_path=data_path56,     beam_mode='time-of-flight', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'wish_5_6'. Number of data points: 4121\n</pre> In\u00a0[10]: Copied! <pre>expt47 = ExperimentFactory.create(\n    name='wish_4_7',\n    data_path=data_path47,\n    beam_mode='time-of-flight',\n)\n</pre> expt47 = ExperimentFactory.create(     name='wish_4_7',     data_path=data_path47,     beam_mode='time-of-flight', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'wish_4_7'. Number of data points: 4043\n</pre> In\u00a0[11]: Copied! <pre>expt56.instrument.setup_twotheta_bank = 152.827\nexpt56.instrument.calib_d_to_tof_offset = -13.5\nexpt56.instrument.calib_d_to_tof_linear = 20773.0\nexpt56.instrument.calib_d_to_tof_quad = -1.08308\n</pre> expt56.instrument.setup_twotheta_bank = 152.827 expt56.instrument.calib_d_to_tof_offset = -13.5 expt56.instrument.calib_d_to_tof_linear = 20773.0 expt56.instrument.calib_d_to_tof_quad = -1.08308 In\u00a0[12]: Copied! <pre>expt47.instrument.setup_twotheta_bank = 121.660\nexpt47.instrument.calib_d_to_tof_offset = -15.0\nexpt47.instrument.calib_d_to_tof_linear = 18660.0\nexpt47.instrument.calib_d_to_tof_quad = -0.47488\n</pre> expt47.instrument.setup_twotheta_bank = 121.660 expt47.instrument.calib_d_to_tof_offset = -15.0 expt47.instrument.calib_d_to_tof_linear = 18660.0 expt47.instrument.calib_d_to_tof_quad = -0.47488 In\u00a0[13]: Copied! <pre>expt56.peak.broad_gauss_sigma_0 = 0.0\nexpt56.peak.broad_gauss_sigma_1 = 0.0\nexpt56.peak.broad_gauss_sigma_2 = 15.5\nexpt56.peak.broad_mix_beta_0 = 0.007\nexpt56.peak.broad_mix_beta_1 = 0.01\nexpt56.peak.asym_alpha_0 = -0.0094\nexpt56.peak.asym_alpha_1 = 0.1\n</pre> expt56.peak.broad_gauss_sigma_0 = 0.0 expt56.peak.broad_gauss_sigma_1 = 0.0 expt56.peak.broad_gauss_sigma_2 = 15.5 expt56.peak.broad_mix_beta_0 = 0.007 expt56.peak.broad_mix_beta_1 = 0.01 expt56.peak.asym_alpha_0 = -0.0094 expt56.peak.asym_alpha_1 = 0.1 In\u00a0[14]: Copied! <pre>expt47.peak.broad_gauss_sigma_0 = 0.0\nexpt47.peak.broad_gauss_sigma_1 = 29.8\nexpt47.peak.broad_gauss_sigma_2 = 18.0\nexpt47.peak.broad_mix_beta_0 = 0.006\nexpt47.peak.broad_mix_beta_1 = 0.015\nexpt47.peak.asym_alpha_0 = -0.0115\nexpt47.peak.asym_alpha_1 = 0.1\n</pre> expt47.peak.broad_gauss_sigma_0 = 0.0 expt47.peak.broad_gauss_sigma_1 = 29.8 expt47.peak.broad_gauss_sigma_2 = 18.0 expt47.peak.broad_mix_beta_0 = 0.006 expt47.peak.broad_mix_beta_1 = 0.015 expt47.peak.asym_alpha_0 = -0.0115 expt47.peak.asym_alpha_1 = 0.1 In\u00a0[15]: Copied! <pre>expt56.background_type = 'line-segment'\nfor idx, (x, y) in enumerate(\n    [\n        (9162, 465),\n        (11136, 593),\n        (13313, 497),\n        (14906, 546),\n        (16454, 533),\n        (17352, 496),\n        (18743, 428),\n        (20179, 452),\n        (21368, 397),\n        (22176, 468),\n        (22827, 477),\n        (24644, 380),\n        (26439, 381),\n        (28257, 378),\n        (31196, 343),\n        (34034, 328),\n        (37265, 310),\n        (41214, 323),\n        (44827, 283),\n        (49830, 273),\n        (52905, 257),\n        (58204, 260),\n        (62916, 261),\n        (70186, 262),\n        (74204, 262),\n        (82103, 268),\n        (91958, 268),\n        (102712, 262),\n    ],\n    start=1,\n):\n    expt56.background.add(id=str(idx), x=x, y=y)\n</pre> expt56.background_type = 'line-segment' for idx, (x, y) in enumerate(     [         (9162, 465),         (11136, 593),         (13313, 497),         (14906, 546),         (16454, 533),         (17352, 496),         (18743, 428),         (20179, 452),         (21368, 397),         (22176, 468),         (22827, 477),         (24644, 380),         (26439, 381),         (28257, 378),         (31196, 343),         (34034, 328),         (37265, 310),         (41214, 323),         (44827, 283),         (49830, 273),         (52905, 257),         (58204, 260),         (62916, 261),         (70186, 262),         (74204, 262),         (82103, 268),         (91958, 268),         (102712, 262),     ],     start=1, ):     expt56.background.add(id=str(idx), x=x, y=y) <pre>Background type for experiment 'wish_5_6' changed to\n</pre> <pre>line-segment\n</pre> In\u00a0[16]: Copied! <pre>expt47.background_type = 'line-segment'\nfor idx, (x, y) in enumerate(\n    [\n        (9090, 488),\n        (10672, 566),\n        (12287, 494),\n        (14037, 559),\n        (15451, 529),\n        (16764, 445),\n        (18076, 460),\n        (19456, 413),\n        (20466, 511),\n        (21880, 396),\n        (23798, 391),\n        (25447, 385),\n        (28073, 349),\n        (30058, 332),\n        (32583, 309),\n        (34804, 355),\n        (37160, 318),\n        (40324, 290),\n        (46895, 260),\n        (50631, 256),\n        (54602, 246),\n        (58439, 264),\n        (66520, 250),\n        (75002, 258),\n        (83649, 257),\n        (92770, 255),\n        (101524, 260),\n    ],\n    start=1,\n):\n    expt47.background.add(id=str(idx), x=x, y=y)\n</pre> expt47.background_type = 'line-segment' for idx, (x, y) in enumerate(     [         (9090, 488),         (10672, 566),         (12287, 494),         (14037, 559),         (15451, 529),         (16764, 445),         (18076, 460),         (19456, 413),         (20466, 511),         (21880, 396),         (23798, 391),         (25447, 385),         (28073, 349),         (30058, 332),         (32583, 309),         (34804, 355),         (37160, 318),         (40324, 290),         (46895, 260),         (50631, 256),         (54602, 246),         (58439, 264),         (66520, 250),         (75002, 258),         (83649, 257),         (92770, 255),         (101524, 260),     ],     start=1, ):     expt47.background.add(id=str(idx), x=x, y=y) <pre>Background type for experiment 'wish_4_7' changed to\n</pre> <pre>line-segment\n</pre> In\u00a0[17]: Copied! <pre>expt56.linked_phases.add(id='ncaf', scale=1.0)\n</pre> expt56.linked_phases.add(id='ncaf', scale=1.0) In\u00a0[18]: Copied! <pre>expt47.linked_phases.add(id='ncaf', scale=2.0)\n</pre> expt47.linked_phases.add(id='ncaf', scale=2.0) In\u00a0[19]: Copied! <pre>expt56.excluded_regions.add(id='1', start=0, end=10010)\nexpt56.excluded_regions.add(id='2', start=100010, end=200000)\n</pre> expt56.excluded_regions.add(id='1', start=0, end=10010) expt56.excluded_regions.add(id='2', start=100010, end=200000) In\u00a0[20]: Copied! <pre>expt47.excluded_regions.add(id='1', start=0, end=10006)\nexpt47.excluded_regions.add(id='2', start=100004, end=200000)\n</pre> expt47.excluded_regions.add(id='1', start=0, end=10006) expt47.excluded_regions.add(id='2', start=100004, end=200000) In\u00a0[21]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[22]: Copied! <pre># Keep the auto-selected engine. Alternatively, you can uncomment the\n# line below to explicitly set the engine to the required one.\n# project.plotter.engine = 'plotly'\n</pre> # Keep the auto-selected engine. Alternatively, you can uncomment the # line below to explicitly set the engine to the required one. # project.plotter.engine = 'plotly' In\u00a0[23]: Copied! <pre>project.sample_models.add(sample_model=model)\n</pre> project.sample_models.add(sample_model=model) In\u00a0[24]: Copied! <pre>project.experiments.add(experiment=expt56)\nproject.experiments.add(experiment=expt47)\n</pre> project.experiments.add(experiment=expt56) project.experiments.add(experiment=expt47) In\u00a0[25]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[26]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[27]: Copied! <pre>project.analysis.fit_mode = 'joint'\n</pre> project.analysis.fit_mode = 'joint' <pre>Current fit mode changed to\n</pre> <pre>joint\n</pre> In\u00a0[28]: Copied! <pre>model.atom_sites['Ca'].b_iso.free = True\nmodel.atom_sites['Al'].b_iso.free = True\nmodel.atom_sites['Na'].b_iso.free = True\nmodel.atom_sites['F1'].b_iso.free = True\nmodel.atom_sites['F2'].b_iso.free = True\nmodel.atom_sites['F3'].b_iso.free = True\n</pre> model.atom_sites['Ca'].b_iso.free = True model.atom_sites['Al'].b_iso.free = True model.atom_sites['Na'].b_iso.free = True model.atom_sites['F1'].b_iso.free = True model.atom_sites['F2'].b_iso.free = True model.atom_sites['F3'].b_iso.free = True In\u00a0[29]: Copied! <pre>expt56.linked_phases['ncaf'].scale.free = True\nexpt56.instrument.calib_d_to_tof_offset.free = True\nexpt56.instrument.calib_d_to_tof_linear.free = True\nexpt56.peak.broad_gauss_sigma_2.free = True\nexpt56.peak.broad_mix_beta_0.free = True\nexpt56.peak.broad_mix_beta_1.free = True\nexpt56.peak.asym_alpha_1.free = True\n\nexpt47.linked_phases['ncaf'].scale.free = True\nexpt47.instrument.calib_d_to_tof_linear.free = True\nexpt47.instrument.calib_d_to_tof_offset.free = True\nexpt47.peak.broad_gauss_sigma_2.free = True\nexpt47.peak.broad_mix_beta_0.free = True\nexpt47.peak.broad_mix_beta_1.free = True\nexpt47.peak.asym_alpha_1.free = True\n</pre> expt56.linked_phases['ncaf'].scale.free = True expt56.instrument.calib_d_to_tof_offset.free = True expt56.instrument.calib_d_to_tof_linear.free = True expt56.peak.broad_gauss_sigma_2.free = True expt56.peak.broad_mix_beta_0.free = True expt56.peak.broad_mix_beta_1.free = True expt56.peak.asym_alpha_1.free = True  expt47.linked_phases['ncaf'].scale.free = True expt47.instrument.calib_d_to_tof_linear.free = True expt47.instrument.calib_d_to_tof_offset.free = True expt47.peak.broad_gauss_sigma_2.free = True expt47.peak.broad_mix_beta_0.free = True expt47.peak.broad_mix_beta_1.free = True expt47.peak.asym_alpha_1.free = True In\u00a0[30]: Copied! <pre>project.plot_meas_vs_calc(expt_name='wish_5_6', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='wish_5_6', show_residual=True) In\u00a0[31]: Copied! <pre>project.plot_meas_vs_calc(expt_name='wish_4_7', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='wish_4_7', show_residual=True) In\u00a0[32]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using all experiments \ud83d\udd2c ['wish_5_6', 'wish_4_7'] for 'joint' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 47.53 2 24 15.57 67.2% \u2193 3 109 15.49 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 15.49 at iteration 95\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 84.00 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 15.49\n</pre> <pre>\ud83d\udccf R-factor (Rf): 6.97%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 8.03%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 9.12%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 ncaf atom_site Ca b_iso 0.9200 0.9340 0.0448 \u00c5\u00b2 1.52 % \u2191 2 ncaf atom_site Al b_iso 0.7300 0.7330 0.0569 \u00c5\u00b2 0.41 % \u2191 3 ncaf atom_site Na b_iso 2.0800 2.0474 0.1082 \u00c5\u00b2 1.57 % \u2193 4 ncaf atom_site F1 b_iso 0.9000 0.9389 0.0373 \u00c5\u00b2 4.32 % \u2191 5 ncaf atom_site F2 b_iso 1.3700 1.3442 0.0408 \u00c5\u00b2 1.88 % \u2193 6 ncaf atom_site F3 b_iso 0.8800 0.8481 0.0551 \u00c5\u00b2 3.62 % \u2193 7 wish_5_6 linked_phases ncaf scale 1.0000 1.1029 0.0035 10.29 % \u2191 8 wish_5_6 peak gauss_sigma_2 15.5000 15.6543 0.7398 \u00b5s\u00b2/\u212b\u00b2 1.00 % \u2191 9 wish_5_6 peak mix_beta_0 0.0070 0.0067 0.0000 deg 4.54 % \u2193 10 wish_5_6 peak mix_beta_1 0.0100 0.0101 0.0002 deg 1.46 % \u2191 11 wish_5_6 peak asym_alpha_1 0.1000 0.1094 0.0012 9.43 % \u2191 12 wish_5_6 instrument d_to_tof_offset -13.5000 -13.6260 0.4257 \u00b5s 0.93 % \u2191 13 wish_5_6 instrument d_to_tof_linear 20773.0000 20773.0394 0.3051 \u00b5s/\u212b 0.00 % \u2191 14 wish_4_7 linked_phases ncaf scale 2.0000 2.5216 0.0077 26.08 % \u2191 15 wish_4_7 peak gauss_sigma_2 18.0000 18.2604 0.8685 \u00b5s\u00b2/\u212b\u00b2 1.45 % \u2191 16 wish_4_7 peak mix_beta_0 0.0060 0.0065 0.0000 deg 7.52 % \u2191 17 wish_4_7 peak mix_beta_1 0.0150 0.0148 0.0003 deg 1.38 % \u2193 18 wish_4_7 peak asym_alpha_1 0.1000 0.1222 0.0018 22.15 % \u2191 19 wish_4_7 instrument d_to_tof_offset -15.0000 -14.9768 0.5084 \u00b5s 0.15 % \u2193 20 wish_4_7 instrument d_to_tof_linear 18660.0000 18660.1028 0.3625 \u00b5s/\u212b 0.00 % \u2191 In\u00a0[33]: Copied! <pre>project.plot_meas_vs_calc(expt_name='wish_5_6', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='wish_5_6', show_residual=True) In\u00a0[34]: Copied! <pre>project.plot_meas_vs_calc(expt_name='wish_4_7', show_residual=True)\n</pre> project.plot_meas_vs_calc(expt_name='wish_4_7', show_residual=True) In\u00a0[35]: Copied! <pre>project.summary.show_report()\n</pre> project.summary.show_report() <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nPROJECT INFO\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Title\n</pre> <pre>Untitled Project\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nCRYSTALLOGRAPHIC DATA\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Phase datablock\n</pre> <pre>\ud83e\udde9 ncaf\n</pre> <pre>Space group\n</pre> <pre>I 21 3\n</pre> <pre>Cell parameters\n</pre> Parameter Value 1 a 10.25026 2 b 10.25026 3 c 10.25026 4 alpha 90.00000 5 beta 90.00000 6 gamma 90.00000 <pre>Atom sites\n</pre> label type x y z occ Biso 1 Ca Ca 0.46630 0.00000 0.25000 1.00000 0.93400 2 Al Al 0.25210 0.25210 0.25210 1.00000 0.73301 3 Na Na 0.08510 0.08510 0.08510 1.00000 2.04740 4 F1 F 0.13770 0.30540 0.11950 1.00000 0.93890 5 F2 F 0.36250 0.36330 0.18670 1.00000 1.34424 6 F3 F 0.46120 0.46120 0.46120 1.00000 0.84814 <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nEXPERIMENTS\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c wish_5_6\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, time-of-flight\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT_IKEDA_CARPENTER\n</pre> <pre>Experiment datablock\n</pre> <pre>\ud83d\udd2c wish_4_7\n</pre> <pre>Experiment type\n</pre> <pre>powder, neutron, time-of-flight\n</pre> <pre>Profile type\n</pre> <pre>PeakProfileTypeEnum.PSEUDO_VOIGT_IKEDA_CARPENTER\n</pre> <pre>\u2014\u2014\u2014\u2014\u2014\u2014\u2014\nFITTING\n\u2014\u2014\u2014\u2014\u2014\u2014\u2014\n</pre> <pre>Calculation engine\n</pre> <pre>cryspy\n</pre> <pre>Minimization engine\n</pre> <pre>lmfit (leastsq)\n</pre> <pre>Fit quality\n</pre> metric value 1 Goodness-of-fit (reduced \u03c7\u00b2) 15.49"},{"location":"tutorials/ed-8/#structure-refinement-ncaf-wish","title":"Structure Refinement: NCAF, WISH\u00b6","text":"<p>This example demonstrates a Rietveld refinement of Na2Ca3Al2F14 crystal structure using time-of-flight neutron powder diffraction data from WISH at ISIS.</p> <p>Two datasets from detector banks 5+6 and 4+7 are used for joint fitting.</p>"},{"location":"tutorials/ed-8/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-8/#define-sample-model","title":"Define Sample Model\u00b6","text":"<p>This section covers how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-8/#create-sample-model","title":"Create Sample Model\u00b6","text":""},{"location":"tutorials/ed-8/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-8/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-8/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-8/#define-experiment","title":"Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-8/#download-measured-data","title":"Download Measured Data\u00b6","text":""},{"location":"tutorials/ed-8/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-8/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-8/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-8/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-8/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-8/#set-excluded-regions","title":"Set Excluded Regions\u00b6","text":""},{"location":"tutorials/ed-8/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage the sample model, experiments, and analysis</p>"},{"location":"tutorials/ed-8/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-8/#set-plotting-engine","title":"Set Plotting Engine\u00b6","text":""},{"location":"tutorials/ed-8/#add-sample-model","title":"Add Sample Model\u00b6","text":""},{"location":"tutorials/ed-8/#add-experiment","title":"Add Experiment\u00b6","text":""},{"location":"tutorials/ed-8/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section shows the analysis process, including how to set up calculation and fitting engines.</p>"},{"location":"tutorials/ed-8/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-8/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-8/#set-fit-mode","title":"Set Fit Mode\u00b6","text":""},{"location":"tutorials/ed-8/#set-free-parameters","title":"Set Free Parameters\u00b6","text":""},{"location":"tutorials/ed-8/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-8/#run-fitting","title":"Run Fitting\u00b6","text":""},{"location":"tutorials/ed-8/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"tutorials/ed-8/#summary","title":"Summary\u00b6","text":"<p>This final section shows how to review the results of the analysis.</p>"},{"location":"tutorials/ed-8/#show-project-summary","title":"Show Project Summary\u00b6","text":""},{"location":"tutorials/ed-9/","title":"LBCO+Si McStas","text":"In\u00a0[2]: Copied! <pre>from easydiffraction import ExperimentFactory\nfrom easydiffraction import Project\nfrom easydiffraction import SampleModelFactory\nfrom easydiffraction import download_data\n</pre> from easydiffraction import ExperimentFactory from easydiffraction import Project from easydiffraction import SampleModelFactory from easydiffraction import download_data In\u00a0[3]: Copied! <pre>model_1 = SampleModelFactory.create(name='lbco')\n</pre> model_1 = SampleModelFactory.create(name='lbco') In\u00a0[4]: Copied! <pre>model_1.space_group.name_h_m = 'P m -3 m'\nmodel_1.space_group.it_coordinate_system_code = '1'\n</pre> model_1.space_group.name_h_m = 'P m -3 m' model_1.space_group.it_coordinate_system_code = '1' In\u00a0[5]: Copied! <pre>model_1.cell.length_a = 3.8909\n</pre> model_1.cell.length_a = 3.8909 In\u00a0[6]: Copied! <pre>model_1.atom_sites.add(\n    label='La',\n    type_symbol='La',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.2,\n    occupancy=0.5,\n)\nmodel_1.atom_sites.add(\n    label='Ba',\n    type_symbol='Ba',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    wyckoff_letter='a',\n    b_iso=0.2,\n    occupancy=0.5,\n)\nmodel_1.atom_sites.add(\n    label='Co',\n    type_symbol='Co',\n    fract_x=0.5,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='b',\n    b_iso=0.2567,\n)\nmodel_1.atom_sites.add(\n    label='O',\n    type_symbol='O',\n    fract_x=0,\n    fract_y=0.5,\n    fract_z=0.5,\n    wyckoff_letter='c',\n    b_iso=1.4041,\n)\n</pre> model_1.atom_sites.add(     label='La',     type_symbol='La',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.2,     occupancy=0.5, ) model_1.atom_sites.add(     label='Ba',     type_symbol='Ba',     fract_x=0,     fract_y=0,     fract_z=0,     wyckoff_letter='a',     b_iso=0.2,     occupancy=0.5, ) model_1.atom_sites.add(     label='Co',     type_symbol='Co',     fract_x=0.5,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='b',     b_iso=0.2567, ) model_1.atom_sites.add(     label='O',     type_symbol='O',     fract_x=0,     fract_y=0.5,     fract_z=0.5,     wyckoff_letter='c',     b_iso=1.4041, ) In\u00a0[7]: Copied! <pre>model_2 = SampleModelFactory.create(name='si')\n</pre> model_2 = SampleModelFactory.create(name='si') In\u00a0[8]: Copied! <pre>model_2.space_group.name_h_m = 'F d -3 m'\nmodel_2.space_group.it_coordinate_system_code = '2'\n</pre> model_2.space_group.name_h_m = 'F d -3 m' model_2.space_group.it_coordinate_system_code = '2' In\u00a0[9]: Copied! <pre>model_2.cell.length_a = 5.43146\n</pre> model_2.cell.length_a = 5.43146 In\u00a0[10]: Copied! <pre>model_2.atom_sites.add(\n    label='Si',\n    type_symbol='Si',\n    fract_x=0.0,\n    fract_y=0.0,\n    fract_z=0.0,\n    wyckoff_letter='a',\n    b_iso=0.0,\n)\n</pre> model_2.atom_sites.add(     label='Si',     type_symbol='Si',     fract_x=0.0,     fract_y=0.0,     fract_z=0.0,     wyckoff_letter='a',     b_iso=0.0, ) In\u00a0[11]: Copied! <pre>data_path = download_data(id=8, destination='data')\n</pre> data_path = download_data(id=8, destination='data') <pre>Getting data...\n</pre> <pre>Data #8: La0.5Ba0.5CoO3 + Si, McStas simulation\n</pre> <pre>\u2705 Data #8 downloaded to 'data/ed-8.xye'\n</pre> In\u00a0[12]: Copied! <pre>experiment = ExperimentFactory.create(\n    name='mcstas',\n    data_path=data_path,\n    sample_form='powder',\n    beam_mode='time-of-flight',\n    radiation_probe='neutron',\n    scattering_type='bragg',\n)\n</pre> experiment = ExperimentFactory.create(     name='mcstas',     data_path=data_path,     sample_form='powder',     beam_mode='time-of-flight',     radiation_probe='neutron',     scattering_type='bragg', ) <pre>Data loaded successfully\n</pre> <pre>Experiment \ud83d\udd2c 'mcstas'. Number of data points: 1000\n</pre> In\u00a0[13]: Copied! <pre>experiment.instrument.setup_twotheta_bank = 94.90931761529106\nexperiment.instrument.calib_d_to_tof_offset = 0.0\nexperiment.instrument.calib_d_to_tof_linear = 58724.76869981215\nexperiment.instrument.calib_d_to_tof_quad = -0.00001\n</pre> experiment.instrument.setup_twotheta_bank = 94.90931761529106 experiment.instrument.calib_d_to_tof_offset = 0.0 experiment.instrument.calib_d_to_tof_linear = 58724.76869981215 experiment.instrument.calib_d_to_tof_quad = -0.00001 In\u00a0[14]: Copied! <pre># experiment.peak_profile_type = 'pseudo-voigt * ikeda-carpenter'\nexperiment.peak.broad_gauss_sigma_0 = 45137\nexperiment.peak.broad_gauss_sigma_1 = -52394\nexperiment.peak.broad_gauss_sigma_2 = 22998\nexperiment.peak.broad_mix_beta_0 = 0.0055\nexperiment.peak.broad_mix_beta_1 = 0.0041\nexperiment.peak.asym_alpha_0 = 0\nexperiment.peak.asym_alpha_1 = 0.0097\n</pre> # experiment.peak_profile_type = 'pseudo-voigt * ikeda-carpenter' experiment.peak.broad_gauss_sigma_0 = 45137 experiment.peak.broad_gauss_sigma_1 = -52394 experiment.peak.broad_gauss_sigma_2 = 22998 experiment.peak.broad_mix_beta_0 = 0.0055 experiment.peak.broad_mix_beta_1 = 0.0041 experiment.peak.asym_alpha_0 = 0 experiment.peak.asym_alpha_1 = 0.0097 <p>Select the background type.</p> In\u00a0[15]: Copied! <pre>experiment.background_type = 'line-segment'\n</pre> experiment.background_type = 'line-segment' <pre>Background type for experiment 'mcstas' changed to\n</pre> <pre>line-segment\n</pre> <p>Add background points.</p> In\u00a0[16]: Copied! <pre>experiment.background.add(id='1', x=45000, y=0.2)\nexperiment.background.add(id='2', x=50000, y=0.2)\nexperiment.background.add(id='3', x=55000, y=0.2)\nexperiment.background.add(id='4', x=65000, y=0.2)\nexperiment.background.add(id='5', x=70000, y=0.2)\nexperiment.background.add(id='6', x=75000, y=0.2)\nexperiment.background.add(id='7', x=80000, y=0.2)\nexperiment.background.add(id='8', x=85000, y=0.2)\nexperiment.background.add(id='9', x=90000, y=0.2)\nexperiment.background.add(id='10', x=95000, y=0.2)\nexperiment.background.add(id='11', x=100000, y=0.2)\nexperiment.background.add(id='12', x=105000, y=0.2)\nexperiment.background.add(id='13', x=110000, y=0.2)\n</pre> experiment.background.add(id='1', x=45000, y=0.2) experiment.background.add(id='2', x=50000, y=0.2) experiment.background.add(id='3', x=55000, y=0.2) experiment.background.add(id='4', x=65000, y=0.2) experiment.background.add(id='5', x=70000, y=0.2) experiment.background.add(id='6', x=75000, y=0.2) experiment.background.add(id='7', x=80000, y=0.2) experiment.background.add(id='8', x=85000, y=0.2) experiment.background.add(id='9', x=90000, y=0.2) experiment.background.add(id='10', x=95000, y=0.2) experiment.background.add(id='11', x=100000, y=0.2) experiment.background.add(id='12', x=105000, y=0.2) experiment.background.add(id='13', x=110000, y=0.2) In\u00a0[17]: Copied! <pre>experiment.linked_phases.add(id='lbco', scale=4.0)\nexperiment.linked_phases.add(id='si', scale=0.2)\n</pre> experiment.linked_phases.add(id='lbco', scale=4.0) experiment.linked_phases.add(id='si', scale=0.2) In\u00a0[18]: Copied! <pre>project = Project()\n</pre> project = Project() In\u00a0[19]: Copied! <pre>project.sample_models.add(sample_model=model_1)\nproject.sample_models.add(sample_model=model_2)\n</pre> project.sample_models.add(sample_model=model_1) project.sample_models.add(sample_model=model_2) In\u00a0[20]: Copied! <pre>project.sample_models.show_names()\n</pre> project.sample_models.show_names() <pre>Defined sample models \ud83e\udde9\n</pre> <pre>['lbco', 'si']\n</pre> In\u00a0[21]: Copied! <pre>project.experiments.add(experiment=experiment)\n</pre> project.experiments.add(experiment=experiment) In\u00a0[22]: Copied! <pre>project.plot_meas(expt_name='mcstas')\n</pre> project.plot_meas(expt_name='mcstas') <p>Add excluded regions.</p> In\u00a0[23]: Copied! <pre>experiment.excluded_regions.add(id='1', start=0, end=40000)\nexperiment.excluded_regions.add(id='2', start=108000, end=200000)\n</pre> experiment.excluded_regions.add(id='1', start=0, end=40000) experiment.excluded_regions.add(id='2', start=108000, end=200000) <p>Show excluded regions.</p> In\u00a0[24]: Copied! <pre>experiment.excluded_regions.show()\n</pre> experiment.excluded_regions.show() <pre>Excluded regions\n</pre> start end 1 0 40000 2 108000 200000 <p>Show measured data after adding excluded regions.</p> In\u00a0[25]: Copied! <pre>project.plot_meas(expt_name='mcstas')\n</pre> project.plot_meas(expt_name='mcstas') <p>Show experiment as CIF.</p> In\u00a0[26]: Copied! <pre>project.experiments['mcstas'].show_as_cif()\n</pre> project.experiments['mcstas'].show_as_cif() <pre>Experiment \ud83d\udd2c 'mcstas' as cif\n</pre> CIF 1 data_mcstas 2 3 _expt_type.sample_form   powder 4 _expt_type.beam_mode time-of-flight 5 _expt_type.radiation_probe  neutron 6 _expt_type.scattering_type    bragg 7 8 _peak.gauss_sigma_0 45137.0000 9 _peak.gauss_sigma_1 -52394.0000 10 _peak.gauss_sigma_2 22998.0000 11 _peak.lorentz_gamma_0   0.0000 12 _peak.lorentz_gamma_1   0.0000 13 _peak.lorentz_gamma_2   0.0000 14 _peak.mix_beta_0   0.0055 15 _peak.mix_beta_1   0.0041 16 _peak.asym_alpha_0   0.0000 17 _peak.asym_alpha_1   0.0097 18 19 _instr.2theta_bank  94.9093 20 _instr.d_to_tof_offset   0.0000 21 _instr.d_to_tof_linear 58724.7687 22 _instr.d_to_tof_quad  -0.0000 23 _instr.d_to_tof_recip   0.0000 24 25 loop_ 26 _pd_phase_block.id 27 _pd_phase_block.scale 28     lbco   4.0000 29       si   0.2000 30 31 loop_ 32 _excluded_region.id 33 _excluded_region.start 34 _excluded_region.end 35        1   0.0000 40000.0000 36        2 108000.0000 200000.0000 37 38 loop_ 39 _pd_meas.time_of_flight 40 _pd_data.point_id 41 _pd_proc.d_spacing 42 _pd_meas.intensity_total 43 _pd_meas.intensity_total_su 44 _pd_calc.intensity_total 45 _pd_calc.intensity_bkg 46 _pd_data.refinement_status 47 41168.1286        1   0.7010   0.2154   0.0249   0.2544   0.2000     incl 48 41273.8536        2   0.7028   0.2609   0.0333   0.3380   0.2000     incl 49 41379.5785        3   0.7046   0.3043   0.0355   0.4664   0.2000     incl 50 41485.3035        4   0.7064   0.4737   0.0421   0.5860   0.2000     incl 51 41591.0285        5   0.7082   0.6003   0.0420   0.6236   0.2000     incl 52 41696.7534        6   0.7100   0.6017   0.0397   0.5577   0.2000     incl 53 41802.4784        7   0.7118   0.5012   0.0381   0.4329   0.2000     incl 54 41908.2034        8   0.7136   0.3770   0.0346   0.3153   0.2000     incl 55 42013.9284        9   0.7154   0.2753   0.0319   0.2457   0.2000     incl 56 42119.6533       10   0.7172   0.2618   0.0283   0.2273   0.2000     incl 57 ... 58 145835.8489      991   2.4834   0.2241   0.0113   0.2000   0.2000     excl 59 145941.5739      992   2.4852   0.2138   0.0107   0.2000   0.2000     excl 60 146047.2988      993   2.4870   0.2093   0.0109   0.2000   0.2000     excl 61 146153.0238      994   2.4888   0.2184   0.0109   0.2000   0.2000     excl 62 146258.7488      995   2.4906   0.2161   0.0110   0.2000   0.2000     excl 63 146364.4737      996   2.4924   0.2057   0.0111   0.2000   0.2000     excl 64 146470.1987      997   2.4942   0.2262   0.0114   0.2000   0.2000     excl 65 146575.9237      998   2.4960   0.2211   0.0115   0.2000   0.2000     excl 66 146681.6486      999   2.4978   0.2086   0.0110   0.2000   0.2000     excl 67 146787.3736     1000   2.4996   0.2088   0.0109   0.2000   0.2000     excl 68 69 loop_ 70 _pd_background.id 71 _pd_background.line_segment_X 72 _pd_background.line_segment_intensity 73        1 45000.0000   0.2000 74        2 50000.0000   0.2000 75        3 55000.0000   0.2000 76        4 65000.0000   0.2000 77        5 70000.0000   0.2000 78        6 75000.0000   0.2000 79        7 80000.0000   0.2000 80        8 85000.0000   0.2000 81        9 90000.0000   0.2000 82       10 95000.0000   0.2000 83       11 100000.0000   0.2000 84       12 105000.0000   0.2000 85       13 110000.0000   0.2000 In\u00a0[27]: Copied! <pre>project.analysis.current_calculator = 'cryspy'\n</pre> project.analysis.current_calculator = 'cryspy' <pre>Current calculator changed to\n</pre> <pre>cryspy\n</pre> In\u00a0[28]: Copied! <pre>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</pre> project.analysis.current_minimizer = 'lmfit (leastsq)' <pre>Current minimizer changed to\n</pre> <pre>lmfit (leastsq)\n</pre> In\u00a0[29]: Copied! <pre>model_1.cell.length_a.free = True\nmodel_1.atom_sites['Co'].b_iso.free = True\nmodel_1.atom_sites['O'].b_iso.free = True\n\nmodel_2.cell.length_a.free = True\n</pre> model_1.cell.length_a.free = True model_1.atom_sites['Co'].b_iso.free = True model_1.atom_sites['O'].b_iso.free = True  model_2.cell.length_a.free = True <p>Set experiment parameters to be optimized.</p> In\u00a0[30]: Copied! <pre>experiment.linked_phases['lbco'].scale.free = True\nexperiment.linked_phases['si'].scale.free = True\n\nexperiment.peak.broad_gauss_sigma_0.free = True\nexperiment.peak.broad_gauss_sigma_1.free = True\nexperiment.peak.broad_gauss_sigma_2.free = True\n\nexperiment.peak.asym_alpha_1.free = True\nexperiment.peak.broad_mix_beta_0.free = True\nexperiment.peak.broad_mix_beta_1.free = True\n\nfor point in experiment.background:\n    point.y.free = True\n</pre> experiment.linked_phases['lbco'].scale.free = True experiment.linked_phases['si'].scale.free = True  experiment.peak.broad_gauss_sigma_0.free = True experiment.peak.broad_gauss_sigma_1.free = True experiment.peak.broad_gauss_sigma_2.free = True  experiment.peak.asym_alpha_1.free = True experiment.peak.broad_mix_beta_0.free = True experiment.peak.broad_mix_beta_1.free = True  for point in experiment.background:     point.y.free = True In\u00a0[31]: Copied! <pre>project.analysis.fit()\nproject.analysis.show_fit_results()\n</pre> project.analysis.fit() project.analysis.show_fit_results() <pre>Using experiment \ud83d\udd2c 'mcstas' for 'single' fitting\n</pre> <pre>\ud83d\ude80 Starting fit process with 'lmfit (leastsq)'...\n</pre> <pre>\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n</pre> iteration \u03c7\u00b2 improvement [%] 1 1 301.38 2 29 3.36 98.9% \u2193 3 55 3.24 3.7% \u2193 4 134 3.24 <pre>\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.24 at iteration 133\n</pre> <pre>\u2705 Fitting complete.\n</pre> <pre>Fit results\n</pre> <pre>\u2705 Success: True\n</pre> <pre>\u23f1\ufe0f Fitting time: 5.66 seconds\n</pre> <pre>\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.24\n</pre> <pre>\ud83d\udccf R-factor (Rf): 4.74%\n</pre> <pre>\ud83d\udccf R-factor squared (Rf\u00b2): 5.12%\n</pre> <pre>\ud83d\udccf Weighted R-factor (wR): 5.18%\n</pre> <pre>\ud83d\udcc8 Fitted parameters:\n</pre> datablock category entry parameter start fitted uncertainty units change 1 lbco cell length_a 3.8909 3.8904 0.0001 \u00c5 0.01 % \u2193 2 lbco atom_site Co b_iso 0.2567 0.3233 0.0853 \u00c5\u00b2 25.94 % \u2191 3 lbco atom_site O b_iso 1.4041 2.1686 0.0282 \u00c5\u00b2 54.45 % \u2191 4 si cell length_a 5.4315 5.4327 0.0006 \u00c5 0.02 % \u2191 5 mcstas linked_phases lbco scale 4.0000 4.5577 0.0318 13.94 % \u2191 6 mcstas linked_phases si scale 0.2000 0.0314 0.0008 84.28 % \u2193 7 mcstas peak gauss_sigma_0 45137.0000 45210.8969 2868.4651 \u00b5s\u00b2 0.16 % \u2191 8 mcstas peak gauss_sigma_1 -52394.0000 -52476.8991 3797.9256 \u00b5s/\u212b 0.16 % \u2191 9 mcstas peak gauss_sigma_2 22998.0000 23014.3392 1193.4306 \u00b5s\u00b2/\u212b\u00b2 0.07 % \u2191 10 mcstas peak mix_beta_0 0.0055 0.0055 0.0001 deg 0.64 % \u2191 11 mcstas peak mix_beta_1 0.0041 0.0041 0.0003 deg 0.32 % \u2193 12 mcstas peak asym_alpha_1 0.0097 0.0097 0.0002 0.40 % \u2193 13 mcstas background 1 y 0.2000 0.2502 0.0082 25.09 % \u2191 14 mcstas background 2 y 0.2000 0.2498 0.0080 24.91 % \u2191 15 mcstas background 3 y 0.2000 0.2674 0.0047 33.68 % \u2191 16 mcstas background 4 y 0.2000 0.2551 0.0036 27.53 % \u2191 17 mcstas background 5 y 0.2000 0.2463 0.0035 23.17 % \u2191 18 mcstas background 6 y 0.2000 0.2417 0.0027 20.86 % \u2191 19 mcstas background 7 y 0.2000 0.2421 0.0033 21.07 % \u2191 20 mcstas background 8 y 0.2000 0.2374 0.0021 18.71 % \u2191 21 mcstas background 9 y 0.2000 0.2381 0.0020 19.07 % \u2191 22 mcstas background 10 y 0.2000 0.2423 0.0025 21.14 % \u2191 23 mcstas background 11 y 0.2000 0.2258 0.0022 12.88 % \u2191 24 mcstas background 12 y 0.2000 0.2228 0.0026 11.40 % \u2191 25 mcstas background 13 y 0.2000 0.2225 0.0078 11.23 % \u2191 In\u00a0[32]: Copied! <pre>project.plot_meas_vs_calc(expt_name='mcstas')\n</pre> project.plot_meas_vs_calc(expt_name='mcstas') In\u00a0[\u00a0]: Copied! <pre>\n</pre>"},{"location":"tutorials/ed-9/#structure-refinement-lbcosi-mcstas","title":"Structure Refinement: LBCO+Si, McStas\u00b6","text":"<p>This example demonstrates a Rietveld refinement of La0.5Ba0.5CoO3 crystal structure with a small amount of Si phase using time-of-flight neutron powder diffraction data simulated with McStas.</p>"},{"location":"tutorials/ed-9/#import-library","title":"Import Library\u00b6","text":""},{"location":"tutorials/ed-9/#define-sample-models","title":"Define Sample Models\u00b6","text":"<p>This section shows how to add sample models and modify their parameters.</p>"},{"location":"tutorials/ed-9/#create-sample-model-1-lbco","title":"Create Sample Model 1: LBCO\u00b6","text":""},{"location":"tutorials/ed-9/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-9/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-9/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-9/#create-sample-model-2-si","title":"Create Sample Model 2: Si\u00b6","text":""},{"location":"tutorials/ed-9/#set-space-group","title":"Set Space Group\u00b6","text":""},{"location":"tutorials/ed-9/#set-unit-cell","title":"Set Unit Cell\u00b6","text":""},{"location":"tutorials/ed-9/#set-atom-sites","title":"Set Atom Sites\u00b6","text":""},{"location":"tutorials/ed-9/#define-experiment","title":"Define Experiment\u00b6","text":"<p>This section shows how to add experiments, configure their parameters, and link the sample models defined in the previous step.</p>"},{"location":"tutorials/ed-9/#download-data","title":"Download Data\u00b6","text":""},{"location":"tutorials/ed-9/#create-experiment","title":"Create Experiment\u00b6","text":""},{"location":"tutorials/ed-9/#set-instrument","title":"Set Instrument\u00b6","text":""},{"location":"tutorials/ed-9/#set-peak-profile","title":"Set Peak Profile\u00b6","text":""},{"location":"tutorials/ed-9/#set-background","title":"Set Background\u00b6","text":""},{"location":"tutorials/ed-9/#set-linked-phases","title":"Set Linked Phases\u00b6","text":""},{"location":"tutorials/ed-9/#define-project","title":"Define Project\u00b6","text":"<p>The project object is used to manage sample models, experiments, and analysis.</p>"},{"location":"tutorials/ed-9/#create-project","title":"Create Project\u00b6","text":""},{"location":"tutorials/ed-9/#add-sample-models","title":"Add Sample Models\u00b6","text":""},{"location":"tutorials/ed-9/#show-sample-models","title":"Show Sample Models\u00b6","text":""},{"location":"tutorials/ed-9/#add-experiments","title":"Add Experiments\u00b6","text":""},{"location":"tutorials/ed-9/#set-excluded-regions","title":"Set Excluded Regions\u00b6","text":"<p>Show measured data as loaded from the file.</p>"},{"location":"tutorials/ed-9/#perform-analysis","title":"Perform Analysis\u00b6","text":"<p>This section outlines the analysis process, including how to configure calculation and fitting engines.</p>"},{"location":"tutorials/ed-9/#set-calculator","title":"Set Calculator\u00b6","text":""},{"location":"tutorials/ed-9/#set-minimizer","title":"Set Minimizer\u00b6","text":""},{"location":"tutorials/ed-9/#set-fitting-parameters","title":"Set Fitting Parameters\u00b6","text":"<p>Set sample model parameters to be optimized.</p>"},{"location":"tutorials/ed-9/#perform-fit","title":"Perform Fit\u00b6","text":""},{"location":"tutorials/ed-9/#plot-measured-vs-calculated","title":"Plot Measured vs Calculated\u00b6","text":""},{"location":"user-guide/","title":"User Guide","text":"<p>This section provides an overview of the core concepts, key parameters and workflow steps required for using EasyDiffraction effectively.</p> <p>Here is a brief overview of the User Guide sections:</p> <ul> <li>Glossary \u2013 Defines common terms and labels used throughout the   documentation.</li> <li>Concept \u2013 Introduces the overall idea behind diffraction data   processing and where EasyDiffraction fits.</li> <li>Data Format \u2013 Explains the Crystallographic Information File   (CIF) and how it's used in EasyDiffraction.</li> <li>Parameters \u2013 Describes how parameters are structured, named,   and accessed within the EasyDiffraction library.</li> <li>First Steps \u2013 Shows how to begin using EasyDiffraction in   Python or Jupyter notebooks.</li> <li>Analysis Workflow \u2013 Breaks down the data   analysis pipeline into practical, sequential steps.</li> </ul>"},{"location":"user-guide/concept/","title":"Concept","text":"<p>Typical data processing in a diffraction experiment consists of three main steps: data acquisition, data reduction, and data analysis.</p> <pre><code>flowchart LR\n    a(Data Aquisition)\n    b(Data Reduction)\n    c(Data Analysis)\n    a --&gt; b\n    b --&gt; c</code></pre>"},{"location":"user-guide/concept/#data-acquisition","title":"Data Acquisition","text":"<p>Data acquisition involves collecting raw data from the diffractometer (also referred to as the instrument) during a neutron or X-ray diffraction experiment.</p> <p>The data is recorded by a detector that measures the intensity of the diffracted radiation as a function of angle or time. The radiation is scattered by the crystalline specimen (also called the sample), whose structural properties are being studied.</p> <p></p> <p>An illustration of the data acquisition step, where raw data is collected by a 2D detector. The studied sample originates from Mars.  Credits: DOI 10.1126/science.1238932</p> <p></p> <p>A 2D diffraction pattern collected by the detector.  Credits: DOI 10.1126/science.1238932</p>"},{"location":"user-guide/concept/#data-reduction","title":"Data Reduction","text":"<p>Data reduction involves processing the raw data to remove background noise, correct for instrumental effects, and convert the data into a more usable format. The goal is to produce a clean and reliable dataset suitable for analysis.</p> <p></p> <p>An illustration of a 1D diffraction pattern reduced from the measured 2D data.  Credits: DOI 10.1126/science.1238932</p>"},{"location":"user-guide/concept/#data-analysis","title":"Data Analysis","text":"<p>Data analysis uses the reduced data to extract meaningful information about the sample. This may include determining the crystal or magnetic structure, identifying phases, performing quantitative analysis, etc.</p> <p>Analysis often involves comparing experimental data with data calculated from a crystallographic model to validate and interpret the results. For powder diffraction, techniques such as Rietveld or Le Bail refinement may be used.</p> <p>In EasyDiffraction, we focus on this model-dependent analysis. A model is built using prior knowledge of the system, and its parameters are optimized to achieve the best agreement between experimental and calculated diffraction data.</p> <p>By \"model\", we usually refer to a crystallographic model of the sample. This includes unit cell parameters, space group, atomic positions, thermal parameters, and more. However, the term \"model\" also encompasses experimental aspects such as instrumental resolution, background, peak shape, etc. Therefore, EasyDiffraction separates the model into two parts: the sample model and the experiment.</p> <p>The aim of data analysis is to refine the structural parameters of the sample by minimizing the difference (or residual) between the experimental and calculated data \u2014 and this is exactly where EasyDiffraction comes into play.</p> <p></p> <p>An illustration of the data analysis step: the experimental data (blue) is compared to the calculated data (red), and the residual (gray) is minimized.  Credits: DOI 10.1126/science.1238932</p> <p></p> <p>An example of a crystal structure model of the studied sample.</p>"},{"location":"user-guide/data-format/","title":"Data Format","text":"<p>Before starting the data analysis workflow, it is important to define the data formats used in EasyDiffraction.</p>"},{"location":"user-guide/data-format/#crystallographic-information-file","title":"Crystallographic Information File","text":"<p>Each software package typically uses its own data format and parameter names for storing and sharing data. In EasyDiffraction, we use the Crystallographic Information File (CIF) format, which is widely used in crystallography and materials science. It provides both a human-readable syntax and a set of dictionaries that define the meaning of each parameter.</p> <p>These dictionaries are maintained by the International Union of Crystallography (IUCr). The base dictionary, coreCIF, contains the most common parameters in crystallography. The pdCIF dictionary covers parameters specific to powder diffraction, magCIF is used for magnetic structure analysis.</p> <p>As most parameters needed for diffraction data analysis are already covered by IUCr dictionaries, EasyDiffraction uses the strict CIF format and follows these dictionaries as closely as possible \u2014 for both input and output \u2014 throughout the workflow described in the Analysis Workflow section.</p> <p>The key advantage of CIF is the standardized naming of parameters and categories, which promotes interoperability and familiarity among researchers.</p> <p>If a required parameter is not defined in the standard dictionaries, EasyDiffraction introduces custom CIF keywords, documented in the Parameters section under the CIF name for serialization columns.</p>"},{"location":"user-guide/data-format/#format-comparison","title":"Format Comparison","text":"<p>Below, we compare CIF with another common data format in programming: JSON.</p>"},{"location":"user-guide/data-format/#scientific-journals","title":"Scientific Journals","text":"<p>Let's assume the following structural data for La\u2080.\u2085Ba\u2080.\u2085CoO\u2083 (LBCO), as reported in a scientific publication. These parameters are to be refined during diffraction data analysis:</p> <p>Table 1. Crystallographic data. Space group: Pm3\u0305m.</p> Parameter Value a 3.8909 b 3.8909 c 3.8909 alpha 90.0 beta 90.0 gamma 90.0 <p>Table 2. Atomic coordinates (x, y, z), occupancies (occ) and isotropic displacement parameters (Biso)</p> Label Type x y z occ Biso La La 0 0 0 0.5 0.4958 Ba Ba 0 0 0 0.5 0.4958 Co Co 0.5 0.5 0.5 1.0 0.2567 O O 0 0.5 0.5 1.0 1.4041"},{"location":"user-guide/data-format/#cif","title":"CIF","text":"<p>The data above would be represented in CIF as follows:</p> <pre>\ndata_lbco\n\n_space_group.name_H-M_alt              \"P m -3 m\"\n_space_group.IT_coordinate_system_code 1\n\n_cell.length_a      3.8909\n_cell.length_b      3.8909\n_cell.length_c      3.8909\n_cell.angle_alpha  90\n_cell.angle_beta   90\n_cell.angle_gamma  90\n\nloop_\n_atom_site.label\n_atom_site.type_symbol\n_atom_site.fract_x\n_atom_site.fract_y\n_atom_site.fract_z\n_atom_site.Wyckoff_letter\n_atom_site.occupancy\n_atom_site.adp_type\n_atom_site.B_iso_or_equiv\nLa La   0   0   0     a   0.5  Biso 0.4958\nBa Ba   0   0   0     a   0.5  Biso 0.4958\nCo Co   0.5 0.5 0.5   b   1    Biso 0.2567\nO  O    0   0.5 0.5   c   1    Biso 1.4041\n</pre> <p>Here, unit cell parameters are grouped under the <code>_cell</code> category, and atomic positions under the <code>_atom_site</code> category. The <code>loop_</code> keyword indicates that multiple rows follow for the listed parameters. Each atom is identified using <code>_atom_site.label</code>.</p>"},{"location":"user-guide/data-format/#json","title":"JSON","text":"<p>Representing the same data in JSON results in a format that is more verbose and less human-readable, especially for large datasets. JSON is ideal for structured data in programming environments, whereas CIF is better suited for human-readable crystallographic data.</p> <pre><code>{\n  \"lbco\": {\n    \"space_group\": {\n      \"name_H-M_alt\": \"P m -3 m\",\n      \"IT_coordinate_system_code\": 1\n    },\n    \"cell\": {\n      \"length_a\": 3.8909,\n      \"length_b\": 3.8909,\n      \"length_c\": 3.8909,\n      \"angle_alpha\": 90,\n      \"angle_beta\": 90,\n      \"angle_gamma\": 90\n    },\n    \"atom_site\": [\n      {\n        \"label\": \"La\",\n        \"type_symbol\": \"La\",\n        \"fract_x\": 0,\n        \"fract_y\": 0,\n        \"fract_z\": 0,\n        \"occupancy\": 0.5,\n        \"B_iso_or_equiv\": 0.4958\n      },\n      {\n        \"label\": \"Ba\",\n        \"type_symbol\": \"Ba\",\n        \"fract_x\": 0,\n        \"fract_y\": 0,\n        \"fract_z\": 0,\n        \"occupancy\": 0.5,\n        \"B_iso_or_equiv\": 0.4943\n      },\n      {\n        \"label\": \"Co\",\n        \"type_symbol\": \"Co\",\n        \"fract_x\": 0.5,\n        \"fract_y\": 0.5,\n        \"fract_z\": 0.5,\n        \"occupancy\": 1.0,\n        \"B_iso_or_equiv\": 0.2567\n      },\n      {\n        \"label\": \"O\",\n        \"type_symbol\": \"O\",\n        \"fract_x\": 0,\n        \"fract_y\": 0.5,\n        \"fract_z\": 0.5,\n        \"occupancy\": 1.0,\n        \"B_iso_or_equiv\": 1.4041\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"user-guide/data-format/#experiment-definition","title":"Experiment Definition","text":"<p>The previous example described the sample model (crystallographic model), but how is the experiment itself represented?</p> <p>The experiment is also saved as a CIF file. For example, background intensity in a powder diffraction experiment might be represented as:</p> <pre>\nloop_\n_pd_background.line_segment_X\n_pd_background.line_segment_intensity\n_pd_background.X_coordinate\n\n 10.0  174.3  2theta\n 20.0  159.8  2theta\n 30.0  167.9  2theta\n ...\n</pre> <p>More details on how to define the experiment in CIF format are provided in the Experiment section.</p>"},{"location":"user-guide/data-format/#other-inputoutput-blocks","title":"Other Input/Output Blocks","text":"<p>EasyDiffraction uses CIF consistently throughout its workflow, including in the following blocks:</p> <ul> <li>project: contains the project information</li> <li>sample model: defines the sample model</li> <li>experiment: contains the experiment setup and measured data</li> <li>analysis: stores fitting and analysis parameters</li> <li>summary: captures analysis results</li> </ul> <p>Example CIF files for each block are provided in the Analysis Workflow and Tutorials.</p>"},{"location":"user-guide/data-format/#other-data-formats","title":"Other Data Formats","text":"<p>While CIF is the primary format in EasyDiffraction, we also support other formats for importing measured data. These include plain text files with multiple columns. The meaning of the columns depends on the experiment type.</p> <p>For example, in a standard constant-wavelength powder diffraction experiment:</p> <ul> <li>Column 1: 2\u03b8 angle</li> <li>Column 2: intensity</li> <li>Column 3: standard uncertainty of the intensity</li> </ul> <p>More details on supported input formats are provided in the Experiment section.</p>"},{"location":"user-guide/first-steps/","title":"First Steps","text":"<p>This section introduces the basic usage of the EasyDiffraction Python API. You'll learn how to import the package, use core classes and utility functions, and access built-in helper methods to streamline diffraction data analysis workflows.</p>"},{"location":"user-guide/first-steps/#importing-easydiffraction","title":"Importing EasyDiffraction","text":""},{"location":"user-guide/first-steps/#importing-the-entire-package","title":"Importing the entire package","text":"<p>To start using EasyDiffraction, first import the package in your Python script or Jupyter Notebook. This can be done with the following command:</p> <pre><code>import easydiffraction\n</code></pre> <p>Alternatively, you can import it with an alias to avoid naming conflicts and for convenience:</p> <pre><code>import easydiffraction as ed\n</code></pre> <p>The latter syntax allows you to access all the modules and classes within the package using the <code>ed</code> prefix. For example, you can create a project instance like this:</p> <pre><code>project = ed.Project()\n</code></pre> <p>A complete tutorial using the <code>import</code> syntax can be found here.</p>"},{"location":"user-guide/first-steps/#importing-specific-parts","title":"Importing specific parts","text":"<p>Alternatively, you can import specific classes or methods from the package. For example, you can import the <code>Project</code>, <code>SampleModel</code>, <code>Experiment</code> classes and <code>download_from_repository</code> method like this:</p> <pre><code>from easydiffraction import (\n    Project,\n    SampleModel,\n    Experiment,\n    download_from_repository\n)\n</code></pre> <p>This enables you to use these classes and methods directly without the package prefix. This is especially useful when you're using only a few components and want to keep your code clean and concise. In this case, you can create a project instance like this:</p> <pre><code>project = Project()\n</code></pre> <p>A complete tutorial using the <code>from</code> syntax can be found here.</p>"},{"location":"user-guide/first-steps/#utility-functions","title":"Utility functions","text":"<p>EasyDiffraction also provides several utility functions that can simplify your workflow. One of them is the <code>download_from_repository</code> function, which allows you to download data files from our remote repository, making it easy to access and use them while experimenting with EasyDiffraction.</p> <p>For example, you can download a sample data file like this:</p> <pre><code>import easydiffraction as ed\n\ned.download_from_repository('hrpt_lbco.xye',\n                            branch='docs',\n                            destination='data')\n</code></pre> <p>This command will download the <code>hrpt_lbco.xye</code> file from the <code>docs</code> branch of the EasyDiffraction repository and save it in the <code>data</code> directory of your current working directory. This is particularly useful for quickly accessing example datasets without having to manually download them.</p>"},{"location":"user-guide/first-steps/#help-methods","title":"Help methods","text":"<p>EasyDiffraction provides several helper methods to display supported engines for calculation, minimization, and plotting. These methods can be called on the <code>Project</code> instance to display the available options for different categories.</p>"},{"location":"user-guide/first-steps/#supported-calculators","title":"Supported calculators","text":"<p>For example, you can use the <code>show_supported_calculators()</code> method to see which calculation engines are available for use in your project:</p> <pre><code>project.show_supported_calculators()\n</code></pre> <p>This will display a list of supported calculators along with their descriptions, allowing you to choose the one that best fits your needs.</p> <p>An example of the output for the <code>show_supported_calculators()</code> method is:</p> Calculator Description cryspy CrysPy library for crystallographic calculations pdffit PDFfit2 library for pair distribution function calculations"},{"location":"user-guide/first-steps/#supported-minimizers","title":"Supported minimizers","text":"<p>You can also check the available minimizers using the <code>show_available_minimizers()</code> method:</p> <pre><code>project.show_available_minimizers()\n</code></pre>"},{"location":"user-guide/first-steps/#available-parameters","title":"Available parameters","text":"<p>EasyDiffraction provides several methods for showing the available parameters grouped in different categories. For example, you can use:</p> <ul> <li><code>project.analysis.show_all_params()</code> \u2013 to display all available parameters for   the analysis step.</li> <li><code>project.analysis.show_fittable_params()</code> \u2013 to display only the parameters   that can be fitted during the analysis.</li> <li><code>project.analysis.show_free_params()</code> \u2013 to display the parameters that are   currently free to be adjusted during the fitting process.</li> </ul> <p>Finally, you can use the <code>project.analysis.how_to_access_parameters()</code> method to get a brief overview of how to access and modify parameters in the analysis step, along with their unique identifiers in the CIF format. This can be particularly useful for users who are new to the EasyDiffraction API or those who want to quickly understand how to work with parameters in their projects.</p> <p>An example of the output for the <code>project.analysis.how_to_access_parameters()</code> method is:</p> Code variable Unique ID for CIF 1 project.sample_models['lbco'].atom_site['La'].adp_type lbco.atom_site.La.ADP_type 2 project.sample_models['lbco'].atom_site['La'].b_iso lbco.atom_site.La.B_iso_or_equiv 3 project.sample_models['lbco'].atom_site['La'].fract_x lbco.atom_site.La.fract_x 4 project.sample_models['lbco'].atom_site['La'].fract_y lbco.atom_site.La.fract_y ... ... ... 59 project.experiments['hrpt'].peak.broad_gauss_u hrpt.peak.broad_gauss_u 60 project.experiments['hrpt'].peak.broad_gauss_v hrpt.peak.broad_gauss_v 61 project.experiments['hrpt'].peak.broad_gauss_w hrpt.peak.broad_gauss_w"},{"location":"user-guide/first-steps/#supported-plotters","title":"Supported plotters","text":"<p>To see the available plotters, you can use the <code>show_available_plotters()</code> method on the <code>plotter</code> attribute of the <code>Project</code> instance:</p> <pre><code>project.plotter.show_supported_engines()\n</code></pre> <p>An example of the output is:</p> Engine Description asciichartpy Console ASCII line charts plotly Interactive browser-based graphing library"},{"location":"user-guide/first-steps/#data-analysis-workflow","title":"Data analysis workflow","text":"<p>Once the EasyDiffraction package is imported, you can proceed with the data analysis. This step can be split into several sub-steps, such as creating a project, defining sample models, adding experimental data, etc.</p> <p>EasyDiffraction provides a Python API that allows you to perform these steps programmatically in a certain linear order. This is especially useful for users who prefer to work in a script or Jupyter Notebook environment. The API is designed to be intuitive and easy to use, allowing you to focus on the analysis rather than low-level implementation details.</p> <p>Because this workflow is an important part of the EasyDiffraction package, it is described in detail in the separate Analysis Workflow section of the documentation.</p>"},{"location":"user-guide/glossary/","title":"Glossary","text":"<p>Before guiding you through the use of EasyDiffraction, we define some common terms and abbreviations used throughout the documentation and tutorials.</p>"},{"location":"user-guide/glossary/#dictionary-type-labels","title":"Dictionary Type Labels","text":"<p>The following labels are used to identify different types of CIF dictionaries:</p> <ul> <li>coreCIF \u2013 Core CIF dictionary by the   IUCr.</li> <li>pdCIF \u2013 Powder CIF dictionary by the   IUCr.</li> <li>easydiffractionCIF \u2013 Custom CIF dictionary developed for   EasyDiffraction.</li> </ul> <p>For more information about CIF, see the Data Format section.</p>"},{"location":"user-guide/glossary/#experiment-type-labels","title":"Experiment Type Labels","text":"<p>EasyDiffraction supports a variety of experiment types, each with its own set of parameters. The following labels identify the supported experiment types:</p>"},{"location":"user-guide/glossary/#neutron-diffraction","title":"Neutron Diffraction","text":"<ul> <li>pd-neut-cwl \u2013 Powder neutron diffraction with   constant wavelength.</li> <li>pd-neut-tof \u2013 Powder neutron diffraction with   time-of-flight.</li> <li>sc-neut-cwl \u2013 Single-crystal neutron diffraction with   constant wavelength.</li> </ul>"},{"location":"user-guide/glossary/#x-ray-diffraction","title":"X-ray Diffraction","text":"<ul> <li>pd-xray Powder X-ray diffraction.</li> </ul>"},{"location":"user-guide/parameters/","title":"Parameters","text":"<p>The data analysis process, introduced in the Concept section, assumes that you mainly work with different parameters. The parameters are used to describe the sample model and the experiment and are required to set up the analysis.</p> <p>Each parameter in EasyDiffraction has a specific name used for code reference, and it belongs to a specific category.</p> <ul> <li>In many cases, the EasyDiffraction name is the same as the CIF name.</li> <li>In some cases, the EasyDiffraction name is a slightly modified version of the   CIF name to comply with Python naming conventions. For example, <code>name_H-M_alt</code>   becomes <code>name_h_m</code>, replacing hyphens with underscores and using lowercase   letters.</li> <li>In rare cases, the EasyDiffraction name is a bit shorter, like <code>b_iso</code> instead   of CIF <code>B_iso_or_equiv</code>, to make the code a bit more user-friendly.</li> <li>When there is no defined CIF name for a parameter, EasyDiffraction introduces   its own name, which is used in the code as well as an equivalent CIF name to   be placed in the custom CIF dictionary <code>easydiffractionCIF</code>.</li> </ul> <p>EasyDiffraction names are used in code, while CIF names are used to store and retrieve the full state of a data analysis project in CIF format. You can find more about the project in the Project section.</p>"},{"location":"user-guide/parameters/#parameter-attributes","title":"Parameter Attributes","text":"<p>Parameters in EasyDiffraction are more than just variables. They are objects that, in addition to the name and value, also include attributes such as the description, unit, uncertainty, minimum and maximum values, etc. All these attributes are described in the API Reference section. Examples of how to use these parameters in code are provided in the Analysis Workflow and Tutorials sections.</p> <p>The most important attribute, besides <code>name</code> and <code>value</code>, is <code>free</code>, which is used to define whether the parameter is free or fixed for optimization during the fitting process. The <code>free</code> attribute is set to <code>False</code> by default, which means the parameter is fixed. To optimize a parameter, set <code>free</code> to <code>True</code>.</p> <p>Although parameters are central, EasyDiffraction hides their creation and attribute handling from the user. The user only accesses the required parameters through the top-level objects, such as <code>project</code>, <code>sample_models</code>, <code>experiments</code>, etc. The parameters are created and initialized automatically when a new project is created or an existing one is loaded.</p> <p>In the following sections, you can see a list of the parameters used in EasyDiffraction. Use the tabs to switch between how to access a parameter in code and its CIF name for serialization.</p> <p>Important</p> <p>Remember that parameters are accessed in code through their parent objects, such as <code>project</code>, <code>sample_models</code>, or <code>experiments</code>. For example, if you have a sample model with the ID <code>nacl</code>, you can access the space group name using the following syntax:</p> <pre><code>project.sample_models['nacl'].space_group.name_h_m\n</code></pre> <p>In the example above, <code>space_group</code> is a sample model category, and <code>name_h_m</code> is the parameter. For simplicity, only the last part (<code>category.parameter</code>) of the full access name will be shown in the tables below.</p> <p>In addition, the CIF names are also provided for each parameter, which are used to serialize the parameters in the CIF format.</p> <p>Tags defining the corresponding experiment type are also given before the table.</p>"},{"location":"user-guide/parameters/#sample-model-parameters","title":"Sample model parameters","text":"<p>Below is a list of parameters used to describe the sample model in EasyDiffraction.</p>"},{"location":"user-guide/parameters/#crystall-structure-parameters","title":"Crystall structure parameters","text":"<p>pd-neut-cwl pd-neut-tof pd-xray sc-neut-cwl</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code space_group name_hm space_group.name_hm system_code space_group.system_code cell length_a cell.length_a length_b cell.length_b length_c cell.length_c angle_alpha cell.angle_alpha angle_beta cell.angle_beta angle_gamma cell.angle_gamma atom_site label atom_sites['ID'].label type_symbol atom_sites['ID'].type_symbol fract_x atom_sites['ID'].fract_x fract_y atom_sites['ID'].fract_y fract_z atom_sites['ID'].fract_z occupancy atom_sites['ID'].occupancy adp_type atom_sites['ID'].adp_type b_iso atom_sites['ID'].b_iso multiplicity atom_sites['ID'].multiplicity wyckoff_letter atom_sites['ID'].wyckoff_letter Category Parameter CIF name for serialization CIF dictionary space_group name_hm _space_group.name_H-M_alt coreCIF system_code _space_group.IT_coordinate_system_code coreCIF cell length_a _cell.length_a coreCIF length_b _cell.length_b coreCIF length_c _cell.length_c coreCIF angle_alpha _cell.angle_alpha coreCIF angle_beta _cell.angle_beta coreCIF angle_gamma _cell.angle_gamma coreCIF atom_site label _atom_site.label coreCIF type_symbol _atom_site.type_symbol coreCIF fract_x _atom_site.fract_x coreCIF fract_y _atom_site.fract_y coreCIF fract_z _atom_site.fract_z coreCIF occupancy _atom_site.occupancy coreCIF adp_type _atom_site.ADP_type coreCIF b_iso _atom_site.B_iso_or_equiv coreCIF multiplicity _atom_site.site_symmetry_multiplicity coreCIF wyckoff_letter _atom_site.Wyckoff_symbol coreCIF"},{"location":"user-guide/parameters/#experiment-parameters","title":"Experiment parameters","text":"<p>Below is a list of parameters used to describe the experiment in EasyDiffraction.</p>"},{"location":"user-guide/parameters/#common-parameters","title":"Common parameters","text":"<p>pd-neut-cwl pd-neut-tof pd-xray sc-neut-cwl</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code expt_type beam_mode expt_type.beam_mode radiation_probe expt_type.radiation_probe sample_form expt_type.sample_form scattering_type expt_type.scattering_type Category Parameter CIF name for serialization CIF dictionary expt_type beam_mode _expt_type.beam_mode easydiffractionCIF radiation_probe _expt_type.radiation_probe easydiffractionCIF sample_form _expt_type.sample_form easydiffractionCIF scattering_type _expt_type.scattering_type easydiffractionCIF"},{"location":"user-guide/parameters/#standard-powder-diffraction","title":"Standard powder diffraction","text":"<p>pd-neut-cwl pd-neut-tof pd-xray</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code background x background.x y background.y order background.order coef background.coef linked_phases scale linked_phases['ID'].scale Category Parameter CIF name for serialization CIF dictionary background x _pd_background.line_segment_X pdCIF y _pd_background.line_segment_intensity pdCIF order _pd_background.chebyshev_order pdCIF coef _pd_background.chebyshev_coef pdCIF linked_phases scale _pd_phase_block.scale pdCIF <p>pd-neut-cwl pd-xray</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code instrument setup_wavelength instrument.setup_wavelength calib_twotheta_offset instrument.calib_twotheta_offset peak broad_gauss_u peak.broad_gauss_u broad_gauss_v peak.broad_gauss_v broad_gauss_w peak.broad_gauss_w broad_lorentz_x peak.broad_lorentz_x broad_lorentz_y peak.broad_lorentz_y Category Parameter CIF name for serialization CIF dictionary instrument setup_wavelength _instrument.setup_wavelength easydiffractionCIF calib_twotheta_offset _instrument.calib_twotheta_offset easydiffractionCIF peak broad_gauss_u _peak.broad_gauss_u easydiffractionCIF broad_gauss_v _peak.broad_gauss_v easydiffractionCIF broad_gauss_w _peak.broad_gauss_w easydiffractionCIF broad_lorentz_x _peak.broad_lorentz_x easydiffractionCIF broad_lorentz_y _peak.broad_lorentz_y easydiffractionCIF <p>pd-neut-tof</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code instrument setup_twotheta_bank instrument.setup_twotheta_bank calib_d_to_tof_recip instrument.calib_d_to_tof_recip calib_d_to_tof_offset instrument.calib_d_to_tof_offset calib_d_to_tof_linear instrument.calib_d_to_tof_linear calib_d_to_tof_quad instrument.calib_d_to_tof_quad peak broad_gauss_sigma_0 peak.broad_gauss_sigma_0 broad_gauss_sigma_1 peak.broad_gauss_sigma_1 broad_gauss_sigma_2 peak.broad_gauss_sigma_2 broad_mix_beta_0 peak.broad_mix_beta_0 broad_mix_beta_1 peak.broad_mix_beta_1 asym_alpha_0 peak.asym_alpha_0 asym_alpha_1 peak.asym_alpha_1 Category Parameter CIF name for serialization CIF dictionary instrument setup_twotheta_bank _instrument.setup_twotheta_bank easydiffractionCIF calib_d_to_tof_recip _instrument.calib_d_to_tof_recip easydiffractionCIF calib_d_to_tof_offset _instrument.calib_d_to_tof_offset easydiffractionCIF calib_d_to_tof_linear _instrument.calib_d_to_tof_linear easydiffractionCIF calib_d_to_tof_quad _instrument.calib_d_to_tof_quad easydiffractionCIF peak broad_gauss_sigma_0 _peak.broad_gauss_sigma_0 easydiffractionCIF broad_gauss_sigma_1 _peak.broad_gauss_sigma_1 easydiffractionCIF broad_gauss_sigma_2 _peak.broad_gauss_sigma_2 easydiffractionCIF broad_mix_beta_0 _peak.broad_mix_beta_0 easydiffractionCIF broad_mix_beta_1 _peak.broad_mix_beta_1 easydiffractionCIF asym_alpha_0 _peak.asym_alpha_0 easydiffractionCIF asym_alpha_1 _peak.asym_alpha_1 easydiffractionCIF"},{"location":"user-guide/parameters/#total-scattering","title":"Total scattering","text":"<p>pd-neut-total pd-xray-total</p> How to access in the codeCIF name for serialization Category Parameter How to access in the code peak cutoff_q peak.cutoff_q broad_q peak.broad_q sharp_delta_1 peak.sharp_delta_1 sharp_delta_2 peak.sharp_delta_2 damp_q peak.damp_q damp_particle_diameter peak.damp_particle_diameter Category Parameter CIF name for serialization CIF dictionary peak cutoff_q _peak.cutoff_q easydiffractionCIF broad_q _peak.broad_q easydiffractionCIF sharp_delta_1 _peak.sharp_delta_1 easydiffractionCIF sharp_delta_2 _peak.sharp_delta_2 easydiffractionCIF damp_q _peak.damp_q easydiffractionCIF damp_particle_diameter _peak.damp_particle_diameter easydiffractionCIF"},{"location":"user-guide/analysis-workflow/","title":"Analysis Workflow","text":"<p>To streamline the data analysis process, EasyDiffraction follows a structured workflow divided into five key steps:</p> <pre><code>flowchart LR\n    a(Project)\n    b(Model)\n    c(Experiment)\n    d(Analysis)\n    e(Summary)\n    a --&gt; b\n    b --&gt; c\n    c --&gt; d\n    d --&gt; e</code></pre> <ul> <li> Project \u2013 Establish a project as a   container for sample model and experiment parameters, measured and calculated   data, analysis settings and results.</li> <li> Sample Model \u2013 Load an existing   crystallographic model in CIF format or define a new one from scratch.</li> <li> Experiment \u2013 Import experimental   diffraction data and configure instrumental and other relevant   parameters.</li> <li> Analysis \u2013 Calculate the diffraction   pattern and optimize the structural model by refining its parameters to   match experimental measurements.</li> <li> Summary \u2013 Generate a report   summarizing the results of the analysis, including refined parameters.</li> </ul> <p>Each step is described in detail in its respective section, guiding users through the entire diffraction data analysis workflow in EasyDiffraction.</p>"},{"location":"user-guide/analysis-workflow/analysis/","title":"Analysis","text":"<p>This section provides an overview of diffraction data analysis in EasyDiffraction, focusing on model-dependent analysis, calculation engines, and minimization techniques.</p> <p>In EasyDiffraction, we focus on model-dependent analysis, where a model is constructed based on prior knowledge of the studied system, and its parameters are optimized to achieve the best agreement between experimental and calculated diffraction data. Model-dependent analysis is widely used in neutron and X-ray scattering data.</p>"},{"location":"user-guide/analysis-workflow/analysis/#calculation","title":"Calculation","text":"<p>EasyDiffraction relies on third-party crystallographic libraries, referred to as calculation engines or just calculators, to perform the calculations.</p> <p>The calculation engines are used to calculate the diffraction pattern for the defined model of the studied sample using the instrumental and other required experiment-related parameters, such as the wavelength, resolution, etc.</p> <p>You do not necessarily need the measured data to perform the calculations, but you need a structural model and some details about the type of experiment you want to simulate.</p> <p>EasyDiffraction is designed as a flexible and extensible tool that supports different calculation engines for diffraction pattern calculations. Currently, we integrate CrysPy, CrysFML, and PDFfit2 libraries as calculation engines.</p>"},{"location":"user-guide/analysis-workflow/analysis/#cryspy-calculator","title":"CrysPy Calculator","text":"<p>CrysPy is a Python library originally developed for analysing polarised neutron diffraction data. It is now evolving into a more general purpose library and covers powders and single crystals, nuclear and (commensurate) magnetic structures, unpolarised neutron and X-ray diffraction.</p>"},{"location":"user-guide/analysis-workflow/analysis/#crysfml-calculator","title":"CrysFML Calculator","text":"<p>CrysFML library is a collection of Fortran modules for crystallographic computations. It is used in the software package FullProf, and we are currently working on its integration into EasyDiffraction.</p>"},{"location":"user-guide/analysis-workflow/analysis/#pdffit2-calculator","title":"PDFfit2 Calculator","text":"<p>PDFfit2 is a Python library for calculating the pair distribution function (PDF) from crystallographic models.</p>"},{"location":"user-guide/analysis-workflow/analysis/#set-calculator","title":"Set Calculator","text":"<p>To show the supported calculation engines:</p> <pre><code>project.analysis.show_supported_calculators()\n</code></pre> <p>The example of the output is:</p> <p>Supported calculators</p> Calculator Description cryspy CrysPy library for crystallographic calculations pdffit PDFfit2 library for pair distribution function calculations <p>To select the desired calculation engine, e.g., 'cryspy':</p> <pre><code>project.analysis.current_calculator = 'cryspy'\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#minimization-optimization","title":"Minimization / Optimization","text":"<p>The process of refining model parameters involves iterating through multiple steps until the calculated data sufficiently matches the experimental data. This process is illustrated in the following diagram:</p> <pre><code>flowchart LR\n    a(Propose&lt;br/&gt;model)\n    b(Set/change&lt;br/&gt;model&lt;br/&gt;parameter&lt;br/&gt;values)\n    c(Calculate&lt;br/&gt;model&lt;br/&gt;data)\n    d(Compare&lt;br/&gt;model data to&lt;br/&gt;experimental&lt;br/&gt;data)\n    e(Stop&lt;br/&gt;iteration)\n    a --&gt; b\n    b --&gt; c\n    c --&gt; d\n    d-- Threshold&lt;br/&gt;not&lt;br/&gt;reached --&gt;b\n    d-- Threshold&lt;br/&gt;reached --&gt;e</code></pre> <p>Like the calculation engines, EasyDiffraction is designed to utilize various third-party libraries for model refinement and parameter optimization. These libraries provide robust curve fitting and uncertainty estimation tools.</p>"},{"location":"user-guide/analysis-workflow/analysis/#lmfit-minimizer","title":"Lmfit Minimizer","text":"<p>Most of the examples in this section will use the lmfit package, which provides a high-level interface to non-linear optimisation and curve fitting problems for Python. It is one of the tools that can be used to fit models to the experimental data.</p>"},{"location":"user-guide/analysis-workflow/analysis/#bumps-minimizer","title":"Bumps Minimizer","text":"<p>Another package that can be used for the same purpose is bumps. In addition to traditional optimizers which search for the best minimum they can find in the search space, bumps provides Bayesian uncertainty analysis which explores all viable minima and finds confidence intervals on the parameters based on uncertainty in the measured values.</p>"},{"location":"user-guide/analysis-workflow/analysis/#dfo-ls-minimizer","title":"DFO-LS Minimizer","text":"<p>DFO-LS (Derivative-Free Optimizer for Least-Squares) is a Python library for solving nonlinear least-squares minimization, without requiring derivatives of the objective.</p>"},{"location":"user-guide/analysis-workflow/analysis/#set-minimizer","title":"Set Minimizer","text":"<p>To show the supported minimizers:</p> <pre><code>project.analysis.show_supported_minimizers()\n</code></pre> <p>The example of the output is:</p> <p>Supported minimizers</p> Minimizer Description lmfit LMFIT library using the default Levenberg-Marquardt least squares method lmfit (leastsq) LMFIT library with Levenberg-Marquardt least squares method lmfit (least_squares) LMFIT library with SciPy\u2019s trust region reflective algorithm dfols DFO-LS library for derivative-free least-squares optimization <p>To select the desired calculation engine, e.g., 'lmfit (least_squares)':</p> <pre><code>project.analysis.current_minimizer = 'lmfit (leastsq)'\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#fit-mode","title":"Fit Mode","text":"<p>In EasyDiffraction, you can set the fit mode to control how the refinement process is performed. The fit mode determines whether the refinement is performed independently for each experiment or jointly across all experiments.</p> <p>To show the supported fit modes:</p> <pre><code>project.analysis.show_supported_fit_modes()\n</code></pre> <p>An example of supported fit modes is:</p> <p>Supported fit modes</p> Strategy Description single Independent fitting of each experiment; no shared parameters joint Simultaneous fitting of all experiments; some parameters are shared <p>You can set the fit mode using the <code>set_fit_mode</code> method of the <code>analysis</code> object:</p> <pre><code>project.analysis.fit_mode = 'joint'\n</code></pre> <p>To check the current fit mode, you can use the <code>show_current_fit_mode</code> method:</p> <pre><code>project.analysis.show_current_fit_mode()\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#perform-fit","title":"Perform Fit","text":"<p>Refining the sample model and experiment parameters against measured data is usually divided into several steps, where each step involves adding or removing parameters to be refined, calculating the model data, and comparing it to the experimental data as shown in the diagram above.</p> <p>To select the parameters to be refined, you can set the attribute <code>free</code> of the parameters to <code>True</code>. This indicates that the parameter is free to be optimized during the refinement process.</p> <p>Here is an example of how to set parameters to be refined:</p> <pre><code># Set sample model parameters to be refined.\nproject.sample_models['lbco'].cell.length_a.free = True\n\n# Set experiment parameters to be refined.\nproject.experiments['hrpt'].linked_phases['lbco'].scale.free = True\nproject.experiments['hrpt'].instrument.calib_twotheta_offset.free = True\nproject.experiments['hrpt'].background['10'].y.free = True\nproject.experiments['hrpt'].background['165'].y.free = True\n</code></pre> <p>After setting the parameters to be refined, you can perform the fit using the <code>fit</code> method of the <code>analysis</code> object:</p> <pre><code>project.analysis.fit()\n</code></pre> <p>This method will iterate through the defined steps, adjusting the parameters until the calculated data sufficiently matches the experimental data.</p> <p>An example of the output after performing the fit is:</p> <pre><code>Using experiment \ud83d\udd2c 'hrpt' for 'single' fitting\n\ud83d\ude80 Starting fitting process with 'lmfit (leastsq)'...\n\ud83d\udcc8 Goodness-of-fit (reduced \u03c7\u00b2) change:\n\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2564\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n\u2502    iteration    \u2502        \u03c7\u00b2       \u2502 improvement [%] \u2502\n\u255e\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u256a\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2561\n\u2502        1        \u2502      164.59     \u2502                 \u2502\n\u2502        12       \u2502      33.43      \u2502     79.7% \u2193     \u2502\n\u2502        21       \u2502      13.22      \u2502     60.4% \u2193     \u2502\n\u2502        30       \u2502       5.78      \u2502     56.3% \u2193     \u2502\n\u2502        39       \u2502       3.15      \u2502     45.6% \u2193     \u2502\n\u2502        77       \u2502       3.14      \u2502                 \u2502\n\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2567\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b\n\ud83c\udfc6 Best goodness-of-fit (reduced \u03c7\u00b2) is 3.14 at iteration 73\n\u2705 Fitting complete.\nFit results\n\u2705 Success: True\n\u23f1\ufe0f Fitting time: 0.77 seconds\n\ud83d\udccf Goodness-of-fit (reduced \u03c7\u00b2): 3.14\n\ud83d\udccf R-factor (Rf): 8.42%\n\ud83d\udccf R-factor squared (Rf\u00b2): 11.79%\n\ud83d\udccf Weighted R-factor (wR): 11.62%\n\ud83d\udcc8 Fitted parameters:\n</code></pre> <p>Now, you can inspect the fitted parameters to see how they have changed during the refinement process, select more parameters to be refined, and perform additional fits as needed.</p> <p>To plot the measured vs calculated data after the fit, you can use the <code>plot_meas_vs_calc</code> method of the <code>analysis</code> object:</p> <pre><code>project.plot_meas_vs_calc(expt_name='hrpt', show_residual=True)\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#constraints","title":"Constraints","text":"<p>In EasyDiffraction, you can define constraints on the model parameters to ensure that they remain within a specific range or follow a certain relationship during the refinement process.</p>"},{"location":"user-guide/analysis-workflow/analysis/#setting-aliases","title":"Setting Aliases","text":"<p>Before setting constraints, you need to set aliases for the parameters you want to constrain. This can be done using the <code>add</code> method of the <code>aliases</code> object. Aliases are used to reference parameters in a more readable way, making it easier to manage constraints.</p> <p>An example of setting aliases for parameters in a sample model:</p> <pre><code># Set aliases for the atomic displacement parameters\nproject.analysis.aliases.add(\n    label='biso_La',\n    param_uid=project.sample_models['lbco'].atom_sites['La'].b_iso.uid\n)\nproject.analysis.aliases.add(\n    label='biso_Ba',\n    param_uid=project.sample_models['lbco'].atom_sites['Ba'].b_iso.uid\n)\n\n# Set aliases for the occupancies of the atom sites\nproject.analysis.aliases.add(\n    label='occ_La',\n    param_uid=project.sample_models['lbco'].atom_sites['La'].occupancy.uid\n)\nproject.analysis.aliases.add(\n    label='occ_Ba',\n    param_uid=project.sample_models['lbco'].atom_sites['Ba'].occupancy.uid\n)\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#setting-constraints","title":"Setting Constraints","text":"<p>Now that you have set the aliases, you can define constraints using the <code>add</code> method of the <code>constraints</code> object. Constraints are defined by specifying the left-hand side (lhs) alias and the right-hand side (rhs) expression. The rhs expression can be a simple alias or a more complex expression involving other aliases.</p> <p>An example of setting constraints for the aliases defined above:</p> <pre><code>project.analysis.constraints.add(\n    lhs_alias='biso_Ba',\n    rhs_expr='biso_La'\n)\n\nproject.analysis.constraints.add(\n    lhs_alias='occ_Ba',\n    rhs_expr='1 - occ_La'\n)\n</code></pre> <p>These constraints ensure that the <code>biso_Ba</code> parameter is equal to <code>biso_La</code>, and the <code>occ_Ba</code> parameter is equal to <code>1 - occ_La</code>. This means that the occupancy of the Ba atom will always be adjusted based on the occupancy of the La atom, and the isotropic displacement parameter for Ba will be equal to that of La during the refinement process.</p>"},{"location":"user-guide/analysis-workflow/analysis/#viewing-constraints","title":"Viewing Constraints","text":"<p>To view the defined constraints, you can use the <code>show_constraints</code> method:</p> <pre><code>project.analysis.show_constraints()\n</code></pre> <p>The example of the output is:</p> <p>User defined constraints</p> lhs_alias rhs_expr full expression biso_Ba biso_La biso_Ba = biso_La occ_Ba 1 - occ_La occ_Ba = 1 - occ_La"},{"location":"user-guide/analysis-workflow/analysis/#analysis-as-cif","title":"Analysis as CIF","text":"<p>To inspect an analysis configuration in CIF format, use:</p> <pre><code># Show sample model as CIF\nproject.sample_models['lbco'].show_as_cif()\n</code></pre> <p>Example output:</p> <pre><code>\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n\u2502 _analysis.calculator_engine  cryspy            \u2502\n\u2502 _analysis.fitting_engine     \"lmfit (leastsq)\" \u2502\n\u2502 _analysis.fit_mode           single            \u2502\n\u2502                                                \u2502\n\u2502 loop_                                          \u2502\n\u2502 _alias.label                                   \u2502\n\u2502 _alias.param_uid                               \u2502\n\u2502 biso_La  lbco.atom_site.La.B_iso_or_equiv      \u2502\n\u2502 biso_Ba  lbco.atom_site.Ba.B_iso_or_equiv      \u2502\n\u2502 occ_La   lbco.atom_site.La.occupancy           \u2502\n\u2502 occ_Ba   lbco.atom_site.Ba.occupancy           \u2502\n\u2502                                                \u2502\n\u2502 loop_                                          \u2502\n\u2502 _constraint.lhs_alias                          \u2502\n\u2502 _constraint.rhs_expr                           \u2502\n\u2502 biso_Ba  biso_La                               \u2502\n\u2502 occ_Ba   \"1 - occ_La\"                          \u2502\n\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b\n</code></pre>"},{"location":"user-guide/analysis-workflow/analysis/#saving-an-analysis","title":"Saving an Analysis","text":"<p>Saving the project, as described in the Project section, will also save the analysis settings to the <code>analysis.cif</code> inside the project directory.</p> <p></p> <p>Now that the analysis is finished, you can proceed to the next step: Summary.</p>"},{"location":"user-guide/analysis-workflow/experiment/","title":"Experiment","text":"<p>An Experiment in EasyDiffraction includes the measured diffraction data along with all relevant parameters that describe the experimental setup and associated conditions. This can include information about the instrumental resolution, peak shape, background, etc.</p>"},{"location":"user-guide/analysis-workflow/experiment/#defining-an-experiment","title":"Defining an Experiment","text":"<p>EasyDiffraction allows you to:</p> <ul> <li>Load an existing experiment from a file (CIF format). Both the   metadata and measured data are expected to be in CIF format.</li> <li>Manually define a new experiment by specifying its type, other necessary   experimental parameters, as well as load measured data. This is useful when   you want to create an experiment from scratch or when you have a measured data   file in a non-CIF format (e.g., <code>.xye</code>, <code>.xy</code>).</li> </ul> <p>Below, you will find instructions on how to define and manage experiments in EasyDiffraction. It is assumed that you have already created a <code>project</code> object, as described in the Project section as well as defined its <code>sample_models</code>, as described in the Sample Model section.</p>"},{"location":"user-guide/analysis-workflow/experiment/#adding-from-cif","title":"Adding from CIF","text":"<p>This is the most straightforward way to define an experiment in EasyDiffraction. If you have a crystallographic information file (CIF) for your experiment, that contains both the necessary information (metadata) about the experiment as well as the measured data, you can add it to your <code>project.experiments</code> collection using the <code>add_from_cif_path</code> method. In this case, the name of the experiment will be taken from CIF.</p> <pre><code># Load an experiment from a CIF file\nproject.experiments.add_from_cif_path('data/hrpt_300K.cif')\n</code></pre> <p>You can also pass the content of the CIF file as a string using the <code>add_from_cif_str</code> method:</p> <pre><code># Add an experiment from a CIF string\ncif_string = \"\"\"\n... content of the CIF file ...\n\"\"\"\nproject.experiments.add_from_cif_str(cif_string)\n</code></pre> <p>Accessing the experiment after adding it will also be done through the <code>experiments</code> object of the <code>project</code> instance. The name of the experiment will be the same as the data block id in the CIF file. For example, if the CIF file contains a data block with the id <code>hrpt</code>,</p> <pre>\ndata_hrpt\n\n_expt_type.beam_mode  \"constant wavelength\"\n...\n</pre> <p>you can access it in the code as follows:</p> <pre><code># Access the experient by its name\nproject.experiments['hrpt']\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#defining-manually","title":"Defining Manually","text":"<p>If you do not have a CIF file or prefer to define the experiment manually, you can use the <code>add_from_data_path</code> method of the <code>experiments</code> object of the <code>project</code> instance. In this case, you will need to specify the name of the experiment, which will be used to reference it later, as well as data_path to the measured data file (e.g., <code>.xye</code>, <code>.xy</code>). Supported formats are described in the Measured Data Category section.</p> <p>Optionally, you can also specify the additional parameters that define the type of experiment you want to create. If you do not specify any of these parameters, the default values will be used, which are the first in the list of supported options for each parameter:</p> <ul> <li>sample_form: The form of the sample (powder, single crystal).</li> <li>beam_mode: The mode of the beam (constant wavelength, time-of-flight).</li> <li>radiation_probe: The type of radiation used (neutron, X-ray).</li> <li>scattering_type: The type of scattering (bragg, total).</li> </ul> <p>Important</p> <p>It is important to mention that once an experiment is added, you cannot change these parameters. If you need to change them, you must create a new experiment or redefine the existing one.</p> <p>Here is an example of how to add an experiment with all relevant components explicitly defined:</p> <pre><code># Add an experiment with default parameters, based on the specified type.\nproject.experiments.add_from_data_path(name='hrpt',\n                                       data_path='data/hrpt_lbco.xye',\n                                       sample_form='powder',\n                                       beam_mode='constant wavelength',\n                                       radiation_probe='neutron',\n                                       scattering_type='bragg')\n</code></pre> <p>To add an experiment of default type, you can simply do:</p> <pre><code># Add an experiment of default type\nproject.experiments.add_from_data_path(name='hrpt',\n                                       data_path='data/hrpt_lbco.xye')\n</code></pre> <p>If you do not have measured data for fitting and only want to view the simulated pattern, you can define an experiment without measured data using the <code>add_without_data</code> method:</p> <pre><code># Add an experiment without measured data\nproject.experiments.add_without_data(name='hrpt',\n                                     sample_form='powder',\n                                     beam_mode='constant wavelength',\n                                     radiation_probe='x-ray')\n</code></pre> <p>Finally, you can also add an experiment by passing the experiment object directly using the <code>add</code> method:</p> <pre><code># Add an experiment by passing the experiment object directly\nfrom easydiffraction import Experiment\nexperiment = Experiment(name='hrpt',\n                        sample_form='powder',\n                        beam_mode='constant wavelength',\n                        radiation_probe='neutron',\n                        scattering_type='bragg')\nproject.experiments.add(experiment)\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#modifying-parameters","title":"Modifying Parameters","text":"<p>When an experiment is added, it is created with a set of default parameters that you can modify to match your specific experimental setup. All parameters are grouped into categories based on their function, making it easier to manage and understand the different aspects of the experiment:</p> <ol> <li>Instrument Category: Defines the instrument configuration, including    wavelength, two-theta offset, and resolution parameters.</li> <li>Peak Category: Specifies the peak profile type and its parameters, such    as broadening and asymmetry.</li> <li>Background Category: Defines the background type and allows you to add    background points.</li> <li>Linked Phases Category: Links the sample model defined in the previous    step to the experiment, allowing you to specify the scale factor for the    linked phase.</li> <li>Measured Data Category: Contains the measured data. The expected format    depends on the experiment type, but generally includes columns for 2\u03b8 angle    or TOF and intensity.</li> </ol>"},{"location":"user-guide/analysis-workflow/experiment/#instrument-category","title":"1. Instrument Category","text":"<pre><code># Modify the default instrument parameters\nproject.experiments['hrpt'].instrument.setup_wavelength = 1.494\nproject.experiments['hrpt'].instrument.calib_twotheta_offset = 0.6\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#excluded-regions-category","title":"2. Excluded Regions Category","text":"<pre><code># Add excluded regions to the experiment\nproject.experiments['hrpt'].excluded_regions.add(start=0, end=10)\nproject.experiments['hrpt'].excluded_regions.add(start=160, end=180)\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#peak-category","title":"3. Peak Category","text":"<pre><code># Select the desired peak profile type\nproject.experiments['hrpt'].peak_profile_type = 'pseudo-voigt'\n\n# Modify default peak profile parameters\nproject.experiments['hrpt'].peak.broad_gauss_u = 0.1\nproject.experiments['hrpt'].peak.broad_gauss_v = -0.1\nproject.experiments['hrpt'].peak.broad_gauss_w = 0.1\nproject.experiments['hrpt'].peak.broad_lorentz_x = 0\nproject.experiments['hrpt'].peak.broad_lorentz_y = 0.1\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#background-category","title":"4. Background Category","text":"<pre><code># Select the desired background type\nproject.experiments['hrpt'].background_type = 'line-segment'\n\n# Add background points\nproject.experiments['hrpt'].background.add(x=10, y=170)\nproject.experiments['hrpt'].background.add(x=30, y=170)\nproject.experiments['hrpt'].background.add(x=50, y=170)\nproject.experiments['hrpt'].background.add(x=110, y=170)\nproject.experiments['hrpt'].background.add(x=165, y=170)\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#linked-phases-category","title":"5. Linked Phases Category","text":"<pre><code># Link the sample model defined in the previous step to the experiment\nproject.experiments['hrpt'].linked_phases.add(id='lbco', scale=10.0)\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#measured-data-category","title":"6. Measured Data Category","text":"<p>If you do not have a CIF file for your experiment, you can load measured data from a file in a supported format. The measured data will be automatically converted into CIF format and added to the experiment. The expected format depends on the experiment type.</p>"},{"location":"user-guide/analysis-workflow/experiment/#supported-data-file-formats","title":"Supported data file formats:","text":"<ul> <li><code>.xye</code> or <code>.xys</code> (3 columns, including standard deviations)</li> <li>_pd_meas.2theta_scan</li> <li>_pd_meas.intensity_total</li> <li>_pd_meas.intensity_total_su</li> <li><code>.xy</code> (2 columns, no standard deviations):</li> <li>_pd_meas.2theta_scan</li> <li>_pd_meas.intensity_total</li> </ul> <p>If no standard deviations are provided, they are automatically calculated as the square root of measured intensities.</p> <p>Optional comments with <code>#</code> are possible in data file headers.</p> <p>Here are some examples:</p>"},{"location":"user-guide/analysis-workflow/experiment/#example1xye","title":"example1.xye","text":"<pre>\n# 2theta  intensity    su\n   10.00     167      12.6\n   10.05     157      12.5\n   10.10     187      13.3\n   10.15     197      14.0\n   10.20     164      12.5\n  ...\n  164.65     173      30.1\n  164.70     187      27.9\n  164.75     175      38.2\n  164.80     168      30.9\n  164.85     109      41.2\n</pre>"},{"location":"user-guide/analysis-workflow/experiment/#example2xy","title":"example2.xy","text":"<pre>\n# 2theta  intensity\n   10.00     167    \n   10.05     157    \n   10.10     187    \n   10.15     197    \n   10.20     164    \n  ...\n  164.65     173    \n  164.70     187    \n  164.75     175    \n  164.80     168    \n  164.85     109  \n</pre>"},{"location":"user-guide/analysis-workflow/experiment/#example3xy","title":"example3.xy","text":"<pre>\n10  167.3    \n10.05  157.4    \n10.1  187.1    \n10.15  197.8    \n10.2  164.9    \n...\n164.65  173.3    \n164.7  187.5    \n164.75  175.8    \n164.8  168.1    \n164.85  109     \n</pre>"},{"location":"user-guide/analysis-workflow/experiment/#listing-defined-experiments","title":"Listing Defined Experiments","text":"<p>To check which experiments have been added to the <code>project</code>, use:</p> <pre><code># Show defined experiments\nproject.experiments.show_names()\n</code></pre> <p>Expected output:</p> <pre><code>Defined experiments \ud83d\udd2c\n['hrpt']\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#viewing-an-experiment-as-cif","title":"Viewing an Experiment as CIF","text":"<p>To inspect an experiment in CIF format, use:</p> <pre><code># Show experiment as CIF\nproject.experiments['hrpt'].show_as_cif()\n</code></pre> <p>Example output:</p> <pre><code>Experiment \ud83d\udd2c 'hrpt' as cif\n\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n\u2502 data_hrpt                                   \u2502\n\u2502                                             \u2502\n\u2502 _expt_type.beam_mode  \"constant wavelength\" \u2502\n\u2502 _expt_type.radiation_probe  neutron         \u2502\n\u2502 _expt_type.sample_form  powder              \u2502\n\u2502 _expt_type.scattering_type  bragg           \u2502\n\u2502                                             \u2502\n\u2502 _instr.2theta_offset  0.6                   \u2502\n\u2502 _instr.wavelength  1.494                    \u2502\n\u2502                                             \u2502\n\u2502 _peak.broad_gauss_u  0.1                    \u2502\n\u2502 _peak.broad_gauss_v  -0.1                   \u2502\n\u2502 _peak.broad_gauss_w  0.1                    \u2502\n\u2502 _peak.broad_lorentz_x  0                    \u2502\n\u2502 _peak.broad_lorentz_y  0.1                  \u2502\n\u2502                                             \u2502\n\u2502 loop_                                       \u2502\n\u2502 _pd_phase_block.id                          \u2502\n\u2502 _pd_phase_block.scale                       \u2502\n\u2502 lbco 10.0                                   \u2502\n\u2502                                             \u2502\n\u2502 loop_                                       \u2502\n\u2502 _pd_background.line_segment_X               \u2502\n\u2502 _pd_background.line_segment_intensity       \u2502\n\u2502 10 170                                      \u2502\n\u2502 30 170                                      \u2502\n\u2502 50 170                                      \u2502\n\u2502 110 170                                     \u2502\n\u2502 165 170                                     \u2502\n\u2502                                             \u2502\n\u2502 loop_                                       \u2502\n\u2502 _pd_meas.2theta_scan                        \u2502\n\u2502 _pd_meas.intensity_total                    \u2502\n\u2502 _pd_meas.intensity_total_su                 \u2502\n\u2502 10.0 167.0 12.6                             \u2502\n\u2502 10.05 157.0 12.5                            \u2502\n\u2502 10.1 187.0 13.3                             \u2502\n\u2502 10.15 197.0 14.0                            \u2502\n\u2502 10.2 164.0 12.5                             \u2502\n\u2502 ...                                         \u2502\n\u2502 164.65 173.0 30.1                           \u2502\n\u2502 164.7 187.0 27.9                            \u2502\n\u2502 164.75 175.0 38.2                           \u2502\n\u2502 164.8 168.0 30.9                            \u2502\n\u2502 164.85 109.0 41.2                           \u2502\n\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b\n</code></pre>"},{"location":"user-guide/analysis-workflow/experiment/#saving-an-experiment","title":"Saving an Experiment","text":"<p>Saving the project, as described in the Project section, will  also save the experiment. Each experiment is saved as a separate CIF file in  the <code>experiments</code> subdirectory of the project directory. The project file  contains references to these files.</p> <p>EasyDiffraction supports different types of experiments, and each experiment  is saved in a dedicated CIF file with experiment-specific parameters. </p> <p>Below are examples of how different experiments are saved in CIF format.</p>"},{"location":"user-guide/analysis-workflow/experiment/#pd-neut-cwl","title":"pd-neut-cwl","text":"<p>This example represents a constant-wavelength neutron powder diffraction experiment:</p> <pre>\ndata_hrpt\n\n_expt_type.beam_mode        \"constant wavelength\"\n_expt_type.radiation_probe  neutron\n_expt_type.sample_form      powder\n_expt_type.scattering_type  bragg\n\n_instr.wavelength    1.494\n_instr.2theta_offset 0.6225(4)\n\n_peak.broad_gauss_u    0.0834\n_peak.broad_gauss_v   -0.1168\n_peak.broad_gauss_w    0.123\n_peak.broad_lorentz_x  0\n_peak.broad_lorentz_y  0.0797\n\nloop_\n_pd_phase_block.id\n_pd_phase_block.scale\nlbco 9.0976(3)\n\nloop_\n_pd_background.line_segment_X\n_pd_background.line_segment_intensity\n_pd_background.X_coordinate\n 10  174.3  2theta\n 20  159.8  2theta\n 30  167.9  2theta\n 50  166.1  2theta\n 70  172.3  2theta\n 90  171.1  2theta\n110  172.4  2theta\n130  182.5  2theta\n150  173.0  2theta\n165  171.1  2theta\n\nloop_\n_pd_meas.2theta_scan\n_pd_meas.intensity_total\n_pd_meas.intensity_total_su\n 10.00  167  12.6\n 10.05  157  12.5\n 10.10  187  13.3\n 10.15  197  14.0\n 10.20  164  12.5\n 10.25  171  13.0\n...\n164.60  153  20.7\n164.65  173  30.1\n164.70  187  27.9\n164.75  175  38.2\n164.80  168  30.9\n164.85  109  41.2\n</pre>"},{"location":"user-guide/analysis-workflow/experiment/#pd-neut-tof","title":"pd-neut-tof","text":"<p>This example demonstrates a time-of-flight neutron powder diffraction experiment:</p> <pre>\ndata_wish\n\n_diffrn_radiation.probe neutron\n\n_pd_instr.2theta_bank 152.827\n\n_pd_instr.dtt1 20773.1(3)\n_pd_instr.dtt2    -1.08308\n_pd_instr.zero   -13.7(5)\n\n_pd_instr.alpha0 -0.009(1)\n_pd_instr.alpha1  0.109(2)\n_pd_instr.beta0   0.00670(3)\n_pd_instr.beta1   0.0100(3)\n_pd_instr.sigma0  0\n_pd_instr.sigma1  0\n_pd_instr.sigma2 15.7(8)\n\nloop_\n_pd_phase_block.id\n_pd_phase_block.scale\nncaf 1.093(5)\n\nloop_\n_pd_background.line_segment_X\n_pd_background.line_segment_intensity\n_pd_background.X_coordinate\n  9162.3  465(38) time-of-flight\n 11136.8  593(30) time-of-flight\n 14906.5  546(18) time-of-flight\n 17352.2  496(14) time-of-flight\n 20179.5  452(10) time-of-flight\n 22176.0  468(12) time-of-flight\n 24644.7  380(6)  time-of-flight\n 28257.2  378(4)  time-of-flight\n 34034.4  328(4)  time-of-flight\n 41214.6  323(3)  time-of-flight\n 49830.9  273(3)  time-of-flight\n 58204.9  260(4)  time-of-flight\n 70186.9  262(5)  time-of-flight\n 82103.2  268(5)  time-of-flight\n102712.0  262(15) time-of-flight\n\nloop_\n_pd_meas.time_of_flight\n_pd_meas.intensity_total\n_pd_meas.intensity_total_su\n  9001.0  616.523  124.564\n  9006.8  578.769  123.141\n  9012.6  574.184  120.507\n  9018.5  507.739  111.300\n  9024.3  404.672  101.616\n  9030.1  469.244  107.991\n...\n103085.0  275.072   60.978\n103151.4  214.187   55.675\n103217.9  256.211   62.825\n103284.4  323.872   73.082\n103351.0  242.382   65.736\n103417.6  277.666   73.837\n</pre>"},{"location":"user-guide/analysis-workflow/experiment/#sc-neut-cwl","title":"sc-neut-cwl","text":"<p>This example represents a single-crystal neutron diffraction experiment:</p> <pre>\ndata_heidi\n\n_diffrn_radiation.probe                 neutron\n_diffrn_radiation_wavelength.wavelength 0.793\n\n_pd_calib.2theta_offset 0.6225(4)\n\n_pd_instr.resolution_u  0.0834\n_pd_instr.resolution_v -0.1168\n_pd_instr.resolution_w  0.123\n_pd_instr.resolution_x  0\n_pd_instr.resolution_y  0.0797\n\n_pd_instr.reflex_asymmetry_p1 0\n_pd_instr.reflex_asymmetry_p2 0\n_pd_instr.reflex_asymmetry_p3 0\n_pd_instr.reflex_asymmetry_p4 0\n\nloop_\n_exptl_crystal.id\n_exptl_crystal.scale\ntbti 2.92(6)\n\nloop_\n_refln.index_h\n_refln.index_k\n_refln.index_l\n_refln.intensity_meas\n_refln.intensity_meas_su\n 1  1  1   194.5677    2.3253\n 2  2  0    22.6319    1.1233\n 3  1  1    99.2917    2.5620\n 2  2  2   219.2877    3.2522\n...\n16  8  8    29.3063   12.6552\n17  7  7  1601.5154  628.8915\n13 13  7  1176.0896  414.6018\n19  5  1     0.8334   20.4207\n15  9  9    10.9864    8.0650\n12 12 10    14.4074   11.3800\n</pre> <p></p> <p>Now that the experiment has been defined, you can proceed to the next step: Analysis.</p>"},{"location":"user-guide/analysis-workflow/model/","title":"Sample Model","text":"<p>The Sample Model in EasyDiffraction represents the crystallographic structure used to calculate the diffraction pattern, which is then fitted to the experimentally measured data to refine the structural parameters.</p> <p>EasyDiffraction allows you to:</p> <ul> <li>Load an existing model from a file (CIF format).</li> <li>Manually define a new sample model by specifying crystallographic   parameters.</li> </ul> <p>Below, you will find instructions on how to define and manage crystallographic models in EasyDiffraction. It is assumed that you have already created a <code>project</code> object, as described in the Project section.</p>"},{"location":"user-guide/analysis-workflow/model/#adding-a-model-from-cif","title":"Adding a Model from CIF","text":"<p>This is the most straightforward way to define a sample model in EasyDiffraction. If you have a crystallographic information file (CIF) for your sample model, you can add it to your project using the <code>add_phase_from_file</code> method of the <code>project</code> instance. In this case, the name of the model will be taken from CIF.</p> <pre><code># Load a phase from a CIF file\nproject.add_phase_from_file('data/lbco.cif')\n</code></pre> <p>Accessing the model after loading it will be done through the <code>sample_models</code> object of the <code>project</code> instance. The name of the model will be the same as the data block id in the CIF file. For example, if the CIF file contains a data block with the id <code>lbco</code>,</p> <pre>\ndata_lbco\n\n_space_group.name_H-M_alt  \"P m -3 m\"\n...\n</pre> <p>you can access it in the code as follows:</p> <pre><code># Access the sample model by its name\nproject.sample_models['lbco']\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#defining-a-model-manually","title":"Defining a Model Manually","text":"<p>If you do not have a CIF file or prefer to define the model manually, you can use the <code>add</code> method of the <code>sample_models</code> object of the <code>project</code> instance. In this case, you will need to specify the name of the model, which will be used to reference it later.</p> <pre><code># Add a sample model with default parameters\n# The sample model name is used to reference it later.\nproject.sample_models.add(name='nacl')\n</code></pre> <p>The <code>add</code> method creates a new sample model with default parameters. You can then modify its parameters to match your specific crystallographic structure. All parameters are grouped into the following categories, which makes it easier to manage the model:</p> <ol> <li>Space Group Category: Defines the symmetry of the crystal structure.</li> <li>Cell Category: Specifies the dimensions and angles of the unit cell.</li> <li>Atom Sites Category: Describes the positions and properties of atoms    within the unit cell.</li> </ol>"},{"location":"user-guide/analysis-workflow/model/#space-group-category","title":"1. Space Group Category","text":"<pre><code># Set space group\nproject.sample_models['nacl'].space_group.name_h_m = 'F m -3 m'\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#cell-category","title":"2. Cell Category","text":"<pre><code># Define unit cell parameters\nproject.sample_models['nacl'].cell.length_a = 5.691694\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#atom-sites-category","title":"3. Atom Sites Category","text":"<pre><code># Add atomic sites\nproject.sample_models['nacl'].atom_sites.append(\n    label='Na',\n    type_symbol='Na',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0,\n    occupancy=1,\n    b_iso_or_equiv=0.5\n)\nproject.sample_models['nacl'].atom_sites.append(\n    label='Cl',\n    type_symbol='Cl',\n    fract_x=0,\n    fract_y=0,\n    fract_z=0.5,\n    occupancy=1,\n    b_iso_or_equiv=0.5\n)\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#listing-defined-models","title":"Listing Defined Models","text":"<p>To check which sample models have been added to the <code>project</code>, use:</p> <pre><code># Show defined sample models\nproject.sample_models.show_names()\n</code></pre> <p>Expected output:</p> <pre><code>Defined sample models \ud83e\udde9\n['lbco', 'nacl']\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#viewing-a-model-as-cif","title":"Viewing a Model as CIF","text":"<p>To inspect a sample model in CIF format, use:</p> <pre><code># Show sample model as CIF\nproject.sample_models['lbco'].show_as_cif()\n</code></pre> <p>Example output:</p> <pre><code>Sample model \ud83e\udde9 'lbco' as cif\n\u2552\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2555\n\u2502 data_lbco                                 \u2502\n\u2502                                           \u2502\n\u2502 _space_group.IT_coordinate_system_code  1 \u2502\n\u2502 _space_group.name_H-M_alt  \"P m -3 m\"     \u2502\n\u2502                                           \u2502\n\u2502 _cell.angle_alpha  90                     \u2502\n\u2502 _cell.angle_beta  90                      \u2502\n\u2502 _cell.angle_gamma  90                     \u2502\n\u2502 _cell.length_a  3.88                      \u2502\n\u2502 _cell.length_b  3.88                      \u2502\n\u2502 _cell.length_c  3.88                      \u2502\n\u2502                                           \u2502\n\u2502 loop_                                     \u2502\n\u2502 _atom_site.ADP_type                       \u2502\n\u2502 _atom_site.B_iso_or_equiv                 \u2502\n\u2502 _atom_site.fract_x                        \u2502\n\u2502 _atom_site.fract_y                        \u2502\n\u2502 _atom_site.fract_z                        \u2502\n\u2502 _atom_site.label                          \u2502\n\u2502 _atom_site.occupancy                      \u2502\n\u2502 _atom_site.type_symbol                    \u2502\n\u2502 _atom_site.Wyckoff_letter                 \u2502\n\u2502 Biso 0.5 0.0 0.0 0.0 La 0.5 La a          \u2502\n\u2502 Biso 0.5 0.0 0.0 0.0 Ba 0.5 Ba a          \u2502\n\u2502 Biso 0.5 0.5 0.5 0.5 Co 1.0 Co b          \u2502\n\u2502 Biso 0.5 0.0 0.5 0.5 O 1.0 O c            \u2502\n\u2558\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u255b\n</code></pre>"},{"location":"user-guide/analysis-workflow/model/#saving-a-model","title":"Saving a Model","text":"<p>Saving the project, as described in the Project section, will also save the model. Each model is saved as a separate CIF file in the <code>sample_models</code> subdirectory of the project directory. The project file contains references to these files.</p> <p>Below is an example of the saved CIF file for the <code>lbco</code> model:</p> <pre>\ndata_lbco\n\n_space_group.name_H-M_alt              \"P m -3 m\"\n_space_group.IT_coordinate_system_code 1\n\n_cell.length_a      3.8909\n_cell.length_b      3.8909\n_cell.length_c      3.8909\n_cell.angle_alpha  90\n_cell.angle_beta   90\n_cell.angle_gamma  90\n\nloop_\n_atom_site.label\n_atom_site.type_symbol\n_atom_site.fract_x\n_atom_site.fract_y\n_atom_site.fract_z\n_atom_site.Wyckoff_letter\n_atom_site.occupancy\n_atom_site.adp_type\n_atom_site.B_iso_or_equiv\nLa La   0   0   0     a   0.5  Biso 0.4958\nBa Ba   0   0   0     a   0.5  Biso 0.4943\nCo Co   0.5 0.5 0.5   b   1    Biso 0.2567\nO  O    0   0.5 0.5   c   1    Biso 1.4041\n</pre> <p></p> <p>Now that the crystallographic model has been defined and added to the project, you can proceed to the next step: Experiment.</p>"},{"location":"user-guide/analysis-workflow/project/","title":"Project","text":"<p>The Project serves as a container for all data and metadata associated with a particular data analysis task. It acts as the top-level entity in EasyDiffraction, ensuring structured organization and easy access to relevant information. Each project can contain multiple experimental datasets, with each dataset containing contribution from multiple sample models.</p> <p>EasyDiffraction allows you to:</p> <ul> <li>Manually create a new project by specifying its metadata.</li> <li>Load an existing project from a file (CIF format).</li> </ul> <p>Below are instructions on how to set up a project in EasyDiffraction. It is assumed that you have already imported the <code>easydiffraction</code> package, as described in the First Steps section.</p>"},{"location":"user-guide/analysis-workflow/project/#creating-a-project-manually","title":"Creating a Project Manually","text":"<p>You can manually create a new project and specify its short name, title and description. All these parameters are optional.</p> <pre><code># Create a new project\nproject = ed.Project(name='lbco_hrpt')\n\n# Define project info\nproject.info.title = 'La0.5Ba0.5CoO3 from neutron diffraction at HRPT@PSI'\nproject.info.description = '''This project demonstrates a standard refinement\nof La0.5Ba0.5CoO3, which crystallizes in a perovskite-type structure, using\nneutron powder diffraction data collected in constant wavelength mode at the\nHRPT diffractometer (PSI).'''\n</code></pre>"},{"location":"user-guide/analysis-workflow/project/#saving-a-project","title":"Saving a Project","text":"<p>Saving the initial project requires specifying the directory path:</p> <pre><code>project.save_as(dir_path='lbco_hrpt')\n</code></pre> <p>If working in the interactive mode in a Jupyter notebook or similar environment, you can also save the project after every significant change. This is useful for keeping track of changes and ensuring that your work is not lost. If you already saved the project with <code>save_as</code>, you can just call the <code>save</code>:</p> <pre><code>project.save()\n</code></pre>"},{"location":"user-guide/analysis-workflow/project/#loading-a-project-from-cif","title":"Loading a Project from CIF","text":"<p>If you have an existing project, you can load it directly from a CIF file. This is useful for reusing previously defined projects or sharing them with others.</p> <pre><code>project.load('data/lbco_hrpt.cif')\n</code></pre>"},{"location":"user-guide/analysis-workflow/project/#project-structure","title":"Project Structure","text":"<p>The example below illustrates a typical project structure for a constant-wavelength powder neutron diffraction experiment:</p> <pre>\n\ud83d\udcc1 La0.5Ba0.5CoO3     - Project directory.\n\u251c\u2500\u2500 \ud83d\udcc4 project.cif    - Main project description file.\n\u251c\u2500\u2500 \ud83d\udcc1 sample_models  - Folder with sample models (crystallographic structures).\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 lbco.cif   - File with La0.5Ba0.5CoO3 structure parameters.\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 \ud83d\udcc1 experiments    - Folder with instrumental parameters and measured data.\n\u2502   \u251c\u2500\u2500 \ud83d\udcc4 hrpt.cif   - Instrumental parameters and measured data from HRPT@PSI.\n\u2502   \u2514\u2500\u2500 ...\n\u251c\u2500\u2500 \ud83d\udcc4 analysis.cif   - Settings for data analysis (calculator, minimizer, etc.).\n\u2514\u2500\u2500 \ud83d\udcc1 summary\n    \u2514\u2500\u2500 \ud83d\udcc4 report.cif - Summary report after structure refinement.\n</pre>"},{"location":"user-guide/analysis-workflow/project/#project-files","title":"Project Files","text":"<p>Below is a complete project example stored in the <code>La0.5Ba0.5CoO3</code> directory, showing the contents of all files in the project.</p> <p>Important</p> <p>If you save the project right after creating it, the project directory will only contain the <code>project.cif</code> file. The other folders and files will be created as you add sample models, experiments, and set up the analysis. The summary folder will be created after the analysis is completed.</p>"},{"location":"user-guide/analysis-workflow/project/#1-projectcif","title":"1. project.cif","text":"<p>This file provides an overview of the project, including file names of the sample models and experiments associated with the project.</p> <pre>\ndata_La0.5Ba0.5CoO3\n\n_project.title       \"La0.5Ba0.5CoO3 from neutron diffraction at HRPT@PSI\"\n_project.description \"neutrons, powder, constant wavelength, HRPT@PSI\"\n\nloop_\n_sample_model.cif_file_name\nlbco.cif\n\nloop_\n_experiment.cif_file_name\nhrpt.cif\n</pre>"},{"location":"user-guide/analysis-workflow/project/#2-sample_models-lbcocif","title":"2. sample_models / lbco.cif","text":"<p>This file contains crystallographic information associated with the sample model, including space group, unit cell parameters, and atomic positions.</p> <pre>\ndata_lbco\n\n_space_group.name_H-M_alt              \"P m -3 m\"\n_space_group.IT_coordinate_system_code 1\n\n_cell.length_a      3.8909(1)\n_cell.length_b      3.8909\n_cell.length_c      3.8909\n_cell.angle_alpha  90\n_cell.angle_beta   90\n_cell.angle_gamma  90\n\nloop_\n_atom_site.label\n_atom_site.type_symbol\n_atom_site.fract_x\n_atom_site.fract_y\n_atom_site.fract_z\n_atom_site.Wyckoff_letter\n_atom_site.occupancy\n_atom_site.adp_type\n_atom_site.B_iso_or_equiv\nLa La   0   0   0     a   0.5  Biso 0.4958\nBa Ba   0   0   0     a   0.5  Biso 0.4943\nCo Co   0.5 0.5 0.5   b   1    Biso 0.2567\nO  O    0   0.5 0.5   c   1    Biso 1.4041\n</pre>"},{"location":"user-guide/analysis-workflow/project/#3-experiments-hrptcif","title":"3. experiments / hrpt.cif","text":"<p>This file contains the experiment type, instrumental parameters, peak parameters, associated phases, background parameters and measured diffraction data.</p> <pre>\ndata_hrpt\n\n_expt_type.beam_mode        \"constant wavelength\"\n_expt_type.radiation_probe  neutron\n_expt_type.sample_form      powder\n_expt_type.scattering_type  bragg\n\n_instr.wavelength    1.494\n_instr.2theta_offset 0.6225(4)\n\n_peak.broad_gauss_u    0.0834\n_peak.broad_gauss_v   -0.1168\n_peak.broad_gauss_w    0.123\n_peak.broad_lorentz_x  0\n_peak.broad_lorentz_y  0.0797\n\nloop_\n_pd_phase_block.id\n_pd_phase_block.scale\nlbco 9.0976(3)\n\nloop_\n_pd_background.line_segment_X\n_pd_background.line_segment_intensity\n_pd_background.X_coordinate\n 10  174.3  2theta\n 20  159.8  2theta\n 30  167.9  2theta\n 50  166.1  2theta\n 70  172.3  2theta\n 90  171.1  2theta\n110  172.4  2theta\n130  182.5  2theta\n150  173.0  2theta\n165  171.1  2theta\n\nloop_\n_pd_meas.2theta_scan\n_pd_meas.intensity_total\n_pd_meas.intensity_total_su\n 10.00  167  12.6\n 10.05  157  12.5\n 10.10  187  13.3\n 10.15  197  14.0\n 10.20  164  12.5\n 10.25  171  13.0\n...\n164.60  153  20.7\n164.65  173  30.1\n164.70  187  27.9\n164.75  175  38.2\n164.80  168  30.9\n164.85  109  41.2\n</pre>"},{"location":"user-guide/analysis-workflow/project/#4-analysiscif","title":"4. analysis.cif","text":"<p>This file contains settings used for data analysis, including the choice of calculation and fitting engines, as well as user defined constraints.</p> <pre>\n_analysis.calculator_engine  cryspy\n_analysis.fitting_engine     \"lmfit (leastsq)\"\n_analysis.fit_mode           single\n\nloop_\n_alias.label\n_alias.param_uid\nbiso_La  lbco.atom_site.La.B_iso_or_equiv\nbiso_Ba  lbco.atom_site.Ba.B_iso_or_equiv\nocc_La   lbco.atom_site.La.occupancy\nocc_Ba   lbco.atom_site.Ba.occupancy\n\nloop_\n_constraint.lhs_alias\n_constraint.rhs_expr\nbiso_Ba  biso_La\nocc_Ba   \"1 - occ_La\"\n</pre> <p></p> <p>Now that the Project has been defined, you can proceed to the next step: Sample Model.</p>"},{"location":"user-guide/analysis-workflow/summary/","title":"Summary","text":"<p>The Summary section represents the final step in the data processing workflow. It involves generating a summary report that consolidates the results of the diffraction data analysis, providing a comprehensive overview of the model refinement process and its outcomes.</p>"},{"location":"user-guide/analysis-workflow/summary/#contents-of-the-summary-report","title":"Contents of the Summary Report","text":"<p>The summary report includes key details such as:</p> <ul> <li>Final refined model parameters \u2013 Optimized crystallographic and instrumental   parameters.</li> <li>Goodness-of-fit indicators \u2013 Metrics such as R-factors, chi-square (\u03c7\u00b2), and   residuals.</li> <li>Graphical representation \u2013 Visualization of experimental vs. calculated   diffraction patterns.</li> </ul>"},{"location":"user-guide/analysis-workflow/summary/#viewing-the-summary-report","title":"Viewing the Summary Report","text":"<p>Users can print the summary report using:</p> <pre><code># Generate and print the summary report\nproject.summary.show_report()\n</code></pre>"},{"location":"user-guide/analysis-workflow/summary/#saving-a-summary","title":"Saving a Summary","text":"<p>Saving the project, as described in the Project section, will also save the summary report to the <code>summary.cif</code> inside the project directory.</p> <p>Now that the initial user guide is complete, you can explore the EasyDiffraction API for detailed information on the available classes and methods. Additionally, you can find practical examples and step-by-step guides in the Tutorials.</p>"},{"location":"user-guide/parameters/_diffrn_radiation/","title":"diffrn radiation","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/_diffrn_radiation/#_diffrn_radiation","title":"_diffrn_radiation","text":"<p>Data items in this category describe the radiation used in measuring the diffraction intensities. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/_diffrn_radiation/#_diffrn_radiationprobe","title":"_diffrn_radiation.probe","text":"<p>The nature of the radiation used (i.e. the name of the subatomic particle or the region of the electromagnetic spectrum).</p> <p>Supported values: <code>neutron</code> and <code>x-ray</code></p>"},{"location":"user-guide/parameters/_diffrn_radiation_wavelength/","title":"diffrn radiation wavelength","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/_diffrn_radiation_wavelength/#_diffrn_radiation_wavelength","title":"_diffrn_radiation_wavelength","text":"<p>Data items in this category describe the wavelength of radiation used in diffraction measurements. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/_diffrn_radiation_wavelength/#_diffrn_radiation_wavelengthwavelength","title":"_diffrn_radiation_wavelength.wavelength","text":"<p>Wavelength of the radiation used to measure the unit cell.</p>"},{"location":"user-guide/parameters/_exptl_crystal/","title":"exptl crystal","text":"<p>customCIF</p>"},{"location":"user-guide/parameters/_extinction/","title":"extinction","text":"<p>customCIF</p>"},{"location":"user-guide/parameters/_pd_calib/","title":"pd calib","text":"<p>customCIF</p>"},{"location":"user-guide/parameters/_pd_calib/#_pd_calib","title":"_pd_calib","text":"<p>This section defines the parameters used for the calibration of the instrument, similar to this IUCr section.</p>"},{"location":"user-guide/parameters/_pd_calib/#_pd_calib2theta_offset","title":"_pd_calib.2theta_offset","text":"<p>An offset angle (in degrees) used to calibrate 2\u03b8.</p>"},{"location":"user-guide/parameters/atom_site/","title":"Atom site","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/atom_site/#_atom_site","title":"_atom_site","text":"<p>Data items in this category record details about the atom sites in a crystal structure, such as the positional coordinates and atomic displacement parameters. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_sitelabel","title":"_atom_site.label","text":"<p>This is a unique identifier for a particular site in the asymmetric unit of the crystal unit cell.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_sitetype_symbol","title":"_atom_site.type_symbol","text":"<p>A code to identify the atom specie(s) occupying this site.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_sitefract","title":"_atom_site.fract","text":"<p>Atom-site coordinates as fractions of the _cell_length values.</p> <ul> <li>_atom_site.fract_x</li> <li>_atom_site.fract_y</li> <li>_atom_site.fract_z</li> </ul>"},{"location":"user-guide/parameters/atom_site/#_atom_siteoccupancy","title":"_atom_site.occupancy","text":"<p>The fraction of the atom type present at this site.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_siteadp_type","title":"_atom_site.ADP_type","text":"<p>Code for type of atomic displacement parameters used for the site. Currently only <code>Biso</code> (isotropic B) is supported.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_siteb_iso_or_equiv","title":"_atom_site.B_iso_or_equiv","text":"<p>Isotropic atomic displacement parameter, or equivalent isotropic atomic displacement parameter, in angstroms squared.</p>"},{"location":"user-guide/parameters/atom_site/#_atom_sitesite_symmetry_multiplicity","title":"_atom_site.site_symmetry_multiplicity","text":"<p><code>optional parameter</code></p> <p>The number of different sites that are generated by the application of the space-group symmetry to the coordinates given for this site. It is equal to the multiplicity given for this Wyckoff site in International Tables for Crystallography Vol. A (2002).</p>"},{"location":"user-guide/parameters/atom_site/#_atom_sitewyckoff_symbol","title":"_atom_site.Wyckoff_symbol","text":"<p><code>optional parameter</code></p> <p>The Wyckoff symbol (letter) as listed in the space-group tables of International Tables for Crystallography Vol. A.</p>"},{"location":"user-guide/parameters/background/","title":"Background","text":"<p>pdCIF</p>"},{"location":"user-guide/parameters/background/#_pd_background","title":"_pd_background","text":"<p>This category defines various background functions that could be used when calculating diffractograms. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/background/#_pd_backgroundline_segment_x","title":"_pd_background.line_segment_X","text":"<p>List of X-coordinates used to create many straight-line segments representing the background in a calculated diffractogram.</p> <p>Supported values: <code>2theta</code> and <code>time-of-flight</code></p>"},{"location":"user-guide/parameters/background/#_pd_backgroundline_segment_intensity","title":"_pd_background.line_segment_intensity","text":"<p>List of intensities used to create many straight-line segments representing the background in a calculated diffractogram.</p>"},{"location":"user-guide/parameters/background/#_pd_backgroundx_coordinate","title":"_pd_background.X_coordinate","text":"<p>The type of X-coordinate against which the pd_background values were calculated.</p>"},{"location":"user-guide/parameters/cell/","title":"Cell","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/cell/#_cell","title":"_cell","text":"<p>Data items in this category record details about the crystallographic cell parameters and their measurement. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/cell/#_cellangle","title":"_cell.angle","text":"<p>The angles between the bounding cell axes in degrees.</p> <ul> <li>_cell.angle_alpha</li> <li>_cell.angle_beta</li> <li>_cell.angle_gamma</li> </ul>"},{"location":"user-guide/parameters/cell/#_celllength","title":"_cell.length","text":"<p>The lengths of each cell axis in angstroms.</p> <ul> <li>_cell.length_a</li> <li>_cell.length_b</li> <li>_cell.length_c</li> </ul>"},{"location":"user-guide/parameters/expt_type/","title":"Expt type","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/expt_type/#_cell","title":"_cell","text":"<p>Data items in this category record details about the crystallographic cell parameters and their measurement. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/expt_type/#_cellangle","title":"_cell.angle","text":"<p>The angles between the bounding cell axes in degrees.</p> <ul> <li>_cell.angle_alpha</li> <li>_cell.angle_beta</li> <li>_cell.angle_gamma</li> </ul>"},{"location":"user-guide/parameters/expt_type/#_celllength","title":"_cell.length","text":"<p>The lengths of each cell axis in angstroms.</p> <ul> <li>_cell.length_a</li> <li>_cell.length_b</li> <li>_cell.length_c</li> </ul>"},{"location":"user-guide/parameters/instrument/","title":"Instrument","text":"<p>customCIF</p>"},{"location":"user-guide/parameters/instrument/#_pd_instr","title":"_pd_instr","text":"<p>This section contains information relevant to the instrument used for the diffraction measurement, similar to this IUCr section.</p>"},{"location":"user-guide/parameters/instrument/#_pd_instrresolution","title":"_pd_instr.resolution","text":"<p>In general, the profile of a Bragg reflection centred at the peak position can be approximated by mathematical convolution of contributions from the instrument, called the instrumental resolution function, and from the microstructure of the sample. Because many contributions to powder diffraction peaks have a nearly Gaussian or Lorentzian shape, the pseudo-Voigt function, is widely used to describe peak profiles in powder diffraction.</p> <p>Half-width parameters (normally characterising the instrumental resolution function) as implemented in CrysPy:</p> <ul> <li>_pd_instr.resolution_u</li> <li>_pd_instr.resolution_v</li> <li>_pd_instr.resolution_w</li> </ul> <p>Lorentzian isotropic microstrain parameter as implemented in CrysPy:</p> <ul> <li>_pd_instr.resolution_x</li> </ul> <p>Lorentzian isotropic particle size parameteras implemented in CrysPy:</p> <ul> <li>_pd_instr.resolution_y</li> </ul>"},{"location":"user-guide/parameters/instrument/#_pd_instrreflex_asymmetry","title":"_pd_instr.reflex_asymmetry","text":"<p>Peak profile asymmetry parameters as implemented in CrysPy.</p> <ul> <li>_pd_instr.reflex_asymmetry_p1</li> <li>_pd_instr.reflex_asymmetry_p2</li> <li>_pd_instr.reflex_asymmetry_p3</li> <li>_pd_instr.reflex_asymmetry_p4</li> </ul>"},{"location":"user-guide/parameters/instrument/#_pd_instr2theta_bank","title":"_pd_instr.2theta_bank","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p>"},{"location":"user-guide/parameters/instrument/#_pd_instrdtt","title":"_pd_instr.dtt","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p> <ul> <li>_pd_instr.dtt1</li> <li>_pd_instr.dtt2</li> </ul>"},{"location":"user-guide/parameters/instrument/#_pd_instrzero","title":"_pd_instr.zero","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p>"},{"location":"user-guide/parameters/instrument/#_pd_instralpha","title":"_pd_instr.alpha","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p> <ul> <li>_pd_instr.alpha0</li> <li>_pd_instr.alpha1</li> </ul>"},{"location":"user-guide/parameters/instrument/#_pd_instrbeta","title":"_pd_instr.beta","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p> <ul> <li>_pd_instr.beta0</li> <li>_pd_instr.beta1</li> </ul>"},{"location":"user-guide/parameters/instrument/#_pd_instrsigma","title":"_pd_instr.sigma","text":"<p>Time-of-flight parameters as implemented in CrysPy.</p> <ul> <li>_pd_instr.sigma0</li> <li>_pd_instr.sigma1</li> <li>_pd_instr.sigma2</li> </ul>"},{"location":"user-guide/parameters/linked_phases/","title":"Linked phases","text":"<p>pdCIF</p>"},{"location":"user-guide/parameters/linked_phases/#_pd_phase_block","title":"_pd_phase_block","text":"<p>A table of phases relevant to the current data block. Each phase is identified by its data block identifier. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/linked_phases/#_pd_phase_blockid","title":"_pd_phase_block.id","text":"<p>A block ID code identifying a block containing phase information.</p>"},{"location":"user-guide/parameters/linked_phases/#_pd_phase_blockscale","title":"_pd_phase_block.scale","text":"<p>Phase scale.</p>"},{"location":"user-guide/parameters/pd_meas/","title":"Pd meas","text":"<p>pdCIF</p>"},{"location":"user-guide/parameters/pd_meas/#_pd_meas","title":"_pd_meas","text":"<p>This section contains the measured diffractogram, similar to this IUCr section.</p>"},{"location":"user-guide/parameters/pd_meas/#_pd_meas2theta_scan","title":"_pd_meas.2theta_scan","text":"<p>2\u03b8 diffraction angle (in degrees) for intensity points measured in a scanning method.</p>"},{"location":"user-guide/parameters/pd_meas/#_pd_meastime-of-flight","title":"_pd_meas.time-of-flight","text":"<p>Measured time (in microseconds) for time-of-flight neutron measurements.</p>"},{"location":"user-guide/parameters/pd_meas/#_pd_measintensity_total","title":"_pd_meas.intensity_total","text":"<p>Intensity recorded at each measurement point as a function of angle.</p>"},{"location":"user-guide/parameters/pd_meas/#_pd_measintensity_total_su","title":"_pd_meas.intensity_total_su","text":"<p>Standard uncertainty of _pd_meas.2theta_scan.</p>"},{"location":"user-guide/parameters/peak/","title":"Peak","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/peak/#_cell","title":"_cell","text":"<p>Data items in this category record details about the crystallographic cell parameters and their measurement. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/peak/#_cellangle","title":"_cell.angle","text":"<p>The angles between the bounding cell axes in degrees.</p> <ul> <li>_cell.angle_alpha</li> <li>_cell.angle_beta</li> <li>_cell.angle_gamma</li> </ul>"},{"location":"user-guide/parameters/peak/#_celllength","title":"_cell.length","text":"<p>The lengths of each cell axis in angstroms.</p> <ul> <li>_cell.length_a</li> <li>_cell.length_b</li> <li>_cell.length_c</li> </ul>"},{"location":"user-guide/parameters/space_group/","title":"Space group","text":"<p>coreCIF</p>"},{"location":"user-guide/parameters/space_group/#_space_group","title":"_space_group","text":"<p>Contains all the data items that refer to the space group as a whole. Please see the IUCr page for further details.</p>"},{"location":"user-guide/parameters/space_group/#_space_groupname_h-m_alt","title":"_space_group.name_H-M_alt","text":"<p>The international Hermann-Mauguin space-group symbol as defined in International Tables for Crystallography Volume A. It allows any Hermann-Mauguin symbol to be given.</p>"},{"location":"user-guide/parameters/space_group/#_space_groupit_coordinate_system_code","title":"_space_group.IT_coordinate_system_code","text":"<p>A qualifier taken from the enumeration list identifying which setting in International Tables for Crystallography Volume A (2002) (IT) is used.</p>"}]}